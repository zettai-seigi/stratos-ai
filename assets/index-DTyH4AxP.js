function x7(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function xl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Yy={exports:{}},pf={};var vT;function g7(){if(vT)return pf;vT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,a,i){var s=null;if(i!==void 0&&(s=""+i),a.key!==void 0&&(s=""+a.key),"key"in a){i={};for(var c in a)c!=="key"&&(i[c]=a[c])}else i=a;return a=i.ref,{$$typeof:e,type:n,key:s,ref:a!==void 0?a:null,props:i}}return pf.Fragment=t,pf.jsx=r,pf.jsxs=r,pf}var yT;function v7(){return yT||(yT=1,Yy.exports=g7()),Yy.exports}var o=v7(),Xy={exports:{}},ot={};var bT;function y7(){if(bT)return ot;bT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),g=Symbol.iterator;function v(W){return W===null||typeof W!="object"?null:(W=g&&W[g]||W["@@iterator"],typeof W=="function"?W:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,w={};function j(W,F,X){this.props=W,this.context=F,this.refs=w,this.updater=X||b}j.prototype.isReactComponent={},j.prototype.setState=function(W,F){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,F,"setState")},j.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function T(){}T.prototype=j.prototype;function N(W,F,X){this.props=W,this.context=F,this.refs=w,this.updater=X||b}var C=N.prototype=new T;C.constructor=N,y(C,j.prototype),C.isPureReactComponent=!0;var E=Array.isArray;function O(){}var A={H:null,A:null,T:null,S:null},D=Object.prototype.hasOwnProperty;function M(W,F,X){var q=X.ref;return{$$typeof:e,type:W,key:F,ref:q!==void 0?q:null,props:X}}function P(W,F){return M(W.type,F,W.props)}function R(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function L(W){var F={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(X){return F[X]})}var te=/\/+/g;function ee(W,F){return typeof W=="object"&&W!==null&&W.key!=null?L(""+W.key):F.toString(36)}function ue(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(O,O):(W.status="pending",W.then(function(F){W.status==="pending"&&(W.status="fulfilled",W.value=F)},function(F){W.status==="pending"&&(W.status="rejected",W.reason=F)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function V(W,F,X,q,U){var G=typeof W;(G==="undefined"||G==="boolean")&&(W=null);var le=!1;if(W===null)le=!0;else switch(G){case"bigint":case"string":case"number":le=!0;break;case"object":switch(W.$$typeof){case e:case t:le=!0;break;case h:return le=W._init,V(le(W._payload),F,X,q,U)}}if(le)return U=U(W),le=q===""?"."+ee(W,0):q,E(U)?(X="",le!=null&&(X=le.replace(te,"$&/")+"/"),V(U,F,X,"",function(oe){return oe})):U!=null&&(R(U)&&(U=P(U,X+(U.key==null||W&&W.key===U.key?"":(""+U.key).replace(te,"$&/")+"/")+le)),F.push(U)),1;le=0;var de=q===""?".":q+":";if(E(W))for(var ne=0;ne<W.length;ne++)q=W[ne],G=de+ee(q,ne),le+=V(q,F,X,G,U);else if(ne=v(W),typeof ne=="function")for(W=ne.call(W),ne=0;!(q=W.next()).done;)q=q.value,G=de+ee(q,ne++),le+=V(q,F,X,G,U);else if(G==="object"){if(typeof W.then=="function")return V(ue(W),F,X,q,U);throw F=String(W),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return le}function K(W,F,X){if(W==null)return W;var q=[],U=0;return V(W,q,"","",function(G){return F.call(X,G,U++)}),q}function ie(W){if(W._status===-1){var F=W._result;F=F(),F.then(function(X){(W._status===0||W._status===-1)&&(W._status=1,W._result=X)},function(X){(W._status===0||W._status===-1)&&(W._status=2,W._result=X)}),W._status===-1&&(W._status=0,W._result=F)}if(W._status===1)return W._result.default;throw W._result}var re=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)},me={map:K,forEach:function(W,F,X){K(W,function(){F.apply(this,arguments)},X)},count:function(W){var F=0;return K(W,function(){F++}),F},toArray:function(W){return K(W,function(F){return F})||[]},only:function(W){if(!R(W))throw Error("React.Children.only expected to receive a single React element child.");return W}};return ot.Activity=p,ot.Children=me,ot.Component=j,ot.Fragment=r,ot.Profiler=a,ot.PureComponent=N,ot.StrictMode=n,ot.Suspense=d,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,ot.__COMPILER_RUNTIME={__proto__:null,c:function(W){return A.H.useMemoCache(W)}},ot.cache=function(W){return function(){return W.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(W,F,X){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var q=y({},W.props),U=W.key;if(F!=null)for(G in F.key!==void 0&&(U=""+F.key),F)!D.call(F,G)||G==="key"||G==="__self"||G==="__source"||G==="ref"&&F.ref===void 0||(q[G]=F[G]);var G=arguments.length-2;if(G===1)q.children=X;else if(1<G){for(var le=Array(G),de=0;de<G;de++)le[de]=arguments[de+2];q.children=le}return M(W.type,U,q)},ot.createContext=function(W){return W={$$typeof:s,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:i,_context:W},W},ot.createElement=function(W,F,X){var q,U={},G=null;if(F!=null)for(q in F.key!==void 0&&(G=""+F.key),F)D.call(F,q)&&q!=="key"&&q!=="__self"&&q!=="__source"&&(U[q]=F[q]);var le=arguments.length-2;if(le===1)U.children=X;else if(1<le){for(var de=Array(le),ne=0;ne<le;ne++)de[ne]=arguments[ne+2];U.children=de}if(W&&W.defaultProps)for(q in le=W.defaultProps,le)U[q]===void 0&&(U[q]=le[q]);return M(W,G,U)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(W){return{$$typeof:c,render:W}},ot.isValidElement=R,ot.lazy=function(W){return{$$typeof:h,_payload:{_status:-1,_result:W},_init:ie}},ot.memo=function(W,F){return{$$typeof:f,type:W,compare:F===void 0?null:F}},ot.startTransition=function(W){var F=A.T,X={};A.T=X;try{var q=W(),U=A.S;U!==null&&U(X,q),typeof q=="object"&&q!==null&&typeof q.then=="function"&&q.then(O,re)}catch(G){re(G)}finally{F!==null&&X.types!==null&&(F.types=X.types),A.T=F}},ot.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},ot.use=function(W){return A.H.use(W)},ot.useActionState=function(W,F,X){return A.H.useActionState(W,F,X)},ot.useCallback=function(W,F){return A.H.useCallback(W,F)},ot.useContext=function(W){return A.H.useContext(W)},ot.useDebugValue=function(){},ot.useDeferredValue=function(W,F){return A.H.useDeferredValue(W,F)},ot.useEffect=function(W,F){return A.H.useEffect(W,F)},ot.useEffectEvent=function(W){return A.H.useEffectEvent(W)},ot.useId=function(){return A.H.useId()},ot.useImperativeHandle=function(W,F,X){return A.H.useImperativeHandle(W,F,X)},ot.useInsertionEffect=function(W,F){return A.H.useInsertionEffect(W,F)},ot.useLayoutEffect=function(W,F){return A.H.useLayoutEffect(W,F)},ot.useMemo=function(W,F){return A.H.useMemo(W,F)},ot.useOptimistic=function(W,F){return A.H.useOptimistic(W,F)},ot.useReducer=function(W,F,X){return A.H.useReducer(W,F,X)},ot.useRef=function(W){return A.H.useRef(W)},ot.useState=function(W){return A.H.useState(W)},ot.useSyncExternalStore=function(W,F,X){return A.H.useSyncExternalStore(W,F,X)},ot.useTransition=function(){return A.H.useTransition()},ot.version="19.2.3",ot}var wT;function ad(){return wT||(wT=1,Xy.exports=y7()),Xy.exports}var k=ad();const Nt=xl(k),fI=x7({__proto__:null,default:Nt},[k]);var Zy={exports:{}},xf={},Qy={exports:{}},Jy={};var ST;function b7(){return ST||(ST=1,(function(e){function t(V,K){var ie=V.length;V.push(K);e:for(;0<ie;){var re=ie-1>>>1,me=V[re];if(0<a(me,K))V[re]=K,V[ie]=me,ie=re;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var K=V[0],ie=V.pop();if(ie!==K){V[0]=ie;e:for(var re=0,me=V.length,W=me>>>1;re<W;){var F=2*(re+1)-1,X=V[F],q=F+1,U=V[q];if(0>a(X,ie))q<me&&0>a(U,X)?(V[re]=U,V[q]=ie,re=q):(V[re]=X,V[F]=ie,re=F);else if(q<me&&0>a(U,ie))V[re]=U,V[q]=ie,re=q;else break e}}return K}function a(V,K){var ie=V.sortIndex-K.sortIndex;return ie!==0?ie:V.id-K.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,c=s.now();e.unstable_now=function(){return s.now()-c}}var d=[],f=[],h=1,p=null,g=3,v=!1,b=!1,y=!1,w=!1,j=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function C(V){for(var K=r(f);K!==null;){if(K.callback===null)n(f);else if(K.startTime<=V)n(f),K.sortIndex=K.expirationTime,t(d,K);else break;K=r(f)}}function E(V){if(y=!1,C(V),!b)if(r(d)!==null)b=!0,O||(O=!0,L());else{var K=r(f);K!==null&&ue(E,K.startTime-V)}}var O=!1,A=-1,D=5,M=-1;function P(){return w?!0:!(e.unstable_now()-M<D)}function R(){if(w=!1,O){var V=e.unstable_now();M=V;var K=!0;try{e:{b=!1,y&&(y=!1,T(A),A=-1),v=!0;var ie=g;try{t:{for(C(V),p=r(d);p!==null&&!(p.expirationTime>V&&P());){var re=p.callback;if(typeof re=="function"){p.callback=null,g=p.priorityLevel;var me=re(p.expirationTime<=V);if(V=e.unstable_now(),typeof me=="function"){p.callback=me,C(V),K=!0;break t}p===r(d)&&n(d),C(V)}else n(d);p=r(d)}if(p!==null)K=!0;else{var W=r(f);W!==null&&ue(E,W.startTime-V),K=!1}}break e}finally{p=null,g=ie,v=!1}K=void 0}}finally{K?L():O=!1}}}var L;if(typeof N=="function")L=function(){N(R)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ee=te.port2;te.port1.onmessage=R,L=function(){ee.postMessage(null)}}else L=function(){j(R,0)};function ue(V,K){A=j(function(){V(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_next=function(V){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var ie=g;g=K;try{return V()}finally{g=ie}},e.unstable_requestPaint=function(){w=!0},e.unstable_runWithPriority=function(V,K){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ie=g;g=V;try{return K()}finally{g=ie}},e.unstable_scheduleCallback=function(V,K,ie){var re=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?re+ie:re):ie=re,V){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=ie+me,V={id:h++,callback:K,priorityLevel:V,startTime:ie,expirationTime:me,sortIndex:-1},ie>re?(V.sortIndex=ie,t(f,V),r(d)===null&&V===r(f)&&(y?(T(A),A=-1):y=!0,ue(E,ie-re))):(V.sortIndex=me,t(d,V),b||v||(b=!0,O||(O=!0,L()))),V},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(V){var K=g;return function(){var ie=g;g=K;try{return V.apply(this,arguments)}finally{g=ie}}}})(Jy)),Jy}var NT;function w7(){return NT||(NT=1,Qy.exports=b7()),Qy.exports}var e1={exports:{}},qn={};var kT;function S7(){if(kT)return qn;kT=1;var e=ad();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)f+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(d,f,h){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:d,containerInfo:f,implementation:h}}var s=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return qn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,qn.createPortal=function(d,f){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return i(d,f,null,h)},qn.flushSync=function(d){var f=s.T,h=n.p;try{if(s.T=null,n.p=2,d)return d()}finally{s.T=f,n.p=h,n.d.f()}},qn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(d,f))},qn.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},qn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var h=f.as,p=c(h,f.crossOrigin),g=typeof f.integrity=="string"?f.integrity:void 0,v=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;h==="style"?n.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:p,integrity:g,fetchPriority:v}):h==="script"&&n.d.X(d,{crossOrigin:p,integrity:g,fetchPriority:v,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},qn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var h=c(f.as,f.crossOrigin);n.d.M(d,{crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(d)},qn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var h=f.as,p=c(h,f.crossOrigin);n.d.L(d,h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},qn.preloadModule=function(d,f){if(typeof d=="string")if(f){var h=c(f.as,f.crossOrigin);n.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:h,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(d)},qn.requestFormReset=function(d){n.d.r(d)},qn.unstable_batchedUpdates=function(d,f){return d(f)},qn.useFormState=function(d,f,h){return s.H.useFormState(d,f,h)},qn.useFormStatus=function(){return s.H.useHostTransitionStatus()},qn.version="19.2.3",qn}var _T;function hI(){if(_T)return e1.exports;_T=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),e1.exports=S7(),e1.exports}var jT;function N7(){if(jT)return xf;jT=1;var e=w7(),t=ad(),r=hI();function n(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function i(l){var u=l,m=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(m=u.return),l=u.return;while(l)}return u.tag===3?m:null}function s(l){if(l.tag===13){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function c(l){if(l.tag===31){var u=l.memoizedState;if(u===null&&(l=l.alternate,l!==null&&(u=l.memoizedState)),u!==null)return u.dehydrated}return null}function d(l){if(i(l)!==l)throw Error(n(188))}function f(l){var u=l.alternate;if(!u){if(u=i(l),u===null)throw Error(n(188));return u!==l?null:l}for(var m=l,x=u;;){var S=m.return;if(S===null)break;var _=S.alternate;if(_===null){if(x=S.return,x!==null){m=x;continue}break}if(S.child===_.child){for(_=S.child;_;){if(_===m)return d(S),l;if(_===x)return d(S),u;_=_.sibling}throw Error(n(188))}if(m.return!==x.return)m=S,x=_;else{for(var I=!1,H=S.child;H;){if(H===m){I=!0,m=S,x=_;break}if(H===x){I=!0,x=S,m=_;break}H=H.sibling}if(!I){for(H=_.child;H;){if(H===m){I=!0,m=_,x=S;break}if(H===x){I=!0,x=_,m=S;break}H=H.sibling}if(!I)throw Error(n(189))}}if(m.alternate!==x)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?l:u}function h(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l;for(l=l.child;l!==null;){if(u=h(l),u!==null)return u;l=l.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),T=Symbol.for("react.consumer"),N=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function L(l){return l===null||typeof l!="object"?null:(l=R&&l[R]||l["@@iterator"],typeof l=="function"?l:null)}var te=Symbol.for("react.client.reference");function ee(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===te?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case y:return"Fragment";case j:return"Profiler";case w:return"StrictMode";case E:return"Suspense";case O:return"SuspenseList";case M:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case b:return"Portal";case N:return l.displayName||"Context";case T:return(l._context.displayName||"Context")+".Consumer";case C:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case A:return u=l.displayName||null,u!==null?u:ee(l.type)||"Memo";case D:u=l._payload,l=l._init;try{return ee(l(u))}catch{}}return null}var ue=Array.isArray,V=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ie={pending:!1,data:null,method:null,action:null},re=[],me=-1;function W(l){return{current:l}}function F(l){0>me||(l.current=re[me],re[me]=null,me--)}function X(l,u){me++,re[me]=l.current,l.current=u}var q=W(null),U=W(null),G=W(null),le=W(null);function de(l,u){switch(X(G,u),X(U,l),X(q,null),u.nodeType){case 9:case 11:l=(l=u.documentElement)&&(l=l.namespaceURI)?zE(l):0;break;default:if(l=u.tagName,u=u.namespaceURI)u=zE(u),l=$E(u,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}F(q),X(q,l)}function ne(){F(q),F(U),F(G)}function oe(l){l.memoizedState!==null&&X(le,l);var u=q.current,m=$E(u,l.type);u!==m&&(X(U,l),X(q,m))}function Ae(l){U.current===l&&(F(q),F(U)),le.current===l&&(F(le),df._currentValue=ie)}var z,et;function Be(l){if(z===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);z=u&&u[1]||"",et=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+z+l+et}var Je=!1;function He(l,u){if(!l||Je)return"";Je=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(u){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(Se){var be=Se}Reflect.construct(l,[],Te)}else{try{Te.call()}catch(Se){be=Se}l.call(Te.prototype)}}else{try{throw Error()}catch(Se){be=Se}(Te=l())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(Se){if(Se&&be&&typeof Se.stack=="string")return[Se.stack,be.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=x.DetermineComponentFrameRoot(),I=_[0],H=_[1];if(I&&H){var se=I.split(`
`),xe=H.split(`
`);for(S=x=0;x<se.length&&!se[x].includes("DetermineComponentFrameRoot");)x++;for(;S<xe.length&&!xe[S].includes("DetermineComponentFrameRoot");)S++;if(x===se.length||S===xe.length)for(x=se.length-1,S=xe.length-1;1<=x&&0<=S&&se[x]!==xe[S];)S--;for(;1<=x&&0<=S;x--,S--)if(se[x]!==xe[S]){if(x!==1||S!==1)do if(x--,S--,0>S||se[x]!==xe[S]){var _e=`
`+se[x].replace(" at new "," at ");return l.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",l.displayName)),_e}while(1<=x&&0<=S);break}}}finally{Je=!1,Error.prepareStackTrace=m}return(m=l?l.displayName||l.name:"")?Be(m):""}function Ie(l,u){switch(l.tag){case 26:case 27:case 5:return Be(l.type);case 16:return Be("Lazy");case 13:return l.child!==u&&u!==null?Be("Suspense Fallback"):Be("Suspense");case 19:return Be("SuspenseList");case 0:case 15:return He(l.type,!1);case 11:return He(l.type.render,!1);case 1:return He(l.type,!0);case 31:return Be("Activity");default:return""}}function _t(l){try{var u="",m=null;do u+=Ie(l,m),m=l,l=l.return;while(l);return u}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}var Er=Object.prototype.hasOwnProperty,fe=e.unstable_scheduleCallback,Re=e.unstable_cancelCallback,bt=e.unstable_shouldYield,Ft=e.unstable_requestPaint,mt=e.unstable_now,sr=e.unstable_getCurrentPriorityLevel,It=e.unstable_ImmediatePriority,Tn=e.unstable_UserBlockingPriority,Xt=e.unstable_NormalPriority,hn=e.unstable_LowPriority,lt=e.unstable_IdlePriority,Tt=e.log,Cn=e.unstable_setDisableYieldValue,Zt=null,br=null;function aa(l){if(typeof Tt=="function"&&Cn(l),br&&typeof br.setStrictMode=="function")try{br.setStrictMode(Zt,l)}catch{}}var mn=Math.clz32?Math.clz32:$c,_d=Math.log,Ao=Math.LN2;function $c(l){return l>>>=0,l===0?32:31-(_d(l)/Ao|0)|0}var js=256,El=262144,wr=4194304;function rr(l){var u=l&42;if(u!==0)return u;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return l&261888;case 262144:case 524288:case 1048576:case 2097152:return l&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function Vr(l,u,m){var x=l.pendingLanes;if(x===0)return 0;var S=0,_=l.suspendedLanes,I=l.pingedLanes;l=l.warmLanes;var H=x&134217727;return H!==0?(x=H&~_,x!==0?S=rr(x):(I&=H,I!==0?S=rr(I):m||(m=H&~l,m!==0&&(S=rr(m))))):(H=x&~_,H!==0?S=rr(H):I!==0?S=rr(I):m||(m=x&~l,m!==0&&(S=rr(m)))),S===0?0:u!==0&&u!==S&&(u&_)===0&&(_=S&-S,m=u&-u,_>=m||_===32&&(m&4194048)!==0)?u:S}function Vn(l,u){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&u)===0}function Gn(l,u){switch(l){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pn(){var l=wr;return wr<<=1,(wr&62914560)===0&&(wr=4194304),l}function Wn(l){for(var u=[],m=0;31>m;m++)u.push(l);return u}function xa(l,u){l.pendingLanes|=u,u!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Pr(l,u,m,x,S,_){var I=l.pendingLanes;l.pendingLanes=m,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=m,l.entangledLanes&=m,l.errorRecoveryDisabledLanes&=m,l.shellSuspendCounter=0;var H=l.entanglements,se=l.expirationTimes,xe=l.hiddenUpdates;for(m=I&~m;0<m;){var _e=31-mn(m),Te=1<<_e;H[_e]=0,se[_e]=-1;var be=xe[_e];if(be!==null)for(xe[_e]=null,_e=0;_e<be.length;_e++){var Se=be[_e];Se!==null&&(Se.lane&=-536870913)}m&=~Te}x!==0&&Fa(l,x,0),_!==0&&S===0&&l.tag!==0&&(l.suspendedLanes|=_&~(I&~u))}function Fa(l,u,m){l.pendingLanes|=u,l.suspendedLanes&=~u;var x=31-mn(u);l.entangledLanes|=u,l.entanglements[x]=l.entanglements[x]|1073741824|m&261930}function An(l,u){var m=l.entangledLanes|=u;for(l=l.entanglements;m;){var x=31-mn(m),S=1<<x;S&u|l[x]&u&&(l[x]|=u),m&=~S}}function ga(l,u){var m=u&-u;return m=(m&42)!==0?1:Fi(m),(m&(l.suspendedLanes|u))!==0?0:m}function Fi(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function Li(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function B(){var l=K.p;return l!==0?l:(l=window.event,l===void 0?32:dT(l.type))}function J(l,u){var m=K.p;try{return K.p=l,u()}finally{K.p=m}}var Y=Math.random().toString(36).slice(2),Z="__reactFiber$"+Y,Q="__reactProps$"+Y,ae="__reactContainer$"+Y,ge="__reactEvents$"+Y,je="__reactListeners$"+Y,ve="__reactHandles$"+Y,ye="__reactResources$"+Y,we="__reactMarker$"+Y;function Oe(l){delete l[Z],delete l[Q],delete l[ge],delete l[je],delete l[ve]}function Pe(l){var u=l[Z];if(u)return u;for(var m=l.parentNode;m;){if(u=m[ae]||m[Z]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(l=YE(l);l!==null;){if(m=l[Z])return m;l=YE(l)}return u}l=m,m=l.parentNode}return null}function ze(l){if(l=l[Z]||l[ae]){var u=l.tag;if(u===5||u===6||u===13||u===31||u===26||u===27||u===3)return l}return null}function De(l){var u=l.tag;if(u===5||u===26||u===27||u===6)return l.stateNode;throw Error(n(33))}function Ue(l){var u=l[ye];return u||(u=l[ye]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function qe(l){l[we]=!0}var nr=new Set,ar={};function mr(l,u){li(l,u),li(l+"Capture",u)}function li(l,u){for(ar[l]=u,l=0;l<u.length;l++)nr.add(u[l])}var Oo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Tl={},is={};function jd(l){return Er.call(is,l)?!0:Er.call(Tl,l)?!1:Oo.test(l)?is[l]=!0:(Tl[l]=!0,!1)}function va(l,u,m){if(jd(u))if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":l.removeAttribute(u);return;case"boolean":var x=u.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){l.removeAttribute(u);return}}l.setAttribute(u,""+m)}}function wh(l,u,m){if(m===null)l.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(u);return}l.setAttribute(u,""+m)}}function Es(l,u,m,x){if(x===null)l.removeAttribute(m);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(m);return}l.setAttributeNS(u,m,""+x)}}function oi(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ik(l){var u=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function cB(l,u,m){var x=Object.getOwnPropertyDescriptor(l.constructor.prototype,u);if(!l.hasOwnProperty(u)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var S=x.get,_=x.set;return Object.defineProperty(l,u,{configurable:!0,get:function(){return S.call(this)},set:function(I){m=""+I,_.call(this,I)}}),Object.defineProperty(l,u,{enumerable:x.enumerable}),{getValue:function(){return m},setValue:function(I){m=""+I},stopTracking:function(){l._valueTracker=null,delete l[u]}}}}function $g(l){if(!l._valueTracker){var u=Ik(l)?"checked":"value";l._valueTracker=cB(l,u,""+l[u])}}function Rk(l){if(!l)return!1;var u=l._valueTracker;if(!u)return!0;var m=u.getValue(),x="";return l&&(x=Ik(l)?l.checked?"true":"false":l.value),l=x,l!==m?(u.setValue(l),!0):!1}function Sh(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var uB=/[\n"\\]/g;function ci(l){return l.replace(uB,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function Hg(l,u,m,x,S,_,I,H){l.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?l.type=I:l.removeAttribute("type"),u!=null?I==="number"?(u===0&&l.value===""||l.value!=u)&&(l.value=""+oi(u)):l.value!==""+oi(u)&&(l.value=""+oi(u)):I!=="submit"&&I!=="reset"||l.removeAttribute("value"),u!=null?Vg(l,I,oi(u)):m!=null?Vg(l,I,oi(m)):x!=null&&l.removeAttribute("value"),S==null&&_!=null&&(l.defaultChecked=!!_),S!=null&&(l.checked=S&&typeof S!="function"&&typeof S!="symbol"),H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?l.name=""+oi(H):l.removeAttribute("name")}function Mk(l,u,m,x,S,_,I,H){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(l.type=_),u!=null||m!=null){if(!(_!=="submit"&&_!=="reset"||u!=null)){$g(l);return}m=m!=null?""+oi(m):"",u=u!=null?""+oi(u):m,H||u===l.value||(l.value=u),l.defaultValue=u}x=x??S,x=typeof x!="function"&&typeof x!="symbol"&&!!x,l.checked=H?l.checked:!!x,l.defaultChecked=!!x,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(l.name=I),$g(l)}function Vg(l,u,m){u==="number"&&Sh(l.ownerDocument)===l||l.defaultValue===""+m||(l.defaultValue=""+m)}function Hc(l,u,m,x){if(l=l.options,u){u={};for(var S=0;S<m.length;S++)u["$"+m[S]]=!0;for(m=0;m<l.length;m++)S=u.hasOwnProperty("$"+l[m].value),l[m].selected!==S&&(l[m].selected=S),S&&x&&(l[m].defaultSelected=!0)}else{for(m=""+oi(m),u=null,S=0;S<l.length;S++){if(l[S].value===m){l[S].selected=!0,x&&(l[S].defaultSelected=!0);return}u!==null||l[S].disabled||(u=l[S])}u!==null&&(u.selected=!0)}}function Pk(l,u,m){if(u!=null&&(u=""+oi(u),u!==l.value&&(l.value=u),m==null)){l.defaultValue!==u&&(l.defaultValue=u);return}l.defaultValue=m!=null?""+oi(m):""}function Fk(l,u,m,x){if(u==null){if(x!=null){if(m!=null)throw Error(n(92));if(ue(x)){if(1<x.length)throw Error(n(93));x=x[0]}m=x}m==null&&(m=""),u=m}m=oi(u),l.defaultValue=m,x=l.textContent,x===m&&x!==""&&x!==null&&(l.value=x),$g(l)}function Vc(l,u){if(u){var m=l.firstChild;if(m&&m===l.lastChild&&m.nodeType===3){m.nodeValue=u;return}}l.textContent=u}var dB=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lk(l,u,m){var x=u.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?x?l.setProperty(u,""):u==="float"?l.cssFloat="":l[u]="":x?l.setProperty(u,m):typeof m!="number"||m===0||dB.has(u)?u==="float"?l.cssFloat=m:l[u]=(""+m).trim():l[u]=m+"px"}function Bk(l,u,m){if(u!=null&&typeof u!="object")throw Error(n(62));if(l=l.style,m!=null){for(var x in m)!m.hasOwnProperty(x)||u!=null&&u.hasOwnProperty(x)||(x.indexOf("--")===0?l.setProperty(x,""):x==="float"?l.cssFloat="":l[x]="");for(var S in u)x=u[S],u.hasOwnProperty(S)&&m[S]!==x&&Lk(l,S,x)}else for(var _ in u)u.hasOwnProperty(_)&&Lk(l,_,u[_])}function Gg(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fB=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hB=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nh(l){return hB.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}function Ts(){}var Wg=null;function qg(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var Gc=null,Wc=null;function Uk(l){var u=ze(l);if(u&&(l=u.stateNode)){var m=l[Q]||null;e:switch(l=u.stateNode,u.type){case"input":if(Hg(l,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),u=m.name,m.type==="radio"&&u!=null){for(m=l;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+ci(""+u)+'"][type="radio"]'),u=0;u<m.length;u++){var x=m[u];if(x!==l&&x.form===l.form){var S=x[Q]||null;if(!S)throw Error(n(90));Hg(x,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(u=0;u<m.length;u++)x=m[u],x.form===l.form&&Rk(x)}break e;case"textarea":Pk(l,m.value,m.defaultValue);break e;case"select":u=m.value,u!=null&&Hc(l,!!m.multiple,u,!1)}}}var Kg=!1;function zk(l,u,m){if(Kg)return l(u,m);Kg=!0;try{var x=l(u);return x}finally{if(Kg=!1,(Gc!==null||Wc!==null)&&(um(),Gc&&(u=Gc,l=Wc,Wc=Gc=null,Uk(u),l)))for(u=0;u<l.length;u++)Uk(l[u])}}function Ed(l,u){var m=l.stateNode;if(m===null)return null;var x=m[Q]||null;if(x===null)return null;m=x[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(l=l.type,x=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!x;break e;default:l=!1}if(l)return null;if(m&&typeof m!="function")throw Error(n(231,u,typeof m));return m}var Cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yg=!1;if(Cs)try{var Td={};Object.defineProperty(Td,"passive",{get:function(){Yg=!0}}),window.addEventListener("test",Td,Td),window.removeEventListener("test",Td,Td)}catch{Yg=!1}var Cl=null,Xg=null,kh=null;function $k(){if(kh)return kh;var l,u=Xg,m=u.length,x,S="value"in Cl?Cl.value:Cl.textContent,_=S.length;for(l=0;l<m&&u[l]===S[l];l++);var I=m-l;for(x=1;x<=I&&u[m-x]===S[_-x];x++);return kh=S.slice(l,1<x?1-x:void 0)}function _h(l){var u=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&u===13&&(l=13)):l=u,l===10&&(l=13),32<=l||l===13?l:0}function jh(){return!0}function Hk(){return!1}function ya(l){function u(m,x,S,_,I){this._reactName=m,this._targetInst=S,this.type=x,this.nativeEvent=_,this.target=I,this.currentTarget=null;for(var H in l)l.hasOwnProperty(H)&&(m=l[H],this[H]=m?m(_):_[H]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?jh:Hk,this.isPropagationStopped=Hk,this}return p(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=jh)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=jh)},persist:function(){},isPersistent:jh}),u}var Do={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eh=ya(Do),Cd=p({},Do,{view:0,detail:0}),mB=ya(Cd),Zg,Qg,Ad,Th=p({},Cd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ev,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==Ad&&(Ad&&l.type==="mousemove"?(Zg=l.screenX-Ad.screenX,Qg=l.screenY-Ad.screenY):Qg=Zg=0,Ad=l),Zg)},movementY:function(l){return"movementY"in l?l.movementY:Qg}}),Vk=ya(Th),pB=p({},Th,{dataTransfer:0}),xB=ya(pB),gB=p({},Cd,{relatedTarget:0}),Jg=ya(gB),vB=p({},Do,{animationName:0,elapsedTime:0,pseudoElement:0}),yB=ya(vB),bB=p({},Do,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),wB=ya(bB),SB=p({},Do,{data:0}),Gk=ya(SB),NB={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kB={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_B={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jB(l){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(l):(l=_B[l])?!!u[l]:!1}function ev(){return jB}var EB=p({},Cd,{key:function(l){if(l.key){var u=NB[l.key]||l.key;if(u!=="Unidentified")return u}return l.type==="keypress"?(l=_h(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?kB[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ev,charCode:function(l){return l.type==="keypress"?_h(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?_h(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),TB=ya(EB),CB=p({},Th,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wk=ya(CB),AB=p({},Cd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ev}),OB=ya(AB),DB=p({},Do,{propertyName:0,elapsedTime:0,pseudoElement:0}),IB=ya(DB),RB=p({},Th,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),MB=ya(RB),PB=p({},Do,{newState:0,oldState:0}),FB=ya(PB),LB=[9,13,27,32],tv=Cs&&"CompositionEvent"in window,Od=null;Cs&&"documentMode"in document&&(Od=document.documentMode);var BB=Cs&&"TextEvent"in window&&!Od,qk=Cs&&(!tv||Od&&8<Od&&11>=Od),Kk=" ",Yk=!1;function Xk(l,u){switch(l){case"keyup":return LB.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zk(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var qc=!1;function UB(l,u){switch(l){case"compositionend":return Zk(u);case"keypress":return u.which!==32?null:(Yk=!0,Kk);case"textInput":return l=u.data,l===Kk&&Yk?null:l;default:return null}}function zB(l,u){if(qc)return l==="compositionend"||!tv&&Xk(l,u)?(l=$k(),kh=Xg=Cl=null,qc=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return qk&&u.locale!=="ko"?null:u.data;default:return null}}var $B={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qk(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u==="input"?!!$B[l.type]:u==="textarea"}function Jk(l,u,m,x){Gc?Wc?Wc.push(x):Wc=[x]:Gc=x,u=gm(u,"onChange"),0<u.length&&(m=new Eh("onChange","change",null,m,x),l.push({event:m,listeners:u}))}var Dd=null,Id=null;function HB(l){ME(l,0)}function Ch(l){var u=De(l);if(Rk(u))return l}function e_(l,u){if(l==="change")return u}var t_=!1;if(Cs){var rv;if(Cs){var nv="oninput"in document;if(!nv){var r_=document.createElement("div");r_.setAttribute("oninput","return;"),nv=typeof r_.oninput=="function"}rv=nv}else rv=!1;t_=rv&&(!document.documentMode||9<document.documentMode)}function n_(){Dd&&(Dd.detachEvent("onpropertychange",a_),Id=Dd=null)}function a_(l){if(l.propertyName==="value"&&Ch(Id)){var u=[];Jk(u,Id,l,qg(l)),zk(HB,u)}}function VB(l,u,m){l==="focusin"?(n_(),Dd=u,Id=m,Dd.attachEvent("onpropertychange",a_)):l==="focusout"&&n_()}function GB(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return Ch(Id)}function WB(l,u){if(l==="click")return Ch(u)}function qB(l,u){if(l==="input"||l==="change")return Ch(u)}function KB(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var La=typeof Object.is=="function"?Object.is:KB;function Rd(l,u){if(La(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var m=Object.keys(l),x=Object.keys(u);if(m.length!==x.length)return!1;for(x=0;x<m.length;x++){var S=m[x];if(!Er.call(u,S)||!La(l[S],u[S]))return!1}return!0}function i_(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function s_(l,u){var m=i_(l);l=0;for(var x;m;){if(m.nodeType===3){if(x=l+m.textContent.length,l<=u&&x>=u)return{node:m,offset:u-l};l=x}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=i_(m)}}function l_(l,u){return l&&u?l===u?!0:l&&l.nodeType===3?!1:u&&u.nodeType===3?l_(l,u.parentNode):"contains"in l?l.contains(u):l.compareDocumentPosition?!!(l.compareDocumentPosition(u)&16):!1:!1}function o_(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var u=Sh(l.document);u instanceof l.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)l=u.contentWindow;else break;u=Sh(l.document)}return u}function av(l){var u=l&&l.nodeName&&l.nodeName.toLowerCase();return u&&(u==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||u==="textarea"||l.contentEditable==="true")}var YB=Cs&&"documentMode"in document&&11>=document.documentMode,Kc=null,iv=null,Md=null,sv=!1;function c_(l,u,m){var x=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;sv||Kc==null||Kc!==Sh(x)||(x=Kc,"selectionStart"in x&&av(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),Md&&Rd(Md,x)||(Md=x,x=gm(iv,"onSelect"),0<x.length&&(u=new Eh("onSelect","select",null,u,m),l.push({event:u,listeners:x}),u.target=Kc)))}function Io(l,u){var m={};return m[l.toLowerCase()]=u.toLowerCase(),m["Webkit"+l]="webkit"+u,m["Moz"+l]="moz"+u,m}var Yc={animationend:Io("Animation","AnimationEnd"),animationiteration:Io("Animation","AnimationIteration"),animationstart:Io("Animation","AnimationStart"),transitionrun:Io("Transition","TransitionRun"),transitionstart:Io("Transition","TransitionStart"),transitioncancel:Io("Transition","TransitionCancel"),transitionend:Io("Transition","TransitionEnd")},lv={},u_={};Cs&&(u_=document.createElement("div").style,"AnimationEvent"in window||(delete Yc.animationend.animation,delete Yc.animationiteration.animation,delete Yc.animationstart.animation),"TransitionEvent"in window||delete Yc.transitionend.transition);function Ro(l){if(lv[l])return lv[l];if(!Yc[l])return l;var u=Yc[l],m;for(m in u)if(u.hasOwnProperty(m)&&m in u_)return lv[l]=u[m];return l}var d_=Ro("animationend"),f_=Ro("animationiteration"),h_=Ro("animationstart"),XB=Ro("transitionrun"),ZB=Ro("transitionstart"),QB=Ro("transitioncancel"),m_=Ro("transitionend"),p_=new Map,ov="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ov.push("scrollEnd");function Bi(l,u){p_.set(l,u),mr(u,[l])}var Ah=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)},ui=[],Xc=0,cv=0;function Oh(){for(var l=Xc,u=cv=Xc=0;u<l;){var m=ui[u];ui[u++]=null;var x=ui[u];ui[u++]=null;var S=ui[u];ui[u++]=null;var _=ui[u];if(ui[u++]=null,x!==null&&S!==null){var I=x.pending;I===null?S.next=S:(S.next=I.next,I.next=S),x.pending=S}_!==0&&x_(m,S,_)}}function Dh(l,u,m,x){ui[Xc++]=l,ui[Xc++]=u,ui[Xc++]=m,ui[Xc++]=x,cv|=x,l.lanes|=x,l=l.alternate,l!==null&&(l.lanes|=x)}function uv(l,u,m,x){return Dh(l,u,m,x),Ih(l)}function Mo(l,u){return Dh(l,null,null,u),Ih(l)}function x_(l,u,m){l.lanes|=m;var x=l.alternate;x!==null&&(x.lanes|=m);for(var S=!1,_=l.return;_!==null;)_.childLanes|=m,x=_.alternate,x!==null&&(x.childLanes|=m),_.tag===22&&(l=_.stateNode,l===null||l._visibility&1||(S=!0)),l=_,_=_.return;return l.tag===3?(_=l.stateNode,S&&u!==null&&(S=31-mn(m),l=_.hiddenUpdates,x=l[S],x===null?l[S]=[u]:x.push(u),u.lane=m|536870912),_):null}function Ih(l){if(50<nf)throw nf=0,yy=null,Error(n(185));for(var u=l.return;u!==null;)l=u,u=l.return;return l.tag===3?l.stateNode:null}var Zc={};function JB(l,u,m,x){this.tag=l,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ba(l,u,m,x){return new JB(l,u,m,x)}function dv(l){return l=l.prototype,!(!l||!l.isReactComponent)}function As(l,u){var m=l.alternate;return m===null?(m=Ba(l.tag,u,l.key,l.mode),m.elementType=l.elementType,m.type=l.type,m.stateNode=l.stateNode,m.alternate=l,l.alternate=m):(m.pendingProps=u,m.type=l.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=l.flags&65011712,m.childLanes=l.childLanes,m.lanes=l.lanes,m.child=l.child,m.memoizedProps=l.memoizedProps,m.memoizedState=l.memoizedState,m.updateQueue=l.updateQueue,u=l.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=l.sibling,m.index=l.index,m.ref=l.ref,m.refCleanup=l.refCleanup,m}function g_(l,u){l.flags&=65011714;var m=l.alternate;return m===null?(l.childLanes=0,l.lanes=u,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=m.childLanes,l.lanes=m.lanes,l.child=m.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=m.memoizedProps,l.memoizedState=m.memoizedState,l.updateQueue=m.updateQueue,l.type=m.type,u=m.dependencies,l.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),l}function Rh(l,u,m,x,S,_){var I=0;if(x=l,typeof l=="function")dv(l)&&(I=1);else if(typeof l=="string")I=a7(l,m,q.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case M:return l=Ba(31,m,u,S),l.elementType=M,l.lanes=_,l;case y:return Po(m.children,S,_,u);case w:I=8,S|=24;break;case j:return l=Ba(12,m,u,S|2),l.elementType=j,l.lanes=_,l;case E:return l=Ba(13,m,u,S),l.elementType=E,l.lanes=_,l;case O:return l=Ba(19,m,u,S),l.elementType=O,l.lanes=_,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case N:I=10;break e;case T:I=9;break e;case C:I=11;break e;case A:I=14;break e;case D:I=16,x=null;break e}I=29,m=Error(n(130,l===null?"null":typeof l,"")),x=null}return u=Ba(I,m,u,S),u.elementType=l,u.type=x,u.lanes=_,u}function Po(l,u,m,x){return l=Ba(7,l,x,u),l.lanes=m,l}function fv(l,u,m){return l=Ba(6,l,null,u),l.lanes=m,l}function v_(l){var u=Ba(18,null,null,0);return u.stateNode=l,u}function hv(l,u,m){return u=Ba(4,l.children!==null?l.children:[],l.key,u),u.lanes=m,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}var y_=new WeakMap;function di(l,u){if(typeof l=="object"&&l!==null){var m=y_.get(l);return m!==void 0?m:(u={value:l,source:u,stack:_t(u)},y_.set(l,u),u)}return{value:l,source:u,stack:_t(u)}}var Qc=[],Jc=0,Mh=null,Pd=0,fi=[],hi=0,Al=null,ss=1,ls="";function Os(l,u){Qc[Jc++]=Pd,Qc[Jc++]=Mh,Mh=l,Pd=u}function b_(l,u,m){fi[hi++]=ss,fi[hi++]=ls,fi[hi++]=Al,Al=l;var x=ss;l=ls;var S=32-mn(x)-1;x&=~(1<<S),m+=1;var _=32-mn(u)+S;if(30<_){var I=S-S%5;_=(x&(1<<I)-1).toString(32),x>>=I,S-=I,ss=1<<32-mn(u)+S|m<<S|x,ls=_+l}else ss=1<<_|m<<S|x,ls=l}function mv(l){l.return!==null&&(Os(l,1),b_(l,1,0))}function pv(l){for(;l===Mh;)Mh=Qc[--Jc],Qc[Jc]=null,Pd=Qc[--Jc],Qc[Jc]=null;for(;l===Al;)Al=fi[--hi],fi[hi]=null,ls=fi[--hi],fi[hi]=null,ss=fi[--hi],fi[hi]=null}function w_(l,u){fi[hi++]=ss,fi[hi++]=ls,fi[hi++]=Al,ss=u.id,ls=u.overflow,Al=l}var On=null,lr=null,kt=!1,Ol=null,mi=!1,xv=Error(n(519));function Dl(l){var u=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fd(di(u,l)),xv}function S_(l){var u=l.stateNode,m=l.type,x=l.memoizedProps;switch(u[Z]=l,u[Q]=x,m){case"dialog":yt("cancel",u),yt("close",u);break;case"iframe":case"object":case"embed":yt("load",u);break;case"video":case"audio":for(m=0;m<sf.length;m++)yt(sf[m],u);break;case"source":yt("error",u);break;case"img":case"image":case"link":yt("error",u),yt("load",u);break;case"details":yt("toggle",u);break;case"input":yt("invalid",u),Mk(u,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0);break;case"select":yt("invalid",u);break;case"textarea":yt("invalid",u),Fk(u,x.value,x.defaultValue,x.children)}m=x.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||u.textContent===""+m||x.suppressHydrationWarning===!0||BE(u.textContent,m)?(x.popover!=null&&(yt("beforetoggle",u),yt("toggle",u)),x.onScroll!=null&&yt("scroll",u),x.onScrollEnd!=null&&yt("scrollend",u),x.onClick!=null&&(u.onclick=Ts),u=!0):u=!1,u||Dl(l,!0)}function N_(l){for(On=l.return;On;)switch(On.tag){case 5:case 31:case 13:mi=!1;return;case 27:case 3:mi=!0;return;default:On=On.return}}function eu(l){if(l!==On)return!1;if(!kt)return N_(l),kt=!0,!1;var u=l.tag,m;if((m=u!==3&&u!==27)&&((m=u===5)&&(m=l.type,m=!(m!=="form"&&m!=="button")||Ry(l.type,l.memoizedProps)),m=!m),m&&lr&&Dl(l),N_(l),u===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));lr=KE(l)}else if(u===31){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));lr=KE(l)}else u===27?(u=lr,Wl(l.type)?(l=By,By=null,lr=l):lr=u):lr=On?xi(l.stateNode.nextSibling):null;return!0}function Fo(){lr=On=null,kt=!1}function gv(){var l=Ol;return l!==null&&(Na===null?Na=l:Na.push.apply(Na,l),Ol=null),l}function Fd(l){Ol===null?Ol=[l]:Ol.push(l)}var vv=W(null),Lo=null,Ds=null;function Il(l,u,m){X(vv,u._currentValue),u._currentValue=m}function Is(l){l._currentValue=vv.current,F(vv)}function yv(l,u,m){for(;l!==null;){var x=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,x!==null&&(x.childLanes|=u)):x!==null&&(x.childLanes&u)!==u&&(x.childLanes|=u),l===m)break;l=l.return}}function bv(l,u,m,x){var S=l.child;for(S!==null&&(S.return=l);S!==null;){var _=S.dependencies;if(_!==null){var I=S.child;_=_.firstContext;e:for(;_!==null;){var H=_;_=S;for(var se=0;se<u.length;se++)if(H.context===u[se]){_.lanes|=m,H=_.alternate,H!==null&&(H.lanes|=m),yv(_.return,m,l),x||(I=null);break e}_=H.next}}else if(S.tag===18){if(I=S.return,I===null)throw Error(n(341));I.lanes|=m,_=I.alternate,_!==null&&(_.lanes|=m),yv(I,m,l),I=null}else I=S.child;if(I!==null)I.return=S;else for(I=S;I!==null;){if(I===l){I=null;break}if(S=I.sibling,S!==null){S.return=I.return,I=S;break}I=I.return}S=I}}function tu(l,u,m,x){l=null;for(var S=u,_=!1;S!==null;){if(!_){if((S.flags&524288)!==0)_=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var I=S.alternate;if(I===null)throw Error(n(387));if(I=I.memoizedProps,I!==null){var H=S.type;La(S.pendingProps.value,I.value)||(l!==null?l.push(H):l=[H])}}else if(S===le.current){if(I=S.alternate,I===null)throw Error(n(387));I.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(l!==null?l.push(df):l=[df])}S=S.return}l!==null&&bv(u,l,m,x),u.flags|=262144}function Ph(l){for(l=l.firstContext;l!==null;){if(!La(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function Bo(l){Lo=l,Ds=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Dn(l){return k_(Lo,l)}function Fh(l,u){return Lo===null&&Bo(l),k_(l,u)}function k_(l,u){var m=u._currentValue;if(u={context:u,memoizedValue:m,next:null},Ds===null){if(l===null)throw Error(n(308));Ds=u,l.dependencies={lanes:0,firstContext:u},l.flags|=524288}else Ds=Ds.next=u;return m}var e9=typeof AbortController<"u"?AbortController:function(){var l=[],u=this.signal={aborted:!1,addEventListener:function(m,x){l.push(x)}};this.abort=function(){u.aborted=!0,l.forEach(function(m){return m()})}},t9=e.unstable_scheduleCallback,r9=e.unstable_NormalPriority,Gr={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function wv(){return{controller:new e9,data:new Map,refCount:0}}function Ld(l){l.refCount--,l.refCount===0&&t9(r9,function(){l.controller.abort()})}var Bd=null,Sv=0,ru=0,nu=null;function n9(l,u){if(Bd===null){var m=Bd=[];Sv=0,ru=_y(),nu={status:"pending",value:void 0,then:function(x){m.push(x)}}}return Sv++,u.then(__,__),u}function __(){if(--Sv===0&&Bd!==null){nu!==null&&(nu.status="fulfilled");var l=Bd;Bd=null,ru=0,nu=null;for(var u=0;u<l.length;u++)(0,l[u])()}}function a9(l,u){var m=[],x={status:"pending",value:null,reason:null,then:function(S){m.push(S)}};return l.then(function(){x.status="fulfilled",x.value=u;for(var S=0;S<m.length;S++)(0,m[S])(u)},function(S){for(x.status="rejected",x.reason=S,S=0;S<m.length;S++)(0,m[S])(void 0)}),x}var j_=V.S;V.S=function(l,u){cE=mt(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&n9(l,u),j_!==null&&j_(l,u)};var Uo=W(null);function Nv(){var l=Uo.current;return l!==null?l:Qt.pooledCache}function Lh(l,u){u===null?X(Uo,Uo.current):X(Uo,u.pool)}function E_(){var l=Nv();return l===null?null:{parent:Gr._currentValue,pool:l}}var au=Error(n(460)),kv=Error(n(474)),Bh=Error(n(542)),Uh={then:function(){}};function T_(l){return l=l.status,l==="fulfilled"||l==="rejected"}function C_(l,u,m){switch(m=l[m],m===void 0?l.push(u):m!==u&&(u.then(Ts,Ts),u=m),u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,O_(l),l;default:if(typeof u.status=="string")u.then(Ts,Ts);else{if(l=Qt,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=u,l.status="pending",l.then(function(x){if(u.status==="pending"){var S=u;S.status="fulfilled",S.value=x}},function(x){if(u.status==="pending"){var S=u;S.status="rejected",S.reason=x}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw l=u.reason,O_(l),l}throw $o=u,au}}function zo(l){try{var u=l._init;return u(l._payload)}catch(m){throw m!==null&&typeof m=="object"&&typeof m.then=="function"?($o=m,au):m}}var $o=null;function A_(){if($o===null)throw Error(n(459));var l=$o;return $o=null,l}function O_(l){if(l===au||l===Bh)throw Error(n(483))}var iu=null,Ud=0;function zh(l){var u=Ud;return Ud+=1,iu===null&&(iu=[]),C_(iu,l,u)}function zd(l,u){u=u.props.ref,l.ref=u!==void 0?u:null}function $h(l,u){throw u.$$typeof===g?Error(n(525)):(l=Object.prototype.toString.call(u),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l)))}function D_(l){function u(he,ce){if(l){var pe=he.deletions;pe===null?(he.deletions=[ce],he.flags|=16):pe.push(ce)}}function m(he,ce){if(!l)return null;for(;ce!==null;)u(he,ce),ce=ce.sibling;return null}function x(he){for(var ce=new Map;he!==null;)he.key!==null?ce.set(he.key,he):ce.set(he.index,he),he=he.sibling;return ce}function S(he,ce){return he=As(he,ce),he.index=0,he.sibling=null,he}function _(he,ce,pe){return he.index=pe,l?(pe=he.alternate,pe!==null?(pe=pe.index,pe<ce?(he.flags|=67108866,ce):pe):(he.flags|=67108866,ce)):(he.flags|=1048576,ce)}function I(he){return l&&he.alternate===null&&(he.flags|=67108866),he}function H(he,ce,pe,Ee){return ce===null||ce.tag!==6?(ce=fv(pe,he.mode,Ee),ce.return=he,ce):(ce=S(ce,pe),ce.return=he,ce)}function se(he,ce,pe,Ee){var Ze=pe.type;return Ze===y?_e(he,ce,pe.props.children,Ee,pe.key):ce!==null&&(ce.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===D&&zo(Ze)===ce.type)?(ce=S(ce,pe.props),zd(ce,pe),ce.return=he,ce):(ce=Rh(pe.type,pe.key,pe.props,null,he.mode,Ee),zd(ce,pe),ce.return=he,ce)}function xe(he,ce,pe,Ee){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==pe.containerInfo||ce.stateNode.implementation!==pe.implementation?(ce=hv(pe,he.mode,Ee),ce.return=he,ce):(ce=S(ce,pe.children||[]),ce.return=he,ce)}function _e(he,ce,pe,Ee,Ze){return ce===null||ce.tag!==7?(ce=Po(pe,he.mode,Ee,Ze),ce.return=he,ce):(ce=S(ce,pe),ce.return=he,ce)}function Te(he,ce,pe){if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return ce=fv(""+ce,he.mode,pe),ce.return=he,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:return pe=Rh(ce.type,ce.key,ce.props,null,he.mode,pe),zd(pe,ce),pe.return=he,pe;case b:return ce=hv(ce,he.mode,pe),ce.return=he,ce;case D:return ce=zo(ce),Te(he,ce,pe)}if(ue(ce)||L(ce))return ce=Po(ce,he.mode,pe,null),ce.return=he,ce;if(typeof ce.then=="function")return Te(he,zh(ce),pe);if(ce.$$typeof===N)return Te(he,Fh(he,ce),pe);$h(he,ce)}return null}function be(he,ce,pe,Ee){var Ze=ce!==null?ce.key:null;if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return Ze!==null?null:H(he,ce,""+pe,Ee);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case v:return pe.key===Ze?se(he,ce,pe,Ee):null;case b:return pe.key===Ze?xe(he,ce,pe,Ee):null;case D:return pe=zo(pe),be(he,ce,pe,Ee)}if(ue(pe)||L(pe))return Ze!==null?null:_e(he,ce,pe,Ee,null);if(typeof pe.then=="function")return be(he,ce,zh(pe),Ee);if(pe.$$typeof===N)return be(he,ce,Fh(he,pe),Ee);$h(he,pe)}return null}function Se(he,ce,pe,Ee,Ze){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return he=he.get(pe)||null,H(ce,he,""+Ee,Ze);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case v:return he=he.get(Ee.key===null?pe:Ee.key)||null,se(ce,he,Ee,Ze);case b:return he=he.get(Ee.key===null?pe:Ee.key)||null,xe(ce,he,Ee,Ze);case D:return Ee=zo(Ee),Se(he,ce,pe,Ee,Ze)}if(ue(Ee)||L(Ee))return he=he.get(pe)||null,_e(ce,he,Ee,Ze,null);if(typeof Ee.then=="function")return Se(he,ce,pe,zh(Ee),Ze);if(Ee.$$typeof===N)return Se(he,ce,pe,Fh(ce,Ee),Ze);$h(ce,Ee)}return null}function Ve(he,ce,pe,Ee){for(var Ze=null,Ct=null,Ke=ce,ft=ce=0,St=null;Ke!==null&&ft<pe.length;ft++){Ke.index>ft?(St=Ke,Ke=null):St=Ke.sibling;var At=be(he,Ke,pe[ft],Ee);if(At===null){Ke===null&&(Ke=St);break}l&&Ke&&At.alternate===null&&u(he,Ke),ce=_(At,ce,ft),Ct===null?Ze=At:Ct.sibling=At,Ct=At,Ke=St}if(ft===pe.length)return m(he,Ke),kt&&Os(he,ft),Ze;if(Ke===null){for(;ft<pe.length;ft++)Ke=Te(he,pe[ft],Ee),Ke!==null&&(ce=_(Ke,ce,ft),Ct===null?Ze=Ke:Ct.sibling=Ke,Ct=Ke);return kt&&Os(he,ft),Ze}for(Ke=x(Ke);ft<pe.length;ft++)St=Se(Ke,he,ft,pe[ft],Ee),St!==null&&(l&&St.alternate!==null&&Ke.delete(St.key===null?ft:St.key),ce=_(St,ce,ft),Ct===null?Ze=St:Ct.sibling=St,Ct=St);return l&&Ke.forEach(function(Zl){return u(he,Zl)}),kt&&Os(he,ft),Ze}function rt(he,ce,pe,Ee){if(pe==null)throw Error(n(151));for(var Ze=null,Ct=null,Ke=ce,ft=ce=0,St=null,At=pe.next();Ke!==null&&!At.done;ft++,At=pe.next()){Ke.index>ft?(St=Ke,Ke=null):St=Ke.sibling;var Zl=be(he,Ke,At.value,Ee);if(Zl===null){Ke===null&&(Ke=St);break}l&&Ke&&Zl.alternate===null&&u(he,Ke),ce=_(Zl,ce,ft),Ct===null?Ze=Zl:Ct.sibling=Zl,Ct=Zl,Ke=St}if(At.done)return m(he,Ke),kt&&Os(he,ft),Ze;if(Ke===null){for(;!At.done;ft++,At=pe.next())At=Te(he,At.value,Ee),At!==null&&(ce=_(At,ce,ft),Ct===null?Ze=At:Ct.sibling=At,Ct=At);return kt&&Os(he,ft),Ze}for(Ke=x(Ke);!At.done;ft++,At=pe.next())At=Se(Ke,he,ft,At.value,Ee),At!==null&&(l&&At.alternate!==null&&Ke.delete(At.key===null?ft:At.key),ce=_(At,ce,ft),Ct===null?Ze=At:Ct.sibling=At,Ct=At);return l&&Ke.forEach(function(p7){return u(he,p7)}),kt&&Os(he,ft),Ze}function Wt(he,ce,pe,Ee){if(typeof pe=="object"&&pe!==null&&pe.type===y&&pe.key===null&&(pe=pe.props.children),typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case v:e:{for(var Ze=pe.key;ce!==null;){if(ce.key===Ze){if(Ze=pe.type,Ze===y){if(ce.tag===7){m(he,ce.sibling),Ee=S(ce,pe.props.children),Ee.return=he,he=Ee;break e}}else if(ce.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===D&&zo(Ze)===ce.type){m(he,ce.sibling),Ee=S(ce,pe.props),zd(Ee,pe),Ee.return=he,he=Ee;break e}m(he,ce);break}else u(he,ce);ce=ce.sibling}pe.type===y?(Ee=Po(pe.props.children,he.mode,Ee,pe.key),Ee.return=he,he=Ee):(Ee=Rh(pe.type,pe.key,pe.props,null,he.mode,Ee),zd(Ee,pe),Ee.return=he,he=Ee)}return I(he);case b:e:{for(Ze=pe.key;ce!==null;){if(ce.key===Ze)if(ce.tag===4&&ce.stateNode.containerInfo===pe.containerInfo&&ce.stateNode.implementation===pe.implementation){m(he,ce.sibling),Ee=S(ce,pe.children||[]),Ee.return=he,he=Ee;break e}else{m(he,ce);break}else u(he,ce);ce=ce.sibling}Ee=hv(pe,he.mode,Ee),Ee.return=he,he=Ee}return I(he);case D:return pe=zo(pe),Wt(he,ce,pe,Ee)}if(ue(pe))return Ve(he,ce,pe,Ee);if(L(pe)){if(Ze=L(pe),typeof Ze!="function")throw Error(n(150));return pe=Ze.call(pe),rt(he,ce,pe,Ee)}if(typeof pe.then=="function")return Wt(he,ce,zh(pe),Ee);if(pe.$$typeof===N)return Wt(he,ce,Fh(he,pe),Ee);$h(he,pe)}return typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint"?(pe=""+pe,ce!==null&&ce.tag===6?(m(he,ce.sibling),Ee=S(ce,pe),Ee.return=he,he=Ee):(m(he,ce),Ee=fv(pe,he.mode,Ee),Ee.return=he,he=Ee),I(he)):m(he,ce)}return function(he,ce,pe,Ee){try{Ud=0;var Ze=Wt(he,ce,pe,Ee);return iu=null,Ze}catch(Ke){if(Ke===au||Ke===Bh)throw Ke;var Ct=Ba(29,Ke,null,he.mode);return Ct.lanes=Ee,Ct.return=he,Ct}}}var Ho=D_(!0),I_=D_(!1),Rl=!1;function _v(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jv(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function Ml(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function Pl(l,u,m){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(Rt&2)!==0){var S=x.pending;return S===null?u.next=u:(u.next=S.next,S.next=u),x.pending=u,u=Ih(l),x_(l,null,m),u}return Dh(l,x,u,m),Ih(l)}function $d(l,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194048)!==0)){var x=u.lanes;x&=l.pendingLanes,m|=x,u.lanes=m,An(l,m)}}function Ev(l,u){var m=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,m===x)){var S=null,_=null;if(m=m.firstBaseUpdate,m!==null){do{var I={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};_===null?S=_=I:_=_.next=I,m=m.next}while(m!==null);_===null?S=_=u:_=_.next=u}else S=_=u;m={baseState:x.baseState,firstBaseUpdate:S,lastBaseUpdate:_,shared:x.shared,callbacks:x.callbacks},l.updateQueue=m;return}l=m.lastBaseUpdate,l===null?m.firstBaseUpdate=u:l.next=u,m.lastBaseUpdate=u}var Tv=!1;function Hd(){if(Tv){var l=nu;if(l!==null)throw l}}function Vd(l,u,m,x){Tv=!1;var S=l.updateQueue;Rl=!1;var _=S.firstBaseUpdate,I=S.lastBaseUpdate,H=S.shared.pending;if(H!==null){S.shared.pending=null;var se=H,xe=se.next;se.next=null,I===null?_=xe:I.next=xe,I=se;var _e=l.alternate;_e!==null&&(_e=_e.updateQueue,H=_e.lastBaseUpdate,H!==I&&(H===null?_e.firstBaseUpdate=xe:H.next=xe,_e.lastBaseUpdate=se))}if(_!==null){var Te=S.baseState;I=0,_e=xe=se=null,H=_;do{var be=H.lane&-536870913,Se=be!==H.lane;if(Se?(wt&be)===be:(x&be)===be){be!==0&&be===ru&&(Tv=!0),_e!==null&&(_e=_e.next={lane:0,tag:H.tag,payload:H.payload,callback:null,next:null});e:{var Ve=l,rt=H;be=u;var Wt=m;switch(rt.tag){case 1:if(Ve=rt.payload,typeof Ve=="function"){Te=Ve.call(Wt,Te,be);break e}Te=Ve;break e;case 3:Ve.flags=Ve.flags&-65537|128;case 0:if(Ve=rt.payload,be=typeof Ve=="function"?Ve.call(Wt,Te,be):Ve,be==null)break e;Te=p({},Te,be);break e;case 2:Rl=!0}}be=H.callback,be!==null&&(l.flags|=64,Se&&(l.flags|=8192),Se=S.callbacks,Se===null?S.callbacks=[be]:Se.push(be))}else Se={lane:be,tag:H.tag,payload:H.payload,callback:H.callback,next:null},_e===null?(xe=_e=Se,se=Te):_e=_e.next=Se,I|=be;if(H=H.next,H===null){if(H=S.shared.pending,H===null)break;Se=H,H=Se.next,Se.next=null,S.lastBaseUpdate=Se,S.shared.pending=null}}while(!0);_e===null&&(se=Te),S.baseState=se,S.firstBaseUpdate=xe,S.lastBaseUpdate=_e,_===null&&(S.shared.lanes=0),zl|=I,l.lanes=I,l.memoizedState=Te}}function R_(l,u){if(typeof l!="function")throw Error(n(191,l));l.call(u)}function M_(l,u){var m=l.callbacks;if(m!==null)for(l.callbacks=null,l=0;l<m.length;l++)R_(m[l],u)}var su=W(null),Hh=W(0);function P_(l,u){l=$s,X(Hh,l),X(su,u),$s=l|u.baseLanes}function Cv(){X(Hh,$s),X(su,su.current)}function Av(){$s=Hh.current,F(su),F(Hh)}var Ua=W(null),pi=null;function Fl(l){var u=l.alternate;X(Fr,Fr.current&1),X(Ua,l),pi===null&&(u===null||su.current!==null||u.memoizedState!==null)&&(pi=l)}function Ov(l){X(Fr,Fr.current),X(Ua,l),pi===null&&(pi=l)}function F_(l){l.tag===22?(X(Fr,Fr.current),X(Ua,l),pi===null&&(pi=l)):Ll()}function Ll(){X(Fr,Fr.current),X(Ua,Ua.current)}function za(l){F(Ua),pi===l&&(pi=null),F(Fr)}var Fr=W(0);function Vh(l){for(var u=l;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||Fy(m)||Ly(m)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Rs=0,ct=null,Vt=null,Wr=null,Gh=!1,lu=!1,Vo=!1,Wh=0,Gd=0,ou=null,i9=0;function Tr(){throw Error(n(321))}function Dv(l,u){if(u===null)return!1;for(var m=0;m<u.length&&m<l.length;m++)if(!La(l[m],u[m]))return!1;return!0}function Iv(l,u,m,x,S,_){return Rs=_,ct=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,V.H=l===null||l.memoizedState===null?bj:Kv,Vo=!1,_=m(x,S),Vo=!1,lu&&(_=B_(u,m,x,S)),L_(l),_}function L_(l){V.H=Kd;var u=Vt!==null&&Vt.next!==null;if(Rs=0,Wr=Vt=ct=null,Gh=!1,Gd=0,ou=null,u)throw Error(n(300));l===null||qr||(l=l.dependencies,l!==null&&Ph(l)&&(qr=!0))}function B_(l,u,m,x){ct=l;var S=0;do{if(lu&&(ou=null),Gd=0,lu=!1,25<=S)throw Error(n(301));if(S+=1,Wr=Vt=null,l.updateQueue!=null){var _=l.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}V.H=wj,_=u(m,x)}while(lu);return _}function s9(){var l=V.H,u=l.useState()[0];return u=typeof u.then=="function"?Wd(u):u,l=l.useState()[0],(Vt!==null?Vt.memoizedState:null)!==l&&(ct.flags|=1024),u}function Rv(){var l=Wh!==0;return Wh=0,l}function Mv(l,u,m){u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~m}function Pv(l){if(Gh){for(l=l.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}Gh=!1}Rs=0,Wr=Vt=ct=null,lu=!1,Gd=Wh=0,ou=null}function ia(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?ct.memoizedState=Wr=l:Wr=Wr.next=l,Wr}function Lr(){if(Vt===null){var l=ct.alternate;l=l!==null?l.memoizedState:null}else l=Vt.next;var u=Wr===null?ct.memoizedState:Wr.next;if(u!==null)Wr=u,Vt=l;else{if(l===null)throw ct.alternate===null?Error(n(467)):Error(n(310));Vt=l,l={memoizedState:Vt.memoizedState,baseState:Vt.baseState,baseQueue:Vt.baseQueue,queue:Vt.queue,next:null},Wr===null?ct.memoizedState=Wr=l:Wr=Wr.next=l}return Wr}function qh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wd(l){var u=Gd;return Gd+=1,ou===null&&(ou=[]),l=C_(ou,l,u),u=ct,(Wr===null?u.memoizedState:Wr.next)===null&&(u=u.alternate,V.H=u===null||u.memoizedState===null?bj:Kv),l}function Kh(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Wd(l);if(l.$$typeof===N)return Dn(l)}throw Error(n(438,String(l)))}function Fv(l){var u=null,m=ct.updateQueue;if(m!==null&&(u=m.memoCache),u==null){var x=ct.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(u={data:x.data.map(function(S){return S.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),m===null&&(m=qh(),ct.updateQueue=m),m.memoCache=u,m=u.data[u.index],m===void 0)for(m=u.data[u.index]=Array(l),x=0;x<l;x++)m[x]=P;return u.index++,m}function Ms(l,u){return typeof u=="function"?u(l):u}function Yh(l){var u=Lr();return Lv(u,Vt,l)}function Lv(l,u,m){var x=l.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=m;var S=l.baseQueue,_=x.pending;if(_!==null){if(S!==null){var I=S.next;S.next=_.next,_.next=I}u.baseQueue=S=_,x.pending=null}if(_=l.baseState,S===null)l.memoizedState=_;else{u=S.next;var H=I=null,se=null,xe=u,_e=!1;do{var Te=xe.lane&-536870913;if(Te!==xe.lane?(wt&Te)===Te:(Rs&Te)===Te){var be=xe.revertLane;if(be===0)se!==null&&(se=se.next={lane:0,revertLane:0,gesture:null,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null}),Te===ru&&(_e=!0);else if((Rs&be)===be){xe=xe.next,be===ru&&(_e=!0);continue}else Te={lane:0,revertLane:xe.revertLane,gesture:null,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null},se===null?(H=se=Te,I=_):se=se.next=Te,ct.lanes|=be,zl|=be;Te=xe.action,Vo&&m(_,Te),_=xe.hasEagerState?xe.eagerState:m(_,Te)}else be={lane:Te,revertLane:xe.revertLane,gesture:xe.gesture,action:xe.action,hasEagerState:xe.hasEagerState,eagerState:xe.eagerState,next:null},se===null?(H=se=be,I=_):se=se.next=be,ct.lanes|=Te,zl|=Te;xe=xe.next}while(xe!==null&&xe!==u);if(se===null?I=_:se.next=H,!La(_,l.memoizedState)&&(qr=!0,_e&&(m=nu,m!==null)))throw m;l.memoizedState=_,l.baseState=I,l.baseQueue=se,x.lastRenderedState=_}return S===null&&(x.lanes=0),[l.memoizedState,x.dispatch]}function Bv(l){var u=Lr(),m=u.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=l;var x=m.dispatch,S=m.pending,_=u.memoizedState;if(S!==null){m.pending=null;var I=S=S.next;do _=l(_,I.action),I=I.next;while(I!==S);La(_,u.memoizedState)||(qr=!0),u.memoizedState=_,u.baseQueue===null&&(u.baseState=_),m.lastRenderedState=_}return[_,x]}function U_(l,u,m){var x=ct,S=Lr(),_=kt;if(_){if(m===void 0)throw Error(n(407));m=m()}else m=u();var I=!La((Vt||S).memoizedState,m);if(I&&(S.memoizedState=m,qr=!0),S=S.queue,$v(H_.bind(null,x,S,l),[l]),S.getSnapshot!==u||I||Wr!==null&&Wr.memoizedState.tag&1){if(x.flags|=2048,cu(9,{destroy:void 0},$_.bind(null,x,S,m,u),null),Qt===null)throw Error(n(349));_||(Rs&127)!==0||z_(x,u,m)}return m}function z_(l,u,m){l.flags|=16384,l={getSnapshot:u,value:m},u=ct.updateQueue,u===null?(u=qh(),ct.updateQueue=u,u.stores=[l]):(m=u.stores,m===null?u.stores=[l]:m.push(l))}function $_(l,u,m,x){u.value=m,u.getSnapshot=x,V_(u)&&G_(l)}function H_(l,u,m){return m(function(){V_(u)&&G_(l)})}function V_(l){var u=l.getSnapshot;l=l.value;try{var m=u();return!La(l,m)}catch{return!0}}function G_(l){var u=Mo(l,2);u!==null&&ka(u,l,2)}function Uv(l){var u=ia();if(typeof l=="function"){var m=l;if(l=m(),Vo){aa(!0);try{m()}finally{aa(!1)}}}return u.memoizedState=u.baseState=l,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:l},u}function W_(l,u,m,x){return l.baseState=m,Lv(l,Vt,typeof x=="function"?x:Ms)}function l9(l,u,m,x,S){if(Qh(l))throw Error(n(485));if(l=u.action,l!==null){var _={payload:S,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){_.listeners.push(I)}};V.T!==null?m(!0):_.isTransition=!1,x(_),m=u.pending,m===null?(_.next=u.pending=_,q_(u,_)):(_.next=m.next,u.pending=m.next=_)}}function q_(l,u){var m=u.action,x=u.payload,S=l.state;if(u.isTransition){var _=V.T,I={};V.T=I;try{var H=m(S,x),se=V.S;se!==null&&se(I,H),K_(l,u,H)}catch(xe){zv(l,u,xe)}finally{_!==null&&I.types!==null&&(_.types=I.types),V.T=_}}else try{_=m(S,x),K_(l,u,_)}catch(xe){zv(l,u,xe)}}function K_(l,u,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(x){Y_(l,u,x)},function(x){return zv(l,u,x)}):Y_(l,u,m)}function Y_(l,u,m){u.status="fulfilled",u.value=m,X_(u),l.state=m,u=l.pending,u!==null&&(m=u.next,m===u?l.pending=null:(m=m.next,u.next=m,q_(l,m)))}function zv(l,u,m){var x=l.pending;if(l.pending=null,x!==null){x=x.next;do u.status="rejected",u.reason=m,X_(u),u=u.next;while(u!==x)}l.action=null}function X_(l){l=l.listeners;for(var u=0;u<l.length;u++)(0,l[u])()}function Z_(l,u){return u}function Q_(l,u){if(kt){var m=Qt.formState;if(m!==null){e:{var x=ct;if(kt){if(lr){t:{for(var S=lr,_=mi;S.nodeType!==8;){if(!_){S=null;break t}if(S=xi(S.nextSibling),S===null){S=null;break t}}_=S.data,S=_==="F!"||_==="F"?S:null}if(S){lr=xi(S.nextSibling),x=S.data==="F!";break e}}Dl(x)}x=!1}x&&(u=m[0])}}return m=ia(),m.memoizedState=m.baseState=u,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Z_,lastRenderedState:u},m.queue=x,m=gj.bind(null,ct,x),x.dispatch=m,x=Uv(!1),_=qv.bind(null,ct,!1,x.queue),x=ia(),S={state:u,dispatch:null,action:l,pending:null},x.queue=S,m=l9.bind(null,ct,S,_,m),S.dispatch=m,x.memoizedState=l,[u,m,!1]}function J_(l){var u=Lr();return ej(u,Vt,l)}function ej(l,u,m){if(u=Lv(l,u,Z_)[0],l=Yh(Ms)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var x=Wd(u)}catch(I){throw I===au?Bh:I}else x=u;u=Lr();var S=u.queue,_=S.dispatch;return m!==u.memoizedState&&(ct.flags|=2048,cu(9,{destroy:void 0},o9.bind(null,S,m),null)),[x,_,l]}function o9(l,u){l.action=u}function tj(l){var u=Lr(),m=Vt;if(m!==null)return ej(u,m,l);Lr(),u=u.memoizedState,m=Lr();var x=m.queue.dispatch;return m.memoizedState=l,[u,x,!1]}function cu(l,u,m,x){return l={tag:l,create:m,deps:x,inst:u,next:null},u=ct.updateQueue,u===null&&(u=qh(),ct.updateQueue=u),m=u.lastEffect,m===null?u.lastEffect=l.next=l:(x=m.next,m.next=l,l.next=x,u.lastEffect=l),l}function rj(){return Lr().memoizedState}function Xh(l,u,m,x){var S=ia();ct.flags|=l,S.memoizedState=cu(1|u,{destroy:void 0},m,x===void 0?null:x)}function Zh(l,u,m,x){var S=Lr();x=x===void 0?null:x;var _=S.memoizedState.inst;Vt!==null&&x!==null&&Dv(x,Vt.memoizedState.deps)?S.memoizedState=cu(u,_,m,x):(ct.flags|=l,S.memoizedState=cu(1|u,_,m,x))}function nj(l,u){Xh(8390656,8,l,u)}function $v(l,u){Zh(2048,8,l,u)}function c9(l){ct.flags|=4;var u=ct.updateQueue;if(u===null)u=qh(),ct.updateQueue=u,u.events=[l];else{var m=u.events;m===null?u.events=[l]:m.push(l)}}function aj(l){var u=Lr().memoizedState;return c9({ref:u,nextImpl:l}),function(){if((Rt&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}function ij(l,u){return Zh(4,2,l,u)}function sj(l,u){return Zh(4,4,l,u)}function lj(l,u){if(typeof u=="function"){l=l();var m=u(l);return function(){typeof m=="function"?m():u(null)}}if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function oj(l,u,m){m=m!=null?m.concat([l]):null,Zh(4,4,lj.bind(null,u,l),m)}function Hv(){}function cj(l,u){var m=Lr();u=u===void 0?null:u;var x=m.memoizedState;return u!==null&&Dv(u,x[1])?x[0]:(m.memoizedState=[l,u],l)}function uj(l,u){var m=Lr();u=u===void 0?null:u;var x=m.memoizedState;if(u!==null&&Dv(u,x[1]))return x[0];if(x=l(),Vo){aa(!0);try{l()}finally{aa(!1)}}return m.memoizedState=[x,u],x}function Vv(l,u,m){return m===void 0||(Rs&1073741824)!==0&&(wt&261930)===0?l.memoizedState=u:(l.memoizedState=m,l=dE(),ct.lanes|=l,zl|=l,m)}function dj(l,u,m,x){return La(m,u)?m:su.current!==null?(l=Vv(l,m,x),La(l,u)||(qr=!0),l):(Rs&42)===0||(Rs&1073741824)!==0&&(wt&261930)===0?(qr=!0,l.memoizedState=m):(l=dE(),ct.lanes|=l,zl|=l,u)}function fj(l,u,m,x,S){var _=K.p;K.p=_!==0&&8>_?_:8;var I=V.T,H={};V.T=H,qv(l,!1,u,m);try{var se=S(),xe=V.S;if(xe!==null&&xe(H,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var _e=a9(se,x);qd(l,u,_e,Va(l))}else qd(l,u,x,Va(l))}catch(Te){qd(l,u,{then:function(){},status:"rejected",reason:Te},Va())}finally{K.p=_,I!==null&&H.types!==null&&(I.types=H.types),V.T=I}}function u9(){}function Gv(l,u,m,x){if(l.tag!==5)throw Error(n(476));var S=hj(l).queue;fj(l,S,u,ie,m===null?u9:function(){return mj(l),m(x)})}function hj(l){var u=l.memoizedState;if(u!==null)return u;u={memoizedState:ie,baseState:ie,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:ie},next:null};var m={};return u.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:m},next:null},l.memoizedState=u,l=l.alternate,l!==null&&(l.memoizedState=u),u}function mj(l){var u=hj(l);u.next===null&&(u=l.alternate.memoizedState),qd(l,u.next.queue,{},Va())}function Wv(){return Dn(df)}function pj(){return Lr().memoizedState}function xj(){return Lr().memoizedState}function d9(l){for(var u=l.return;u!==null;){switch(u.tag){case 24:case 3:var m=Va();l=Ml(m);var x=Pl(u,l,m);x!==null&&(ka(x,u,m),$d(x,u,m)),u={cache:wv()},l.payload=u;return}u=u.return}}function f9(l,u,m){var x=Va();m={lane:x,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null},Qh(l)?vj(u,m):(m=uv(l,u,m,x),m!==null&&(ka(m,l,x),yj(m,u,x)))}function gj(l,u,m){var x=Va();qd(l,u,m,x)}function qd(l,u,m,x){var S={lane:x,revertLane:0,gesture:null,action:m,hasEagerState:!1,eagerState:null,next:null};if(Qh(l))vj(u,S);else{var _=l.alternate;if(l.lanes===0&&(_===null||_.lanes===0)&&(_=u.lastRenderedReducer,_!==null))try{var I=u.lastRenderedState,H=_(I,m);if(S.hasEagerState=!0,S.eagerState=H,La(H,I))return Dh(l,u,S,0),Qt===null&&Oh(),!1}catch{}if(m=uv(l,u,S,x),m!==null)return ka(m,l,x),yj(m,u,x),!0}return!1}function qv(l,u,m,x){if(x={lane:2,revertLane:_y(),gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},Qh(l)){if(u)throw Error(n(479))}else u=uv(l,m,x,2),u!==null&&ka(u,l,2)}function Qh(l){var u=l.alternate;return l===ct||u!==null&&u===ct}function vj(l,u){lu=Gh=!0;var m=l.pending;m===null?u.next=u:(u.next=m.next,m.next=u),l.pending=u}function yj(l,u,m){if((m&4194048)!==0){var x=u.lanes;x&=l.pendingLanes,m|=x,u.lanes=m,An(l,m)}}var Kd={readContext:Dn,use:Kh,useCallback:Tr,useContext:Tr,useEffect:Tr,useImperativeHandle:Tr,useLayoutEffect:Tr,useInsertionEffect:Tr,useMemo:Tr,useReducer:Tr,useRef:Tr,useState:Tr,useDebugValue:Tr,useDeferredValue:Tr,useTransition:Tr,useSyncExternalStore:Tr,useId:Tr,useHostTransitionStatus:Tr,useFormState:Tr,useActionState:Tr,useOptimistic:Tr,useMemoCache:Tr,useCacheRefresh:Tr};Kd.useEffectEvent=Tr;var bj={readContext:Dn,use:Kh,useCallback:function(l,u){return ia().memoizedState=[l,u===void 0?null:u],l},useContext:Dn,useEffect:nj,useImperativeHandle:function(l,u,m){m=m!=null?m.concat([l]):null,Xh(4194308,4,lj.bind(null,u,l),m)},useLayoutEffect:function(l,u){return Xh(4194308,4,l,u)},useInsertionEffect:function(l,u){Xh(4,2,l,u)},useMemo:function(l,u){var m=ia();u=u===void 0?null:u;var x=l();if(Vo){aa(!0);try{l()}finally{aa(!1)}}return m.memoizedState=[x,u],x},useReducer:function(l,u,m){var x=ia();if(m!==void 0){var S=m(u);if(Vo){aa(!0);try{m(u)}finally{aa(!1)}}}else S=u;return x.memoizedState=x.baseState=S,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:S},x.queue=l,l=l.dispatch=f9.bind(null,ct,l),[x.memoizedState,l]},useRef:function(l){var u=ia();return l={current:l},u.memoizedState=l},useState:function(l){l=Uv(l);var u=l.queue,m=gj.bind(null,ct,u);return u.dispatch=m,[l.memoizedState,m]},useDebugValue:Hv,useDeferredValue:function(l,u){var m=ia();return Vv(m,l,u)},useTransition:function(){var l=Uv(!1);return l=fj.bind(null,ct,l.queue,!0,!1),ia().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,u,m){var x=ct,S=ia();if(kt){if(m===void 0)throw Error(n(407));m=m()}else{if(m=u(),Qt===null)throw Error(n(349));(wt&127)!==0||z_(x,u,m)}S.memoizedState=m;var _={value:m,getSnapshot:u};return S.queue=_,nj(H_.bind(null,x,_,l),[l]),x.flags|=2048,cu(9,{destroy:void 0},$_.bind(null,x,_,m,u),null),m},useId:function(){var l=ia(),u=Qt.identifierPrefix;if(kt){var m=ls,x=ss;m=(x&~(1<<32-mn(x)-1)).toString(32)+m,u="_"+u+"R_"+m,m=Wh++,0<m&&(u+="H"+m.toString(32)),u+="_"}else m=i9++,u="_"+u+"r_"+m.toString(32)+"_";return l.memoizedState=u},useHostTransitionStatus:Wv,useFormState:Q_,useActionState:Q_,useOptimistic:function(l){var u=ia();u.memoizedState=u.baseState=l;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=m,u=qv.bind(null,ct,!0,m),m.dispatch=u,[l,u]},useMemoCache:Fv,useCacheRefresh:function(){return ia().memoizedState=d9.bind(null,ct)},useEffectEvent:function(l){var u=ia(),m={impl:l};return u.memoizedState=m,function(){if((Rt&2)!==0)throw Error(n(440));return m.impl.apply(void 0,arguments)}}},Kv={readContext:Dn,use:Kh,useCallback:cj,useContext:Dn,useEffect:$v,useImperativeHandle:oj,useInsertionEffect:ij,useLayoutEffect:sj,useMemo:uj,useReducer:Yh,useRef:rj,useState:function(){return Yh(Ms)},useDebugValue:Hv,useDeferredValue:function(l,u){var m=Lr();return dj(m,Vt.memoizedState,l,u)},useTransition:function(){var l=Yh(Ms)[0],u=Lr().memoizedState;return[typeof l=="boolean"?l:Wd(l),u]},useSyncExternalStore:U_,useId:pj,useHostTransitionStatus:Wv,useFormState:J_,useActionState:J_,useOptimistic:function(l,u){var m=Lr();return W_(m,Vt,l,u)},useMemoCache:Fv,useCacheRefresh:xj};Kv.useEffectEvent=aj;var wj={readContext:Dn,use:Kh,useCallback:cj,useContext:Dn,useEffect:$v,useImperativeHandle:oj,useInsertionEffect:ij,useLayoutEffect:sj,useMemo:uj,useReducer:Bv,useRef:rj,useState:function(){return Bv(Ms)},useDebugValue:Hv,useDeferredValue:function(l,u){var m=Lr();return Vt===null?Vv(m,l,u):dj(m,Vt.memoizedState,l,u)},useTransition:function(){var l=Bv(Ms)[0],u=Lr().memoizedState;return[typeof l=="boolean"?l:Wd(l),u]},useSyncExternalStore:U_,useId:pj,useHostTransitionStatus:Wv,useFormState:tj,useActionState:tj,useOptimistic:function(l,u){var m=Lr();return Vt!==null?W_(m,Vt,l,u):(m.baseState=l,[l,m.queue.dispatch])},useMemoCache:Fv,useCacheRefresh:xj};wj.useEffectEvent=aj;function Yv(l,u,m,x){u=l.memoizedState,m=m(x,u),m=m==null?u:p({},u,m),l.memoizedState=m,l.lanes===0&&(l.updateQueue.baseState=m)}var Xv={enqueueSetState:function(l,u,m){l=l._reactInternals;var x=Va(),S=Ml(x);S.payload=u,m!=null&&(S.callback=m),u=Pl(l,S,x),u!==null&&(ka(u,l,x),$d(u,l,x))},enqueueReplaceState:function(l,u,m){l=l._reactInternals;var x=Va(),S=Ml(x);S.tag=1,S.payload=u,m!=null&&(S.callback=m),u=Pl(l,S,x),u!==null&&(ka(u,l,x),$d(u,l,x))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var m=Va(),x=Ml(m);x.tag=2,u!=null&&(x.callback=u),u=Pl(l,x,m),u!==null&&(ka(u,l,m),$d(u,l,m))}};function Sj(l,u,m,x,S,_,I){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,_,I):u.prototype&&u.prototype.isPureReactComponent?!Rd(m,x)||!Rd(S,_):!0}function Nj(l,u,m,x){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,x),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,x),u.state!==l&&Xv.enqueueReplaceState(u,u.state,null)}function Go(l,u){var m=u;if("ref"in u){m={};for(var x in u)x!=="ref"&&(m[x]=u[x])}if(l=l.defaultProps){m===u&&(m=p({},m));for(var S in l)m[S]===void 0&&(m[S]=l[S])}return m}function kj(l){Ah(l)}function _j(l){console.error(l)}function jj(l){Ah(l)}function Jh(l,u){try{var m=l.onUncaughtError;m(u.value,{componentStack:u.stack})}catch(x){setTimeout(function(){throw x})}}function Ej(l,u,m){try{var x=l.onCaughtError;x(m.value,{componentStack:m.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function Zv(l,u,m){return m=Ml(m),m.tag=3,m.payload={element:null},m.callback=function(){Jh(l,u)},m}function Tj(l){return l=Ml(l),l.tag=3,l}function Cj(l,u,m,x){var S=m.type.getDerivedStateFromError;if(typeof S=="function"){var _=x.value;l.payload=function(){return S(_)},l.callback=function(){Ej(u,m,x)}}var I=m.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(l.callback=function(){Ej(u,m,x),typeof S!="function"&&($l===null?$l=new Set([this]):$l.add(this));var H=x.stack;this.componentDidCatch(x.value,{componentStack:H!==null?H:""})})}function h9(l,u,m,x,S){if(m.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(u=m.alternate,u!==null&&tu(u,m,S,!0),m=Ua.current,m!==null){switch(m.tag){case 31:case 13:return pi===null?dm():m.alternate===null&&Cr===0&&(Cr=3),m.flags&=-257,m.flags|=65536,m.lanes=S,x===Uh?m.flags|=16384:(u=m.updateQueue,u===null?m.updateQueue=new Set([x]):u.add(x),Sy(l,x,S)),!1;case 22:return m.flags|=65536,x===Uh?m.flags|=16384:(u=m.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([x])},m.updateQueue=u):(m=u.retryQueue,m===null?u.retryQueue=new Set([x]):m.add(x)),Sy(l,x,S)),!1}throw Error(n(435,m.tag))}return Sy(l,x,S),dm(),!1}if(kt)return u=Ua.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=S,x!==xv&&(l=Error(n(422),{cause:x}),Fd(di(l,m)))):(x!==xv&&(u=Error(n(423),{cause:x}),Fd(di(u,m))),l=l.current.alternate,l.flags|=65536,S&=-S,l.lanes|=S,x=di(x,m),S=Zv(l.stateNode,x,S),Ev(l,S),Cr!==4&&(Cr=2)),!1;var _=Error(n(520),{cause:x});if(_=di(_,m),rf===null?rf=[_]:rf.push(_),Cr!==4&&(Cr=2),u===null)return!0;x=di(x,m),m=u;do{switch(m.tag){case 3:return m.flags|=65536,l=S&-S,m.lanes|=l,l=Zv(m.stateNode,x,l),Ev(m,l),!1;case 1:if(u=m.type,_=m.stateNode,(m.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&($l===null||!$l.has(_))))return m.flags|=65536,S&=-S,m.lanes|=S,S=Tj(S),Cj(S,l,m,x),Ev(m,S),!1}m=m.return}while(m!==null);return!1}var Qv=Error(n(461)),qr=!1;function In(l,u,m,x){u.child=l===null?I_(u,null,m,x):Ho(u,l.child,m,x)}function Aj(l,u,m,x,S){m=m.render;var _=u.ref;if("ref"in x){var I={};for(var H in x)H!=="ref"&&(I[H]=x[H])}else I=x;return Bo(u),x=Iv(l,u,m,I,_,S),H=Rv(),l!==null&&!qr?(Mv(l,u,S),Ps(l,u,S)):(kt&&H&&mv(u),u.flags|=1,In(l,u,x,S),u.child)}function Oj(l,u,m,x,S){if(l===null){var _=m.type;return typeof _=="function"&&!dv(_)&&_.defaultProps===void 0&&m.compare===null?(u.tag=15,u.type=_,Dj(l,u,_,x,S)):(l=Rh(m.type,null,x,u,u.mode,S),l.ref=u.ref,l.return=u,u.child=l)}if(_=l.child,!sy(l,S)){var I=_.memoizedProps;if(m=m.compare,m=m!==null?m:Rd,m(I,x)&&l.ref===u.ref)return Ps(l,u,S)}return u.flags|=1,l=As(_,x),l.ref=u.ref,l.return=u,u.child=l}function Dj(l,u,m,x,S){if(l!==null){var _=l.memoizedProps;if(Rd(_,x)&&l.ref===u.ref)if(qr=!1,u.pendingProps=x=_,sy(l,S))(l.flags&131072)!==0&&(qr=!0);else return u.lanes=l.lanes,Ps(l,u,S)}return Jv(l,u,m,x,S)}function Ij(l,u,m,x){var S=x.children,_=l!==null?l.memoizedState:null;if(l===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.mode==="hidden"){if((u.flags&128)!==0){if(_=_!==null?_.baseLanes|m:m,l!==null){for(x=u.child=l.child,S=0;x!==null;)S=S|x.lanes|x.childLanes,x=x.sibling;x=S&~_}else x=0,u.child=null;return Rj(l,u,_,m,x)}if((m&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},l!==null&&Lh(u,_!==null?_.cachePool:null),_!==null?P_(u,_):Cv(),F_(u);else return x=u.lanes=536870912,Rj(l,u,_!==null?_.baseLanes|m:m,m,x)}else _!==null?(Lh(u,_.cachePool),P_(u,_),Ll(),u.memoizedState=null):(l!==null&&Lh(u,null),Cv(),Ll());return In(l,u,S,m),u.child}function Yd(l,u){return l!==null&&l.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function Rj(l,u,m,x,S){var _=Nv();return _=_===null?null:{parent:Gr._currentValue,pool:_},u.memoizedState={baseLanes:m,cachePool:_},l!==null&&Lh(u,null),Cv(),F_(u),l!==null&&tu(l,u,x,!0),u.childLanes=S,null}function em(l,u){return u=rm({mode:u.mode,children:u.children},l.mode),u.ref=l.ref,l.child=u,u.return=l,u}function Mj(l,u,m){return Ho(u,l.child,null,m),l=em(u,u.pendingProps),l.flags|=2,za(u),u.memoizedState=null,l}function m9(l,u,m){var x=u.pendingProps,S=(u.flags&128)!==0;if(u.flags&=-129,l===null){if(kt){if(x.mode==="hidden")return l=em(u,x),u.lanes=536870912,Yd(null,l);if(Ov(u),(l=lr)?(l=qE(l,mi),l=l!==null&&l.data==="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:Al!==null?{id:ss,overflow:ls}:null,retryLane:536870912,hydrationErrors:null},m=v_(l),m.return=u,u.child=m,On=u,lr=null)):l=null,l===null)throw Dl(u);return u.lanes=536870912,null}return em(u,x)}var _=l.memoizedState;if(_!==null){var I=_.dehydrated;if(Ov(u),S)if(u.flags&256)u.flags&=-257,u=Mj(l,u,m);else if(u.memoizedState!==null)u.child=l.child,u.flags|=128,u=null;else throw Error(n(558));else if(qr||tu(l,u,m,!1),S=(m&l.childLanes)!==0,qr||S){if(x=Qt,x!==null&&(I=ga(x,m),I!==0&&I!==_.retryLane))throw _.retryLane=I,Mo(l,I),ka(x,l,I),Qv;dm(),u=Mj(l,u,m)}else l=_.treeContext,lr=xi(I.nextSibling),On=u,kt=!0,Ol=null,mi=!1,l!==null&&w_(u,l),u=em(u,x),u.flags|=4096;return u}return l=As(l.child,{mode:x.mode,children:x.children}),l.ref=u.ref,u.child=l,l.return=u,l}function tm(l,u){var m=u.ref;if(m===null)l!==null&&l.ref!==null&&(u.flags|=4194816);else{if(typeof m!="function"&&typeof m!="object")throw Error(n(284));(l===null||l.ref!==m)&&(u.flags|=4194816)}}function Jv(l,u,m,x,S){return Bo(u),m=Iv(l,u,m,x,void 0,S),x=Rv(),l!==null&&!qr?(Mv(l,u,S),Ps(l,u,S)):(kt&&x&&mv(u),u.flags|=1,In(l,u,m,S),u.child)}function Pj(l,u,m,x,S,_){return Bo(u),u.updateQueue=null,m=B_(u,x,m,S),L_(l),x=Rv(),l!==null&&!qr?(Mv(l,u,_),Ps(l,u,_)):(kt&&x&&mv(u),u.flags|=1,In(l,u,m,_),u.child)}function Fj(l,u,m,x,S){if(Bo(u),u.stateNode===null){var _=Zc,I=m.contextType;typeof I=="object"&&I!==null&&(_=Dn(I)),_=new m(x,_),u.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Xv,u.stateNode=_,_._reactInternals=u,_=u.stateNode,_.props=x,_.state=u.memoizedState,_.refs={},_v(u),I=m.contextType,_.context=typeof I=="object"&&I!==null?Dn(I):Zc,_.state=u.memoizedState,I=m.getDerivedStateFromProps,typeof I=="function"&&(Yv(u,m,I,x),_.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(I=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),I!==_.state&&Xv.enqueueReplaceState(_,_.state,null),Vd(u,x,_,S),Hd(),_.state=u.memoizedState),typeof _.componentDidMount=="function"&&(u.flags|=4194308),x=!0}else if(l===null){_=u.stateNode;var H=u.memoizedProps,se=Go(m,H);_.props=se;var xe=_.context,_e=m.contextType;I=Zc,typeof _e=="object"&&_e!==null&&(I=Dn(_e));var Te=m.getDerivedStateFromProps;_e=typeof Te=="function"||typeof _.getSnapshotBeforeUpdate=="function",H=u.pendingProps!==H,_e||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(H||xe!==I)&&Nj(u,_,x,I),Rl=!1;var be=u.memoizedState;_.state=be,Vd(u,x,_,S),Hd(),xe=u.memoizedState,H||be!==xe||Rl?(typeof Te=="function"&&(Yv(u,m,Te,x),xe=u.memoizedState),(se=Rl||Sj(u,m,se,x,be,xe,I))?(_e||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(u.flags|=4194308)):(typeof _.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=x,u.memoizedState=xe),_.props=x,_.state=xe,_.context=I,x=se):(typeof _.componentDidMount=="function"&&(u.flags|=4194308),x=!1)}else{_=u.stateNode,jv(l,u),I=u.memoizedProps,_e=Go(m,I),_.props=_e,Te=u.pendingProps,be=_.context,xe=m.contextType,se=Zc,typeof xe=="object"&&xe!==null&&(se=Dn(xe)),H=m.getDerivedStateFromProps,(xe=typeof H=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(I!==Te||be!==se)&&Nj(u,_,x,se),Rl=!1,be=u.memoizedState,_.state=be,Vd(u,x,_,S),Hd();var Se=u.memoizedState;I!==Te||be!==Se||Rl||l!==null&&l.dependencies!==null&&Ph(l.dependencies)?(typeof H=="function"&&(Yv(u,m,H,x),Se=u.memoizedState),(_e=Rl||Sj(u,m,_e,x,be,Se,se)||l!==null&&l.dependencies!==null&&Ph(l.dependencies))?(xe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(x,Se,se),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(x,Se,se)),typeof _.componentDidUpdate=="function"&&(u.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof _.componentDidUpdate!="function"||I===l.memoizedProps&&be===l.memoizedState||(u.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===l.memoizedProps&&be===l.memoizedState||(u.flags|=1024),u.memoizedProps=x,u.memoizedState=Se),_.props=x,_.state=Se,_.context=se,x=_e):(typeof _.componentDidUpdate!="function"||I===l.memoizedProps&&be===l.memoizedState||(u.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||I===l.memoizedProps&&be===l.memoizedState||(u.flags|=1024),x=!1)}return _=x,tm(l,u),x=(u.flags&128)!==0,_||x?(_=u.stateNode,m=x&&typeof m.getDerivedStateFromError!="function"?null:_.render(),u.flags|=1,l!==null&&x?(u.child=Ho(u,l.child,null,S),u.child=Ho(u,null,m,S)):In(l,u,m,S),u.memoizedState=_.state,l=u.child):l=Ps(l,u,S),l}function Lj(l,u,m,x){return Fo(),u.flags|=256,In(l,u,m,x),u.child}var ey={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ty(l){return{baseLanes:l,cachePool:E_()}}function ry(l,u,m){return l=l!==null?l.childLanes&~m:0,u&&(l|=Ha),l}function Bj(l,u,m){var x=u.pendingProps,S=!1,_=(u.flags&128)!==0,I;if((I=_)||(I=l!==null&&l.memoizedState===null?!1:(Fr.current&2)!==0),I&&(S=!0,u.flags&=-129),I=(u.flags&32)!==0,u.flags&=-33,l===null){if(kt){if(S?Fl(u):Ll(),(l=lr)?(l=qE(l,mi),l=l!==null&&l.data!=="&"?l:null,l!==null&&(u.memoizedState={dehydrated:l,treeContext:Al!==null?{id:ss,overflow:ls}:null,retryLane:536870912,hydrationErrors:null},m=v_(l),m.return=u,u.child=m,On=u,lr=null)):l=null,l===null)throw Dl(u);return Ly(l)?u.lanes=32:u.lanes=536870912,null}var H=x.children;return x=x.fallback,S?(Ll(),S=u.mode,H=rm({mode:"hidden",children:H},S),x=Po(x,S,m,null),H.return=u,x.return=u,H.sibling=x,u.child=H,x=u.child,x.memoizedState=ty(m),x.childLanes=ry(l,I,m),u.memoizedState=ey,Yd(null,x)):(Fl(u),ny(u,H))}var se=l.memoizedState;if(se!==null&&(H=se.dehydrated,H!==null)){if(_)u.flags&256?(Fl(u),u.flags&=-257,u=ay(l,u,m)):u.memoizedState!==null?(Ll(),u.child=l.child,u.flags|=128,u=null):(Ll(),H=x.fallback,S=u.mode,x=rm({mode:"visible",children:x.children},S),H=Po(H,S,m,null),H.flags|=2,x.return=u,H.return=u,x.sibling=H,u.child=x,Ho(u,l.child,null,m),x=u.child,x.memoizedState=ty(m),x.childLanes=ry(l,I,m),u.memoizedState=ey,u=Yd(null,x));else if(Fl(u),Ly(H)){if(I=H.nextSibling&&H.nextSibling.dataset,I)var xe=I.dgst;I=xe,x=Error(n(419)),x.stack="",x.digest=I,Fd({value:x,source:null,stack:null}),u=ay(l,u,m)}else if(qr||tu(l,u,m,!1),I=(m&l.childLanes)!==0,qr||I){if(I=Qt,I!==null&&(x=ga(I,m),x!==0&&x!==se.retryLane))throw se.retryLane=x,Mo(l,x),ka(I,l,x),Qv;Fy(H)||dm(),u=ay(l,u,m)}else Fy(H)?(u.flags|=192,u.child=l.child,u=null):(l=se.treeContext,lr=xi(H.nextSibling),On=u,kt=!0,Ol=null,mi=!1,l!==null&&w_(u,l),u=ny(u,x.children),u.flags|=4096);return u}return S?(Ll(),H=x.fallback,S=u.mode,se=l.child,xe=se.sibling,x=As(se,{mode:"hidden",children:x.children}),x.subtreeFlags=se.subtreeFlags&65011712,xe!==null?H=As(xe,H):(H=Po(H,S,m,null),H.flags|=2),H.return=u,x.return=u,x.sibling=H,u.child=x,Yd(null,x),x=u.child,H=l.child.memoizedState,H===null?H=ty(m):(S=H.cachePool,S!==null?(se=Gr._currentValue,S=S.parent!==se?{parent:se,pool:se}:S):S=E_(),H={baseLanes:H.baseLanes|m,cachePool:S}),x.memoizedState=H,x.childLanes=ry(l,I,m),u.memoizedState=ey,Yd(l.child,x)):(Fl(u),m=l.child,l=m.sibling,m=As(m,{mode:"visible",children:x.children}),m.return=u,m.sibling=null,l!==null&&(I=u.deletions,I===null?(u.deletions=[l],u.flags|=16):I.push(l)),u.child=m,u.memoizedState=null,m)}function ny(l,u){return u=rm({mode:"visible",children:u},l.mode),u.return=l,l.child=u}function rm(l,u){return l=Ba(22,l,null,u),l.lanes=0,l}function ay(l,u,m){return Ho(u,l.child,null,m),l=ny(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function Uj(l,u,m){l.lanes|=u;var x=l.alternate;x!==null&&(x.lanes|=u),yv(l.return,u,m)}function iy(l,u,m,x,S,_){var I=l.memoizedState;I===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:x,tail:m,tailMode:S,treeForkCount:_}:(I.isBackwards=u,I.rendering=null,I.renderingStartTime=0,I.last=x,I.tail=m,I.tailMode=S,I.treeForkCount=_)}function zj(l,u,m){var x=u.pendingProps,S=x.revealOrder,_=x.tail;x=x.children;var I=Fr.current,H=(I&2)!==0;if(H?(I=I&1|2,u.flags|=128):I&=1,X(Fr,I),In(l,u,x,m),x=kt?Pd:0,!H&&l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Uj(l,m,u);else if(l.tag===19)Uj(l,m,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}switch(S){case"forwards":for(m=u.child,S=null;m!==null;)l=m.alternate,l!==null&&Vh(l)===null&&(S=m),m=m.sibling;m=S,m===null?(S=u.child,u.child=null):(S=m.sibling,m.sibling=null),iy(u,!1,S,m,_,x);break;case"backwards":case"unstable_legacy-backwards":for(m=null,S=u.child,u.child=null;S!==null;){if(l=S.alternate,l!==null&&Vh(l)===null){u.child=S;break}l=S.sibling,S.sibling=m,m=S,S=l}iy(u,!0,m,null,_,x);break;case"together":iy(u,!1,null,null,void 0,x);break;default:u.memoizedState=null}return u.child}function Ps(l,u,m){if(l!==null&&(u.dependencies=l.dependencies),zl|=u.lanes,(m&u.childLanes)===0)if(l!==null){if(tu(l,u,m,!1),(m&u.childLanes)===0)return null}else return null;if(l!==null&&u.child!==l.child)throw Error(n(153));if(u.child!==null){for(l=u.child,m=As(l,l.pendingProps),u.child=m,m.return=u;l.sibling!==null;)l=l.sibling,m=m.sibling=As(l,l.pendingProps),m.return=u;m.sibling=null}return u.child}function sy(l,u){return(l.lanes&u)!==0?!0:(l=l.dependencies,!!(l!==null&&Ph(l)))}function p9(l,u,m){switch(u.tag){case 3:de(u,u.stateNode.containerInfo),Il(u,Gr,l.memoizedState.cache),Fo();break;case 27:case 5:oe(u);break;case 4:de(u,u.stateNode.containerInfo);break;case 10:Il(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,Ov(u),null;break;case 13:var x=u.memoizedState;if(x!==null)return x.dehydrated!==null?(Fl(u),u.flags|=128,null):(m&u.child.childLanes)!==0?Bj(l,u,m):(Fl(u),l=Ps(l,u,m),l!==null?l.sibling:null);Fl(u);break;case 19:var S=(l.flags&128)!==0;if(x=(m&u.childLanes)!==0,x||(tu(l,u,m,!1),x=(m&u.childLanes)!==0),S){if(x)return zj(l,u,m);u.flags|=128}if(S=u.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),X(Fr,Fr.current),x)break;return null;case 22:return u.lanes=0,Ij(l,u,m,u.pendingProps);case 24:Il(u,Gr,l.memoizedState.cache)}return Ps(l,u,m)}function $j(l,u,m){if(l!==null)if(l.memoizedProps!==u.pendingProps)qr=!0;else{if(!sy(l,m)&&(u.flags&128)===0)return qr=!1,p9(l,u,m);qr=(l.flags&131072)!==0}else qr=!1,kt&&(u.flags&1048576)!==0&&b_(u,Pd,u.index);switch(u.lanes=0,u.tag){case 16:e:{var x=u.pendingProps;if(l=zo(u.elementType),u.type=l,typeof l=="function")dv(l)?(x=Go(l,x),u.tag=1,u=Fj(null,u,l,x,m)):(u.tag=0,u=Jv(null,u,l,x,m));else{if(l!=null){var S=l.$$typeof;if(S===C){u.tag=11,u=Aj(null,u,l,x,m);break e}else if(S===A){u.tag=14,u=Oj(null,u,l,x,m);break e}}throw u=ee(l)||l,Error(n(306,u,""))}}return u;case 0:return Jv(l,u,u.type,u.pendingProps,m);case 1:return x=u.type,S=Go(x,u.pendingProps),Fj(l,u,x,S,m);case 3:e:{if(de(u,u.stateNode.containerInfo),l===null)throw Error(n(387));x=u.pendingProps;var _=u.memoizedState;S=_.element,jv(l,u),Vd(u,x,null,m);var I=u.memoizedState;if(x=I.cache,Il(u,Gr,x),x!==_.cache&&bv(u,[Gr],m,!0),Hd(),x=I.element,_.isDehydrated)if(_={element:x,isDehydrated:!1,cache:I.cache},u.updateQueue.baseState=_,u.memoizedState=_,u.flags&256){u=Lj(l,u,x,m);break e}else if(x!==S){S=di(Error(n(424)),u),Fd(S),u=Lj(l,u,x,m);break e}else for(l=u.stateNode.containerInfo,l.nodeType===9?l=l.body:l=l.nodeName==="HTML"?l.ownerDocument.body:l,lr=xi(l.firstChild),On=u,kt=!0,Ol=null,mi=!0,m=I_(u,null,x,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Fo(),x===S){u=Ps(l,u,m);break e}In(l,u,x,m)}u=u.child}return u;case 26:return tm(l,u),l===null?(m=JE(u.type,null,u.pendingProps,null))?u.memoizedState=m:kt||(m=u.type,l=u.pendingProps,x=vm(G.current).createElement(m),x[Z]=u,x[Q]=l,Rn(x,m,l),qe(x),u.stateNode=x):u.memoizedState=JE(u.type,l.memoizedProps,u.pendingProps,l.memoizedState),null;case 27:return oe(u),l===null&&kt&&(x=u.stateNode=XE(u.type,u.pendingProps,G.current),On=u,mi=!0,S=lr,Wl(u.type)?(By=S,lr=xi(x.firstChild)):lr=S),In(l,u,u.pendingProps.children,m),tm(l,u),l===null&&(u.flags|=4194304),u.child;case 5:return l===null&&kt&&((S=x=lr)&&(x=G9(x,u.type,u.pendingProps,mi),x!==null?(u.stateNode=x,On=u,lr=xi(x.firstChild),mi=!1,S=!0):S=!1),S||Dl(u)),oe(u),S=u.type,_=u.pendingProps,I=l!==null?l.memoizedProps:null,x=_.children,Ry(S,_)?x=null:I!==null&&Ry(S,I)&&(u.flags|=32),u.memoizedState!==null&&(S=Iv(l,u,s9,null,null,m),df._currentValue=S),tm(l,u),In(l,u,x,m),u.child;case 6:return l===null&&kt&&((l=m=lr)&&(m=W9(m,u.pendingProps,mi),m!==null?(u.stateNode=m,On=u,lr=null,l=!0):l=!1),l||Dl(u)),null;case 13:return Bj(l,u,m);case 4:return de(u,u.stateNode.containerInfo),x=u.pendingProps,l===null?u.child=Ho(u,null,x,m):In(l,u,x,m),u.child;case 11:return Aj(l,u,u.type,u.pendingProps,m);case 7:return In(l,u,u.pendingProps,m),u.child;case 8:return In(l,u,u.pendingProps.children,m),u.child;case 12:return In(l,u,u.pendingProps.children,m),u.child;case 10:return x=u.pendingProps,Il(u,u.type,x.value),In(l,u,x.children,m),u.child;case 9:return S=u.type._context,x=u.pendingProps.children,Bo(u),S=Dn(S),x=x(S),u.flags|=1,In(l,u,x,m),u.child;case 14:return Oj(l,u,u.type,u.pendingProps,m);case 15:return Dj(l,u,u.type,u.pendingProps,m);case 19:return zj(l,u,m);case 31:return m9(l,u,m);case 22:return Ij(l,u,m,u.pendingProps);case 24:return Bo(u),x=Dn(Gr),l===null?(S=Nv(),S===null&&(S=Qt,_=wv(),S.pooledCache=_,_.refCount++,_!==null&&(S.pooledCacheLanes|=m),S=_),u.memoizedState={parent:x,cache:S},_v(u),Il(u,Gr,S)):((l.lanes&m)!==0&&(jv(l,u),Vd(u,null,null,m),Hd()),S=l.memoizedState,_=u.memoizedState,S.parent!==x?(S={parent:x,cache:x},u.memoizedState=S,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=S),Il(u,Gr,x)):(x=_.cache,Il(u,Gr,x),x!==S.cache&&bv(u,[Gr],m,!0))),In(l,u,u.pendingProps.children,m),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function Fs(l){l.flags|=4}function ly(l,u,m,x,S){if((u=(l.mode&32)!==0)&&(u=!1),u){if(l.flags|=16777216,(S&335544128)===S)if(l.stateNode.complete)l.flags|=8192;else if(pE())l.flags|=8192;else throw $o=Uh,kv}else l.flags&=-16777217}function Hj(l,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!aT(u))if(pE())l.flags|=8192;else throw $o=Uh,kv}function nm(l,u){u!==null&&(l.flags|=4),l.flags&16384&&(u=l.tag!==22?pn():536870912,l.lanes|=u,hu|=u)}function Xd(l,u){if(!kt)switch(l.tailMode){case"hidden":u=l.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?l.tail=null:m.sibling=null;break;case"collapsed":m=l.tail;for(var x=null;m!==null;)m.alternate!==null&&(x=m),m=m.sibling;x===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function or(l){var u=l.alternate!==null&&l.alternate.child===l.child,m=0,x=0;if(u)for(var S=l.child;S!==null;)m|=S.lanes|S.childLanes,x|=S.subtreeFlags&65011712,x|=S.flags&65011712,S.return=l,S=S.sibling;else for(S=l.child;S!==null;)m|=S.lanes|S.childLanes,x|=S.subtreeFlags,x|=S.flags,S.return=l,S=S.sibling;return l.subtreeFlags|=x,l.childLanes=m,u}function x9(l,u,m){var x=u.pendingProps;switch(pv(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return or(u),null;case 1:return or(u),null;case 3:return m=u.stateNode,x=null,l!==null&&(x=l.memoizedState.cache),u.memoizedState.cache!==x&&(u.flags|=2048),Is(Gr),ne(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(l===null||l.child===null)&&(eu(u)?Fs(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,gv())),or(u),null;case 26:var S=u.type,_=u.memoizedState;return l===null?(Fs(u),_!==null?(or(u),Hj(u,_)):(or(u),ly(u,S,null,x,m))):_?_!==l.memoizedState?(Fs(u),or(u),Hj(u,_)):(or(u),u.flags&=-16777217):(l=l.memoizedProps,l!==x&&Fs(u),or(u),ly(u,S,l,x,m)),null;case 27:if(Ae(u),m=G.current,S=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==x&&Fs(u);else{if(!x){if(u.stateNode===null)throw Error(n(166));return or(u),null}l=q.current,eu(u)?S_(u):(l=XE(S,x,m),u.stateNode=l,Fs(u))}return or(u),null;case 5:if(Ae(u),S=u.type,l!==null&&u.stateNode!=null)l.memoizedProps!==x&&Fs(u);else{if(!x){if(u.stateNode===null)throw Error(n(166));return or(u),null}if(_=q.current,eu(u))S_(u);else{var I=vm(G.current);switch(_){case 1:_=I.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:_=I.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":_=I.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":_=I.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":_=I.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof x.is=="string"?I.createElement("select",{is:x.is}):I.createElement("select"),x.multiple?_.multiple=!0:x.size&&(_.size=x.size);break;default:_=typeof x.is=="string"?I.createElement(S,{is:x.is}):I.createElement(S)}}_[Z]=u,_[Q]=x;e:for(I=u.child;I!==null;){if(I.tag===5||I.tag===6)_.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===u)break e;for(;I.sibling===null;){if(I.return===null||I.return===u)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}u.stateNode=_;e:switch(Rn(_,S,x),S){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&Fs(u)}}return or(u),ly(u,u.type,l===null?null:l.memoizedProps,u.pendingProps,m),null;case 6:if(l&&u.stateNode!=null)l.memoizedProps!==x&&Fs(u);else{if(typeof x!="string"&&u.stateNode===null)throw Error(n(166));if(l=G.current,eu(u)){if(l=u.stateNode,m=u.memoizedProps,x=null,S=On,S!==null)switch(S.tag){case 27:case 5:x=S.memoizedProps}l[Z]=u,l=!!(l.nodeValue===m||x!==null&&x.suppressHydrationWarning===!0||BE(l.nodeValue,m)),l||Dl(u,!0)}else l=vm(l).createTextNode(x),l[Z]=u,u.stateNode=l}return or(u),null;case 31:if(m=u.memoizedState,l===null||l.memoizedState!==null){if(x=eu(u),m!==null){if(l===null){if(!x)throw Error(n(318));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(557));l[Z]=u}else Fo(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;or(u),l=!1}else m=gv(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=m),l=!0;if(!l)return u.flags&256?(za(u),u):(za(u),null);if((u.flags&128)!==0)throw Error(n(558))}return or(u),null;case 13:if(x=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(S=eu(u),x!==null&&x.dehydrated!==null){if(l===null){if(!S)throw Error(n(318));if(S=u.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[Z]=u}else Fo(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;or(u),S=!1}else S=gv(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=S),S=!0;if(!S)return u.flags&256?(za(u),u):(za(u),null)}return za(u),(u.flags&128)!==0?(u.lanes=m,u):(m=x!==null,l=l!==null&&l.memoizedState!==null,m&&(x=u.child,S=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(S=x.alternate.memoizedState.cachePool.pool),_=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(_=x.memoizedState.cachePool.pool),_!==S&&(x.flags|=2048)),m!==l&&m&&(u.child.flags|=8192),nm(u,u.updateQueue),or(u),null);case 4:return ne(),l===null&&Cy(u.stateNode.containerInfo),or(u),null;case 10:return Is(u.type),or(u),null;case 19:if(F(Fr),x=u.memoizedState,x===null)return or(u),null;if(S=(u.flags&128)!==0,_=x.rendering,_===null)if(S)Xd(x,!1);else{if(Cr!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(_=Vh(l),_!==null){for(u.flags|=128,Xd(x,!1),l=_.updateQueue,u.updateQueue=l,nm(u,l),u.subtreeFlags=0,l=m,m=u.child;m!==null;)g_(m,l),m=m.sibling;return X(Fr,Fr.current&1|2),kt&&Os(u,x.treeForkCount),u.child}l=l.sibling}x.tail!==null&&mt()>om&&(u.flags|=128,S=!0,Xd(x,!1),u.lanes=4194304)}else{if(!S)if(l=Vh(_),l!==null){if(u.flags|=128,S=!0,l=l.updateQueue,u.updateQueue=l,nm(u,l),Xd(x,!0),x.tail===null&&x.tailMode==="hidden"&&!_.alternate&&!kt)return or(u),null}else 2*mt()-x.renderingStartTime>om&&m!==536870912&&(u.flags|=128,S=!0,Xd(x,!1),u.lanes=4194304);x.isBackwards?(_.sibling=u.child,u.child=_):(l=x.last,l!==null?l.sibling=_:u.child=_,x.last=_)}return x.tail!==null?(l=x.tail,x.rendering=l,x.tail=l.sibling,x.renderingStartTime=mt(),l.sibling=null,m=Fr.current,X(Fr,S?m&1|2:m&1),kt&&Os(u,x.treeForkCount),l):(or(u),null);case 22:case 23:return za(u),Av(),x=u.memoizedState!==null,l!==null?l.memoizedState!==null!==x&&(u.flags|=8192):x&&(u.flags|=8192),x?(m&536870912)!==0&&(u.flags&128)===0&&(or(u),u.subtreeFlags&6&&(u.flags|=8192)):or(u),m=u.updateQueue,m!==null&&nm(u,m.retryQueue),m=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),x=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(x=u.memoizedState.cachePool.pool),x!==m&&(u.flags|=2048),l!==null&&F(Uo),null;case 24:return m=null,l!==null&&(m=l.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),Is(Gr),or(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function g9(l,u){switch(pv(u),u.tag){case 1:return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Is(Gr),ne(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 26:case 27:case 5:return Ae(u),null;case 31:if(u.memoizedState!==null){if(za(u),u.alternate===null)throw Error(n(340));Fo()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 13:if(za(u),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(n(340));Fo()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return F(Fr),null;case 4:return ne(),null;case 10:return Is(u.type),null;case 22:case 23:return za(u),Av(),l!==null&&F(Uo),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 24:return Is(Gr),null;case 25:return null;default:return null}}function Vj(l,u){switch(pv(u),u.tag){case 3:Is(Gr),ne();break;case 26:case 27:case 5:Ae(u);break;case 4:ne();break;case 31:u.memoizedState!==null&&za(u);break;case 13:za(u);break;case 19:F(Fr);break;case 10:Is(u.type);break;case 22:case 23:za(u),Av(),l!==null&&F(Uo);break;case 24:Is(Gr)}}function Zd(l,u){try{var m=u.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var S=x.next;m=S;do{if((m.tag&l)===l){x=void 0;var _=m.create,I=m.inst;x=_(),I.destroy=x}m=m.next}while(m!==S)}}catch(H){Bt(u,u.return,H)}}function Bl(l,u,m){try{var x=u.updateQueue,S=x!==null?x.lastEffect:null;if(S!==null){var _=S.next;x=_;do{if((x.tag&l)===l){var I=x.inst,H=I.destroy;if(H!==void 0){I.destroy=void 0,S=u;var se=m,xe=H;try{xe()}catch(_e){Bt(S,se,_e)}}}x=x.next}while(x!==_)}}catch(_e){Bt(u,u.return,_e)}}function Gj(l){var u=l.updateQueue;if(u!==null){var m=l.stateNode;try{M_(u,m)}catch(x){Bt(l,l.return,x)}}}function Wj(l,u,m){m.props=Go(l.type,l.memoizedProps),m.state=l.memoizedState;try{m.componentWillUnmount()}catch(x){Bt(l,u,x)}}function Qd(l,u){try{var m=l.ref;if(m!==null){switch(l.tag){case 26:case 27:case 5:var x=l.stateNode;break;case 30:x=l.stateNode;break;default:x=l.stateNode}typeof m=="function"?l.refCleanup=m(x):m.current=x}}catch(S){Bt(l,u,S)}}function os(l,u){var m=l.ref,x=l.refCleanup;if(m!==null)if(typeof x=="function")try{x()}catch(S){Bt(l,u,S)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(S){Bt(l,u,S)}else m.current=null}function qj(l){var u=l.type,m=l.memoizedProps,x=l.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":m.autoFocus&&x.focus();break e;case"img":m.src?x.src=m.src:m.srcSet&&(x.srcset=m.srcSet)}}catch(S){Bt(l,l.return,S)}}function oy(l,u,m){try{var x=l.stateNode;B9(x,l.type,m,u),x[Q]=u}catch(S){Bt(l,l.return,S)}}function Kj(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&Wl(l.type)||l.tag===4}function cy(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Kj(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&Wl(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function uy(l,u,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m).insertBefore(l,u):(u=m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,u.appendChild(l),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=Ts));else if(x!==4&&(x===27&&Wl(l.type)&&(m=l.stateNode,u=null),l=l.child,l!==null))for(uy(l,u,m),l=l.sibling;l!==null;)uy(l,u,m),l=l.sibling}function am(l,u,m){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?m.insertBefore(l,u):m.appendChild(l);else if(x!==4&&(x===27&&Wl(l.type)&&(m=l.stateNode),l=l.child,l!==null))for(am(l,u,m),l=l.sibling;l!==null;)am(l,u,m),l=l.sibling}function Yj(l){var u=l.stateNode,m=l.memoizedProps;try{for(var x=l.type,S=u.attributes;S.length;)u.removeAttributeNode(S[0]);Rn(u,x,m),u[Z]=l,u[Q]=m}catch(_){Bt(l,l.return,_)}}var Ls=!1,Kr=!1,dy=!1,Xj=typeof WeakSet=="function"?WeakSet:Set,xn=null;function v9(l,u){if(l=l.containerInfo,Dy=_m,l=o_(l),av(l)){if("selectionStart"in l)var m={start:l.selectionStart,end:l.selectionEnd};else e:{m=(m=l.ownerDocument)&&m.defaultView||window;var x=m.getSelection&&m.getSelection();if(x&&x.rangeCount!==0){m=x.anchorNode;var S=x.anchorOffset,_=x.focusNode;x=x.focusOffset;try{m.nodeType,_.nodeType}catch{m=null;break e}var I=0,H=-1,se=-1,xe=0,_e=0,Te=l,be=null;t:for(;;){for(var Se;Te!==m||S!==0&&Te.nodeType!==3||(H=I+S),Te!==_||x!==0&&Te.nodeType!==3||(se=I+x),Te.nodeType===3&&(I+=Te.nodeValue.length),(Se=Te.firstChild)!==null;)be=Te,Te=Se;for(;;){if(Te===l)break t;if(be===m&&++xe===S&&(H=I),be===_&&++_e===x&&(se=I),(Se=Te.nextSibling)!==null)break;Te=be,be=Te.parentNode}Te=Se}m=H===-1||se===-1?null:{start:H,end:se}}else m=null}m=m||{start:0,end:0}}else m=null;for(Iy={focusedElem:l,selectionRange:m},_m=!1,xn=u;xn!==null;)if(u=xn,l=u.child,(u.subtreeFlags&1028)!==0&&l!==null)l.return=u,xn=l;else for(;xn!==null;){switch(u=xn,_=u.alternate,l=u.flags,u.tag){case 0:if((l&4)!==0&&(l=u.updateQueue,l=l!==null?l.events:null,l!==null))for(m=0;m<l.length;m++)S=l[m],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((l&1024)!==0&&_!==null){l=void 0,m=u,S=_.memoizedProps,_=_.memoizedState,x=m.stateNode;try{var Ve=Go(m.type,S);l=x.getSnapshotBeforeUpdate(Ve,_),x.__reactInternalSnapshotBeforeUpdate=l}catch(rt){Bt(m,m.return,rt)}}break;case 3:if((l&1024)!==0){if(l=u.stateNode.containerInfo,m=l.nodeType,m===9)Py(l);else if(m===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":Py(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=u.sibling,l!==null){l.return=u.return,xn=l;break}xn=u.return}}function Zj(l,u,m){var x=m.flags;switch(m.tag){case 0:case 11:case 15:Us(l,m),x&4&&Zd(5,m);break;case 1:if(Us(l,m),x&4)if(l=m.stateNode,u===null)try{l.componentDidMount()}catch(I){Bt(m,m.return,I)}else{var S=Go(m.type,u.memoizedProps);u=u.memoizedState;try{l.componentDidUpdate(S,u,l.__reactInternalSnapshotBeforeUpdate)}catch(I){Bt(m,m.return,I)}}x&64&&Gj(m),x&512&&Qd(m,m.return);break;case 3:if(Us(l,m),x&64&&(l=m.updateQueue,l!==null)){if(u=null,m.child!==null)switch(m.child.tag){case 27:case 5:u=m.child.stateNode;break;case 1:u=m.child.stateNode}try{M_(l,u)}catch(I){Bt(m,m.return,I)}}break;case 27:u===null&&x&4&&Yj(m);case 26:case 5:Us(l,m),u===null&&x&4&&qj(m),x&512&&Qd(m,m.return);break;case 12:Us(l,m);break;case 31:Us(l,m),x&4&&eE(l,m);break;case 13:Us(l,m),x&4&&tE(l,m),x&64&&(l=m.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(m=E9.bind(null,m),q9(l,m))));break;case 22:if(x=m.memoizedState!==null||Ls,!x){u=u!==null&&u.memoizedState!==null||Kr,S=Ls;var _=Kr;Ls=x,(Kr=u)&&!_?zs(l,m,(m.subtreeFlags&8772)!==0):Us(l,m),Ls=S,Kr=_}break;case 30:break;default:Us(l,m)}}function Qj(l){var u=l.alternate;u!==null&&(l.alternate=null,Qj(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&Oe(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var pr=null,ba=!1;function Bs(l,u,m){for(m=m.child;m!==null;)Jj(l,u,m),m=m.sibling}function Jj(l,u,m){if(br&&typeof br.onCommitFiberUnmount=="function")try{br.onCommitFiberUnmount(Zt,m)}catch{}switch(m.tag){case 26:Kr||os(m,u),Bs(l,u,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Kr||os(m,u);var x=pr,S=ba;Wl(m.type)&&(pr=m.stateNode,ba=!1),Bs(l,u,m),of(m.stateNode),pr=x,ba=S;break;case 5:Kr||os(m,u);case 6:if(x=pr,S=ba,pr=null,Bs(l,u,m),pr=x,ba=S,pr!==null)if(ba)try{(pr.nodeType===9?pr.body:pr.nodeName==="HTML"?pr.ownerDocument.body:pr).removeChild(m.stateNode)}catch(_){Bt(m,u,_)}else try{pr.removeChild(m.stateNode)}catch(_){Bt(m,u,_)}break;case 18:pr!==null&&(ba?(l=pr,GE(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,m.stateNode),wu(l)):GE(pr,m.stateNode));break;case 4:x=pr,S=ba,pr=m.stateNode.containerInfo,ba=!0,Bs(l,u,m),pr=x,ba=S;break;case 0:case 11:case 14:case 15:Bl(2,m,u),Kr||Bl(4,m,u),Bs(l,u,m);break;case 1:Kr||(os(m,u),x=m.stateNode,typeof x.componentWillUnmount=="function"&&Wj(m,u,x)),Bs(l,u,m);break;case 21:Bs(l,u,m);break;case 22:Kr=(x=Kr)||m.memoizedState!==null,Bs(l,u,m),Kr=x;break;default:Bs(l,u,m)}}function eE(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null))){l=l.dehydrated;try{wu(l)}catch(m){Bt(u,u.return,m)}}}function tE(l,u){if(u.memoizedState===null&&(l=u.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{wu(l)}catch(m){Bt(u,u.return,m)}}function y9(l){switch(l.tag){case 31:case 13:case 19:var u=l.stateNode;return u===null&&(u=l.stateNode=new Xj),u;case 22:return l=l.stateNode,u=l._retryCache,u===null&&(u=l._retryCache=new Xj),u;default:throw Error(n(435,l.tag))}}function im(l,u){var m=y9(l);u.forEach(function(x){if(!m.has(x)){m.add(x);var S=T9.bind(null,l,x);x.then(S,S)}})}function wa(l,u){var m=u.deletions;if(m!==null)for(var x=0;x<m.length;x++){var S=m[x],_=l,I=u,H=I;e:for(;H!==null;){switch(H.tag){case 27:if(Wl(H.type)){pr=H.stateNode,ba=!1;break e}break;case 5:pr=H.stateNode,ba=!1;break e;case 3:case 4:pr=H.stateNode.containerInfo,ba=!0;break e}H=H.return}if(pr===null)throw Error(n(160));Jj(_,I,S),pr=null,ba=!1,_=S.alternate,_!==null&&(_.return=null),S.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)rE(u,l),u=u.sibling}var Ui=null;function rE(l,u){var m=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:wa(u,l),Sa(l),x&4&&(Bl(3,l,l.return),Zd(3,l),Bl(5,l,l.return));break;case 1:wa(u,l),Sa(l),x&512&&(Kr||m===null||os(m,m.return)),x&64&&Ls&&(l=l.updateQueue,l!==null&&(x=l.callbacks,x!==null&&(m=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=m===null?x:m.concat(x))));break;case 26:var S=Ui;if(wa(u,l),Sa(l),x&512&&(Kr||m===null||os(m,m.return)),x&4){var _=m!==null?m.memoizedState:null;if(x=l.memoizedState,m===null)if(x===null)if(l.stateNode===null){e:{x=l.type,m=l.memoizedProps,S=S.ownerDocument||S;t:switch(x){case"title":_=S.getElementsByTagName("title")[0],(!_||_[we]||_[Z]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=S.createElement(x),S.head.insertBefore(_,S.querySelector("head > title"))),Rn(_,x,m),_[Z]=l,qe(_),x=_;break e;case"link":var I=rT("link","href",S).get(x+(m.href||""));if(I){for(var H=0;H<I.length;H++)if(_=I[H],_.getAttribute("href")===(m.href==null||m.href===""?null:m.href)&&_.getAttribute("rel")===(m.rel==null?null:m.rel)&&_.getAttribute("title")===(m.title==null?null:m.title)&&_.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){I.splice(H,1);break t}}_=S.createElement(x),Rn(_,x,m),S.head.appendChild(_);break;case"meta":if(I=rT("meta","content",S).get(x+(m.content||""))){for(H=0;H<I.length;H++)if(_=I[H],_.getAttribute("content")===(m.content==null?null:""+m.content)&&_.getAttribute("name")===(m.name==null?null:m.name)&&_.getAttribute("property")===(m.property==null?null:m.property)&&_.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&_.getAttribute("charset")===(m.charSet==null?null:m.charSet)){I.splice(H,1);break t}}_=S.createElement(x),Rn(_,x,m),S.head.appendChild(_);break;default:throw Error(n(468,x))}_[Z]=l,qe(_),x=_}l.stateNode=x}else nT(S,l.type,l.stateNode);else l.stateNode=tT(S,x,l.memoizedProps);else _!==x?(_===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):_.count--,x===null?nT(S,l.type,l.stateNode):tT(S,x,l.memoizedProps)):x===null&&l.stateNode!==null&&oy(l,l.memoizedProps,m.memoizedProps)}break;case 27:wa(u,l),Sa(l),x&512&&(Kr||m===null||os(m,m.return)),m!==null&&x&4&&oy(l,l.memoizedProps,m.memoizedProps);break;case 5:if(wa(u,l),Sa(l),x&512&&(Kr||m===null||os(m,m.return)),l.flags&32){S=l.stateNode;try{Vc(S,"")}catch(Ve){Bt(l,l.return,Ve)}}x&4&&l.stateNode!=null&&(S=l.memoizedProps,oy(l,S,m!==null?m.memoizedProps:S)),x&1024&&(dy=!0);break;case 6:if(wa(u,l),Sa(l),x&4){if(l.stateNode===null)throw Error(n(162));x=l.memoizedProps,m=l.stateNode;try{m.nodeValue=x}catch(Ve){Bt(l,l.return,Ve)}}break;case 3:if(wm=null,S=Ui,Ui=ym(u.containerInfo),wa(u,l),Ui=S,Sa(l),x&4&&m!==null&&m.memoizedState.isDehydrated)try{wu(u.containerInfo)}catch(Ve){Bt(l,l.return,Ve)}dy&&(dy=!1,nE(l));break;case 4:x=Ui,Ui=ym(l.stateNode.containerInfo),wa(u,l),Sa(l),Ui=x;break;case 12:wa(u,l),Sa(l);break;case 31:wa(u,l),Sa(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,im(l,x)));break;case 13:wa(u,l),Sa(l),l.child.flags&8192&&l.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(lm=mt()),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,im(l,x)));break;case 22:S=l.memoizedState!==null;var se=m!==null&&m.memoizedState!==null,xe=Ls,_e=Kr;if(Ls=xe||S,Kr=_e||se,wa(u,l),Kr=_e,Ls=xe,Sa(l),x&8192)e:for(u=l.stateNode,u._visibility=S?u._visibility&-2:u._visibility|1,S&&(m===null||se||Ls||Kr||Wo(l)),m=null,u=l;;){if(u.tag===5||u.tag===26){if(m===null){se=m=u;try{if(_=se.stateNode,S)I=_.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{H=se.stateNode;var Te=se.memoizedProps.style,be=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;H.style.display=be==null||typeof be=="boolean"?"":(""+be).trim()}}catch(Ve){Bt(se,se.return,Ve)}}}else if(u.tag===6){if(m===null){se=u;try{se.stateNode.nodeValue=S?"":se.memoizedProps}catch(Ve){Bt(se,se.return,Ve)}}}else if(u.tag===18){if(m===null){se=u;try{var Se=se.stateNode;S?WE(Se,!0):WE(se.stateNode,!1)}catch(Ve){Bt(se,se.return,Ve)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}x&4&&(x=l.updateQueue,x!==null&&(m=x.retryQueue,m!==null&&(x.retryQueue=null,im(l,m))));break;case 19:wa(u,l),Sa(l),x&4&&(x=l.updateQueue,x!==null&&(l.updateQueue=null,im(l,x)));break;case 30:break;case 21:break;default:wa(u,l),Sa(l)}}function Sa(l){var u=l.flags;if(u&2){try{for(var m,x=l.return;x!==null;){if(Kj(x)){m=x;break}x=x.return}if(m==null)throw Error(n(160));switch(m.tag){case 27:var S=m.stateNode,_=cy(l);am(l,_,S);break;case 5:var I=m.stateNode;m.flags&32&&(Vc(I,""),m.flags&=-33);var H=cy(l);am(l,H,I);break;case 3:case 4:var se=m.stateNode.containerInfo,xe=cy(l);uy(l,xe,se);break;default:throw Error(n(161))}}catch(_e){Bt(l,l.return,_e)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function nE(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var u=l;nE(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),l=l.sibling}}function Us(l,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Zj(l,u.alternate,u),u=u.sibling}function Wo(l){for(l=l.child;l!==null;){var u=l;switch(u.tag){case 0:case 11:case 14:case 15:Bl(4,u,u.return),Wo(u);break;case 1:os(u,u.return);var m=u.stateNode;typeof m.componentWillUnmount=="function"&&Wj(u,u.return,m),Wo(u);break;case 27:of(u.stateNode);case 26:case 5:os(u,u.return),Wo(u);break;case 22:u.memoizedState===null&&Wo(u);break;case 30:Wo(u);break;default:Wo(u)}l=l.sibling}}function zs(l,u,m){for(m=m&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var x=u.alternate,S=l,_=u,I=_.flags;switch(_.tag){case 0:case 11:case 15:zs(S,_,m),Zd(4,_);break;case 1:if(zs(S,_,m),x=_,S=x.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(xe){Bt(x,x.return,xe)}if(x=_,S=x.updateQueue,S!==null){var H=x.stateNode;try{var se=S.shared.hiddenCallbacks;if(se!==null)for(S.shared.hiddenCallbacks=null,S=0;S<se.length;S++)R_(se[S],H)}catch(xe){Bt(x,x.return,xe)}}m&&I&64&&Gj(_),Qd(_,_.return);break;case 27:Yj(_);case 26:case 5:zs(S,_,m),m&&x===null&&I&4&&qj(_),Qd(_,_.return);break;case 12:zs(S,_,m);break;case 31:zs(S,_,m),m&&I&4&&eE(S,_);break;case 13:zs(S,_,m),m&&I&4&&tE(S,_);break;case 22:_.memoizedState===null&&zs(S,_,m),Qd(_,_.return);break;case 30:break;default:zs(S,_,m)}u=u.sibling}}function fy(l,u){var m=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),l=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(l=u.memoizedState.cachePool.pool),l!==m&&(l!=null&&l.refCount++,m!=null&&Ld(m))}function hy(l,u){l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Ld(l))}function zi(l,u,m,x){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)aE(l,u,m,x),u=u.sibling}function aE(l,u,m,x){var S=u.flags;switch(u.tag){case 0:case 11:case 15:zi(l,u,m,x),S&2048&&Zd(9,u);break;case 1:zi(l,u,m,x);break;case 3:zi(l,u,m,x),S&2048&&(l=null,u.alternate!==null&&(l=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==l&&(u.refCount++,l!=null&&Ld(l)));break;case 12:if(S&2048){zi(l,u,m,x),l=u.stateNode;try{var _=u.memoizedProps,I=_.id,H=_.onPostCommit;typeof H=="function"&&H(I,u.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(se){Bt(u,u.return,se)}}else zi(l,u,m,x);break;case 31:zi(l,u,m,x);break;case 13:zi(l,u,m,x);break;case 23:break;case 22:_=u.stateNode,I=u.alternate,u.memoizedState!==null?_._visibility&2?zi(l,u,m,x):Jd(l,u):_._visibility&2?zi(l,u,m,x):(_._visibility|=2,uu(l,u,m,x,(u.subtreeFlags&10256)!==0||!1)),S&2048&&fy(I,u);break;case 24:zi(l,u,m,x),S&2048&&hy(u.alternate,u);break;default:zi(l,u,m,x)}}function uu(l,u,m,x,S){for(S=S&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var _=l,I=u,H=m,se=x,xe=I.flags;switch(I.tag){case 0:case 11:case 15:uu(_,I,H,se,S),Zd(8,I);break;case 23:break;case 22:var _e=I.stateNode;I.memoizedState!==null?_e._visibility&2?uu(_,I,H,se,S):Jd(_,I):(_e._visibility|=2,uu(_,I,H,se,S)),S&&xe&2048&&fy(I.alternate,I);break;case 24:uu(_,I,H,se,S),S&&xe&2048&&hy(I.alternate,I);break;default:uu(_,I,H,se,S)}u=u.sibling}}function Jd(l,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var m=l,x=u,S=x.flags;switch(x.tag){case 22:Jd(m,x),S&2048&&fy(x.alternate,x);break;case 24:Jd(m,x),S&2048&&hy(x.alternate,x);break;default:Jd(m,x)}u=u.sibling}}var ef=8192;function du(l,u,m){if(l.subtreeFlags&ef)for(l=l.child;l!==null;)iE(l,u,m),l=l.sibling}function iE(l,u,m){switch(l.tag){case 26:du(l,u,m),l.flags&ef&&l.memoizedState!==null&&i7(m,Ui,l.memoizedState,l.memoizedProps);break;case 5:du(l,u,m);break;case 3:case 4:var x=Ui;Ui=ym(l.stateNode.containerInfo),du(l,u,m),Ui=x;break;case 22:l.memoizedState===null&&(x=l.alternate,x!==null&&x.memoizedState!==null?(x=ef,ef=16777216,du(l,u,m),ef=x):du(l,u,m));break;default:du(l,u,m)}}function sE(l){var u=l.alternate;if(u!==null&&(l=u.child,l!==null)){u.child=null;do u=l.sibling,l.sibling=null,l=u;while(l!==null)}}function tf(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var x=u[m];xn=x,oE(x,l)}sE(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)lE(l),l=l.sibling}function lE(l){switch(l.tag){case 0:case 11:case 15:tf(l),l.flags&2048&&Bl(9,l,l.return);break;case 3:tf(l);break;case 12:tf(l);break;case 22:var u=l.stateNode;l.memoizedState!==null&&u._visibility&2&&(l.return===null||l.return.tag!==13)?(u._visibility&=-3,sm(l)):tf(l);break;default:tf(l)}}function sm(l){var u=l.deletions;if((l.flags&16)!==0){if(u!==null)for(var m=0;m<u.length;m++){var x=u[m];xn=x,oE(x,l)}sE(l)}for(l=l.child;l!==null;){switch(u=l,u.tag){case 0:case 11:case 15:Bl(8,u,u.return),sm(u);break;case 22:m=u.stateNode,m._visibility&2&&(m._visibility&=-3,sm(u));break;default:sm(u)}l=l.sibling}}function oE(l,u){for(;xn!==null;){var m=xn;switch(m.tag){case 0:case 11:case 15:Bl(8,m,u);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var x=m.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Ld(m.memoizedState.cache)}if(x=m.child,x!==null)x.return=m,xn=x;else e:for(m=l;xn!==null;){x=xn;var S=x.sibling,_=x.return;if(Qj(x),x===m){xn=null;break e}if(S!==null){S.return=_,xn=S;break e}xn=_}}}var b9={getCacheForType:function(l){var u=Dn(Gr),m=u.data.get(l);return m===void 0&&(m=l(),u.data.set(l,m)),m},cacheSignal:function(){return Dn(Gr).controller.signal}},w9=typeof WeakMap=="function"?WeakMap:Map,Rt=0,Qt=null,vt=null,wt=0,Lt=0,$a=null,Ul=!1,fu=!1,my=!1,$s=0,Cr=0,zl=0,qo=0,py=0,Ha=0,hu=0,rf=null,Na=null,xy=!1,lm=0,cE=0,om=1/0,cm=null,$l=null,tn=0,Hl=null,mu=null,Hs=0,gy=0,vy=null,uE=null,nf=0,yy=null;function Va(){return(Rt&2)!==0&&wt!==0?wt&-wt:V.T!==null?_y():B()}function dE(){if(Ha===0)if((wt&536870912)===0||kt){var l=El;El<<=1,(El&3932160)===0&&(El=262144),Ha=l}else Ha=536870912;return l=Ua.current,l!==null&&(l.flags|=32),Ha}function ka(l,u,m){(l===Qt&&(Lt===2||Lt===9)||l.cancelPendingCommit!==null)&&(pu(l,0),Vl(l,wt,Ha,!1)),xa(l,m),((Rt&2)===0||l!==Qt)&&(l===Qt&&((Rt&2)===0&&(qo|=m),Cr===4&&Vl(l,wt,Ha,!1)),cs(l))}function fE(l,u,m){if((Rt&6)!==0)throw Error(n(327));var x=!m&&(u&127)===0&&(u&l.expiredLanes)===0||Vn(l,u),S=x?k9(l,u):wy(l,u,!0),_=x;do{if(S===0){fu&&!x&&Vl(l,u,0,!1);break}else{if(m=l.current.alternate,_&&!S9(m)){S=wy(l,u,!1),_=!1;continue}if(S===2){if(_=u,l.errorRecoveryDisabledLanes&_)var I=0;else I=l.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){u=I;e:{var H=l;S=rf;var se=H.current.memoizedState.isDehydrated;if(se&&(pu(H,I).flags|=256),I=wy(H,I,!1),I!==2){if(my&&!se){H.errorRecoveryDisabledLanes|=_,qo|=_,S=4;break e}_=Na,Na=S,_!==null&&(Na===null?Na=_:Na.push.apply(Na,_))}S=I}if(_=!1,S!==2)continue}}if(S===1){pu(l,0),Vl(l,u,0,!0);break}e:{switch(x=l,_=S,_){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:Vl(x,u,Ha,!Ul);break e;case 2:Na=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(S=lm+300-mt(),10<S)){if(Vl(x,u,Ha,!Ul),Vr(x,0,!0)!==0)break e;Hs=u,x.timeoutHandle=HE(hE.bind(null,x,m,Na,cm,xy,u,Ha,qo,hu,Ul,_,"Throttled",-0,0),S);break e}hE(x,m,Na,cm,xy,u,Ha,qo,hu,Ul,_,null,-0,0)}}break}while(!0);cs(l)}function hE(l,u,m,x,S,_,I,H,se,xe,_e,Te,be,Se){if(l.timeoutHandle=-1,Te=u.subtreeFlags,Te&8192||(Te&16785408)===16785408){Te={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ts},iE(u,_,Te);var Ve=(_&62914560)===_?lm-mt():(_&4194048)===_?cE-mt():0;if(Ve=s7(Te,Ve),Ve!==null){Hs=_,l.cancelPendingCommit=Ve(wE.bind(null,l,u,_,m,x,S,I,H,se,_e,Te,null,be,Se)),Vl(l,_,I,!xe);return}}wE(l,u,_,m,x,S,I,H,se)}function S9(l){for(var u=l;;){var m=u.tag;if((m===0||m===11||m===15)&&u.flags&16384&&(m=u.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var x=0;x<m.length;x++){var S=m[x],_=S.getSnapshot;S=S.value;try{if(!La(_(),S))return!1}catch{return!1}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Vl(l,u,m,x){u&=~py,u&=~qo,l.suspendedLanes|=u,l.pingedLanes&=~u,x&&(l.warmLanes|=u),x=l.expirationTimes;for(var S=u;0<S;){var _=31-mn(S),I=1<<_;x[_]=-1,S&=~I}m!==0&&Fa(l,m,u)}function um(){return(Rt&6)===0?(af(0),!1):!0}function by(){if(vt!==null){if(Lt===0)var l=vt.return;else l=vt,Ds=Lo=null,Pv(l),iu=null,Ud=0,l=vt;for(;l!==null;)Vj(l.alternate,l),l=l.return;vt=null}}function pu(l,u){var m=l.timeoutHandle;m!==-1&&(l.timeoutHandle=-1,$9(m)),m=l.cancelPendingCommit,m!==null&&(l.cancelPendingCommit=null,m()),Hs=0,by(),Qt=l,vt=m=As(l.current,null),wt=u,Lt=0,$a=null,Ul=!1,fu=Vn(l,u),my=!1,hu=Ha=py=qo=zl=Cr=0,Na=rf=null,xy=!1,(u&8)!==0&&(u|=u&32);var x=l.entangledLanes;if(x!==0)for(l=l.entanglements,x&=u;0<x;){var S=31-mn(x),_=1<<S;u|=l[S],x&=~_}return $s=u,Oh(),m}function mE(l,u){ct=null,V.H=Kd,u===au||u===Bh?(u=A_(),Lt=3):u===kv?(u=A_(),Lt=4):Lt=u===Qv?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,$a=u,vt===null&&(Cr=1,Jh(l,di(u,l.current)))}function pE(){var l=Ua.current;return l===null?!0:(wt&4194048)===wt?pi===null:(wt&62914560)===wt||(wt&536870912)!==0?l===pi:!1}function xE(){var l=V.H;return V.H=Kd,l===null?Kd:l}function gE(){var l=V.A;return V.A=b9,l}function dm(){Cr=4,Ul||(wt&4194048)!==wt&&Ua.current!==null||(fu=!0),(zl&134217727)===0&&(qo&134217727)===0||Qt===null||Vl(Qt,wt,Ha,!1)}function wy(l,u,m){var x=Rt;Rt|=2;var S=xE(),_=gE();(Qt!==l||wt!==u)&&(cm=null,pu(l,u)),u=!1;var I=Cr;e:do try{if(Lt!==0&&vt!==null){var H=vt,se=$a;switch(Lt){case 8:by(),I=6;break e;case 3:case 2:case 9:case 6:Ua.current===null&&(u=!0);var xe=Lt;if(Lt=0,$a=null,xu(l,H,se,xe),m&&fu){I=0;break e}break;default:xe=Lt,Lt=0,$a=null,xu(l,H,se,xe)}}N9(),I=Cr;break}catch(_e){mE(l,_e)}while(!0);return u&&l.shellSuspendCounter++,Ds=Lo=null,Rt=x,V.H=S,V.A=_,vt===null&&(Qt=null,wt=0,Oh()),I}function N9(){for(;vt!==null;)vE(vt)}function k9(l,u){var m=Rt;Rt|=2;var x=xE(),S=gE();Qt!==l||wt!==u?(cm=null,om=mt()+500,pu(l,u)):fu=Vn(l,u);e:do try{if(Lt!==0&&vt!==null){u=vt;var _=$a;t:switch(Lt){case 1:Lt=0,$a=null,xu(l,u,_,1);break;case 2:case 9:if(T_(_)){Lt=0,$a=null,yE(u);break}u=function(){Lt!==2&&Lt!==9||Qt!==l||(Lt=7),cs(l)},_.then(u,u);break e;case 3:Lt=7;break e;case 4:Lt=5;break e;case 7:T_(_)?(Lt=0,$a=null,yE(u)):(Lt=0,$a=null,xu(l,u,_,7));break;case 5:var I=null;switch(vt.tag){case 26:I=vt.memoizedState;case 5:case 27:var H=vt;if(I?aT(I):H.stateNode.complete){Lt=0,$a=null;var se=H.sibling;if(se!==null)vt=se;else{var xe=H.return;xe!==null?(vt=xe,fm(xe)):vt=null}break t}}Lt=0,$a=null,xu(l,u,_,5);break;case 6:Lt=0,$a=null,xu(l,u,_,6);break;case 8:by(),Cr=6;break e;default:throw Error(n(462))}}_9();break}catch(_e){mE(l,_e)}while(!0);return Ds=Lo=null,V.H=x,V.A=S,Rt=m,vt!==null?0:(Qt=null,wt=0,Oh(),Cr)}function _9(){for(;vt!==null&&!bt();)vE(vt)}function vE(l){var u=$j(l.alternate,l,$s);l.memoizedProps=l.pendingProps,u===null?fm(l):vt=u}function yE(l){var u=l,m=u.alternate;switch(u.tag){case 15:case 0:u=Pj(m,u,u.pendingProps,u.type,void 0,wt);break;case 11:u=Pj(m,u,u.pendingProps,u.type.render,u.ref,wt);break;case 5:Pv(u);default:Vj(m,u),u=vt=g_(u,$s),u=$j(m,u,$s)}l.memoizedProps=l.pendingProps,u===null?fm(l):vt=u}function xu(l,u,m,x){Ds=Lo=null,Pv(u),iu=null,Ud=0;var S=u.return;try{if(h9(l,S,u,m,wt)){Cr=1,Jh(l,di(m,l.current)),vt=null;return}}catch(_){if(S!==null)throw vt=S,_;Cr=1,Jh(l,di(m,l.current)),vt=null;return}u.flags&32768?(kt||x===1?l=!0:fu||(wt&536870912)!==0?l=!1:(Ul=l=!0,(x===2||x===9||x===3||x===6)&&(x=Ua.current,x!==null&&x.tag===13&&(x.flags|=16384))),bE(u,l)):fm(u)}function fm(l){var u=l;do{if((u.flags&32768)!==0){bE(u,Ul);return}l=u.return;var m=x9(u.alternate,u,$s);if(m!==null){vt=m;return}if(u=u.sibling,u!==null){vt=u;return}vt=u=l}while(u!==null);Cr===0&&(Cr=5)}function bE(l,u){do{var m=g9(l.alternate,l);if(m!==null){m.flags&=32767,vt=m;return}if(m=l.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!u&&(l=l.sibling,l!==null)){vt=l;return}vt=l=m}while(l!==null);Cr=6,vt=null}function wE(l,u,m,x,S,_,I,H,se){l.cancelPendingCommit=null;do hm();while(tn!==0);if((Rt&6)!==0)throw Error(n(327));if(u!==null){if(u===l.current)throw Error(n(177));if(_=u.lanes|u.childLanes,_|=cv,Pr(l,m,_,I,H,se),l===Qt&&(vt=Qt=null,wt=0),mu=u,Hl=l,Hs=m,gy=_,vy=S,uE=x,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,C9(Xt,function(){return jE(),null})):(l.callbackNode=null,l.callbackPriority=0),x=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||x){x=V.T,V.T=null,S=K.p,K.p=2,I=Rt,Rt|=4;try{v9(l,u,m)}finally{Rt=I,K.p=S,V.T=x}}tn=1,SE(),NE(),kE()}}function SE(){if(tn===1){tn=0;var l=Hl,u=mu,m=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||m){m=V.T,V.T=null;var x=K.p;K.p=2;var S=Rt;Rt|=4;try{rE(u,l);var _=Iy,I=o_(l.containerInfo),H=_.focusedElem,se=_.selectionRange;if(I!==H&&H&&H.ownerDocument&&l_(H.ownerDocument.documentElement,H)){if(se!==null&&av(H)){var xe=se.start,_e=se.end;if(_e===void 0&&(_e=xe),"selectionStart"in H)H.selectionStart=xe,H.selectionEnd=Math.min(_e,H.value.length);else{var Te=H.ownerDocument||document,be=Te&&Te.defaultView||window;if(be.getSelection){var Se=be.getSelection(),Ve=H.textContent.length,rt=Math.min(se.start,Ve),Wt=se.end===void 0?rt:Math.min(se.end,Ve);!Se.extend&&rt>Wt&&(I=Wt,Wt=rt,rt=I);var he=s_(H,rt),ce=s_(H,Wt);if(he&&ce&&(Se.rangeCount!==1||Se.anchorNode!==he.node||Se.anchorOffset!==he.offset||Se.focusNode!==ce.node||Se.focusOffset!==ce.offset)){var pe=Te.createRange();pe.setStart(he.node,he.offset),Se.removeAllRanges(),rt>Wt?(Se.addRange(pe),Se.extend(ce.node,ce.offset)):(pe.setEnd(ce.node,ce.offset),Se.addRange(pe))}}}}for(Te=[],Se=H;Se=Se.parentNode;)Se.nodeType===1&&Te.push({element:Se,left:Se.scrollLeft,top:Se.scrollTop});for(typeof H.focus=="function"&&H.focus(),H=0;H<Te.length;H++){var Ee=Te[H];Ee.element.scrollLeft=Ee.left,Ee.element.scrollTop=Ee.top}}_m=!!Dy,Iy=Dy=null}finally{Rt=S,K.p=x,V.T=m}}l.current=u,tn=2}}function NE(){if(tn===2){tn=0;var l=Hl,u=mu,m=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||m){m=V.T,V.T=null;var x=K.p;K.p=2;var S=Rt;Rt|=4;try{Zj(l,u.alternate,u)}finally{Rt=S,K.p=x,V.T=m}}tn=3}}function kE(){if(tn===4||tn===3){tn=0,Ft();var l=Hl,u=mu,m=Hs,x=uE;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?tn=5:(tn=0,mu=Hl=null,_E(l,l.pendingLanes));var S=l.pendingLanes;if(S===0&&($l=null),Li(m),u=u.stateNode,br&&typeof br.onCommitFiberRoot=="function")try{br.onCommitFiberRoot(Zt,u,void 0,(u.current.flags&128)===128)}catch{}if(x!==null){u=V.T,S=K.p,K.p=2,V.T=null;try{for(var _=l.onRecoverableError,I=0;I<x.length;I++){var H=x[I];_(H.value,{componentStack:H.stack})}}finally{V.T=u,K.p=S}}(Hs&3)!==0&&hm(),cs(l),S=l.pendingLanes,(m&261930)!==0&&(S&42)!==0?l===yy?nf++:(nf=0,yy=l):nf=0,af(0)}}function _E(l,u){(l.pooledCacheLanes&=u)===0&&(u=l.pooledCache,u!=null&&(l.pooledCache=null,Ld(u)))}function hm(){return SE(),NE(),kE(),jE()}function jE(){if(tn!==5)return!1;var l=Hl,u=gy;gy=0;var m=Li(Hs),x=V.T,S=K.p;try{K.p=32>m?32:m,V.T=null,m=vy,vy=null;var _=Hl,I=Hs;if(tn=0,mu=Hl=null,Hs=0,(Rt&6)!==0)throw Error(n(331));var H=Rt;if(Rt|=4,lE(_.current),aE(_,_.current,I,m),Rt=H,af(0,!1),br&&typeof br.onPostCommitFiberRoot=="function")try{br.onPostCommitFiberRoot(Zt,_)}catch{}return!0}finally{K.p=S,V.T=x,_E(l,u)}}function EE(l,u,m){u=di(m,u),u=Zv(l.stateNode,u,2),l=Pl(l,u,2),l!==null&&(xa(l,2),cs(l))}function Bt(l,u,m){if(l.tag===3)EE(l,l,m);else for(;u!==null;){if(u.tag===3){EE(u,l,m);break}else if(u.tag===1){var x=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&($l===null||!$l.has(x))){l=di(m,l),m=Tj(2),x=Pl(u,m,2),x!==null&&(Cj(m,x,u,l),xa(x,2),cs(x));break}}u=u.return}}function Sy(l,u,m){var x=l.pingCache;if(x===null){x=l.pingCache=new w9;var S=new Set;x.set(u,S)}else S=x.get(u),S===void 0&&(S=new Set,x.set(u,S));S.has(m)||(my=!0,S.add(m),l=j9.bind(null,l,u,m),u.then(l,l))}function j9(l,u,m){var x=l.pingCache;x!==null&&x.delete(u),l.pingedLanes|=l.suspendedLanes&m,l.warmLanes&=~m,Qt===l&&(wt&m)===m&&(Cr===4||Cr===3&&(wt&62914560)===wt&&300>mt()-lm?(Rt&2)===0&&pu(l,0):py|=m,hu===wt&&(hu=0)),cs(l)}function TE(l,u){u===0&&(u=pn()),l=Mo(l,u),l!==null&&(xa(l,u),cs(l))}function E9(l){var u=l.memoizedState,m=0;u!==null&&(m=u.retryLane),TE(l,m)}function T9(l,u){var m=0;switch(l.tag){case 31:case 13:var x=l.stateNode,S=l.memoizedState;S!==null&&(m=S.retryLane);break;case 19:x=l.stateNode;break;case 22:x=l.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(u),TE(l,m)}function C9(l,u){return fe(l,u)}var mm=null,gu=null,Ny=!1,pm=!1,ky=!1,Gl=0;function cs(l){l!==gu&&l.next===null&&(gu===null?mm=gu=l:gu=gu.next=l),pm=!0,Ny||(Ny=!0,O9())}function af(l,u){if(!ky&&pm){ky=!0;do for(var m=!1,x=mm;x!==null;){if(l!==0){var S=x.pendingLanes;if(S===0)var _=0;else{var I=x.suspendedLanes,H=x.pingedLanes;_=(1<<31-mn(42|l)+1)-1,_&=S&~(I&~H),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(m=!0,DE(x,_))}else _=wt,_=Vr(x,x===Qt?_:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(_&3)===0||Vn(x,_)||(m=!0,DE(x,_));x=x.next}while(m);ky=!1}}function A9(){CE()}function CE(){pm=Ny=!1;var l=0;Gl!==0&&z9()&&(l=Gl);for(var u=mt(),m=null,x=mm;x!==null;){var S=x.next,_=AE(x,u);_===0?(x.next=null,m===null?mm=S:m.next=S,S===null&&(gu=m)):(m=x,(l!==0||(_&3)!==0)&&(pm=!0)),x=S}tn!==0&&tn!==5||af(l),Gl!==0&&(Gl=0)}function AE(l,u){for(var m=l.suspendedLanes,x=l.pingedLanes,S=l.expirationTimes,_=l.pendingLanes&-62914561;0<_;){var I=31-mn(_),H=1<<I,se=S[I];se===-1?((H&m)===0||(H&x)!==0)&&(S[I]=Gn(H,u)):se<=u&&(l.expiredLanes|=H),_&=~H}if(u=Qt,m=wt,m=Vr(l,l===u?m:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x=l.callbackNode,m===0||l===u&&(Lt===2||Lt===9)||l.cancelPendingCommit!==null)return x!==null&&x!==null&&Re(x),l.callbackNode=null,l.callbackPriority=0;if((m&3)===0||Vn(l,m)){if(u=m&-m,u===l.callbackPriority)return u;switch(x!==null&&Re(x),Li(m)){case 2:case 8:m=Tn;break;case 32:m=Xt;break;case 268435456:m=lt;break;default:m=Xt}return x=OE.bind(null,l),m=fe(m,x),l.callbackPriority=u,l.callbackNode=m,u}return x!==null&&x!==null&&Re(x),l.callbackPriority=2,l.callbackNode=null,2}function OE(l,u){if(tn!==0&&tn!==5)return l.callbackNode=null,l.callbackPriority=0,null;var m=l.callbackNode;if(hm()&&l.callbackNode!==m)return null;var x=wt;return x=Vr(l,l===Qt?x:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),x===0?null:(fE(l,x,u),AE(l,mt()),l.callbackNode!=null&&l.callbackNode===m?OE.bind(null,l):null)}function DE(l,u){if(hm())return null;fE(l,u,!0)}function O9(){H9(function(){(Rt&6)!==0?fe(It,A9):CE()})}function _y(){if(Gl===0){var l=ru;l===0&&(l=js,js<<=1,(js&261888)===0&&(js=256)),Gl=l}return Gl}function IE(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:Nh(""+l)}function RE(l,u){var m=u.ownerDocument.createElement("input");return m.name=u.name,m.value=u.value,l.id&&m.setAttribute("form",l.id),u.parentNode.insertBefore(m,u),l=new FormData(l),m.parentNode.removeChild(m),l}function D9(l,u,m,x,S){if(u==="submit"&&m&&m.stateNode===S){var _=IE((S[Q]||null).action),I=x.submitter;I&&(u=(u=I[Q]||null)?IE(u.formAction):I.getAttribute("formAction"),u!==null&&(_=u,I=null));var H=new Eh("action","action",null,x,S);l.push({event:H,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Gl!==0){var se=I?RE(S,I):new FormData(S);Gv(m,{pending:!0,data:se,method:S.method,action:_},null,se)}}else typeof _=="function"&&(H.preventDefault(),se=I?RE(S,I):new FormData(S),Gv(m,{pending:!0,data:se,method:S.method,action:_},_,se))},currentTarget:S}]})}}for(var jy=0;jy<ov.length;jy++){var Ey=ov[jy],I9=Ey.toLowerCase(),R9=Ey[0].toUpperCase()+Ey.slice(1);Bi(I9,"on"+R9)}Bi(d_,"onAnimationEnd"),Bi(f_,"onAnimationIteration"),Bi(h_,"onAnimationStart"),Bi("dblclick","onDoubleClick"),Bi("focusin","onFocus"),Bi("focusout","onBlur"),Bi(XB,"onTransitionRun"),Bi(ZB,"onTransitionStart"),Bi(QB,"onTransitionCancel"),Bi(m_,"onTransitionEnd"),li("onMouseEnter",["mouseout","mouseover"]),li("onMouseLeave",["mouseout","mouseover"]),li("onPointerEnter",["pointerout","pointerover"]),li("onPointerLeave",["pointerout","pointerover"]),mr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),mr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),mr("onBeforeInput",["compositionend","keypress","textInput","paste"]),mr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),mr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),mr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M9=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(sf));function ME(l,u){u=(u&4)!==0;for(var m=0;m<l.length;m++){var x=l[m],S=x.event;x=x.listeners;e:{var _=void 0;if(u)for(var I=x.length-1;0<=I;I--){var H=x[I],se=H.instance,xe=H.currentTarget;if(H=H.listener,se!==_&&S.isPropagationStopped())break e;_=H,S.currentTarget=xe;try{_(S)}catch(_e){Ah(_e)}S.currentTarget=null,_=se}else for(I=0;I<x.length;I++){if(H=x[I],se=H.instance,xe=H.currentTarget,H=H.listener,se!==_&&S.isPropagationStopped())break e;_=H,S.currentTarget=xe;try{_(S)}catch(_e){Ah(_e)}S.currentTarget=null,_=se}}}}function yt(l,u){var m=u[ge];m===void 0&&(m=u[ge]=new Set);var x=l+"__bubble";m.has(x)||(PE(u,l,2,!1),m.add(x))}function Ty(l,u,m){var x=0;u&&(x|=4),PE(m,l,x,u)}var xm="_reactListening"+Math.random().toString(36).slice(2);function Cy(l){if(!l[xm]){l[xm]=!0,nr.forEach(function(m){m!=="selectionchange"&&(M9.has(m)||Ty(m,!1,l),Ty(m,!0,l))});var u=l.nodeType===9?l:l.ownerDocument;u===null||u[xm]||(u[xm]=!0,Ty("selectionchange",!1,u))}}function PE(l,u,m,x){switch(dT(u)){case 2:var S=c7;break;case 8:S=u7;break;default:S=Vy}m=S.bind(null,u,m,l),S=void 0,!Yg||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(S=!0),x?S!==void 0?l.addEventListener(u,m,{capture:!0,passive:S}):l.addEventListener(u,m,!0):S!==void 0?l.addEventListener(u,m,{passive:S}):l.addEventListener(u,m,!1)}function Ay(l,u,m,x,S){var _=x;if((u&1)===0&&(u&2)===0&&x!==null)e:for(;;){if(x===null)return;var I=x.tag;if(I===3||I===4){var H=x.stateNode.containerInfo;if(H===S)break;if(I===4)for(I=x.return;I!==null;){var se=I.tag;if((se===3||se===4)&&I.stateNode.containerInfo===S)return;I=I.return}for(;H!==null;){if(I=Pe(H),I===null)return;if(se=I.tag,se===5||se===6||se===26||se===27){x=_=I;continue e}H=H.parentNode}}x=x.return}zk(function(){var xe=_,_e=qg(m),Te=[];e:{var be=p_.get(l);if(be!==void 0){var Se=Eh,Ve=l;switch(l){case"keypress":if(_h(m)===0)break e;case"keydown":case"keyup":Se=TB;break;case"focusin":Ve="focus",Se=Jg;break;case"focusout":Ve="blur",Se=Jg;break;case"beforeblur":case"afterblur":Se=Jg;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Se=Vk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Se=xB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Se=OB;break;case d_:case f_:case h_:Se=yB;break;case m_:Se=IB;break;case"scroll":case"scrollend":Se=mB;break;case"wheel":Se=MB;break;case"copy":case"cut":case"paste":Se=wB;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Se=Wk;break;case"toggle":case"beforetoggle":Se=FB}var rt=(u&4)!==0,Wt=!rt&&(l==="scroll"||l==="scrollend"),he=rt?be!==null?be+"Capture":null:be;rt=[];for(var ce=xe,pe;ce!==null;){var Ee=ce;if(pe=Ee.stateNode,Ee=Ee.tag,Ee!==5&&Ee!==26&&Ee!==27||pe===null||he===null||(Ee=Ed(ce,he),Ee!=null&&rt.push(lf(ce,Ee,pe))),Wt)break;ce=ce.return}0<rt.length&&(be=new Se(be,Ve,null,m,_e),Te.push({event:be,listeners:rt}))}}if((u&7)===0){e:{if(be=l==="mouseover"||l==="pointerover",Se=l==="mouseout"||l==="pointerout",be&&m!==Wg&&(Ve=m.relatedTarget||m.fromElement)&&(Pe(Ve)||Ve[ae]))break e;if((Se||be)&&(be=_e.window===_e?_e:(be=_e.ownerDocument)?be.defaultView||be.parentWindow:window,Se?(Ve=m.relatedTarget||m.toElement,Se=xe,Ve=Ve?Pe(Ve):null,Ve!==null&&(Wt=i(Ve),rt=Ve.tag,Ve!==Wt||rt!==5&&rt!==27&&rt!==6)&&(Ve=null)):(Se=null,Ve=xe),Se!==Ve)){if(rt=Vk,Ee="onMouseLeave",he="onMouseEnter",ce="mouse",(l==="pointerout"||l==="pointerover")&&(rt=Wk,Ee="onPointerLeave",he="onPointerEnter",ce="pointer"),Wt=Se==null?be:De(Se),pe=Ve==null?be:De(Ve),be=new rt(Ee,ce+"leave",Se,m,_e),be.target=Wt,be.relatedTarget=pe,Ee=null,Pe(_e)===xe&&(rt=new rt(he,ce+"enter",Ve,m,_e),rt.target=pe,rt.relatedTarget=Wt,Ee=rt),Wt=Ee,Se&&Ve)t:{for(rt=P9,he=Se,ce=Ve,pe=0,Ee=he;Ee;Ee=rt(Ee))pe++;Ee=0;for(var Ze=ce;Ze;Ze=rt(Ze))Ee++;for(;0<pe-Ee;)he=rt(he),pe--;for(;0<Ee-pe;)ce=rt(ce),Ee--;for(;pe--;){if(he===ce||ce!==null&&he===ce.alternate){rt=he;break t}he=rt(he),ce=rt(ce)}rt=null}else rt=null;Se!==null&&FE(Te,be,Se,rt,!1),Ve!==null&&Wt!==null&&FE(Te,Wt,Ve,rt,!0)}}e:{if(be=xe?De(xe):window,Se=be.nodeName&&be.nodeName.toLowerCase(),Se==="select"||Se==="input"&&be.type==="file")var Ct=e_;else if(Qk(be))if(t_)Ct=qB;else{Ct=GB;var Ke=VB}else Se=be.nodeName,!Se||Se.toLowerCase()!=="input"||be.type!=="checkbox"&&be.type!=="radio"?xe&&Gg(xe.elementType)&&(Ct=e_):Ct=WB;if(Ct&&(Ct=Ct(l,xe))){Jk(Te,Ct,m,_e);break e}Ke&&Ke(l,be,xe),l==="focusout"&&xe&&be.type==="number"&&xe.memoizedProps.value!=null&&Vg(be,"number",be.value)}switch(Ke=xe?De(xe):window,l){case"focusin":(Qk(Ke)||Ke.contentEditable==="true")&&(Kc=Ke,iv=xe,Md=null);break;case"focusout":Md=iv=Kc=null;break;case"mousedown":sv=!0;break;case"contextmenu":case"mouseup":case"dragend":sv=!1,c_(Te,m,_e);break;case"selectionchange":if(YB)break;case"keydown":case"keyup":c_(Te,m,_e)}var ft;if(tv)e:{switch(l){case"compositionstart":var St="onCompositionStart";break e;case"compositionend":St="onCompositionEnd";break e;case"compositionupdate":St="onCompositionUpdate";break e}St=void 0}else qc?Xk(l,m)&&(St="onCompositionEnd"):l==="keydown"&&m.keyCode===229&&(St="onCompositionStart");St&&(qk&&m.locale!=="ko"&&(qc||St!=="onCompositionStart"?St==="onCompositionEnd"&&qc&&(ft=$k()):(Cl=_e,Xg="value"in Cl?Cl.value:Cl.textContent,qc=!0)),Ke=gm(xe,St),0<Ke.length&&(St=new Gk(St,l,null,m,_e),Te.push({event:St,listeners:Ke}),ft?St.data=ft:(ft=Zk(m),ft!==null&&(St.data=ft)))),(ft=BB?UB(l,m):zB(l,m))&&(St=gm(xe,"onBeforeInput"),0<St.length&&(Ke=new Gk("onBeforeInput","beforeinput",null,m,_e),Te.push({event:Ke,listeners:St}),Ke.data=ft)),D9(Te,l,xe,m,_e)}ME(Te,u)})}function lf(l,u,m){return{instance:l,listener:u,currentTarget:m}}function gm(l,u){for(var m=u+"Capture",x=[];l!==null;){var S=l,_=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||_===null||(S=Ed(l,m),S!=null&&x.unshift(lf(l,S,_)),S=Ed(l,u),S!=null&&x.push(lf(l,S,_))),l.tag===3)return x;l=l.return}return[]}function P9(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function FE(l,u,m,x,S){for(var _=u._reactName,I=[];m!==null&&m!==x;){var H=m,se=H.alternate,xe=H.stateNode;if(H=H.tag,se!==null&&se===x)break;H!==5&&H!==26&&H!==27||xe===null||(se=xe,S?(xe=Ed(m,_),xe!=null&&I.unshift(lf(m,xe,se))):S||(xe=Ed(m,_),xe!=null&&I.push(lf(m,xe,se)))),m=m.return}I.length!==0&&l.push({event:u,listeners:I})}var F9=/\r\n?/g,L9=/\u0000|\uFFFD/g;function LE(l){return(typeof l=="string"?l:""+l).replace(F9,`
`).replace(L9,"")}function BE(l,u){return u=LE(u),LE(l)===u}function Gt(l,u,m,x,S,_){switch(m){case"children":typeof x=="string"?u==="body"||u==="textarea"&&x===""||Vc(l,x):(typeof x=="number"||typeof x=="bigint")&&u!=="body"&&Vc(l,""+x);break;case"className":wh(l,"class",x);break;case"tabIndex":wh(l,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":wh(l,m,x);break;case"style":Bk(l,x,_);break;case"data":if(u!=="object"){wh(l,"data",x);break}case"src":case"href":if(x===""&&(u!=="a"||m!=="href")){l.removeAttribute(m);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(m);break}x=Nh(""+x),l.setAttribute(m,x);break;case"action":case"formAction":if(typeof x=="function"){l.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(m==="formAction"?(u!=="input"&&Gt(l,u,"name",S.name,S,null),Gt(l,u,"formEncType",S.formEncType,S,null),Gt(l,u,"formMethod",S.formMethod,S,null),Gt(l,u,"formTarget",S.formTarget,S,null)):(Gt(l,u,"encType",S.encType,S,null),Gt(l,u,"method",S.method,S,null),Gt(l,u,"target",S.target,S,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){l.removeAttribute(m);break}x=Nh(""+x),l.setAttribute(m,x);break;case"onClick":x!=null&&(l.onclick=Ts);break;case"onScroll":x!=null&&yt("scroll",l);break;case"onScrollEnd":x!=null&&yt("scrollend",l);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(m=x.__html,m!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"multiple":l.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":l.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){l.removeAttribute("xlink:href");break}m=Nh(""+x),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,""+x):l.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,""):l.removeAttribute(m);break;case"capture":case"download":x===!0?l.setAttribute(m,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?l.setAttribute(m,x):l.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?l.setAttribute(m,x):l.removeAttribute(m);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?l.removeAttribute(m):l.setAttribute(m,x);break;case"popover":yt("beforetoggle",l),yt("toggle",l),va(l,"popover",x);break;case"xlinkActuate":Es(l,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Es(l,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Es(l,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Es(l,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Es(l,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Es(l,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Es(l,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Es(l,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Es(l,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":va(l,"is",x);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=fB.get(m)||m,va(l,m,x))}}function Oy(l,u,m,x,S,_){switch(m){case"style":Bk(l,x,_);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(m=x.__html,m!=null){if(S.children!=null)throw Error(n(60));l.innerHTML=m}}break;case"children":typeof x=="string"?Vc(l,x):(typeof x=="number"||typeof x=="bigint")&&Vc(l,""+x);break;case"onScroll":x!=null&&yt("scroll",l);break;case"onScrollEnd":x!=null&&yt("scrollend",l);break;case"onClick":x!=null&&(l.onclick=Ts);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ar.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(S=m.endsWith("Capture"),u=m.slice(2,S?m.length-7:void 0),_=l[Q]||null,_=_!=null?_[m]:null,typeof _=="function"&&l.removeEventListener(u,_,S),typeof x=="function")){typeof _!="function"&&_!==null&&(m in l?l[m]=null:l.hasAttribute(m)&&l.removeAttribute(m)),l.addEventListener(u,x,S);break e}m in l?l[m]=x:x===!0?l.setAttribute(m,""):va(l,m,x)}}}function Rn(l,u,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",l),yt("load",l);var x=!1,S=!1,_;for(_ in m)if(m.hasOwnProperty(_)){var I=m[_];if(I!=null)switch(_){case"src":x=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Gt(l,u,_,I,m,null)}}S&&Gt(l,u,"srcSet",m.srcSet,m,null),x&&Gt(l,u,"src",m.src,m,null);return;case"input":yt("invalid",l);var H=_=I=S=null,se=null,xe=null;for(x in m)if(m.hasOwnProperty(x)){var _e=m[x];if(_e!=null)switch(x){case"name":S=_e;break;case"type":I=_e;break;case"checked":se=_e;break;case"defaultChecked":xe=_e;break;case"value":_=_e;break;case"defaultValue":H=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,u));break;default:Gt(l,u,x,_e,m,null)}}Mk(l,_,H,se,xe,I,S,!1);return;case"select":yt("invalid",l),x=I=_=null;for(S in m)if(m.hasOwnProperty(S)&&(H=m[S],H!=null))switch(S){case"value":_=H;break;case"defaultValue":I=H;break;case"multiple":x=H;default:Gt(l,u,S,H,m,null)}u=_,m=I,l.multiple=!!x,u!=null?Hc(l,!!x,u,!1):m!=null&&Hc(l,!!x,m,!0);return;case"textarea":yt("invalid",l),_=S=x=null;for(I in m)if(m.hasOwnProperty(I)&&(H=m[I],H!=null))switch(I){case"value":x=H;break;case"defaultValue":S=H;break;case"children":_=H;break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(n(91));break;default:Gt(l,u,I,H,m,null)}Fk(l,x,S,_);return;case"option":for(se in m)m.hasOwnProperty(se)&&(x=m[se],x!=null)&&(se==="selected"?l.selected=x&&typeof x!="function"&&typeof x!="symbol":Gt(l,u,se,x,m,null));return;case"dialog":yt("beforetoggle",l),yt("toggle",l),yt("cancel",l),yt("close",l);break;case"iframe":case"object":yt("load",l);break;case"video":case"audio":for(x=0;x<sf.length;x++)yt(sf[x],l);break;case"image":yt("error",l),yt("load",l);break;case"details":yt("toggle",l);break;case"embed":case"source":case"link":yt("error",l),yt("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(xe in m)if(m.hasOwnProperty(xe)&&(x=m[xe],x!=null))switch(xe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Gt(l,u,xe,x,m,null)}return;default:if(Gg(u)){for(_e in m)m.hasOwnProperty(_e)&&(x=m[_e],x!==void 0&&Oy(l,u,_e,x,m,void 0));return}}for(H in m)m.hasOwnProperty(H)&&(x=m[H],x!=null&&Gt(l,u,H,x,m,null))}function B9(l,u,m,x){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,_=null,I=null,H=null,se=null,xe=null,_e=null;for(Se in m){var Te=m[Se];if(m.hasOwnProperty(Se)&&Te!=null)switch(Se){case"checked":break;case"value":break;case"defaultValue":se=Te;default:x.hasOwnProperty(Se)||Gt(l,u,Se,null,x,Te)}}for(var be in x){var Se=x[be];if(Te=m[be],x.hasOwnProperty(be)&&(Se!=null||Te!=null))switch(be){case"type":_=Se;break;case"name":S=Se;break;case"checked":xe=Se;break;case"defaultChecked":_e=Se;break;case"value":I=Se;break;case"defaultValue":H=Se;break;case"children":case"dangerouslySetInnerHTML":if(Se!=null)throw Error(n(137,u));break;default:Se!==Te&&Gt(l,u,be,Se,x,Te)}}Hg(l,I,H,se,xe,_e,_,S);return;case"select":Se=I=H=be=null;for(_ in m)if(se=m[_],m.hasOwnProperty(_)&&se!=null)switch(_){case"value":break;case"multiple":Se=se;default:x.hasOwnProperty(_)||Gt(l,u,_,null,x,se)}for(S in x)if(_=x[S],se=m[S],x.hasOwnProperty(S)&&(_!=null||se!=null))switch(S){case"value":be=_;break;case"defaultValue":H=_;break;case"multiple":I=_;default:_!==se&&Gt(l,u,S,_,x,se)}u=H,m=I,x=Se,be!=null?Hc(l,!!m,be,!1):!!x!=!!m&&(u!=null?Hc(l,!!m,u,!0):Hc(l,!!m,m?[]:"",!1));return;case"textarea":Se=be=null;for(H in m)if(S=m[H],m.hasOwnProperty(H)&&S!=null&&!x.hasOwnProperty(H))switch(H){case"value":break;case"children":break;default:Gt(l,u,H,null,x,S)}for(I in x)if(S=x[I],_=m[I],x.hasOwnProperty(I)&&(S!=null||_!=null))switch(I){case"value":be=S;break;case"defaultValue":Se=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==_&&Gt(l,u,I,S,x,_)}Pk(l,be,Se);return;case"option":for(var Ve in m)be=m[Ve],m.hasOwnProperty(Ve)&&be!=null&&!x.hasOwnProperty(Ve)&&(Ve==="selected"?l.selected=!1:Gt(l,u,Ve,null,x,be));for(se in x)be=x[se],Se=m[se],x.hasOwnProperty(se)&&be!==Se&&(be!=null||Se!=null)&&(se==="selected"?l.selected=be&&typeof be!="function"&&typeof be!="symbol":Gt(l,u,se,be,x,Se));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rt in m)be=m[rt],m.hasOwnProperty(rt)&&be!=null&&!x.hasOwnProperty(rt)&&Gt(l,u,rt,null,x,be);for(xe in x)if(be=x[xe],Se=m[xe],x.hasOwnProperty(xe)&&be!==Se&&(be!=null||Se!=null))switch(xe){case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(n(137,u));break;default:Gt(l,u,xe,be,x,Se)}return;default:if(Gg(u)){for(var Wt in m)be=m[Wt],m.hasOwnProperty(Wt)&&be!==void 0&&!x.hasOwnProperty(Wt)&&Oy(l,u,Wt,void 0,x,be);for(_e in x)be=x[_e],Se=m[_e],!x.hasOwnProperty(_e)||be===Se||be===void 0&&Se===void 0||Oy(l,u,_e,be,x,Se);return}}for(var he in m)be=m[he],m.hasOwnProperty(he)&&be!=null&&!x.hasOwnProperty(he)&&Gt(l,u,he,null,x,be);for(Te in x)be=x[Te],Se=m[Te],!x.hasOwnProperty(Te)||be===Se||be==null&&Se==null||Gt(l,u,Te,be,x,Se)}function UE(l){switch(l){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function U9(){if(typeof performance.getEntriesByType=="function"){for(var l=0,u=0,m=performance.getEntriesByType("resource"),x=0;x<m.length;x++){var S=m[x],_=S.transferSize,I=S.initiatorType,H=S.duration;if(_&&H&&UE(I)){for(I=0,H=S.responseEnd,x+=1;x<m.length;x++){var se=m[x],xe=se.startTime;if(xe>H)break;var _e=se.transferSize,Te=se.initiatorType;_e&&UE(Te)&&(se=se.responseEnd,I+=_e*(se<H?1:(H-xe)/(se-xe)))}if(--x,u+=8*(_+I)/(S.duration/1e3),l++,10<l)break}}if(0<l)return u/l/1e6}return navigator.connection&&(l=navigator.connection.downlink,typeof l=="number")?l:5}var Dy=null,Iy=null;function vm(l){return l.nodeType===9?l:l.ownerDocument}function zE(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function $E(l,u){if(l===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&u==="foreignObject"?0:l}function Ry(l,u){return l==="textarea"||l==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var My=null;function z9(){var l=window.event;return l&&l.type==="popstate"?l===My?!1:(My=l,!0):(My=null,!1)}var HE=typeof setTimeout=="function"?setTimeout:void 0,$9=typeof clearTimeout=="function"?clearTimeout:void 0,VE=typeof Promise=="function"?Promise:void 0,H9=typeof queueMicrotask=="function"?queueMicrotask:typeof VE<"u"?function(l){return VE.resolve(null).then(l).catch(V9)}:HE;function V9(l){setTimeout(function(){throw l})}function Wl(l){return l==="head"}function GE(l,u){var m=u,x=0;do{var S=m.nextSibling;if(l.removeChild(m),S&&S.nodeType===8)if(m=S.data,m==="/$"||m==="/&"){if(x===0){l.removeChild(S),wu(u);return}x--}else if(m==="$"||m==="$?"||m==="$~"||m==="$!"||m==="&")x++;else if(m==="html")of(l.ownerDocument.documentElement);else if(m==="head"){m=l.ownerDocument.head,of(m);for(var _=m.firstChild;_;){var I=_.nextSibling,H=_.nodeName;_[we]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&_.rel.toLowerCase()==="stylesheet"||m.removeChild(_),_=I}}else m==="body"&&of(l.ownerDocument.body);m=S}while(m);wu(u)}function WE(l,u){var m=l;l=0;do{var x=m.nextSibling;if(m.nodeType===1?u?(m._stashedDisplay=m.style.display,m.style.display="none"):(m.style.display=m._stashedDisplay||"",m.getAttribute("style")===""&&m.removeAttribute("style")):m.nodeType===3&&(u?(m._stashedText=m.nodeValue,m.nodeValue=""):m.nodeValue=m._stashedText||""),x&&x.nodeType===8)if(m=x.data,m==="/$"){if(l===0)break;l--}else m!=="$"&&m!=="$?"&&m!=="$~"&&m!=="$!"||l++;m=x}while(m)}function Py(l){var u=l.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var m=u;switch(u=u.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Py(m),Oe(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}l.removeChild(m)}}function G9(l,u,m,x){for(;l.nodeType===1;){var S=m;if(l.nodeName.toLowerCase()!==u.toLowerCase()){if(!x&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(x){if(!l[we])switch(u){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(_=l.getAttribute("rel"),_==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(_!==S.rel||l.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||l.getAttribute("title")!==(S.title==null?null:S.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(_=l.getAttribute("src"),(_!==(S.src==null?null:S.src)||l.getAttribute("type")!==(S.type==null?null:S.type)||l.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&_&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(u==="input"&&l.type==="hidden"){var _=S.name==null?null:""+S.name;if(S.type==="hidden"&&l.getAttribute("name")===_)return l}else return l;if(l=xi(l.nextSibling),l===null)break}return null}function W9(l,u,m){if(u==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!m||(l=xi(l.nextSibling),l===null))return null;return l}function qE(l,u){for(;l.nodeType!==8;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!u||(l=xi(l.nextSibling),l===null))return null;return l}function Fy(l){return l.data==="$?"||l.data==="$~"}function Ly(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState!=="loading"}function q9(l,u){var m=l.ownerDocument;if(l.data==="$~")l._reactRetry=u;else if(l.data!=="$?"||m.readyState!=="loading")u();else{var x=function(){u(),m.removeEventListener("DOMContentLoaded",x)};m.addEventListener("DOMContentLoaded",x),l._reactRetry=x}}function xi(l){for(;l!=null;l=l.nextSibling){var u=l.nodeType;if(u===1||u===3)break;if(u===8){if(u=l.data,u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"||u==="F!"||u==="F")break;if(u==="/$"||u==="/&")return null}}return l}var By=null;function KE(l){l=l.nextSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="/$"||m==="/&"){if(u===0)return xi(l.nextSibling);u--}else m!=="$"&&m!=="$!"&&m!=="$?"&&m!=="$~"&&m!=="&"||u++}l=l.nextSibling}return null}function YE(l){l=l.previousSibling;for(var u=0;l;){if(l.nodeType===8){var m=l.data;if(m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"){if(u===0)return l;u--}else m!=="/$"&&m!=="/&"||u++}l=l.previousSibling}return null}function XE(l,u,m){switch(u=vm(m),l){case"html":if(l=u.documentElement,!l)throw Error(n(452));return l;case"head":if(l=u.head,!l)throw Error(n(453));return l;case"body":if(l=u.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function of(l){for(var u=l.attributes;u.length;)l.removeAttributeNode(u[0]);Oe(l)}var gi=new Map,ZE=new Set;function ym(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var Vs=K.d;K.d={f:K9,r:Y9,D:X9,C:Z9,L:Q9,m:J9,X:t7,S:e7,M:r7};function K9(){var l=Vs.f(),u=um();return l||u}function Y9(l){var u=ze(l);u!==null&&u.tag===5&&u.type==="form"?mj(u):Vs.r(l)}var vu=typeof document>"u"?null:document;function QE(l,u,m){var x=vu;if(x&&typeof u=="string"&&u){var S=ci(u);S='link[rel="'+l+'"][href="'+S+'"]',typeof m=="string"&&(S+='[crossorigin="'+m+'"]'),ZE.has(S)||(ZE.add(S),l={rel:l,crossOrigin:m,href:u},x.querySelector(S)===null&&(u=x.createElement("link"),Rn(u,"link",l),qe(u),x.head.appendChild(u)))}}function X9(l){Vs.D(l),QE("dns-prefetch",l,null)}function Z9(l,u){Vs.C(l,u),QE("preconnect",l,u)}function Q9(l,u,m){Vs.L(l,u,m);var x=vu;if(x&&l&&u){var S='link[rel="preload"][as="'+ci(u)+'"]';u==="image"&&m&&m.imageSrcSet?(S+='[imagesrcset="'+ci(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(S+='[imagesizes="'+ci(m.imageSizes)+'"]')):S+='[href="'+ci(l)+'"]';var _=S;switch(u){case"style":_=yu(l);break;case"script":_=bu(l)}gi.has(_)||(l=p({rel:"preload",href:u==="image"&&m&&m.imageSrcSet?void 0:l,as:u},m),gi.set(_,l),x.querySelector(S)!==null||u==="style"&&x.querySelector(cf(_))||u==="script"&&x.querySelector(uf(_))||(u=x.createElement("link"),Rn(u,"link",l),qe(u),x.head.appendChild(u)))}}function J9(l,u){Vs.m(l,u);var m=vu;if(m&&l){var x=u&&typeof u.as=="string"?u.as:"script",S='link[rel="modulepreload"][as="'+ci(x)+'"][href="'+ci(l)+'"]',_=S;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=bu(l)}if(!gi.has(_)&&(l=p({rel:"modulepreload",href:l},u),gi.set(_,l),m.querySelector(S)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(uf(_)))return}x=m.createElement("link"),Rn(x,"link",l),qe(x),m.head.appendChild(x)}}}function e7(l,u,m){Vs.S(l,u,m);var x=vu;if(x&&l){var S=Ue(x).hoistableStyles,_=yu(l);u=u||"default";var I=S.get(_);if(!I){var H={loading:0,preload:null};if(I=x.querySelector(cf(_)))H.loading=5;else{l=p({rel:"stylesheet",href:l,"data-precedence":u},m),(m=gi.get(_))&&Uy(l,m);var se=I=x.createElement("link");qe(se),Rn(se,"link",l),se._p=new Promise(function(xe,_e){se.onload=xe,se.onerror=_e}),se.addEventListener("load",function(){H.loading|=1}),se.addEventListener("error",function(){H.loading|=2}),H.loading|=4,bm(I,u,x)}I={type:"stylesheet",instance:I,count:1,state:H},S.set(_,I)}}}function t7(l,u){Vs.X(l,u);var m=vu;if(m&&l){var x=Ue(m).hoistableScripts,S=bu(l),_=x.get(S);_||(_=m.querySelector(uf(S)),_||(l=p({src:l,async:!0},u),(u=gi.get(S))&&zy(l,u),_=m.createElement("script"),qe(_),Rn(_,"link",l),m.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},x.set(S,_))}}function r7(l,u){Vs.M(l,u);var m=vu;if(m&&l){var x=Ue(m).hoistableScripts,S=bu(l),_=x.get(S);_||(_=m.querySelector(uf(S)),_||(l=p({src:l,async:!0,type:"module"},u),(u=gi.get(S))&&zy(l,u),_=m.createElement("script"),qe(_),Rn(_,"link",l),m.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},x.set(S,_))}}function JE(l,u,m,x){var S=(S=G.current)?ym(S):null;if(!S)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(u=yu(m.href),m=Ue(S).hoistableStyles,x=m.get(u),x||(x={type:"style",instance:null,count:0,state:null},m.set(u,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){l=yu(m.href);var _=Ue(S).hoistableStyles,I=_.get(l);if(I||(S=S.ownerDocument||S,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(l,I),(_=S.querySelector(cf(l)))&&!_._p&&(I.instance=_,I.state.loading=5),gi.has(l)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},gi.set(l,m),_||n7(S,l,m,I.state))),u&&x===null)throw Error(n(528,""));return I}if(u&&x!==null)throw Error(n(529,""));return null;case"script":return u=m.async,m=m.src,typeof m=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=bu(m),m=Ue(S).hoistableScripts,x=m.get(u),x||(x={type:"script",instance:null,count:0,state:null},m.set(u,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function yu(l){return'href="'+ci(l)+'"'}function cf(l){return'link[rel="stylesheet"]['+l+"]"}function eT(l){return p({},l,{"data-precedence":l.precedence,precedence:null})}function n7(l,u,m,x){l.querySelector('link[rel="preload"][as="style"]['+u+"]")?x.loading=1:(u=l.createElement("link"),x.preload=u,u.addEventListener("load",function(){return x.loading|=1}),u.addEventListener("error",function(){return x.loading|=2}),Rn(u,"link",m),qe(u),l.head.appendChild(u))}function bu(l){return'[src="'+ci(l)+'"]'}function uf(l){return"script[async]"+l}function tT(l,u,m){if(u.count++,u.instance===null)switch(u.type){case"style":var x=l.querySelector('style[data-href~="'+ci(m.href)+'"]');if(x)return u.instance=x,qe(x),x;var S=p({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return x=(l.ownerDocument||l).createElement("style"),qe(x),Rn(x,"style",S),bm(x,m.precedence,l),u.instance=x;case"stylesheet":S=yu(m.href);var _=l.querySelector(cf(S));if(_)return u.state.loading|=4,u.instance=_,qe(_),_;x=eT(m),(S=gi.get(S))&&Uy(x,S),_=(l.ownerDocument||l).createElement("link"),qe(_);var I=_;return I._p=new Promise(function(H,se){I.onload=H,I.onerror=se}),Rn(_,"link",x),u.state.loading|=4,bm(_,m.precedence,l),u.instance=_;case"script":return _=bu(m.src),(S=l.querySelector(uf(_)))?(u.instance=S,qe(S),S):(x=m,(S=gi.get(_))&&(x=p({},m),zy(x,S)),l=l.ownerDocument||l,S=l.createElement("script"),qe(S),Rn(S,"link",x),l.head.appendChild(S),u.instance=S);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(x=u.instance,u.state.loading|=4,bm(x,m.precedence,l));return u.instance}function bm(l,u,m){for(var x=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=x.length?x[x.length-1]:null,_=S,I=0;I<x.length;I++){var H=x[I];if(H.dataset.precedence===u)_=H;else if(_!==S)break}_?_.parentNode.insertBefore(l,_.nextSibling):(u=m.nodeType===9?m.head:m,u.insertBefore(l,u.firstChild))}function Uy(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.title==null&&(l.title=u.title)}function zy(l,u){l.crossOrigin==null&&(l.crossOrigin=u.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=u.referrerPolicy),l.integrity==null&&(l.integrity=u.integrity)}var wm=null;function rT(l,u,m){if(wm===null){var x=new Map,S=wm=new Map;S.set(m,x)}else S=wm,x=S.get(m),x||(x=new Map,S.set(m,x));if(x.has(l))return x;for(x.set(l,null),m=m.getElementsByTagName(l),S=0;S<m.length;S++){var _=m[S];if(!(_[we]||_[Z]||l==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var I=_.getAttribute(u)||"";I=l+I;var H=x.get(I);H?H.push(_):x.set(I,[_])}}return x}function nT(l,u,m){l=l.ownerDocument||l,l.head.insertBefore(m,u==="title"?l.querySelector("head > title"):null)}function a7(l,u,m){if(m===1||u.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;return u.rel==="stylesheet"?(l=u.disabled,typeof u.precedence=="string"&&l==null):!0;case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function aT(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}function i7(l,u,m,x){if(m.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(m.state.loading&4)===0){if(m.instance===null){var S=yu(x.href),_=u.querySelector(cf(S));if(_){u=_._p,u!==null&&typeof u=="object"&&typeof u.then=="function"&&(l.count++,l=Sm.bind(l),u.then(l,l)),m.state.loading|=4,m.instance=_,qe(_);return}_=u.ownerDocument||u,x=eT(x),(S=gi.get(S))&&Uy(x,S),_=_.createElement("link"),qe(_);var I=_;I._p=new Promise(function(H,se){I.onload=H,I.onerror=se}),Rn(_,"link",x),m.instance=_}l.stylesheets===null&&(l.stylesheets=new Map),l.stylesheets.set(m,u),(u=m.state.preload)&&(m.state.loading&3)===0&&(l.count++,m=Sm.bind(l),u.addEventListener("load",m),u.addEventListener("error",m))}}var $y=0;function s7(l,u){return l.stylesheets&&l.count===0&&km(l,l.stylesheets),0<l.count||0<l.imgCount?function(m){var x=setTimeout(function(){if(l.stylesheets&&km(l,l.stylesheets),l.unsuspend){var _=l.unsuspend;l.unsuspend=null,_()}},6e4+u);0<l.imgBytes&&$y===0&&($y=62500*U9());var S=setTimeout(function(){if(l.waitingForImages=!1,l.count===0&&(l.stylesheets&&km(l,l.stylesheets),l.unsuspend)){var _=l.unsuspend;l.unsuspend=null,_()}},(l.imgBytes>$y?50:800)+u);return l.unsuspend=m,function(){l.unsuspend=null,clearTimeout(x),clearTimeout(S)}}:null}function Sm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)km(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var Nm=null;function km(l,u){l.stylesheets=null,l.unsuspend!==null&&(l.count++,Nm=new Map,u.forEach(l7,l),Nm=null,Sm.call(l))}function l7(l,u){if(!(u.state.loading&4)){var m=Nm.get(l);if(m)var x=m.get(null);else{m=new Map,Nm.set(l,m);for(var S=l.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<S.length;_++){var I=S[_];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(m.set(I.dataset.precedence,I),x=I)}x&&m.set(null,x)}S=u.instance,I=S.getAttribute("data-precedence"),_=m.get(I)||x,_===x&&m.set(null,S),m.set(I,S),this.count++,x=Sm.bind(this),S.addEventListener("load",x),S.addEventListener("error",x),_?_.parentNode.insertBefore(S,_.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(S,l.firstChild)),u.state.loading|=4}}var df={$$typeof:N,Provider:null,Consumer:null,_currentValue:ie,_currentValue2:ie,_threadCount:0};function o7(l,u,m,x,S,_,I,H,se){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Wn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wn(0),this.hiddenUpdates=Wn(null),this.identifierPrefix=x,this.onUncaughtError=S,this.onCaughtError=_,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function iT(l,u,m,x,S,_,I,H,se,xe,_e,Te){return l=new o7(l,u,m,I,se,xe,_e,Te,H),u=1,_===!0&&(u|=24),_=Ba(3,null,null,u),l.current=_,_.stateNode=l,u=wv(),u.refCount++,l.pooledCache=u,u.refCount++,_.memoizedState={element:x,isDehydrated:m,cache:u},_v(_),l}function sT(l){return l?(l=Zc,l):Zc}function lT(l,u,m,x,S,_){S=sT(S),x.context===null?x.context=S:x.pendingContext=S,x=Ml(u),x.payload={element:m},_=_===void 0?null:_,_!==null&&(x.callback=_),m=Pl(l,x,u),m!==null&&(ka(m,l,u),$d(m,l,u))}function oT(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var m=l.retryLane;l.retryLane=m!==0&&m<u?m:u}}function Hy(l,u){oT(l,u),(l=l.alternate)&&oT(l,u)}function cT(l){if(l.tag===13||l.tag===31){var u=Mo(l,67108864);u!==null&&ka(u,l,67108864),Hy(l,67108864)}}function uT(l){if(l.tag===13||l.tag===31){var u=Va();u=Fi(u);var m=Mo(l,u);m!==null&&ka(m,l,u),Hy(l,u)}}var _m=!0;function c7(l,u,m,x){var S=V.T;V.T=null;var _=K.p;try{K.p=2,Vy(l,u,m,x)}finally{K.p=_,V.T=S}}function u7(l,u,m,x){var S=V.T;V.T=null;var _=K.p;try{K.p=8,Vy(l,u,m,x)}finally{K.p=_,V.T=S}}function Vy(l,u,m,x){if(_m){var S=Gy(x);if(S===null)Ay(l,u,x,jm,m),fT(l,x);else if(f7(S,l,u,m,x))x.stopPropagation();else if(fT(l,x),u&4&&-1<d7.indexOf(l)){for(;S!==null;){var _=ze(S);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var I=rr(_.pendingLanes);if(I!==0){var H=_;for(H.pendingLanes|=2,H.entangledLanes|=2;I;){var se=1<<31-mn(I);H.entanglements[1]|=se,I&=~se}cs(_),(Rt&6)===0&&(om=mt()+500,af(0))}}break;case 31:case 13:H=Mo(_,2),H!==null&&ka(H,_,2),um(),Hy(_,2)}if(_=Gy(x),_===null&&Ay(l,u,x,jm,m),_===S)break;S=_}S!==null&&x.stopPropagation()}else Ay(l,u,x,null,m)}}function Gy(l){return l=qg(l),Wy(l)}var jm=null;function Wy(l){if(jm=null,l=Pe(l),l!==null){var u=i(l);if(u===null)l=null;else{var m=u.tag;if(m===13){if(l=s(u),l!==null)return l;l=null}else if(m===31){if(l=c(u),l!==null)return l;l=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;l=null}else u!==l&&(l=null)}}return jm=l,null}function dT(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(sr()){case It:return 2;case Tn:return 8;case Xt:case hn:return 32;case lt:return 268435456;default:return 32}default:return 32}}var qy=!1,ql=null,Kl=null,Yl=null,ff=new Map,hf=new Map,Xl=[],d7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fT(l,u){switch(l){case"focusin":case"focusout":ql=null;break;case"dragenter":case"dragleave":Kl=null;break;case"mouseover":case"mouseout":Yl=null;break;case"pointerover":case"pointerout":ff.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":hf.delete(u.pointerId)}}function mf(l,u,m,x,S,_){return l===null||l.nativeEvent!==_?(l={blockedOn:u,domEventName:m,eventSystemFlags:x,nativeEvent:_,targetContainers:[S]},u!==null&&(u=ze(u),u!==null&&cT(u)),l):(l.eventSystemFlags|=x,u=l.targetContainers,S!==null&&u.indexOf(S)===-1&&u.push(S),l)}function f7(l,u,m,x,S){switch(u){case"focusin":return ql=mf(ql,l,u,m,x,S),!0;case"dragenter":return Kl=mf(Kl,l,u,m,x,S),!0;case"mouseover":return Yl=mf(Yl,l,u,m,x,S),!0;case"pointerover":var _=S.pointerId;return ff.set(_,mf(ff.get(_)||null,l,u,m,x,S)),!0;case"gotpointercapture":return _=S.pointerId,hf.set(_,mf(hf.get(_)||null,l,u,m,x,S)),!0}return!1}function hT(l){var u=Pe(l.target);if(u!==null){var m=i(u);if(m!==null){if(u=m.tag,u===13){if(u=s(m),u!==null){l.blockedOn=u,J(l.priority,function(){uT(m)});return}}else if(u===31){if(u=c(m),u!==null){l.blockedOn=u,J(l.priority,function(){uT(m)});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){l.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}l.blockedOn=null}function Em(l){if(l.blockedOn!==null)return!1;for(var u=l.targetContainers;0<u.length;){var m=Gy(l.nativeEvent);if(m===null){m=l.nativeEvent;var x=new m.constructor(m.type,m);Wg=x,m.target.dispatchEvent(x),Wg=null}else return u=ze(m),u!==null&&cT(u),l.blockedOn=m,!1;u.shift()}return!0}function mT(l,u,m){Em(l)&&m.delete(u)}function h7(){qy=!1,ql!==null&&Em(ql)&&(ql=null),Kl!==null&&Em(Kl)&&(Kl=null),Yl!==null&&Em(Yl)&&(Yl=null),ff.forEach(mT),hf.forEach(mT)}function Tm(l,u){l.blockedOn===u&&(l.blockedOn=null,qy||(qy=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,h7)))}var Cm=null;function pT(l){Cm!==l&&(Cm=l,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Cm===l&&(Cm=null);for(var u=0;u<l.length;u+=3){var m=l[u],x=l[u+1],S=l[u+2];if(typeof x!="function"){if(Wy(x||m)===null)continue;break}var _=ze(m);_!==null&&(l.splice(u,3),u-=3,Gv(_,{pending:!0,data:S,method:m.method,action:x},x,S))}}))}function wu(l){function u(se){return Tm(se,l)}ql!==null&&Tm(ql,l),Kl!==null&&Tm(Kl,l),Yl!==null&&Tm(Yl,l),ff.forEach(u),hf.forEach(u);for(var m=0;m<Xl.length;m++){var x=Xl[m];x.blockedOn===l&&(x.blockedOn=null)}for(;0<Xl.length&&(m=Xl[0],m.blockedOn===null);)hT(m),m.blockedOn===null&&Xl.shift();if(m=(l.ownerDocument||l).$$reactFormReplay,m!=null)for(x=0;x<m.length;x+=3){var S=m[x],_=m[x+1],I=S[Q]||null;if(typeof _=="function")I||pT(m);else if(I){var H=null;if(_&&_.hasAttribute("formAction")){if(S=_,I=_[Q]||null)H=I.formAction;else if(Wy(S)!==null)continue}else H=I.action;typeof H=="function"?m[x+1]=H:(m.splice(x,3),x-=3),pT(m)}}}function xT(){function l(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(I){return S=I})},focusReset:"manual",scroll:"manual"})}function u(){S!==null&&(S(),S=null),x||setTimeout(m,20)}function m(){if(!x&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var x=!1,S=null;return navigation.addEventListener("navigate",l),navigation.addEventListener("navigatesuccess",u),navigation.addEventListener("navigateerror",u),setTimeout(m,100),function(){x=!0,navigation.removeEventListener("navigate",l),navigation.removeEventListener("navigatesuccess",u),navigation.removeEventListener("navigateerror",u),S!==null&&(S(),S=null)}}}function Ky(l){this._internalRoot=l}Am.prototype.render=Ky.prototype.render=function(l){var u=this._internalRoot;if(u===null)throw Error(n(409));var m=u.current,x=Va();lT(m,x,l,u,null,null)},Am.prototype.unmount=Ky.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var u=l.containerInfo;lT(l.current,2,null,l,null,null),um(),u[ae]=null}};function Am(l){this._internalRoot=l}Am.prototype.unstable_scheduleHydration=function(l){if(l){var u=B();l={blockedOn:null,target:l,priority:u};for(var m=0;m<Xl.length&&u!==0&&u<Xl[m].priority;m++);Xl.splice(m,0,l),m===0&&hT(l)}};var gT=t.version;if(gT!=="19.2.3")throw Error(n(527,gT,"19.2.3"));K.findDOMNode=function(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=f(u),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var m7={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Om=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Om.isDisabled&&Om.supportsFiber)try{Zt=Om.inject(m7),br=Om}catch{}}return xf.createRoot=function(l,u){if(!a(l))throw Error(n(299));var m=!1,x="",S=kj,_=_j,I=jj;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(S=u.onUncaughtError),u.onCaughtError!==void 0&&(_=u.onCaughtError),u.onRecoverableError!==void 0&&(I=u.onRecoverableError)),u=iT(l,1,!1,null,null,m,x,null,S,_,I,xT),l[ae]=u.current,Cy(l),new Ky(u)},xf.hydrateRoot=function(l,u,m){if(!a(l))throw Error(n(299));var x=!1,S="",_=kj,I=_j,H=jj,se=null;return m!=null&&(m.unstable_strictMode===!0&&(x=!0),m.identifierPrefix!==void 0&&(S=m.identifierPrefix),m.onUncaughtError!==void 0&&(_=m.onUncaughtError),m.onCaughtError!==void 0&&(I=m.onCaughtError),m.onRecoverableError!==void 0&&(H=m.onRecoverableError),m.formState!==void 0&&(se=m.formState)),u=iT(l,1,!0,u,m??null,x,S,se,_,I,H,xT),u.context=sT(null),m=u.current,x=Va(),x=Fi(x),S=Ml(x),S.callback=null,Pl(m,S,x),m=x,u.current.lanes=m,xa(u,m),cs(u),l[ae]=u.current,Cy(l),new Am(u)},xf.version="19.2.3",xf}var ET;function k7(){if(ET)return Zy.exports;ET=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Zy.exports=N7(),Zy.exports}var _7=k7();var TT="popstate";function j7(e={}){function t(a,i){let{pathname:s="/",search:c="",hash:d=""}=Cc(a.location.hash.substring(1));return!s.startsWith("/")&&!s.startsWith(".")&&(s="/"+s),x2("",{pathname:s,search:c,hash:d},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(a,i){let s=a.document.querySelector("base"),c="";if(s&&s.getAttribute("href")){let d=a.location.href,f=d.indexOf("#");c=f===-1?d:d.slice(0,f)}return c+"#"+(typeof i=="string"?i:Xf(i))}function n(a,i){ti(a.pathname.charAt(0)==="/",`relative pathnames are not supported in hash history.push(${JSON.stringify(i)})`)}return T7(t,r,n,e)}function _r(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ti(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function E7(){return Math.random().toString(36).substring(2,10)}function CT(e,t){return{usr:e.state,key:e.key,idx:t}}function x2(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Cc(t):t,state:r,key:t&&t.key||n||E7()}}function Xf({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Cc(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function T7(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,c="POP",d=null,f=h();f==null&&(f=0,s.replaceState({...s.state,idx:f},""));function h(){return(s.state||{idx:null}).idx}function p(){c="POP";let w=h(),j=w==null?null:w-f;f=w,d&&d({action:c,location:y.location,delta:j})}function g(w,j){c="PUSH";let T=x2(y.location,w,j);r&&r(T,w),f=h()+1;let N=CT(T,f),C=y.createHref(T);try{s.pushState(N,"",C)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;a.location.assign(C)}i&&d&&d({action:c,location:y.location,delta:1})}function v(w,j){c="REPLACE";let T=x2(y.location,w,j);r&&r(T,w),f=h();let N=CT(T,f),C=y.createHref(T);s.replaceState(N,"",C),i&&d&&d({action:c,location:y.location,delta:0})}function b(w){return C7(w)}let y={get action(){return c},get location(){return e(a,s)},listen(w){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(TT,p),d=w,()=>{a.removeEventListener(TT,p),d=null}},createHref(w){return t(a,w)},createURL:b,encodeLocation(w){let j=b(w);return{pathname:j.pathname,search:j.search,hash:j.hash}},push:g,replace:v,go(w){return s.go(w)}};return y}function C7(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),_r(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:Xf(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function mI(e,t,r="/"){return A7(e,t,r,!1)}function A7(e,t,r,n){let a=typeof t=="string"?Cc(t):t,i=al(a.pathname||"/",r);if(i==null)return null;let s=pI(e);O7(s);let c=null;for(let d=0;c==null&&d<s.length;++d){let f=$7(i);c=U7(s[d],f,n)}return c}function pI(e,t=[],r=[],n="",a=!1){let i=(s,c,d=a,f)=>{let h={relativePath:f===void 0?s.path||"":f,caseSensitive:s.caseSensitive===!0,childrenIndex:c,route:s};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(n)&&d)return;_r(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length)}let p=el([n,h.relativePath]),g=r.concat(h);s.children&&s.children.length>0&&(_r(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),pI(s.children,t,g,p,d)),!(s.path==null&&!s.index)&&t.push({path:p,score:L7(p,s.index),routesMeta:g})};return e.forEach((s,c)=>{if(s.path===""||!s.path?.includes("?"))i(s,c);else for(let d of xI(s.path))i(s,c,!0,d)}),t}function xI(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=xI(n.join("/")),c=[];return c.push(...s.map(d=>d===""?i:[i,d].join("/"))),a&&c.push(...s),c.map(d=>e.startsWith("/")&&d===""?"/":d)}function O7(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:B7(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var D7=/^:[\w-]+$/,I7=3,R7=2,M7=1,P7=10,F7=-2,AT=e=>e==="*";function L7(e,t){let r=e.split("/"),n=r.length;return r.some(AT)&&(n+=F7),t&&(n+=R7),r.filter(a=>!AT(a)).reduce((a,i)=>a+(D7.test(i)?I7:i===""?M7:P7),n)}function B7(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function U7(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",s=[];for(let c=0;c<n.length;++c){let d=n[c],f=c===n.length-1,h=i==="/"?t:t.slice(i.length)||"/",p=wp({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},h),g=d.route;if(!p&&f&&r&&!n[n.length-1].route.index&&(p=wp({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},h)),!p)return null;Object.assign(a,p.params),s.push({params:a,pathname:el([i,p.pathname]),pathnameBase:q7(el([i,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(i=el([i,p.pathnameBase]))}return s}function wp(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=z7(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:n.reduce((f,{paramName:h,isOptional:p},g)=>{if(h==="*"){let b=c[g]||"";s=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const v=c[g];return p&&!v?f[h]=void 0:f[h]=(v||"").replace(/%2F/g,"/"),f},{}),pathname:i,pathnameBase:s,pattern:e}}function z7(e,t=!1,r=!0){ti(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,c,d)=>(n.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function $7(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ti(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function al(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}var H7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,V7=e=>H7.test(e);function G7(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Cc(e):e,i;if(r)if(V7(r))i=r;else{if(r.includes("//")){let s=r;r=r.replace(/\/\/+/g,"/"),ti(!1,`Pathnames cannot have embedded double slashes - normalizing ${s} -> ${r}`)}r.startsWith("/")?i=OT(r.substring(1),"/"):i=OT(r,t)}else i=t;return{pathname:i,search:K7(n),hash:Y7(a)}}function OT(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function t1(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function W7(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function gI(e){let t=W7(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function vI(e,t,r,n=!1){let a;typeof e=="string"?a=Cc(e):(a={...e},_r(!a.pathname||!a.pathname.includes("?"),t1("?","pathname","search",a)),_r(!a.pathname||!a.pathname.includes("#"),t1("#","pathname","hash",a)),_r(!a.search||!a.search.includes("#"),t1("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,c;if(s==null)c=r;else{let p=t.length-1;if(!n&&s.startsWith("..")){let g=s.split("/");for(;g[0]==="..";)g.shift(),p-=1;a.pathname=g.join("/")}c=p>=0?t[p]:"/"}let d=G7(a,c),f=s&&s!=="/"&&s.endsWith("/"),h=(i||s===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(f||h)&&(d.pathname+="/"),d}var el=e=>e.join("/").replace(/\/\/+/g,"/"),q7=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),K7=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Y7=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function X7(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function Z7(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var yI=["POST","PUT","PATCH","DELETE"];new Set(yI);var Q7=["GET",...yI];new Set(Q7);var id=k.createContext(null);id.displayName="DataRouter";var Mx=k.createContext(null);Mx.displayName="DataRouterState";k.createContext(!1);var bI=k.createContext({isTransitioning:!1});bI.displayName="ViewTransition";var J7=k.createContext(new Map);J7.displayName="Fetchers";var eU=k.createContext(null);eU.displayName="Await";var rs=k.createContext(null);rs.displayName="Navigation";var D0=k.createContext(null);D0.displayName="Location";var ns=k.createContext({outlet:null,matches:[],isDataRoute:!1});ns.displayName="Route";var Lw=k.createContext(null);Lw.displayName="RouteError";function tU(e,{relative:t}={}){_r(I0(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=k.useContext(rs),{hash:a,pathname:i,search:s}=R0(e,{relative:t}),c=i;return r!=="/"&&(c=i==="/"?r:el([r,i])),n.createHref({pathname:c,search:s,hash:a})}function I0(){return k.useContext(D0)!=null}function Ns(){return _r(I0(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(D0).location}var wI="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function SI(e){k.useContext(rs).static||k.useLayoutEffect(e)}function fa(){let{isDataRoute:e}=k.useContext(ns);return e?xU():rU()}function rU(){_r(I0(),"useNavigate() may be used only in the context of a <Router> component.");let e=k.useContext(id),{basename:t,navigator:r}=k.useContext(rs),{matches:n}=k.useContext(ns),{pathname:a}=Ns(),i=JSON.stringify(gI(n)),s=k.useRef(!1);return SI(()=>{s.current=!0}),k.useCallback((d,f={})=>{if(ti(s.current,wI),!s.current)return;if(typeof d=="number"){r.go(d);return}let h=vI(d,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:el([t,h.pathname])),(f.replace?r.replace:r.push)(h,f.state,f)},[t,r,i,a,e])}var nU=k.createContext(null);function aU(e){let t=k.useContext(ns).outlet;return k.useMemo(()=>t&&k.createElement(nU.Provider,{value:e},t),[t,e])}function NI(){let{matches:e}=k.useContext(ns),t=e[e.length-1];return t?t.params:{}}function R0(e,{relative:t}={}){let{matches:r}=k.useContext(ns),{pathname:n}=Ns(),a=JSON.stringify(gI(r));return k.useMemo(()=>vI(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function iU(e,t){return kI(e,t)}function kI(e,t,r,n,a){_r(I0(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=k.useContext(rs),{matches:s}=k.useContext(ns),c=s[s.length-1],d=c?c.params:{},f=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let T=p&&p.path||"";_I(f,!p||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let g=Ns(),v;if(t){let T=typeof t=="string"?Cc(t):t;_r(h==="/"||T.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${T.pathname}" was given in the \`location\` prop.`),v=T}else v=g;let b=v.pathname||"/",y=b;if(h!=="/"){let T=h.replace(/^\//,"").split("/");y="/"+b.replace(/^\//,"").split("/").slice(T.length).join("/")}let w=mI(e,{pathname:y});ti(p||w!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),ti(w==null||w[w.length-1].route.element!==void 0||w[w.length-1].route.Component!==void 0||w[w.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=uU(w&&w.map(T=>Object.assign({},T,{params:Object.assign({},d,T.params),pathname:el([h,i.encodeLocation?i.encodeLocation(T.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:el([h,i.encodeLocation?i.encodeLocation(T.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:T.pathnameBase])})),s,r,n,a);return t&&j?k.createElement(D0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},j):j}function sU(){let e=pU(),t=X7(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=k.createElement(k.Fragment,null,k.createElement("p",null," Hey developer "),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:i},"ErrorBoundary")," or"," ",k.createElement("code",{style:i},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},t),r?k.createElement("pre",{style:a},r):null,s)}var lU=k.createElement(sU,null),oU=class extends k.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){return this.state.error!==void 0?k.createElement(ns.Provider,{value:this.props.routeContext},k.createElement(Lw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function cU({routeContext:e,match:t,children:r}){let n=k.useContext(id);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),k.createElement(ns.Provider,{value:e},r)}function uU(e,t=[],r=null,n=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,s=r?.errors;if(s!=null){let h=i.findIndex(p=>p.route.id&&s?.[p.route.id]!==void 0);_r(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let c=!1,d=-1;if(r)for(let h=0;h<i.length;h++){let p=i[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:g,errors:v}=r,b=p.route.loader&&!g.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||b){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}let f=r&&n?(h,p)=>{n(h,{location:r.location,params:r.matches?.[0]?.params??{},unstable_pattern:Z7(r.matches),errorInfo:p})}:void 0;return i.reduceRight((h,p,g)=>{let v,b=!1,y=null,w=null;r&&(v=s&&p.route.id?s[p.route.id]:void 0,y=p.route.errorElement||lU,c&&(d<0&&g===0?(_I("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,w=null):d===g&&(b=!0,w=p.route.hydrateFallbackElement||null)));let j=t.concat(i.slice(0,g+1)),T=()=>{let N;return v?N=y:b?N=w:p.route.Component?N=k.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=h,k.createElement(cU,{match:p,routeContext:{outlet:h,matches:j,isDataRoute:r!=null},children:N})};return r&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?k.createElement(oU,{location:r.location,revalidation:r.revalidation,component:y,error:v,children:T(),routeContext:{outlet:null,matches:j,isDataRoute:!0},onError:f}):T()},null)}function Bw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function dU(e){let t=k.useContext(id);return _r(t,Bw(e)),t}function fU(e){let t=k.useContext(Mx);return _r(t,Bw(e)),t}function hU(e){let t=k.useContext(ns);return _r(t,Bw(e)),t}function Uw(e){let t=hU(e),r=t.matches[t.matches.length-1];return _r(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function mU(){return Uw("useRouteId")}function pU(){let e=k.useContext(Lw),t=fU("useRouteError"),r=Uw("useRouteError");return e!==void 0?e:t.errors?.[r]}function xU(){let{router:e}=dU("useNavigate"),t=Uw("useNavigate"),r=k.useRef(!1);return SI(()=>{r.current=!0}),k.useCallback(async(a,i={})=>{ti(r.current,wI),r.current&&(typeof a=="number"?await e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var DT={};function _I(e,t,r){!t&&!DT[e]&&(DT[e]=!0,ti(!1,r))}k.memo(gU);function gU({routes:e,future:t,state:r,unstable_onError:n}){return kI(e,void 0,r,n,t)}function vU(e){return aU(e.context)}function sa(e){_r(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function yU({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1,unstable_useTransitions:s}){_r(!I0(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),d=k.useMemo(()=>({basename:c,navigator:a,static:i,unstable_useTransitions:s,future:{}}),[c,a,i,s]);typeof r=="string"&&(r=Cc(r));let{pathname:f="/",search:h="",hash:p="",state:g=null,key:v="default"}=r,b=k.useMemo(()=>{let y=al(f,c);return y==null?null:{location:{pathname:y,search:h,hash:p,state:g,key:v},navigationType:n}},[c,f,h,p,g,v,n]);return ti(b!=null,`<Router basename="${c}"> is not able to match the URL "${f}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:k.createElement(rs.Provider,{value:d},k.createElement(D0.Provider,{children:t,value:b}))}function bU({children:e,location:t}){return iU(g2(e),t)}function g2(e,t=[]){let r=[];return k.Children.forEach(e,(n,a)=>{if(!k.isValidElement(n))return;let i=[...t,a];if(n.type===k.Fragment){r.push.apply(r,g2(n.props.children,i));return}_r(n.type===sa,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),_r(!n.props.index||!n.props.children,"An index route cannot have child routes.");let s={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(s.children=g2(n.props.children,i)),r.push(s)}),r}var hp="get",mp="application/x-www-form-urlencoded";function Px(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function wU(e){return Px(e)&&e.tagName.toLowerCase()==="button"}function SU(e){return Px(e)&&e.tagName.toLowerCase()==="form"}function NU(e){return Px(e)&&e.tagName.toLowerCase()==="input"}function kU(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function _U(e,t){return e.button===0&&(!t||t==="_self")&&!kU(e)}function v2(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function jU(e,t){let r=v2(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}var Dm=null;function EU(){if(Dm===null)try{new FormData(document.createElement("form"),0),Dm=!1}catch{Dm=!0}return Dm}var TU=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function r1(e){return e!=null&&!TU.has(e)?(ti(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${mp}"`),null):e}function CU(e,t){let r,n,a,i,s;if(SU(e)){let c=e.getAttribute("action");n=c?al(c,t):null,r=e.getAttribute("method")||hp,a=r1(e.getAttribute("enctype"))||mp,i=new FormData(e)}else if(wU(e)||NU(e)&&(e.type==="submit"||e.type==="image")){let c=e.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||c.getAttribute("action");if(n=d?al(d,t):null,r=e.getAttribute("formmethod")||c.getAttribute("method")||hp,a=r1(e.getAttribute("formenctype"))||r1(c.getAttribute("enctype"))||mp,i=new FormData(c,e),!EU()){let{name:f,type:h,value:p}=e;if(h==="image"){let g=f?`${f}.`:"";i.append(`${g}x`,"0"),i.append(`${g}y`,"0")}else f&&i.append(f,p)}}else{if(Px(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=hp,n=null,a=mp,s=e}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:s}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function zw(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function AU(e,t,r){let n=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return n.pathname==="/"?n.pathname=`_root.${r}`:t&&al(n.pathname,t)==="/"?n.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function OU(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function DU(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function IU(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let s=await OU(i,r);return s.links?s.links():[]}return[]}));return FU(n.flat(1).filter(DU).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function IT(e,t,r,n,a,i){let s=(d,f)=>r[f]?d.route.id!==r[f].route.id:!0,c=(d,f)=>r[f].pathname!==d.pathname||r[f].route.path?.endsWith("*")&&r[f].params["*"]!==d.params["*"];return i==="assets"?t.filter((d,f)=>s(d,f)||c(d,f)):i==="data"?t.filter((d,f)=>{let h=n.routes[d.route.id];if(!h||!h.hasLoader)return!1;if(s(d,f)||c(d,f))return!0;if(d.route.shouldRevalidate){let p=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function RU(e,t,{includeHydrateFallback:r}={}){return MU(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function MU(e){return[...new Set(e)]}function PU(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function FU(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(PU(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}function jI(){let e=k.useContext(id);return zw(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function LU(){let e=k.useContext(Mx);return zw(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var $w=k.createContext(void 0);$w.displayName="FrameworkContext";function EI(){let e=k.useContext($w);return zw(e,"You must render this element inside a <HydratedRouter> element"),e}function BU(e,t){let r=k.useContext($w),[n,a]=k.useState(!1),[i,s]=k.useState(!1),{onFocus:c,onBlur:d,onMouseEnter:f,onMouseLeave:h,onTouchStart:p}=t,g=k.useRef(null);k.useEffect(()=>{if(e==="render"&&s(!0),e==="viewport"){let y=j=>{j.forEach(T=>{s(T.isIntersecting)})},w=new IntersectionObserver(y,{threshold:.5});return g.current&&w.observe(g.current),()=>{w.disconnect()}}},[e]),k.useEffect(()=>{if(n){let y=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(y)}}},[n]);let v=()=>{a(!0)},b=()=>{a(!1),s(!1)};return r?e!=="intent"?[i,g,{}]:[i,g,{onFocus:gf(c,v),onBlur:gf(d,b),onMouseEnter:gf(f,v),onMouseLeave:gf(h,b),onTouchStart:gf(p,v)}]:[!1,g,{}]}function gf(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function UU({page:e,...t}){let{router:r}=jI(),n=k.useMemo(()=>mI(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?k.createElement($U,{page:e,matches:n,...t}):null}function zU(e){let{manifest:t,routeModules:r}=EI(),[n,a]=k.useState([]);return k.useEffect(()=>{let i=!1;return IU(e,t,r).then(s=>{i||a(s)}),()=>{i=!0}},[e,t,r]),n}function $U({page:e,matches:t,...r}){let n=Ns(),{manifest:a,routeModules:i}=EI(),{basename:s}=jI(),{loaderData:c,matches:d}=LU(),f=k.useMemo(()=>IT(e,t,d,a,n,"data"),[e,t,d,a,n]),h=k.useMemo(()=>IT(e,t,d,a,n,"assets"),[e,t,d,a,n]),p=k.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let b=new Set,y=!1;if(t.forEach(j=>{let T=a.routes[j.route.id];!T||!T.hasLoader||(!f.some(N=>N.route.id===j.route.id)&&j.route.id in c&&i[j.route.id]?.shouldRevalidate||T.hasClientLoader?y=!0:b.add(j.route.id))}),b.size===0)return[];let w=AU(e,s,"data");return y&&b.size>0&&w.searchParams.set("_routes",t.filter(j=>b.has(j.route.id)).map(j=>j.route.id).join(",")),[w.pathname+w.search]},[s,c,n,a,f,t,e,i]),g=k.useMemo(()=>RU(h,a),[h,a]),v=zU(h);return k.createElement(k.Fragment,null,p.map(b=>k.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...r})),g.map(b=>k.createElement("link",{key:b,rel:"modulepreload",href:b,...r})),v.map(({key:b,link:y})=>k.createElement("link",{key:b,nonce:r.nonce,...y})))}function HU(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var TI=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{TI&&(window.__reactRouterVersion="7.10.1")}catch{}function VU({basename:e,children:t,unstable_useTransitions:r,window:n}){let a=k.useRef();a.current==null&&(a.current=j7({window:n,v5Compat:!0}));let i=a.current,[s,c]=k.useState({action:i.action,location:i.location}),d=k.useCallback(f=>{r===!1?c(f):k.startTransition(()=>c(f))},[r]);return k.useLayoutEffect(()=>i.listen(d),[i,d]),k.createElement(yU,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:i,unstable_useTransitions:r===!0})}var CI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xn=k.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:c,target:d,to:f,preventScrollReset:h,viewTransition:p,...g},v){let{basename:b,unstable_useTransitions:y}=k.useContext(rs),w=typeof f=="string"&&CI.test(f),j,T=!1;if(typeof f=="string"&&w&&(j=f,TI))try{let P=new URL(window.location.href),R=f.startsWith("//")?new URL(P.protocol+f):new URL(f),L=al(R.pathname,b);R.origin===P.origin&&L!=null?f=L+R.search+R.hash:T=!0}catch{ti(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=tU(f,{relative:a}),[C,E,O]=BU(n,g),A=qU(f,{replace:s,state:c,target:d,preventScrollReset:h,relative:a,viewTransition:p,unstable_useTransitions:y});function D(P){t&&t(P),P.defaultPrevented||A(P)}let M=k.createElement("a",{...g,...O,href:j||N,onClick:T||i?t:D,ref:HU(v,E),target:d,"data-discover":!w&&r==="render"?"true":void 0});return C&&!w?k.createElement(k.Fragment,null,M,k.createElement(UU,{page:N})):M});Xn.displayName="Link";var AI=k.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:c,children:d,...f},h){let p=R0(s,{relative:f.relative}),g=Ns(),v=k.useContext(Mx),{navigator:b,basename:y}=k.useContext(rs),w=v!=null&&QU(p)&&c===!0,j=b.encodeLocation?b.encodeLocation(p).pathname:p.pathname,T=g.pathname,N=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;r||(T=T.toLowerCase(),N=N?N.toLowerCase():null,j=j.toLowerCase()),N&&y&&(N=al(N,y)||N);const C=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let E=T===j||!a&&T.startsWith(j)&&T.charAt(C)==="/",O=N!=null&&(N===j||!a&&N.startsWith(j)&&N.charAt(j.length)==="/"),A={isActive:E,isPending:O,isTransitioning:w},D=E?t:void 0,M;typeof n=="function"?M=n(A):M=[n,E?"active":null,O?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let P=typeof i=="function"?i(A):i;return k.createElement(Xn,{...f,"aria-current":D,className:M,ref:h,style:P,to:s,viewTransition:c},typeof d=="function"?d(A):d)});AI.displayName="NavLink";var GU=k.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:s=hp,action:c,onSubmit:d,relative:f,preventScrollReset:h,viewTransition:p,...g},v)=>{let{unstable_useTransitions:b}=k.useContext(rs),y=XU(),w=ZU(c,{relative:f}),j=s.toLowerCase()==="get"?"get":"post",T=typeof c=="string"&&CI.test(c),N=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let E=C.nativeEvent.submitter,O=E?.getAttribute("formmethod")||s,A=()=>y(E||C.currentTarget,{fetcherKey:t,method:O,navigate:r,replace:a,state:i,relative:f,preventScrollReset:h,viewTransition:p});b&&r!==!1?k.startTransition(()=>A()):A()};return k.createElement("form",{ref:v,method:j,action:w,onSubmit:n?d:N,...g,"data-discover":!T&&e==="render"?"true":void 0})});GU.displayName="Form";function WU(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function OI(e){let t=k.useContext(id);return _r(t,WU(e)),t}function qU(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:s,unstable_useTransitions:c}={}){let d=fa(),f=Ns(),h=R0(e,{relative:i});return k.useCallback(p=>{if(_U(p,t)){p.preventDefault();let g=r!==void 0?r:Xf(f)===Xf(h),v=()=>d(e,{replace:g,state:n,preventScrollReset:a,relative:i,viewTransition:s});c?k.startTransition(()=>v()):v()}},[f,d,h,r,n,t,e,a,i,s,c])}function Hw(e){ti(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=k.useRef(v2(e)),r=k.useRef(!1),n=Ns(),a=k.useMemo(()=>jU(n.search,r.current?null:t.current),[n.search]),i=fa(),s=k.useCallback((c,d)=>{const f=v2(typeof c=="function"?c(new URLSearchParams(a)):c);r.current=!0,i("?"+f,d)},[i,a]);return[a,s]}var KU=0,YU=()=>`__${String(++KU)}__`;function XU(){let{router:e}=OI("useSubmit"),{basename:t}=k.useContext(rs),r=mU(),n=e.fetch,a=e.navigate;return k.useCallback(async(i,s={})=>{let{action:c,method:d,encType:f,formData:h,body:p}=CU(i,t);if(s.navigate===!1){let g=s.fetcherKey||YU();await n(g,r,s.action||c,{preventScrollReset:s.preventScrollReset,formData:h,body:p,formMethod:s.method||d,formEncType:s.encType||f,flushSync:s.flushSync})}else await a(s.action||c,{preventScrollReset:s.preventScrollReset,formData:h,body:p,formMethod:s.method||d,formEncType:s.encType||f,replace:s.replace,state:s.state,fromRouteId:r,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,a,t,r])}function ZU(e,{relative:t}={}){let{basename:r}=k.useContext(rs),n=k.useContext(ns);_r(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...R0(e||".",{relative:t})},s=Ns();if(e==null){i.search=s.search;let c=new URLSearchParams(i.search),d=c.getAll("index");if(d.some(h=>h==="")){c.delete("index"),d.filter(p=>p).forEach(p=>c.append("index",p));let h=c.toString();i.search=h?`?${h}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:el([r,i.pathname])),Xf(i)}function QU(e,{relative:t}={}){let r=k.useContext(bI);_r(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=OI("useViewTransitionState"),a=R0(e,{relative:t});if(!r.isTransitioning)return!1;let i=al(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=al(r.nextLocation.pathname,n)||r.nextLocation.pathname;return wp(a.pathname,s)!=null||wp(a.pathname,i)!=null}var Jo=hI();const JU={levelNames:{corporation:"Corporation",holding:"Holding Company",company:"Operating Company"},enableOwnershipTracking:!0,defaultCurrency:"USD",consolidatedReporting:!0};function DI(e){const t=new Date().toISOString();return{id:e.id||`entity-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e.name,code:e.code||e.name.substring(0,10).toUpperCase().replace(/\s+/g,""),entityType:e.entityType,parentEntityId:e.parentEntityId??null,ownershipPercentage:e.ownershipPercentage??100,description:e.description??"",registeredCountry:e.registeredCountry,currency:e.currency??"USD",fiscalYearEnd:e.fiscalYearEnd??"12-31",hasBSC:e.hasBSC??!0,bscScope:e.bscScope??(e.entityType==="company"?"standalone":"consolidated"),isActive:e.isActive??!0,displayOrder:e.displayOrder??0,createdAt:e.createdAt??t,updatedAt:t}}const ez={id:"corp-root",name:"My Corporation",code:"CORP",entityType:"corporation",parentEntityId:null,ownershipPercentage:100,description:"Root corporate entity",registeredCountry:"US",currency:"USD",fiscalYearEnd:"12-31",hasBSC:!0,bscScope:"consolidated",isActive:!0,displayOrder:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},n1={id:"company-default",name:"Main Company",code:"MAIN",entityType:"company",parentEntityId:"corp-root",ownershipPercentage:100,description:"Primary operating company",registeredCountry:"US",currency:"USD",fiscalYearEnd:"12-31",hasBSC:!0,bscScope:"standalone",isActive:!0,displayOrder:0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},y2=["section"],Vw={levelNames:{directorate:"Directorate",division:"Division",department:"Department",section:"Section"},levelsWithBSC:["directorate","division","department"],defaultBSCLevel:"directorate"};function II(e){switch(e){case"directorate":return"division";case"division":return"department";case"department":return"section";case"section":return null}}function tz(e){return!y2.includes(e)}function Mf(e){const t=new Date().toISOString(),r=tz(e.level);return{id:e.id||`org-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:e.name,code:e.code||e.name.substring(0,10).toUpperCase().replace(/\s+/g,""),level:e.level,parentId:e.parentId??null,companyId:e.companyId,description:e.description??"",headId:e.headId,hasBSC:r?e.hasBSC??!0:!1,inheritBSCFromId:e.inheritBSCFromId,displayOrder:e.displayOrder??0,isActive:e.isActive??!0,createdAt:e.createdAt??t,updatedAt:t}}const rz={admin:{canManageStructure:!0,canEditBSC:!0,canManagePortfolio:!0,canManageTasks:!0,canImportExport:!0,canManageUsers:!0,canViewReports:!0,canConfigureSettings:!0},editor:{canManageStructure:!1,canEditBSC:!0,canManagePortfolio:!0,canManageTasks:!0,canImportExport:!0,canManageUsers:!1,canViewReports:!0,canConfigureSettings:!1},viewer:{canManageStructure:!1,canEditBSC:!1,canManagePortfolio:!1,canManageTasks:!1,canImportExport:!1,canManageUsers:!1,canViewReports:!0,canConfigureSettings:!1}};function nz(e){return e?{...rz[e]}:{canManageStructure:!1,canEditBSC:!1,canManagePortfolio:!1,canManageTasks:!1,canImportExport:!1,canManageUsers:!1,canViewReports:!1,canConfigureSettings:!1}}const RT={id:"user-admin",email:"admin@example.com",displayName:"System Admin",avatarInitials:"SA",avatarColor:"#8a3ffc",isSystemAdmin:!0,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},az={id:"assign-admin-root",userId:"user-admin",corporateEntityId:"corp-root",role:"admin",inheritToChildren:!0,isActive:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},Un={FIN:{code:"FIN",name:"Finance",color:"#10b981"},MKT:{code:"MKT",name:"Marketing",color:"#f59e0b"},OPS:{code:"OPS",name:"Operations",color:"#3b82f6"},IT:{code:"IT",name:"Information Technology",color:"#8b5cf6"},HR:{code:"HR",name:"Human Resources",color:"#ec4899"},SAL:{code:"SAL",name:"Sales",color:"#06b6d4"},PRD:{code:"PRD",name:"Product",color:"#f97316"},ENG:{code:"ENG",name:"Engineering",color:"#6366f1"},LEG:{code:"LEG",name:"Legal",color:"#64748b"},ADM:{code:"ADM",name:"Administration",color:"#78716c"}},Hi={RUN:{code:"RUN",name:"Run",description:"Run the Business - Operational excellence",color:"#3b82f6"},GROW:{code:"GROW",name:"Grow",description:"Grow the Business - Expansion & scaling",color:"#10b981"},TRNS:{code:"TRNS",name:"Transform",description:"Transform the Business - Innovation & change",color:"#8b5cf6"}},RI={pillars:[{id:"pillar-1",name:"Financial",description:"Financial health and growth objectives",displayOrder:1,ragStatus:"green"},{id:"pillar-2",name:"Customer",description:"Customer satisfaction and loyalty metrics",displayOrder:2,ragStatus:"amber"},{id:"pillar-3",name:"Internal Processes",description:"Operational excellence and efficiency",displayOrder:3,ragStatus:"green"},{id:"pillar-4",name:"Learning & Growth",description:"Employee development and organizational capability",displayOrder:4,ragStatus:"red"}],kpis:[{id:"kpi-1",pillarId:"pillar-1",name:"Revenue Growth YoY",targetValue:12,currentValue:15,previousValue:10,unit:"%",lastUpdated:"2024-12-01"},{id:"kpi-2",pillarId:"pillar-1",name:"Cost Reduction",targetValue:100,currentValue:98,previousValue:95,unit:"%",lastUpdated:"2024-12-01"},{id:"kpi-3",pillarId:"pillar-2",name:"NPS Score",targetValue:50,currentValue:42,previousValue:45,unit:"score",lastUpdated:"2024-12-01"},{id:"kpi-4",pillarId:"pillar-2",name:"Customer Churn Rate",targetValue:3,currentValue:5.1,previousValue:4.2,unit:"%",lastUpdated:"2024-12-01"},{id:"kpi-5",pillarId:"pillar-3",name:"Operational Efficiency",targetValue:90,currentValue:92,previousValue:88,unit:"%",lastUpdated:"2024-12-01"},{id:"kpi-6",pillarId:"pillar-3",name:"Process Automation Rate",targetValue:75,currentValue:78,previousValue:70,unit:"%",lastUpdated:"2024-12-01"},{id:"kpi-7",pillarId:"pillar-4",name:"Key Role Retention",targetValue:95,currentValue:85,previousValue:90,unit:"%",lastUpdated:"2024-12-01"},{id:"kpi-8",pillarId:"pillar-4",name:"Training Hours per Employee",targetValue:40,currentValue:32,previousValue:28,unit:"number",lastUpdated:"2024-12-01"}],initiatives:[{id:"init-1",pillarId:"pillar-2",name:"Global CRM Rollout",description:"Implement new CRM system across all regions",ownerId:"res-1",startDate:"2024-01-01",endDate:"2024-12-31",budget:15e5,spentBudget:11e5,ragStatus:"amber",linkedKpiIds:["kpi-3","kpi-4"]},{id:"init-2",pillarId:"pillar-3",name:"Supply Chain Automation",description:"Automate supply chain processes for efficiency",ownerId:"res-2",startDate:"2024-03-01",endDate:"2025-06-30",budget:32e5,spentBudget:18e5,ragStatus:"green",linkedKpiIds:["kpi-5","kpi-6"]},{id:"init-3",pillarId:"pillar-1",name:"Data-Driven Revenue",description:"Leverage data analytics for revenue optimization",ownerId:"res-3",startDate:"2024-02-01",endDate:"2024-11-30",budget:8e5,spentBudget:65e4,ragStatus:"green",linkedKpiIds:["kpi-1","kpi-2"]},{id:"init-4",pillarId:"pillar-4",name:"Key Role Retention Program",description:"Programs to improve retention of critical talent",ownerId:"res-4",startDate:"2024-04-01",endDate:"2024-12-31",budget:5e5,spentBudget:42e4,ragStatus:"red",linkedKpiIds:["kpi-7","kpi-8"]},{id:"init-5",pillarId:"pillar-2",name:"Customer Retention Drive",description:"Initiatives to reduce churn and improve loyalty",ownerId:"res-1",startDate:"2024-05-01",endDate:"2025-03-31",budget:95e4,spentBudget:38e4,ragStatus:"amber",linkedKpiIds:["kpi-4"]},{id:"init-6",pillarId:"pillar-3",name:"Operational Efficiency",description:"Streamline operations across departments",ownerId:"res-5",startDate:"2024-01-15",endDate:"2024-10-31",budget:6e5,spentBudget:52e4,ragStatus:"green",linkedKpiIds:["kpi-5"]}],projects:[{id:"proj-1",initiativeId:"init-1",name:"CRM Vendor Selection",description:"Evaluate and select CRM vendor",managerId:"res-1",status:"completed",ragStatus:"green",startDate:"2024-01-01",endDate:"2024-03-31",completionPercentage:100,budget:1e5,spentBudget:95e3,departmentCode:"IT",category:"GROW",sequenceNumber:1,fiscalYear:2024,workId:"IT-24-GROW-001"},{id:"proj-2",initiativeId:"init-1",name:"Project Phoenix - Data Migration",description:"Migrate customer data to new CRM",managerId:"res-6",status:"in_progress",ragStatus:"amber",startDate:"2024-04-01",endDate:"2024-09-30",completionPercentage:65,budget:6e5,spentBudget:48e4,departmentCode:"IT",category:"TRNS",sequenceNumber:1,fiscalYear:2024,workId:"IT-24-TRNS-001"},{id:"proj-3",initiativeId:"init-1",name:"CRM Training Program",description:"Train staff on new CRM system",managerId:"res-4",status:"in_progress",ragStatus:"red",startDate:"2024-07-01",endDate:"2024-11-30",completionPercentage:30,budget:2e5,spentBudget:18e4,departmentCode:"HR",category:"RUN",sequenceNumber:1,fiscalYear:2024,workId:"HR-24-RUN-001"},{id:"proj-4",initiativeId:"init-2",name:"Warehouse Automation",description:"Automate warehouse operations",managerId:"res-2",status:"in_progress",ragStatus:"green",startDate:"2024-03-01",endDate:"2024-12-31",completionPercentage:75,budget:15e5,spentBudget:11e5,departmentCode:"OPS",category:"TRNS",sequenceNumber:1,fiscalYear:2024,workId:"OPS-24-TRNS-001"},{id:"proj-5",initiativeId:"init-2",name:"Logistics Optimization",description:"Optimize logistics and delivery routes",managerId:"res-7",status:"in_progress",ragStatus:"green",startDate:"2024-06-01",endDate:"2025-03-31",completionPercentage:45,budget:8e5,spentBudget:35e4,departmentCode:"OPS",category:"GROW",sequenceNumber:1,fiscalYear:2024,workId:"OPS-24-GROW-001"},{id:"proj-6",initiativeId:"init-3",name:"Analytics Platform",description:"Build data analytics platform",managerId:"res-3",status:"in_progress",ragStatus:"green",startDate:"2024-02-01",endDate:"2024-08-31",completionPercentage:90,budget:45e4,spentBudget:42e4,departmentCode:"IT",category:"GROW",sequenceNumber:2,fiscalYear:2024,workId:"IT-24-GROW-002"},{id:"proj-7",initiativeId:"init-4",name:"Project Beta - Talent Assessment",description:"Assess critical talent retention risks",managerId:"res-4",status:"in_progress",ragStatus:"red",startDate:"2024-04-01",endDate:"2024-09-30",completionPercentage:50,budget:15e4,spentBudget:14e4,departmentCode:"HR",category:"RUN",sequenceNumber:2,fiscalYear:2024,workId:"HR-24-RUN-002"},{id:"proj-8",initiativeId:"init-5",name:"Customer Feedback System",description:"Implement customer feedback collection",managerId:"res-8",status:"in_progress",ragStatus:"amber",startDate:"2024-05-01",endDate:"2024-12-31",completionPercentage:55,budget:3e5,spentBudget:18e4,departmentCode:"MKT",category:"GROW",sequenceNumber:1,fiscalYear:2024,workId:"MKT-24-GROW-001"}],tasks:[{id:"task-1",projectId:"proj-2",title:"Define Data Schema",description:"Define the data schema for migration",assigneeId:"res-9",kanbanStatus:"done",dueDate:"2024-04-15",estimatedHours:40,actualHours:38,departmentCode:"IT"},{id:"task-2",projectId:"proj-2",title:"Migrate EU Customer Data",description:"Migrate customer data from EU region",assigneeId:"res-9",kanbanStatus:"in_progress",dueDate:"2024-05-20",estimatedHours:120,actualHours:80,departmentCode:"IT"},{id:"task-3",projectId:"proj-2",title:"Data Migration Scripts",description:"Write data migration automation scripts",assigneeId:"res-10",kanbanStatus:"in_progress",dueDate:"2024-06-01",estimatedHours:80,actualHours:45,departmentCode:"ENG"},{id:"task-4",projectId:"proj-2",title:"QA Testing - Phase 1",description:"Quality assurance testing for first migration phase",assigneeId:"res-8",kanbanStatus:"todo",dueDate:"2024-06-15",estimatedHours:60,actualHours:0,departmentCode:"IT"},{id:"task-5",projectId:"proj-2",title:"Define CRM Requirements",description:"Document CRM system requirements",assigneeId:"res-1",kanbanStatus:"done",dueDate:"2024-04-30",estimatedHours:24,actualHours:28,departmentCode:"PRD"},{id:"task-6",projectId:"proj-2",title:"Velocity Requirements",description:"Define performance requirements",assigneeId:"res-6",kanbanStatus:"in_progress",dueDate:"2024-05-25",estimatedHours:16,actualHours:12,departmentCode:"IT"},{id:"task-7",projectId:"proj-2",title:"User Training Modules",description:"Create training modules for end users",assigneeId:"res-4",kanbanStatus:"blocked",dueDate:"2024-06-30",estimatedHours:40,actualHours:8,departmentCode:"HR"},{id:"task-8",projectId:"proj-2",title:"Define Migration Exceptions",description:"Handle edge cases in data migration",assigneeId:"res-10",kanbanStatus:"blocked",dueDate:"2024-06-10",estimatedHours:32,actualHours:16,departmentCode:"ENG"},{id:"task-9",projectId:"proj-3",title:"Create Training Materials",description:"Develop CRM training documentation",assigneeId:"res-4",kanbanStatus:"in_progress",dueDate:"2024-08-15",estimatedHours:60,actualHours:25,departmentCode:"HR"},{id:"task-10",projectId:"proj-3",title:"Schedule Training Sessions",description:"Coordinate training schedule across teams",assigneeId:"res-4",kanbanStatus:"todo",dueDate:"2024-09-01",estimatedHours:20,actualHours:0,departmentCode:"HR"},{id:"task-11",projectId:"proj-4",title:"Install Automation Hardware",description:"Install conveyor and sorting systems",assigneeId:"res-2",kanbanStatus:"done",dueDate:"2024-06-30",estimatedHours:200,actualHours:180,departmentCode:"OPS"},{id:"task-12",projectId:"proj-4",title:"Integration Testing",description:"Test automation system integration",assigneeId:"res-7",kanbanStatus:"in_progress",dueDate:"2024-08-15",estimatedHours:80,actualHours:50,departmentCode:"OPS"},{id:"task-13",projectId:"proj-6",title:"Build Dashboard Framework",description:"Create dashboard visualization framework",assigneeId:"res-3",kanbanStatus:"done",dueDate:"2024-05-15",estimatedHours:100,actualHours:95,departmentCode:"IT"},{id:"task-14",projectId:"proj-6",title:"Data Pipeline Setup",description:"Configure data ingestion pipelines",assigneeId:"res-9",kanbanStatus:"done",dueDate:"2024-06-01",estimatedHours:80,actualHours:75,departmentCode:"IT"}],resources:[{id:"res-1",name:"Jane Doe",email:"jane.doe@company.com",role:"Senior PM",team:"PMO",weeklyCapacity:40,avatarColor:"#3b82f6",departmentCode:"ADM",hourlyRate:85},{id:"res-2",name:"Bob Jones",email:"bob.jones@company.com",role:"Operations Director",team:"Operations",weeklyCapacity:40,avatarColor:"#22c55e",departmentCode:"OPS",hourlyRate:95},{id:"res-3",name:"Alice Chen",email:"alice.chen@company.com",role:"Data Science Lead",team:"Analytics",weeklyCapacity:40,avatarColor:"#8b5cf6",departmentCode:"IT",hourlyRate:90},{id:"res-4",name:"Mike Brown",email:"mike.brown@company.com",role:"HR Director",team:"Human Resources",weeklyCapacity:40,avatarColor:"#f59e0b",departmentCode:"HR",hourlyRate:80},{id:"res-5",name:"Sarah Lee",email:"sarah.lee@company.com",role:"Process Excellence Lead",team:"Operations",weeklyCapacity:40,avatarColor:"#ec4899",departmentCode:"OPS",hourlyRate:75},{id:"res-6",name:"Tom Wilson",email:"tom.wilson@company.com",role:"Technical PM",team:"IT",weeklyCapacity:40,avatarColor:"#06b6d4",departmentCode:"IT",hourlyRate:85},{id:"res-7",name:"Emily Davis",email:"emily.davis@company.com",role:"Logistics Manager",team:"Operations",weeklyCapacity:40,avatarColor:"#f43f5e",departmentCode:"OPS",hourlyRate:70},{id:"res-8",name:"James Taylor",email:"james.taylor@company.com",role:"QA Lead",team:"Quality",weeklyCapacity:40,avatarColor:"#14b8a6",departmentCode:"IT",hourlyRate:65},{id:"res-9",name:"John Smith",email:"john.smith@company.com",role:"Cloud Architect",team:"IT Infrastructure",weeklyCapacity:40,avatarColor:"#a855f7",departmentCode:"IT",hourlyRate:100},{id:"res-10",name:"Lisa Wang",email:"lisa.wang@company.com",role:"Senior Developer",team:"Engineering",weeklyCapacity:40,avatarColor:"#eab308",departmentCode:"ENG",hourlyRate:80}],functionContributions:[{projectId:"proj-2",departmentCode:"IT",plannedHours:240,actualHours:168,completionPercentage:70,assignedResourceIds:["res-6","res-8","res-9"]},{projectId:"proj-2",departmentCode:"ENG",plannedHours:112,actualHours:61,completionPercentage:55,assignedResourceIds:["res-10"]},{projectId:"proj-2",departmentCode:"HR",plannedHours:40,actualHours:8,completionPercentage:20,assignedResourceIds:["res-4"]},{projectId:"proj-2",departmentCode:"PRD",plannedHours:24,actualHours:28,completionPercentage:100,assignedResourceIds:["res-1"]},{projectId:"proj-4",departmentCode:"OPS",plannedHours:280,actualHours:230,completionPercentage:82,assignedResourceIds:["res-2","res-7"]},{projectId:"proj-6",departmentCode:"IT",plannedHours:180,actualHours:170,completionPercentage:94,assignedResourceIds:["res-3","res-9"]}]},iz=Vw,MI=["directorate","division","department","section"];function sz(e){return!1}function PI(e){return e.orgConfig?e:{...e,orgConfig:iz}}function FI(e){return!e.corporateEntities||e.corporateEntities.length===0}function b2(e){if(!FI(e))return e;console.log("[Migration] Starting corporate structure migration...");const t=[],r=[],n=new Map,a={...ez,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};t.push(a);const i=e.orgUnits||[];if(i.some(h=>h.level==="company"))i.filter(g=>g.level==="company").forEach((g,v)=>{const b=DI({id:`company-${g.id}`,name:g.name,code:g.code,entityType:"company",parentEntityId:a.id,description:g.description||`Migrated from org unit: ${g.name}`,hasBSC:g.hasBSC,bscScope:"standalone",displayOrder:v,isActive:g.isActive});t.push(b),n.set(g.id,b.id)}),i.filter(g=>g.level!=="company").forEach(g=>{let v=lz(g,i,n);v||(v=t.find(y=>y.entityType==="company")?.id||n1.id);const b=Mf({...g,level:g.level,companyId:v,parentId:n.has(g.parentId||"")?null:g.parentId});r.push(b)});else if(i.length>0){const h={...n1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};t.push(h),i.forEach(p=>{const g=Mf({...p,level:p.level,companyId:p.companyId||h.id});r.push(g)})}else{const h={...n1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};t.push(h),i.forEach(p=>{const g=Mf({...p,level:p.level,companyId:h.id});r.push(g)})}const c=e.users||[{...RT}],d=e.userAssignments||[{...az}],f={...e,corporateEntities:t,corporateConfig:e.corporateConfig,orgUnits:r,orgConfig:e.orgConfig||Vw,users:c,userAssignments:d,currentUserId:e.currentUserId||RT.id,setupWizardCompleted:e.setupWizardCompleted??!1};return console.log("[Migration] Corporate structure migration complete:",{corporateEntities:t.length,orgUnits:r.length,users:c.length}),f}function lz(e,t,r){if(e.parentId&&r.has(e.parentId))return r.get(e.parentId)||null;let n=e;for(;n.parentId;){if(r.has(n.parentId))return r.get(n.parentId)||null;const a=t.find(i=>i.id===n.parentId);if(!a)break;n=a}return null}const LI="stratos-ai-data",oz=[{id:"pillar-1",name:"Financial",description:"Financial health and growth objectives",displayOrder:1,ragStatus:"green"},{id:"pillar-2",name:"Customer",description:"Customer satisfaction and loyalty metrics",displayOrder:2,ragStatus:"green"},{id:"pillar-3",name:"Internal Processes",description:"Operational excellence and efficiency",displayOrder:3,ragStatus:"green"},{id:"pillar-4",name:"Learning & Growth",description:"Employee development and organizational capability",displayOrder:4,ragStatus:"green"}],cz=()=>{try{const t=localStorage.getItem(LI);if(t){let r=JSON.parse(t);return(!r.pillars||r.pillars.length===0)&&(r.pillars=oz),sz(r),FI(r)&&(r=b2(r)),r}}catch(t){console.error("Error loading from localStorage:",t)}let e=PI(RI);return e=b2(e),e},uz=(e,t)=>{switch(t.type){case"SET_STATE":return t.payload;case"ADD_PILLAR":return{...e,pillars:[...e.pillars,t.payload]};case"UPDATE_PILLAR":return{...e,pillars:e.pillars.map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_PILLAR":return{...e,pillars:e.pillars.filter(r=>r.id!==t.payload)};case"ADD_KPI":return{...e,kpis:[...e.kpis,t.payload]};case"UPDATE_KPI":return{...e,kpis:e.kpis.map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_KPI":return{...e,kpis:e.kpis.filter(r=>r.id!==t.payload)};case"ADD_INITIATIVE":return{...e,initiatives:[...e.initiatives,t.payload]};case"UPDATE_INITIATIVE":return{...e,initiatives:e.initiatives.map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_INITIATIVE":return{...e,initiatives:e.initiatives.filter(r=>r.id!==t.payload)};case"ADD_PROJECT":return{...e,projects:[...e.projects,t.payload]};case"UPDATE_PROJECT":return{...e,projects:e.projects.map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_PROJECT":return{...e,projects:e.projects.filter(r=>r.id!==t.payload)};case"ADD_TASK":return{...e,tasks:[...e.tasks,t.payload]};case"UPDATE_TASK":return{...e,tasks:e.tasks.map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_TASK":return{...e,tasks:e.tasks.filter(r=>r.id!==t.payload)};case"ADD_RESOURCE":return{...e,resources:[...e.resources,t.payload]};case"UPDATE_RESOURCE":return{...e,resources:e.resources.map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_RESOURCE":return{...e,resources:e.resources.filter(r=>r.id!==t.payload)};case"ADD_MILESTONE":return{...e,milestones:[...e.milestones||[],t.payload]};case"UPDATE_MILESTONE":return{...e,milestones:(e.milestones||[]).map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_MILESTONE":return{...e,milestones:(e.milestones||[]).filter(r=>r.id!==t.payload)};case"ADD_ORG_UNIT":return{...e,orgUnits:[...e.orgUnits||[],t.payload]};case"UPDATE_ORG_UNIT":return{...e,orgUnits:(e.orgUnits||[]).map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_ORG_UNIT":return{...e,orgUnits:(e.orgUnits||[]).filter(r=>r.id!==t.payload)};case"UPDATE_ORG_CONFIG":return{...e,orgConfig:t.payload};case"ADD_CORPORATE_ENTITY":return{...e,corporateEntities:[...e.corporateEntities||[],t.payload]};case"UPDATE_CORPORATE_ENTITY":return{...e,corporateEntities:(e.corporateEntities||[]).map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_CORPORATE_ENTITY":return{...e,corporateEntities:(e.corporateEntities||[]).filter(r=>r.id!==t.payload)};case"UPDATE_CORPORATE_CONFIG":return{...e,corporateConfig:t.payload};case"ADD_USER":return{...e,users:[...e.users||[],t.payload]};case"UPDATE_USER":return{...e,users:(e.users||[]).map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_USER":return{...e,users:(e.users||[]).filter(r=>r.id!==t.payload)};case"SET_CURRENT_USER":return{...e,currentUserId:t.payload??void 0};case"ADD_USER_ASSIGNMENT":return{...e,userAssignments:[...e.userAssignments||[],t.payload]};case"UPDATE_USER_ASSIGNMENT":return{...e,userAssignments:(e.userAssignments||[]).map(r=>r.id===t.payload.id?t.payload:r)};case"DELETE_USER_ASSIGNMENT":return{...e,userAssignments:(e.userAssignments||[]).filter(r=>r.id!==t.payload)};case"SET_SETUP_WIZARD_COMPLETED":return{...e,setupWizardCompleted:t.payload};case"IMPORT_DATA":return{pillars:t.payload.pillars||e.pillars,kpis:t.payload.kpis||e.kpis,initiatives:t.payload.initiatives||e.initiatives,projects:[...e.projects,...t.payload.projects||[]],tasks:[...e.tasks,...t.payload.tasks||[]],resources:t.payload.resources||e.resources,milestones:[...e.milestones||[],...t.payload.milestones||[]],corporateEntities:t.payload.corporateEntities||e.corporateEntities,corporateConfig:t.payload.corporateConfig||e.corporateConfig,orgUnits:t.payload.orgUnits||e.orgUnits,orgConfig:t.payload.orgConfig||e.orgConfig,users:t.payload.users||e.users,userAssignments:t.payload.userAssignments||e.userAssignments,currentUserId:e.currentUserId,setupWizardCompleted:e.setupWizardCompleted};default:return e}},BI=k.createContext(void 0),dz=({children:e})=>{const[t,r]=k.useReducer(uz,null,cz);k.useEffect(()=>{try{localStorage.setItem(LI,JSON.stringify(t))}catch(U){console.error("Error saving to localStorage:",U)}},[t]);const n=U=>t.pillars.find(G=>G.id===U),a=U=>t.kpis.filter(G=>G.pillarId===U),i=U=>t.initiatives.find(G=>G.id===U),s=U=>t.initiatives.filter(G=>G.pillarId===U),c=U=>t.projects.find(G=>G.id===U),d=U=>t.projects.filter(G=>G.initiativeId===U),f=U=>t.tasks.find(G=>G.id===U),h=U=>t.tasks.filter(G=>G.projectId===U),p=U=>t.resources.find(G=>G.id===U),g=U=>(t.milestones||[]).find(G=>G.id===U),v=U=>(t.milestones||[]).filter(G=>G.projectId===U),b=U=>t.tasks.filter(G=>G.parentTaskId===U),y=U=>t.tasks.filter(G=>G.projectId===U&&!G.parentTaskId),w=U=>(t.corporateEntities||[]).find(G=>G.id===U),j=()=>(t.corporateEntities||[]).find(U=>U.entityType==="corporation"&&!U.parentEntityId),T=U=>(t.corporateEntities||[]).filter(G=>G.parentEntityId===U&&G.isActive).sort((G,le)=>G.displayOrder-le.displayOrder),N=U=>{const G=w(U);return!G||!G.parentEntityId?[]:(t.corporateEntities||[]).filter(le=>le.parentEntityId===G.parentEntityId&&le.id!==U&&le.isActive)},C=U=>{const G=[];let le=w(U);for(;le?.parentEntityId;){const de=w(le.parentEntityId);if(de)G.unshift(de),le=de;else break}return G},E=U=>{const G=[],le=T(U);for(;le.length>0;){const de=le.shift();G.push(de),le.push(...T(de.id))}return G},O=()=>(t.corporateEntities||[]).filter(U=>U.entityType==="company"&&U.isActive).sort((U,G)=>U.displayOrder-G.displayOrder),A=()=>t.corporateConfig||JU,D=U=>(t.orgUnits||[]).find(G=>G.id===U),M=U=>(t.orgUnits||[]).filter(G=>G.level===U&&G.isActive),P=U=>(t.orgUnits||[]).filter(G=>G.parentId===U&&G.isActive),R=U=>{const G=[];let le=D(U);for(;le?.parentId;){const de=D(le.parentId);if(de)G.unshift(de),le=de;else break}return G},L=U=>{const G=[],le=P(U);for(;le.length>0;){const de=le.shift();G.push(de),le.push(...P(de.id))}return G},te=U=>t.pillars.filter(G=>G.orgUnitId===U||!G.orgUnitId&&U==="org-company"),ee=(U,G=!1)=>{const le=new Set([U]);return G&&L(U).forEach(de=>le.add(de.id)),t.initiatives.filter(de=>le.has(de.orgUnitId||"org-company"))},ue=(U,G=!1)=>{const le=new Set([U]);return G&&L(U).forEach(de=>le.add(de.id)),t.projects.filter(de=>le.has(de.orgUnitId||"org-company"))},V=U=>{const G=t.orgUnits||[],le=new Set;let de=U;for(;de&&!le.has(de);){le.add(de);const ne=G.find(oe=>oe.id===de);if(!ne)return;if(ne.hasBSC)return ne;de=ne.inheritBSCFromId||ne.parentId||void 0}return G.find(ne=>ne.level==="directorate"&&ne.hasBSC)},K=()=>t.orgConfig||Vw,ie=U=>(t.orgUnits||[]).filter(G=>G.companyId===U&&G.isActive).sort((G,le)=>G.displayOrder-le.displayOrder),re=U=>(t.users||[]).find(G=>G.id===U),q={state:t,dispatch:r,getPillar:n,getKPIsByPillar:a,getInitiative:i,getInitiativesByPillar:s,getProject:c,getProjectsByInitiative:d,getTask:f,getTasksByProject:h,getResource:p,getMilestone:g,getMilestonesByProject:v,getChildTasks:b,getRootTasks:y,getCorporateEntity:w,getRootCorporation:j,getChildCorporateEntities:T,getSiblingCorporateEntities:N,getCorporateEntityAncestors:C,getCorporateEntityDescendants:E,getAllCompanies:O,getCorporateConfig:A,getOrgUnit:D,getOrgUnitsByLevel:M,getOrgUnitsForCompany:ie,getChildOrgUnits:P,getOrgUnitAncestors:R,getOrgUnitDescendants:L,getPillarsByOrgUnit:te,getInitiativesByOrgUnit:ee,getProjectsByOrgUnit:ue,getEffectiveBSCOrgUnit:V,getOrgConfig:K,getUser:re,getCurrentUser:()=>t.currentUserId?re(t.currentUserId):void 0,getUserAssignments:U=>(t.userAssignments||[]).filter(G=>G.userId===U&&G.isActive),isSetupWizardCompleted:()=>t.setupWizardCompleted??!1,resetToSeedData:()=>{let U=PI(RI);U=b2(U),r({type:"SET_STATE",payload:U})}};return o.jsx(BI.Provider,{value:q,children:e})},Pt=()=>{const e=k.useContext(BI);if(!e)throw new Error("useApp must be used within an AppProvider");return e},UI=k.createContext(void 0),MT="stratos-ai-theme",fz=({children:e})=>{const[t,r]=k.useState(()=>localStorage.getItem(MT)||"system"),[n,a]=k.useState("dark"),i=()=>typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":"dark";k.useEffect(()=>{const c=t==="system"?i():t;a(c);const d=document.documentElement;d.classList.remove("light","dark"),d.classList.add(c)},[t]),k.useEffect(()=>{if(t!=="system")return;const c=window.matchMedia("(prefers-color-scheme: dark)"),d=()=>{a(i())};return c.addEventListener("change",d),()=>c.removeEventListener("change",d)},[t]);const s=c=>{r(c),localStorage.setItem(MT,c)};return o.jsx(UI.Provider,{value:{theme:t,setTheme:s,resolvedTheme:n},children:e})},hz=()=>{const e=k.useContext(UI);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e},Gw="stratos-ai-analysis-cache",mz=300*1e3;function pz(e){const t=JSON.stringify({pillars:e.pillars.map(n=>({id:n.id,ragStatus:n.ragStatus})),initiatives:e.initiatives.map(n=>({id:n.id,ragStatus:n.ragStatus,spentBudget:n.spentBudget})),projects:e.projects.map(n=>({id:n.id,ragStatus:n.ragStatus,completionPercentage:n.completionPercentage})),tasks:e.tasks.map(n=>({id:n.id,kanbanStatus:n.kanbanStatus}))});let r=0;for(let n=0;n<t.length;n++){const a=t.charCodeAt(n);r=(r<<5)-r+a,r=r&r}return r.toString(36)}function xz(e){try{const t=localStorage.getItem(Gw);if(t){const r=JSON.parse(t),n=Date.now();if(r.dataHash===e&&n-r.timestamp<mz)return r.result}}catch(t){console.error("Error reading AI cache:",t)}return null}function gz(e,t){try{const r={result:e,timestamp:Date.now(),dataHash:t};localStorage.setItem(Gw,JSON.stringify(r))}catch(r){console.error("Error saving AI cache:",r)}}function vz(e){const{pillars:t,kpis:r,initiatives:n,projects:a,tasks:i,resources:s}=e,c=new Date,d=t.map(v=>{const b=r.filter(w=>w.pillarId===v.id),y=n.filter(w=>w.pillarId===v.id);return a.filter(w=>y.some(j=>j.id===w.initiativeId)),{name:v.name,description:v.description,ragStatus:v.ragStatus,kpis:b.map(w=>({name:w.name,current:w.currentValue,target:w.targetValue,previous:w.previousValue,unit:w.unit,achievement:Math.round(w.currentValue/w.targetValue*100),trend:w.currentValue>w.previousValue?"up":w.currentValue<w.previousValue?"down":"stable"})),initiativeCount:y.length,atRiskInitiatives:y.filter(w=>w.ragStatus!=="green").length,totalBudget:y.reduce((w,j)=>w+j.budget,0),spentBudget:y.reduce((w,j)=>w+j.spentBudget,0)}}),f=n.map(v=>{const b=a.filter(C=>C.initiativeId===v.id),y=i.filter(C=>b.some(E=>E.id===C.projectId)),w=t.find(C=>C.id===v.pillarId),j=s.find(C=>C.id===v.ownerId),T=Math.ceil((new Date(v.endDate).getTime()-c.getTime())/(1e3*60*60*24)),N=Math.round(v.spentBudget/v.budget*100);return{name:v.name,pillar:w?.name,ragStatus:v.ragStatus,owner:j?.name,startDate:v.startDate,endDate:v.endDate,daysRemaining:T,budget:v.budget,spentBudget:v.spentBudget,budgetUtilization:N,isOverBudget:v.spentBudget>v.budget,projectCount:b.length,redProjects:b.filter(C=>C.ragStatus==="red").length,amberProjects:b.filter(C=>C.ragStatus==="amber").length,totalTasks:y.length,completedTasks:y.filter(C=>C.kanbanStatus==="done").length,blockedTasks:y.filter(C=>C.kanbanStatus==="blocked").length}}),h=a.map(v=>{const b=i.filter(C=>C.projectId===v.id),y=n.find(C=>C.id===v.initiativeId),w=s.find(C=>C.id===v.managerId),j=Math.ceil((new Date(v.endDate).getTime()-c.getTime())/(1e3*60*60*24)),T=Math.round(v.spentBudget/v.budget*100),N=b.filter(C=>C.kanbanStatus!=="done"&&new Date(C.dueDate)<c).length;return{name:v.name,initiative:y?.name,ragStatus:v.ragStatus,status:v.status,manager:w?.name,completionPercentage:v.completionPercentage,daysRemaining:j,budget:v.budget,spentBudget:v.spentBudget,budgetUtilization:T,isOverBudget:v.spentBudget>v.budget,totalTasks:b.length,todoTasks:b.filter(C=>C.kanbanStatus==="todo").length,inProgressTasks:b.filter(C=>C.kanbanStatus==="in_progress").length,blockedTasks:b.filter(C=>C.kanbanStatus==="blocked").length,doneTasks:b.filter(C=>C.kanbanStatus==="done").length,overdueTasks:N}}),p=s.map(v=>{const b=i.filter(T=>T.assigneeId===v.id&&T.kanbanStatus!=="done"),y=b.reduce((T,N)=>T+N.estimatedHours,0),w=v.weeklyCapacity*4,j=Math.round(y/w*100);return{name:v.name,role:v.role,team:v.team,weeklyCapacity:v.weeklyCapacity,activeTasks:b.length,totalEstimatedHours:y,utilization:j,isOverloaded:j>100,blockedTasks:b.filter(T=>T.kanbanStatus==="blocked").length}}),g={totalPillars:t.length,greenPillars:t.filter(v=>v.ragStatus==="green").length,amberPillars:t.filter(v=>v.ragStatus==="amber").length,redPillars:t.filter(v=>v.ragStatus==="red").length,totalInitiatives:n.length,atRiskInitiatives:n.filter(v=>v.ragStatus!=="green").length,totalProjects:a.length,redProjects:a.filter(v=>v.ragStatus==="red").length,totalTasks:i.length,completedTasks:i.filter(v=>v.kanbanStatus==="done").length,blockedTasks:i.filter(v=>v.kanbanStatus==="blocked").length,overdueTasks:i.filter(v=>v.kanbanStatus!=="done"&&new Date(v.dueDate)<c).length,totalBudget:n.reduce((v,b)=>v+b.budget,0),totalSpent:n.reduce((v,b)=>v+b.spentBudget,0),overloadedResources:p.filter(v=>v.isOverloaded).length};return JSON.stringify({overview:g,pillars:d,initiatives:f,projects:h,resources:p,analysisDate:c.toISOString().split("T")[0]},null,2)}async function zI(e,t,r){const n=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:4096,system:t,messages:[{role:"user",content:r}]})});if(!n.ok){const i=await n.json();throw new Error(i.error?.message||"API request failed")}return(await n.json()).content[0].text}async function $I(e,t,r=!1){const n=pz(e);if(!r){const c=xz(n);if(c)return c}const a=vz(e),i=`You are an expert strategic advisor AI integrated into StratOS AI, an Integrated Strategy & Delivery Platform. Your role is to analyze organizational performance data following the Balanced Scorecard (BSC) framework and provide actionable insights.

The platform follows a "Golden Thread" hierarchy:
1. Strategy Pillars (BSC perspectives: Financial, Customer, Internal Processes, Learning & Growth)
2. Strategic KPIs (metrics tied to each pillar)
3. Initiatives (programs/portfolios linked to pillars)
4. Projects (execution vehicles linked to initiatives)
5. Tasks (granular work items linked to projects)
6. Resources (people with capacity tracking)

RAG Status meanings:
- Green: On track, meeting targets
- Amber: At risk, needs attention
- Red: Critical, immediate action required

Your analysis should:
- Identify patterns and correlations across the hierarchy
- Highlight risks that could cascade up to strategic goals
- Provide specific, actionable recommendations
- Consider resource constraints and budget utilization
- Focus on the "so what" - what should leadership do about it

Always respond with valid JSON matching the requested schema.`,s=`Analyze this organizational performance data and provide comprehensive insights:

${a}

Respond with a JSON object matching this exact schema:
{
  "executiveSummary": {
    "summary": "2-3 sentence high-level summary for board/C-suite",
    "keyRisks": ["risk1", "risk2", "risk3"],
    "opportunities": ["opportunity1", "opportunity2"],
    "recommendations": ["recommendation1", "recommendation2", "recommendation3"]
  },
  "pillarInsights": [
    {
      "pillarId": "pillar-1",
      "insight": "Specific insight about this pillar's performance",
      "trend": "improving|declining|stable",
      "riskLevel": "low|medium|high"
    }
  ],
  "projectSuggestions": [
    {
      "projectId": "proj-X",
      "suggestion": "Specific suggestion for this project",
      "priority": "low|medium|high|critical",
      "actionItems": ["action1", "action2"]
    }
  ],
  "resourceAlerts": [
    {
      "resourceId": "res-X",
      "alert": "Alert message about this resource",
      "utilizationRisk": "underutilized|optimal|overloaded|critical"
    }
  ],
  "insights": [
    {
      "id": "insight-1",
      "type": "critical|warning|success|info",
      "title": "Short title",
      "description": "Detailed description",
      "affectedEntities": [{"type": "initiative|project|pillar", "id": "id", "name": "name"}],
      "suggestedAction": "What to do about it",
      "link": "/portfolio or /strategy or /execution"
    }
  ]
}

Focus on:
1. Cross-pillar correlations (e.g., Learning & Growth issues impacting other pillars)
2. Budget risks and burn rates
3. Resource bottlenecks
4. Blocked tasks and their upstream impact
5. Projects at risk of missing deadlines
6. KPIs trending away from targets

Provide at least 5-8 insights covering different severity levels.`;try{const d=(await zI(t,i,s)).match(/\{[\s\S]*\}/);if(!d)throw new Error("Invalid JSON response from AI");const h={...JSON.parse(d[0]),generatedAt:new Date().toISOString()};return gz(h,n),h}catch(c){throw console.error("AI analysis error:",c),c}}async function yz(e,t,r){const n=e.projects.find(v=>v.id===t);if(!n)throw new Error("Project not found");const a=e.initiatives.find(v=>v.id===n.initiativeId),i=e.tasks.filter(v=>v.projectId===t),s=e.resources,c=new Date,d={project:{name:n.name,description:n.description,ragStatus:n.ragStatus,status:n.status,completionPercentage:n.completionPercentage,budget:n.budget,spentBudget:n.spentBudget,daysRemaining:Math.ceil((new Date(n.endDate).getTime()-c.getTime())/(1e3*60*60*24))},initiative:a?{name:a.name,ragStatus:a.ragStatus}:null,tasks:{total:i.length,todo:i.filter(v=>v.kanbanStatus==="todo").length,inProgress:i.filter(v=>v.kanbanStatus==="in_progress").length,blocked:i.filter(v=>v.kanbanStatus==="blocked").length,done:i.filter(v=>v.kanbanStatus==="done").length,overdue:i.filter(v=>v.kanbanStatus!=="done"&&new Date(v.dueDate)<c).length},teamUtilization:i.filter(v=>v.kanbanStatus!=="done").reduce((v,b)=>{const y=s.find(w=>w.id===b.assigneeId);if(y&&!v.find(w=>w.name===y.name)){const j=i.filter(T=>T.assigneeId===y.id&&T.kanbanStatus!=="done").reduce((T,N)=>T+N.estimatedHours,0);v.push({name:y.name,role:y.role,utilization:Math.round(j/(y.weeklyCapacity*4)*100)})}return v},[])},f="You are an AI project advisor. Analyze project data and provide a concise, actionable suggestion. Focus on the most impactful issue and how to resolve it.",h=`Analyze this project and provide a suggestion:

${JSON.stringify(d,null,2)}

Respond with JSON:
{
  "projectId": "${t}",
  "suggestion": "Concise suggestion (1-2 sentences)",
  "priority": "low|medium|high|critical",
  "actionItems": ["specific action 1", "specific action 2"]
}`,g=(await zI(r,f,h)).match(/\{[\s\S]*\}/);if(!g)throw new Error("Invalid JSON response");return JSON.parse(g[0])}function HI(){localStorage.removeItem(Gw)}function VI(){const e=localStorage.getItem("stratos-ai-api-key");return!!e&&e.length>0}function Sp(){return localStorage.getItem("stratos-ai-api-key")}function PT(e){localStorage.setItem("stratos-ai-api-key",e)}function bz(){localStorage.removeItem("stratos-ai-api-key"),HI()}async function wz(e,t,r,n){const a=Sp();if(!a)throw new Error("API key not configured");const i=`You are an AI assistant integrated into StratOS AI, a strategic planning and execution platform. You help users with:

1. Understanding Balanced Scorecard (BSC) methodology
2. Designing KPIs for their strategic objectives
3. Creating and managing initiatives and projects
4. Analyzing performance and identifying risks
5. Best practices for strategy execution

Context about the user's current state:
${t.currentPage?`- Currently viewing: ${t.currentPage}`:""}
${t.selectedPillar?`- Selected pillar: ${t.selectedPillar}`:""}
${t.selectedProject?`- Selected project: ${t.selectedProject}`:""}
${t.recentActions?.length?`- Recent actions: ${t.recentActions.join(", ")}`:""}

Be helpful, concise, and actionable. If the user asks about creating KPIs or WBS, explain that you can generate suggestions for them using the dedicated tools in the app.`,s=[...r.map(f=>({role:f.role,content:f.content})),{role:"user",content:e}],c=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":a,"anthropic-version":"2023-06-01","anthropic-dangerous-direct-browser-access":"true"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:1024,system:i,messages:s})});if(!c.ok){const f=await c.json();throw new Error(f.error?.message||"API request failed")}return(await c.json()).content[0].text}const GI={charter:{enforceOnImport:!1,minimumCompletenessScore:0,requiredSections:{processDiagrams:!1,costBenefits:!1,goals:!1,metrics:!1,scope:!1,projectTeam:!1,operationsTeam:!1,controls:!1,policies:!1,dataSpecifications:!1}},fields:{treatWarningsAsErrors:!1,additionalRequired:{project:[],task:[],initiative:[],resource:[],kpi:[],milestone:[]}},references:{allowFuzzyMatching:!0,fuzzyMatchThreshold:70,createMissingReferences:!1},businessRules:{enforceProjectDateRange:!0,enforceBudgetPositive:!0,enforceCompletionRange:!0,rejectOverdueTasks:!1,rejectOverBudgetInitiatives:!1}},M0={enabled:!0,weights:{schedule:.25,cost:.25,scope:.2,resource:.15,quality:.15},thresholds:{spi:{good:.95,warning:.85,critical:.7},cpi:{good:.95,warning:.85,critical:.7},budgetVariance:{good:5,warning:15,critical:25},overdueRatio:{good:.05,warning:.15,critical:.3},blockedRatio:{good:.05,warning:.1,critical:.2},resourceUtilization:{good:90,warning:110,critical:130}},riskLevels:{low:25,medium:50,high:75}},Ww={enabled:!0,categories:{schedule:!0,cost:!0,scope:!0,resource:!0,strategic:!0,success:!0},thresholds:{schedule:{spiWarning:.9,spiCritical:.8,overdueTasksWarning:.1,overdueTasksCritical:.25,daysToDeadlineWarning:14,daysToDeadlineCritical:7},cost:{cpiWarning:.9,cpiCritical:.8,budgetVarianceWarning:10,budgetVarianceCritical:25,burnRateWarning:1.1,burnRateCritical:1.3},scope:{completionGapWarning:15,completionGapCritical:30,blockedRatioWarning:.1,blockedRatioCritical:.2},resource:{utilizationWarning:100,utilizationCritical:120,unassignedTasksWarning:.1},strategic:{atRiskInitiativesWarning:.25,atRiskInitiativesCritical:.5,pillarImbalanceThreshold:.4}}},qw={enabled:!0,gateMinimums:{idea:60,business_case:70,planning:75,execution:80,closure:70},categoryWeights:{strategic:20,financial:20,technical:15,resource:15,risk:15,governance:10,delivery:5},charterWeights:{processDiagrams:{asIs:5,toBe:10},costBenefits:{tangible:12,intangible:8},controls:8,goals:12,metrics:10,policies:5,projectTeam:10,operationsTeam:5,scope:{inScope:6,outOfScope:4},dataSpecifications:5},recommendations:{conditionalThresholdOffset:10,deferMinimumScore:40,deferMaxBlockers:2}},Sz={percentage:{greenThreshold:95,amberThreshold:80},budget:{amberThreshold:5,redThreshold:15},progress:{greenVariance:-5,amberVariance:-15}},Nz={aiInsights:!0,ruleBasedInsights:!0,riskScoring:!0,approvalFramework:!0,charterTracking:!0,smartImport:!0,fuzzyMatching:!0,autoEntityDetection:!0,executiveSummary:!0,trendAnalysis:!0,recommendations:!0},P0={version:"1.0.0",lastUpdated:new Date().toISOString(),import:GI,riskScore:M0,insights:Ww,approval:qw,rag:Sz,features:Nz},a1={strict:{name:"strict",label:"Strict (Enterprise)",description:"Full enforcement with charter requirements and strict validation"},standard:{name:"standard",label:"Standard",description:"Balanced settings for most organizations"},lenient:{name:"lenient",label:"Lenient (Startup)",description:"Minimal enforcement for agile teams"},custom:{name:"custom",label:"Custom",description:"User-defined configuration"}},kz={...P0,import:{charter:{enforceOnImport:!0,minimumCompletenessScore:70,requiredSections:{processDiagrams:!1,costBenefits:!0,goals:!0,metrics:!0,scope:!0,projectTeam:!0,operationsTeam:!1,controls:!1,policies:!1,dataSpecifications:!1}},fields:{treatWarningsAsErrors:!0,additionalRequired:{project:["baselineEndDate","riskExposure"],task:["estimatedHours"],initiative:[],resource:["hourlyRate"],kpi:[],milestone:[]}},references:{allowFuzzyMatching:!1,fuzzyMatchThreshold:90,createMissingReferences:!1},businessRules:{enforceProjectDateRange:!0,enforceBudgetPositive:!0,enforceCompletionRange:!0,rejectOverdueTasks:!0,rejectOverBudgetInitiatives:!0}},approval:{...qw,gateMinimums:{idea:70,business_case:80,planning:85,execution:90,closure:80}}},_z={...P0,import:{charter:{enforceOnImport:!1,minimumCompletenessScore:0,requiredSections:{processDiagrams:!1,costBenefits:!1,goals:!1,metrics:!1,scope:!1,projectTeam:!1,operationsTeam:!1,controls:!1,policies:!1,dataSpecifications:!1}},fields:{treatWarningsAsErrors:!1,additionalRequired:{project:[],task:[],initiative:[],resource:[],kpi:[],milestone:[]}},references:{allowFuzzyMatching:!0,fuzzyMatchThreshold:50,createMissingReferences:!0},businessRules:{enforceProjectDateRange:!1,enforceBudgetPositive:!1,enforceCompletionRange:!1,rejectOverdueTasks:!1,rejectOverBudgetInitiatives:!1}},approval:{...qw,gateMinimums:{idea:50,business_case:60,planning:65,execution:70,closure:60}}};function jz(e){switch(e){case"strict":return{...kz,lastUpdated:new Date().toISOString()};case"lenient":return{..._z,lastUpdated:new Date().toISOString()};default:return{...P0,lastUpdated:new Date().toISOString()}}}function FT(e){return e.import.charter.enforceOnImport&&e.import.charter.minimumCompletenessScore>=70&&e.import.fields.treatWarningsAsErrors&&!e.import.references.allowFuzzyMatching?"strict":!e.import.charter.enforceOnImport&&e.import.references.fuzzyMatchThreshold<=50&&e.import.references.createMissingReferences&&!e.import.businessRules.enforceProjectDateRange?"lenient":!e.import.charter.enforceOnImport&&e.import.references.allowFuzzyMatching&&e.import.references.fuzzyMatchThreshold===70&&e.import.businessRules.enforceProjectDateRange?"standard":"custom"}function Ez(e){const t=e.schedule+e.cost+e.scope+e.resource+e.quality;return Math.abs(t-1)<.001}function Tz(e){const t=e.schedule+e.cost+e.scope+e.resource+e.quality;return t===0?M0.weights:{schedule:e.schedule/t,cost:e.cost/t,scope:e.scope/t,resource:e.resource/t,quality:e.quality/t}}const F0=Ww.thresholds;function Sr(){return`insight-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}function w2(e,t){return Math.round((t.getTime()-e.getTime())/864e5)}function Kw(e,t){const r=new Date(e),n=new Date(t),a=new Date,i=w2(r,n);if(i<=0)return 100;const s=w2(r,a);return Math.min(100,Math.max(0,s/i*100))}function Cz(e,t,r,n=F0.schedule){const a=[],i=new Date;e.forEach(f=>{const h=t.filter(b=>b.initiativeId===f.id),p=h.length>0?h.reduce((b,y)=>b+y.completionPercentage,0)/h.length:0,g=Kw(f.startDate,f.endDate),v=g>0?p/g:1;v<n.spiCritical?a.push({id:Sr(),category:"schedule",severity:"critical",title:`${f.name} critically behind schedule`,description:`Schedule Performance Index is ${(v*100).toFixed(0)}% - only ${p.toFixed(0)}% complete with ${g.toFixed(0)}% of timeline elapsed.`,ruleName:"SPI_CRITICAL",affectedEntities:[{type:"initiative",id:f.id,name:f.name}],suggestedAction:"Immediately review scope, add resources, or adjust timeline. Consider executive escalation.",link:"/portfolio",metrics:{spi:v,avgCompletion:p,timeElapsed:g},generatedAt:i.toISOString()}):v<n.spiWarning&&a.push({id:Sr(),category:"schedule",severity:"warning",title:`${f.name} falling behind schedule`,description:`Schedule Performance Index is ${(v*100).toFixed(0)}% - tracking slightly behind plan.`,ruleName:"SPI_WARNING",affectedEntities:[{type:"initiative",id:f.id,name:f.name}],suggestedAction:"Review blockers and consider resource reallocation.",link:"/portfolio",metrics:{spi:v},generatedAt:i.toISOString()})});const s=r.filter(f=>f.kanbanStatus!=="done"),c=s.filter(f=>new Date(f.dueDate)<i),d=s.length>0?c.length/s.length:0;return d>n.overdueTasksCritical?a.push({id:Sr(),category:"schedule",severity:"critical",title:`${c.length} tasks overdue (${(d*100).toFixed(0)}%)`,description:`Critical: ${(d*100).toFixed(0)}% of active tasks are past their due date. This indicates systemic schedule issues.`,ruleName:"OVERDUE_TASKS_CRITICAL",affectedEntities:c.slice(0,5).map(f=>({type:"task",id:f.id,name:f.title})),suggestedAction:"Conduct task triage session. Reprioritize or reassign overdue work. Update unrealistic due dates.",link:"/execution",metrics:{overdueTasks:c.length,overdueRatio:d},generatedAt:i.toISOString()}):d>n.overdueTasksWarning&&a.push({id:Sr(),category:"schedule",severity:"warning",title:`${c.length} tasks overdue`,description:`${(d*100).toFixed(0)}% of active tasks are past their due date.`,ruleName:"OVERDUE_TASKS_WARNING",affectedEntities:c.slice(0,3).map(f=>({type:"task",id:f.id,name:f.title})),suggestedAction:"Review overdue tasks and update timelines or reassign.",link:"/execution",metrics:{overdueTasks:c.length,overdueRatio:d},generatedAt:i.toISOString()}),t.forEach(f=>{if(f.status==="completed"||f.status==="cancelled")return;const h=w2(i,new Date(f.endDate));h>0&&h<=n.daysToDeadlineCritical&&f.completionPercentage<80?a.push({id:Sr(),category:"schedule",severity:"critical",title:`${f.name} deadline in ${h} days`,description:`Only ${f.completionPercentage}% complete with ${h} days remaining. High risk of missing deadline.`,ruleName:"DEADLINE_CRITICAL",affectedEntities:[{type:"project",id:f.id,name:f.name}],suggestedAction:"Evaluate scope cut options or timeline extension. Mobilize additional resources.",link:"/execution",metrics:{daysRemaining:h,completionPercentage:f.completionPercentage},generatedAt:i.toISOString()}):h>0&&h<=n.daysToDeadlineWarning&&f.completionPercentage<70&&a.push({id:Sr(),category:"schedule",severity:"warning",title:`${f.name} deadline approaching`,description:`${h} days remaining with ${f.completionPercentage}% completion.`,ruleName:"DEADLINE_WARNING",affectedEntities:[{type:"project",id:f.id,name:f.name}],suggestedAction:"Accelerate delivery or prepare stakeholders for potential delay.",link:"/execution",metrics:{daysRemaining:h,completionPercentage:f.completionPercentage},generatedAt:i.toISOString()})}),a}function Az(e,t,r=F0.cost){const n=[],a=new Date;e.forEach(s=>{const c=s.budget>0?(s.spentBudget-s.budget)/s.budget*100:0;c>r.budgetVarianceCritical?n.push({id:Sr(),category:"cost",severity:"critical",title:`${s.name} ${c.toFixed(0)}% over budget`,description:`Budget overrun of $${(s.spentBudget-s.budget).toLocaleString()}. Immediate financial review required.`,ruleName:"BUDGET_CRITICAL",affectedEntities:[{type:"initiative",id:s.id,name:s.name}],suggestedAction:"Freeze non-essential spending. Request budget increase or reduce scope.",link:"/portfolio",metrics:{variance:c,spent:s.spentBudget,budget:s.budget},generatedAt:a.toISOString()}):c>r.budgetVarianceWarning&&n.push({id:Sr(),category:"cost",severity:"warning",title:`${s.name} trending over budget`,description:`${c.toFixed(0)}% over allocated budget. Monitor spending closely.`,ruleName:"BUDGET_WARNING",affectedEntities:[{type:"initiative",id:s.id,name:s.name}],suggestedAction:"Review remaining commitments and identify cost savings.",link:"/portfolio",metrics:{variance:c},generatedAt:a.toISOString()})}),e.forEach(s=>{const c=t.filter(p=>p.initiativeId===s.id),d=c.length>0?c.reduce((p,g)=>p+g.completionPercentage,0)/c.length:0,f=s.budget>0?s.spentBudget/s.budget*100:0,h=f>0?d/f:1;h<r.cpiCritical&&f>20&&n.push({id:Sr(),category:"cost",severity:"critical",title:`${s.name} poor cost efficiency`,description:`Cost Performance Index is ${(h*100).toFixed(0)}% - getting ${d.toFixed(0)}% value for ${f.toFixed(0)}% of budget spent.`,ruleName:"CPI_CRITICAL",affectedEntities:[{type:"initiative",id:s.id,name:s.name}],suggestedAction:"Analyze cost drivers. Consider value engineering or vendor renegotiation.",link:"/portfolio",metrics:{cpi:h,avgCompletion:d,budgetSpentPercent:f},generatedAt:a.toISOString()})});const i=t.filter(s=>s.spentBudget>s.budget);if(i.length>0){const s=i.reduce((c,d)=>c+(d.spentBudget-d.budget),0);n.push({id:Sr(),category:"cost",severity:i.length>2?"critical":"warning",title:`${i.length} project(s) over budget`,description:`Total overrun of $${s.toLocaleString()} across ${i.length} projects.`,ruleName:"PROJECTS_OVER_BUDGET",affectedEntities:i.slice(0,3).map(c=>({type:"project",id:c.id,name:c.name})),suggestedAction:"Review project budgets and identify root causes of overruns.",link:"/portfolio",metrics:{count:i.length,totalOverrun:s},generatedAt:a.toISOString()})}return n}function Oz(e,t,r,n=F0.scope){const a=[],i=new Date,s=r.filter(f=>f.kanbanStatus!=="done"),c=r.filter(f=>f.kanbanStatus==="blocked"),d=s.length>0?c.length/s.length:0;return d>n.blockedRatioCritical?a.push({id:Sr(),category:"scope",severity:"critical",title:`${c.length} tasks blocked (${(d*100).toFixed(0)}%)`,description:"High number of blocked tasks indicates systemic impediments affecting delivery.",ruleName:"BLOCKED_CRITICAL",affectedEntities:c.slice(0,5).map(f=>({type:"task",id:f.id,name:f.title})),suggestedAction:"Conduct blocker resolution session. Escalate persistent impediments to leadership.",link:"/execution",metrics:{blockedTasks:c.length,blockedRatio:d},generatedAt:i.toISOString()}):d>n.blockedRatioWarning&&a.push({id:Sr(),category:"scope",severity:"warning",title:`${c.length} tasks blocked`,description:`${(d*100).toFixed(0)}% of active work is blocked.`,ruleName:"BLOCKED_WARNING",affectedEntities:c.slice(0,3).map(f=>({type:"task",id:f.id,name:f.title})),suggestedAction:"Review and resolve blockers in daily standup.",link:"/execution",metrics:{blockedTasks:c.length},generatedAt:i.toISOString()}),t.forEach(f=>{if(f.status==="completed"||f.status==="cancelled"||f.status==="not_started")return;const h=Kw(f.startDate,f.endDate),p=h-f.completionPercentage;p>n.completionGapCritical&&h>30&&a.push({id:Sr(),category:"scope",severity:"critical",title:`${f.name} significantly behind on delivery`,description:`${f.completionPercentage}% complete with ${h.toFixed(0)}% of timeline used. Gap of ${p.toFixed(0)}%.`,ruleName:"COMPLETION_GAP_CRITICAL",affectedEntities:[{type:"project",id:f.id,name:f.name}],suggestedAction:"Re-baseline project plan or reduce scope to meet timeline.",link:"/execution",metrics:{completionPercentage:f.completionPercentage,timeElapsed:h,gap:p},generatedAt:i.toISOString()})}),a}function Dz(e,t,r=F0.resource){const n=[],a=new Date,i=new Map;e.forEach(h=>{if(h.kanbanStatus==="done")return;const p=t.find(v=>v.id===h.assigneeId);if(!p)return;const g=i.get(h.assigneeId);g?(g.totalHours+=h.estimatedHours||0,g.taskCount++,g.projectIds.add(h.projectId)):i.set(h.assigneeId,{resource:p,totalHours:h.estimatedHours||0,taskCount:1,projectIds:new Set([h.projectId])})});const s=[];if(i.forEach(({resource:h,totalHours:p})=>{const g=h.weeklyCapacity*4,v=g>0?p/g*100:0;v>r.utilizationCritical&&s.push({resource:h,utilization:v})}),s.length>0){const h=s.length>2?"critical":"warning";n.push({id:Sr(),category:"resource",severity:h,title:`${s.length} team member(s) over-allocated`,description:`${s.map(p=>`${p.resource.name} (${p.utilization.toFixed(0)}%)`).join(", ")} exceeding capacity.`,ruleName:"RESOURCE_OVERALLOCATED",affectedEntities:s.map(p=>({type:"resource",id:p.resource.id,name:p.resource.name})),suggestedAction:"Redistribute work or delay lower priority tasks. Consider temporary resources.",link:"/resources",metrics:{overAllocatedCount:s.length},generatedAt:a.toISOString()})}const c=[];i.forEach(({resource:h,projectIds:p})=>{(p.size>=4||h.isKeyResource&&p.size>=3)&&c.push({resource:h,projectCount:p.size})}),c.length>0&&n.push({id:Sr(),category:"resource",severity:"warning",title:"Key person dependency risk",description:`${c.map(h=>`${h.resource.name} (${h.projectCount} projects)`).join(", ")} represent single points of failure.`,ruleName:"KEY_PERSON_RISK",affectedEntities:c.map(h=>({type:"resource",id:h.resource.id,name:h.resource.name})),suggestedAction:"Cross-train team members. Document critical knowledge. Consider backup resources.",link:"/resources",metrics:{keyPersonCount:c.length},generatedAt:a.toISOString()});const d=e.filter(h=>h.kanbanStatus!=="done"&&(!h.assigneeId||!t.find(p=>p.id===h.assigneeId))),f=e.filter(h=>h.kanbanStatus!=="done").length>0?d.length/e.filter(h=>h.kanbanStatus!=="done").length:0;return f>r.unassignedTasksWarning&&d.length>2&&n.push({id:Sr(),category:"resource",severity:"warning",title:`${d.length} tasks without owners`,description:`${(f*100).toFixed(0)}% of active tasks are unassigned.`,ruleName:"UNASSIGNED_TASKS",affectedEntities:d.slice(0,5).map(h=>({type:"task",id:h.id,name:h.title})),suggestedAction:"Assign owners to all tasks during sprint planning.",link:"/execution",metrics:{unassignedCount:d.length,unassignedRatio:f},generatedAt:a.toISOString()}),n}function Iz(e,t,r=F0.strategic){const n=[],a=new Date;e.filter(h=>h.ragStatus==="red").forEach(h=>{n.push({id:Sr(),category:"strategic",severity:"critical",title:`${h.name} pillar in critical status`,description:"Strategic pillar marked as Red. Review linked KPIs and initiatives for root cause.",ruleName:"PILLAR_CRITICAL",affectedEntities:[{type:"pillar",id:h.id,name:h.name}],suggestedAction:"Convene strategic review. Assess if initiatives are addressing root causes.",link:"/strategy",generatedAt:a.toISOString()})});const s=t.filter(h=>h.ragStatus==="red"||h.ragStatus==="amber"),c=t.length>0?s.length/t.length:0;c>r.atRiskInitiativesCritical?n.push({id:Sr(),category:"strategic",severity:"critical",title:`${(c*100).toFixed(0)}% of initiatives at risk`,description:`${s.length} of ${t.length} initiatives are in Red or Amber status. Portfolio health is compromised.`,ruleName:"PORTFOLIO_AT_RISK_CRITICAL",affectedEntities:s.slice(0,5).map(h=>({type:"initiative",id:h.id,name:h.name})),suggestedAction:"Executive portfolio review required. Consider initiative consolidation or termination.",link:"/portfolio",metrics:{atRiskCount:s.length,atRiskRatio:c},generatedAt:a.toISOString()}):c>r.atRiskInitiativesWarning&&n.push({id:Sr(),category:"strategic",severity:"warning",title:`${s.length} initiatives at risk`,description:`${(c*100).toFixed(0)}% of portfolio showing risk indicators.`,ruleName:"PORTFOLIO_AT_RISK_WARNING",affectedEntities:s.slice(0,3).map(h=>({type:"initiative",id:h.id,name:h.name})),suggestedAction:"Review at-risk initiatives in PMO meeting.",link:"/portfolio",metrics:{atRiskCount:s.length},generatedAt:a.toISOString()});const d=e.map(h=>{const g=t.filter(v=>v.pillarId===h.id).reduce((v,b)=>v+b.budget,0);return{pillar:h,totalBudget:g}}),f=d.reduce((h,p)=>h+p.totalBudget,0);return d.forEach(({pillar:h,totalBudget:p})=>{const g=f>0?p/f:0;g>r.pillarImbalanceThreshold&&e.length>2&&n.push({id:Sr(),category:"strategic",severity:"info",title:`Budget concentration in ${h.name}`,description:`${(g*100).toFixed(0)}% of portfolio budget allocated to one strategic pillar.`,ruleName:"BUDGET_CONCENTRATION",affectedEntities:[{type:"pillar",id:h.id,name:h.name}],suggestedAction:"Review if budget distribution aligns with strategic priorities.",link:"/strategy",metrics:{budgetShare:g,totalBudget:p},generatedAt:a.toISOString()})}),n}function Rz(e,t,r){const n=[],a=new Date;e.forEach(d=>{const f=t.filter(b=>b.initiativeId===d.id);if(f.length===0)return;const h=f.reduce((b,y)=>b+y.completionPercentage,0)/f.length,p=Kw(d.startDate,d.endDate),g=p>0?h/p:1,v=d.budget>0?(d.spentBudget-d.budget)/d.budget*100:0;g>=1.1&&v<=0&&d.ragStatus==="green"&&n.push({id:Sr(),category:"strategic",severity:"success",title:`${d.name} exceeding expectations`,description:`Ahead of schedule (SPI ${(g*100).toFixed(0)}%) and under budget. Consider as model for other initiatives.`,ruleName:"HIGH_PERFORMER",affectedEntities:[{type:"initiative",id:d.id,name:d.name}],suggestedAction:"Document success factors. Share best practices with other teams.",link:"/portfolio",metrics:{spi:g,budgetVariance:v},generatedAt:a.toISOString()})});const i=t.filter(d=>d.completionPercentage>=85&&d.status==="in_progress"&&d.ragStatus!=="red");i.length>0&&n.push({id:Sr(),category:"scope",severity:"success",title:`${i.length} project(s) nearing completion`,description:`${i.map(d=>d.name).join(", ")} are 85%+ complete.`,ruleName:"NEAR_COMPLETION",affectedEntities:i.slice(0,3).map(d=>({type:"project",id:d.id,name:d.name})),suggestedAction:"Prepare for project closure. Plan benefits realization tracking.",link:"/execution",generatedAt:a.toISOString()});const s=r.filter(d=>d.kanbanStatus==="done").length,c=r.length>0?s/r.length:0;return c>.6&&r.length>=10&&n.push({id:Sr(),category:"scope",severity:"success",title:"Strong task completion rate",description:`${(c*100).toFixed(0)}% of tasks completed. Team is maintaining good velocity.`,ruleName:"HIGH_COMPLETION_RATE",affectedEntities:[],link:"/execution",metrics:{completedTasks:s,completionRate:c},generatedAt:a.toISOString()}),n}function Mz(e,t){const{pillars:r,initiatives:n,projects:a,tasks:i,resources:s}=e,c=Ww,d=c.thresholds,f=c.categories;if(!c.enabled)return[];const h=[];f.schedule&&h.push(...Cz(n,a,i,d.schedule)),f.cost&&h.push(...Az(n,a,d.cost)),f.scope&&h.push(...Oz(n,a,i,d.scope)),f.resource&&h.push(...Dz(i,s,d.resource)),f.strategic&&h.push(...Iz(r,n,d.strategic)),f.success&&h.push(...Rz(n,a,i));const p={critical:0,warning:1,info:2,success:3};return h.sort((g,v)=>{const b=p[g.severity]-p[v.severity];return b!==0?b:g.category.localeCompare(v.category)})}function Pz(e){return{critical:e.filter(t=>t.severity==="critical").length,warning:e.filter(t=>t.severity==="warning").length,info:e.filter(t=>t.severity==="info").length,success:e.filter(t=>t.severity==="success").length}}function Fz(e){const t=Pz(e),r=e.filter(f=>f.severity==="critical"),n=e.filter(f=>f.severity==="warning"),a=e.filter(f=>f.severity==="success");if(e.length===0)return{summary:"",keyRisks:[],opportunities:[],recommendations:[]};let i="";t.critical>0?i=`Portfolio requires immediate attention with ${t.critical} critical issue(s). `:t.warning>3?i=`Portfolio showing multiple warning signs (${t.warning} items). `:t.success>t.warning?i=`Portfolio is performing well with ${t.success} positive indicator(s). `:i="Portfolio is stable with minor items requiring attention. ",i+=`Total: ${t.critical} critical, ${t.warning} warnings, ${t.success} positive trends.`;const s=r.concat(n).slice(0,5).map(f=>f.title),c=a.slice(0,3).map(f=>f.title),d=r.concat(n).filter(f=>f.suggestedAction).slice(0,5).map(f=>f.suggestedAction);return{summary:i,keyRisks:s,opportunities:c,recommendations:d}}const WI=k.createContext(void 0),Lz=({children:e})=>{const{state:t}=Pt(),[r,n]=k.useState(!1),[a,i]=k.useState(!1),[s,c]=k.useState(null),[d,f]=k.useState(null),[h,p]=k.useState(null),[g,v]=k.useState({}),b=k.useMemo(()=>Mz(t),[t]),y=k.useMemo(()=>Fz(b),[b]);k.useEffect(()=>{const P=()=>{n(VI())};return P(),window.addEventListener("focus",P),()=>window.removeEventListener("focus",P)},[]),k.useEffect(()=>{if(!r||a)return;const P=setTimeout(()=>{w(!1)},1e3);return()=>clearTimeout(P)},[t,r]);const w=k.useCallback(async(P=!1)=>{const R=Sp();if(!R){n(!1);return}i(!0),c(null);try{const L=await $I(t,R,P);f(L),p(L.generatedAt),n(!0)}catch(L){const te=L instanceof Error?L.message:"Analysis failed";c(te),console.error("AI analysis error:",L)}finally{i(!1)}},[t]),j=k.useCallback(async P=>{if(g[P])return g[P];const R=Sp();if(!R)return null;try{const L=await yz(t,P,R);return v(te=>({...te,[P]:L})),L}catch(L){return console.error("Project insight error:",L),null}},[t,g]),T=k.useCallback(()=>{c(null)},[]),N=k.useCallback(()=>d?d.executiveSummary.summary:y.summary?y.summary:O(),[d,y]),C=k.useCallback(P=>d&&d.pillarInsights.find(L=>L.pillarId===P)?.insight||A(P),[d]),E=k.useCallback(P=>{if(d){const R=d.projectSuggestions.find(L=>L.projectId===P);if(R)return R.suggestion}return g[P]?g[P].suggestion:D(P)},[d,g]);function O(){const{pillars:P,initiatives:R,projects:L,tasks:te}=t;if(P.length===0&&R.length===0&&L.length===0)return"";const ee=P.filter(K=>K.ragStatus==="red").length,ue=te.filter(K=>K.kanbanStatus==="blocked").length,V=R.filter(K=>K.ragStatus!=="green").length;return ee>0?`${ee} strategic pillar(s) are in critical status requiring immediate attention. ${V} initiatives are at risk. Configure Claude API in Settings to enable AI-powered insights.`:V>0?`${V} initiative(s) are showing risk indicators. ${ue} tasks are currently blocked. Configure Claude API for detailed AI analysis.`:`Overall strategic health is stable with ${P.filter(K=>K.ragStatus==="green").length} of ${P.length} pillars on track. Configure Claude API in Settings for AI-powered insights.`}function A(P){const R=t.pillars.find(V=>V.id===P),L=t.kpis.filter(V=>V.pillarId===P),te=t.initiatives.filter(V=>V.pillarId===P);if(!R)return"Pillar data not available.";const ee=L.filter(V=>V.currentValue<V.targetValue).length,ue=te.filter(V=>V.ragStatus!=="green").length;return R.ragStatus==="red"?`Critical: ${ee} KPI(s) below target. ${ue} initiative(s) at risk.`:R.ragStatus==="amber"?`Monitor: ${ee} KPI(s) trending below target. Review resource allocation.`:`On track with ${L.filter(V=>V.currentValue>=V.targetValue).length}/${L.length} KPIs meeting targets.`}function D(P){const R=t.projects.find(K=>K.id===P),L=t.tasks.filter(K=>K.projectId===P);if(!R)return null;const te=[],ee=L.filter(K=>K.kanbanStatus==="blocked").length,ue=L.filter(K=>K.kanbanStatus!=="done"&&new Date(K.dueDate)<new Date).length,V=R.budget>0?Math.round(R.spentBudget/R.budget*100):0;return ee>0&&te.push(`${ee} blocked task(s) need resolution`),ue>0&&te.push(`${ue} task(s) are overdue`),V>90&&te.push(`Budget ${V}% utilized`),R.ragStatus==="red"&&new Date(R.endDate)<new Date&&te.push("Project is past end date"),(R.ragStatus==="amber"||R.ragStatus==="red")&&R.completionPercentage<50&&new Date(R.endDate)<new Date(Date.now()+720*60*60*1e3)&&te.push("Low completion with deadline approaching"),te.length===0?null:te.join(". ")+"."}const M={isConfigured:r,isLoading:a,error:s,analysis:d,lastUpdated:h,ruleBasedInsights:b,ruleBasedSummary:y,refreshAnalysis:w,getProjectSuggestion:j,clearError:T,getExecutiveSummary:N,getPillarInsight:C,getProjectAISuggestion:E};return o.jsx(WI.Provider,{value:M,children:e})},Yw=()=>{const e=k.useContext(WI);if(!e)throw new Error("useAI must be used within an AIProvider");return e},qI="stratos-ai-config",Bz="1.0.0";function LT(){try{const e=localStorage.getItem(qI);if(e){const t=JSON.parse(e);if(t.version===Bz)return t;console.warn("Config version mismatch, using defaults")}}catch(e){console.error("Failed to load config:",e)}return{...P0,lastUpdated:new Date().toISOString()}}function Uz(e){try{const t={...e,lastUpdated:new Date().toISOString()};localStorage.setItem(qI,JSON.stringify(t))}catch(t){console.error("Failed to save config:",t)}}const KI=k.createContext(void 0),zz=({children:e})=>{const[t,r]=k.useState(LT),[n,a]=k.useState(()=>FT(LT()));k.useEffect(()=>{Uz(t),a(FT(t))},[t]);const i=k.useCallback(T=>{r(N=>({...N,...T}))},[]),s=k.useCallback(T=>{r(N=>({...N,import:{...N.import,...T}}))},[]),c=k.useCallback(T=>{r(N=>{const C={...N.riskScore,...T};return T.weights&&!Ez(C.weights)&&(C.weights=Tz(C.weights)),{...N,riskScore:C}})},[]),d=k.useCallback(T=>{r(N=>({...N,insights:{...N.insights,...T}}))},[]),f=k.useCallback(T=>{r(N=>({...N,approval:{...N.approval,...T}}))},[]),h=k.useCallback(T=>{r(N=>({...N,rag:{...N.rag,...T}}))},[]),p=k.useCallback(T=>{r(N=>({...N,features:{...N.features,...T}}))},[]),g=k.useCallback(T=>{const N=jz(T);r(N)},[]),v=k.useCallback(()=>{r({...P0,lastUpdated:new Date().toISOString()})},[]),b=k.useCallback(()=>JSON.stringify(t,null,2),[t]),y=k.useCallback(T=>{try{const N=JSON.parse(T);return!N.version||!N.import||!N.riskScore?(console.error("Invalid config format"),!1):(r({...N,lastUpdated:new Date().toISOString()}),!0)}catch(N){return console.error("Failed to import config:",N),!1}},[]),w=k.useCallback(T=>t.features[T],[t.features]),j={config:t,currentPreset:n,importEnforcement:t.import,riskScoreConfig:t.riskScore,insightsConfig:t.insights,approvalConfig:t.approval,ragConfig:t.rag,features:t.features,updateConfig:i,updateImportEnforcement:s,updateRiskScoreConfig:c,updateInsightsConfig:d,updateApprovalConfig:f,updateRAGConfig:h,updateFeatures:p,applyPreset:g,resetToDefaults:v,exportConfig:b,importConfigJson:y,isFeatureEnabled:w};return o.jsx(KI.Provider,{value:j,children:e})},$z=()=>{const e=k.useContext(KI);if(!e)throw new Error("useConfig must be used within a ConfigProvider");return e},i1="stratos-ai-selected-org",YI=k.createContext(void 0),Hz=({children:e})=>{const{state:t,getOrgUnit:r,getOrgUnitAncestors:n,getOrgUnitDescendants:a}=Pt(),[i,s]=k.useState(null);k.useEffect(()=>{try{const y=localStorage.getItem(i1);y&&(t.orgUnits||[]).some(j=>j.id===y)&&s(y)}catch(y){console.error("Error loading org selection:",y)}},[t.orgUnits]);const c=y=>{s(y);try{y?localStorage.setItem(i1,y):localStorage.removeItem(i1)}catch(w){console.error("Error saving org selection:",w)}},d=k.useMemo(()=>i?r(i):void 0,[i,r]),f=k.useMemo(()=>i?n(i):[],[i,n]),h=i!==null,p=k.useMemo(()=>d&&d.companyId||null,[d]),b={selectedOrgUnitId:i,setSelectedOrgUnitId:c,selectedOrgUnit:d,selectedOrgUnitAncestors:f,isFiltering:h,currentCompanyId:p,getFilteredOrgUnits:()=>{const y=t.orgUnits||[];if(!i)return y.filter(T=>T.isActive);const w=a(i);r(i);const j=new Set([i,...w.map(T=>T.id)]);return y.filter(T=>T.isActive&&j.has(T.id))},isOrgUnitVisible:y=>!i||y===i?!0:n(y).some(j=>j.id===i)};return o.jsx(YI.Provider,{value:b,children:e})},Xw=()=>{const e=k.useContext(YI);if(!e)throw new Error("useOrgContext must be used within an OrgProvider");return e},s1="stratos-ai-selected-corporate-entity",Vz=k.createContext(void 0),Gz=({children:e})=>{const{state:t,getCorporateEntity:r,getRootCorporation:n,getChildCorporateEntities:a,getSiblingCorporateEntities:i,getCorporateEntityAncestors:s,getCorporateEntityDescendants:c,getAllCompanies:d,getOrgUnitsForCompany:f}=Pt(),[h,p]=k.useState(null);k.useEffect(()=>{try{const N=localStorage.getItem(s1);N&&(t.corporateEntities||[]).some(E=>E.id===N)&&p(N)}catch(N){console.error("Error loading corporate entity selection:",N)}},[t.corporateEntities]);const g=N=>{p(N);try{N?localStorage.setItem(s1,N):localStorage.removeItem(s1)}catch(C){console.error("Error saving corporate entity selection:",C)}},v=k.useMemo(()=>h?r(h):void 0,[h,r]),b=k.useMemo(()=>h?s(h):[],[h,s]),T={selectedCorporateEntityId:h,setSelectedCorporateEntityId:g,getCorporateEntity:r,getRootCorporation:n,getChildEntities:N=>N===null?(t.corporateEntities||[]).filter(C=>!C.parentEntityId&&C.isActive):a(N),getSiblingEntities:i,getEntityAncestors:s,getEntityDescendants:c,getCompanies:d,getOrgUnitsForCompany:f,selectedEntity:v,selectedEntityAncestors:b,isFiltering:h!==null,calculateEntityMetrics:(N,C=!1)=>{const E=r(N);if(!E)return{entityId:N,totalInitiatives:0,totalProjects:0,totalTasks:0,greenCount:0,amberCount:0,redCount:0,totalBudget:0,totalActualSpend:0,budgetVariance:0,weightedRAG:"gray",childEntityCount:0,childCompanyCount:0};let O=[E],A=[];C&&(A=c(N),O=[...O,...A]);const D=new Set(O.map(G=>G.id)),M=(t.orgUnits||[]).filter(G=>D.has(G.companyId)),P=new Set(M.map(G=>G.id)),R=(t.pillars||[]).filter(G=>!G.orgUnitId||P.has(G.orgUnitId)),L=new Set(R.map(G=>G.id)),te=(t.initiatives||[]).filter(G=>L.has(G.pillarId)),ee=new Set(te.map(G=>G.id)),ue=(t.projects||[]).filter(G=>ee.has(G.initiativeId)),V=new Set(ue.map(G=>G.id)),K=(t.tasks||[]).filter(G=>V.has(G.projectId));let ie=0,re=0,me=0;te.forEach(G=>{const le=G.ragStatus||"green";le==="green"?ie++:le==="amber"?re++:le==="red"&&me++});const W=te.reduce((G,le)=>G+(le.budget||0),0),F=te.reduce((G,le)=>G+(le.spentBudget||0),0),X=W-F;let q="gray";if(te.length>0){const G=ie+re+me;me>G*.2?q="red":re>G*.3?q="amber":q="green"}const U=A.filter(G=>G.entityType==="company");return{entityId:N,totalInitiatives:te.length,totalProjects:ue.length,totalTasks:K.length,greenCount:ie,amberCount:re,redCount:me,totalBudget:W,totalActualSpend:F,budgetVariance:X,weightedRAG:q,childEntityCount:A.length,childCompanyCount:U.length}}};return o.jsx(Vz.Provider,{value:T,children:e})},Wz=k.createContext(void 0),qz=({children:e})=>{const{state:t,getCurrentUser:r,getUserAssignments:n,getCorporateEntityAncestors:a,getOrgUnitAncestors:i,getOrgUnit:s}=Pt(),c=t.currentUserId||null,d=r(),f=!!d,h=k.useMemo(()=>c?n(c).filter(E=>E.isActive):[],[c,n]),p=k.useCallback((E,O)=>{if(!d)return"viewer";if(d.isSystemAdmin)return"admin";let A="viewer";for(const D of h)E&&D.corporateEntityId===E&&vi(D.role)>vi(A)&&(A=D.role),O&&D.orgUnitId===O&&vi(D.role)>vi(A)&&(A=D.role),D.inheritToChildren&&D.corporateEntityId&&E&&a(E).some(P=>P.id===D.corporateEntityId)&&vi(D.role)>vi(A)&&(A=D.role),D.inheritToChildren&&D.orgUnitId&&O&&i(O).some(P=>P.id===D.orgUnitId)&&vi(D.role)>vi(A)&&(A=D.role),!D.corporateEntityId&&!D.orgUnitId&&vi(D.role)>vi(A)&&(A=D.role);if(O&&!E){const D=s(O);if(D?.companyId){const M=p(D.companyId,void 0);vi(M)>vi(A)&&(A=M)}}return A},[d,h,a,i,s]),g=k.useCallback((E,O)=>{const A=p(E,O);return nz(A)},[p]),v=k.useCallback((E,O,A)=>g(O,A)[E]||!1,[g]),b=k.useCallback(E=>v("canManageStructure",E),[v]),y=k.useCallback(E=>v("canEditBSC",void 0,E),[v]),w=k.useCallback(E=>v("canManagePortfolio",void 0,E),[v]),j=k.useCallback(E=>v("canManageTasks",void 0,E),[v]),T=k.useCallback(()=>v("canImportExport"),[v]),N=k.useMemo(()=>d?d.isSystemAdmin?!0:h.some(E=>E.role==="admin"&&!E.corporateEntityId&&!E.orgUnitId):!1,[d,h]),C={currentUserId:c,currentUser:d,isAuthenticated:f,getEffectiveRole:p,getPermissions:g,canPerform:v,canManageStructure:b,canEditBSC:y,canManagePortfolio:w,canManageTasks:j,canImportExport:T,isAdmin:N};return o.jsx(Wz.Provider,{value:C,children:e})};function vi(e){switch(e){case"admin":return 3;case"editor":return 2;case"viewer":return 1;default:return 0}}const Kz=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Yz=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),BT=e=>{const t=Yz(e);return t.charAt(0).toUpperCase()+t.slice(1)},XI=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),Xz=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var Zz={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Qz=k.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:s,...c},d)=>k.createElement("svg",{ref:d,...Zz,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:XI("lucide",a),...!i&&!Xz(c)&&{"aria-hidden":"true"},...c},[...s.map(([f,h])=>k.createElement(f,h)),...Array.isArray(i)?i:[i]]));const Me=(e,t)=>{const r=k.forwardRef(({className:n,...a},i)=>k.createElement(Qz,{ref:i,iconNode:t,className:XI(`lucide-${Kz(BT(e))}`,`lucide-${e}`,n),...a}));return r.displayName=BT(e),r};const Jz=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Fx=Me("arrow-left",Jz);const e$=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Kt=Me("arrow-right",e$);const t$=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],r$=Me("ban",t$);const n$=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],a$=Me("bell",n$);const i$=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],mc=Me("briefcase",i$);const s$=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],gl=Me("building-2",s$);const l$=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],S2=Me("building",l$);const o$=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],c$=Me("calculator",o$);const u$=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Zw=Me("calendar",u$);const d$=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Vu=Me("chart-column",d$);const f$=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Zf=Me("check",f$);const h$=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ra=Me("chevron-down",h$);const m$=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ha=Me("chevron-right",m$);const p$=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ZI=Me("chevron-up",p$);const x$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],_n=Me("circle-alert",x$);const g$=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],yr=Me("circle-check-big",g$);const v$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],y$=Me("circle-check",v$);const b$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],QI=Me("circle-question-mark",b$);const w$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Qw=Me("circle-x",w$);const S$=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],N$=Me("circle",S$);const k$=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],fo=Me("clock",k$);const _$=[["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["circle",{cx:"12",cy:"12",r:"8",key:"46899m"}]],j$=Me("cog",_$);const E$=[["path",{d:"m15 10 5 5-5 5",key:"qqa56n"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]],Jw=Me("corner-down-right",E$);const T$=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Np=Me("database",T$);const C$=[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]],A$=Me("diamond",C$);const O$=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],sd=Me("dollar-sign",O$);const D$=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Pf=Me("download",D$);const I$=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],R$=Me("ellipsis-vertical",I$);const M$=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],JI=Me("external-link",M$);const P$=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],F$=Me("eye-off",P$);const L$=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],e5=Me("eye",L$);const B$=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],U$=Me("factory",B$);const z$=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],UT=Me("file-down",z$);const $$=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ho=Me("file-spreadsheet",$$);const H$=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],eS=Me("file-text",H$);const V$=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],G$=Me("file-up",V$);const W$=[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]],ys=Me("flag",W$);const q$=[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]],Ai=Me("folder-kanban",q$);const K$=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],t5=Me("folder-tree",K$);const Y$=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],X$=Me("funnel",Y$);const Z$=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Lx=Me("git-branch",Z$);const Q$=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],J$=Me("graduation-cap",Q$);const eH=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],tH=Me("grid-3x3",eH);const rH=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],nH=Me("grip-horizontal",rH);const aH=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],ld=Me("grip-vertical",aH);const iH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Gu=Me("info",iH);const sH=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Wu=Me("layers",sH);const lH=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],Qf=Me("layout-dashboard",lH);const oH=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],L0=Me("lightbulb",oH);const cH=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],r5=Me("link-2",cH);const uH=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],dH=Me("list-checks",uH);const fH=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["rect",{x:"3",y:"4",width:"6",height:"6",rx:"1",key:"cif1o7"}]],n5=Me("list-todo",fH);const hH=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],il=Me("loader-circle",hH);const mH=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],pH=Me("message-circle",mH);const xH=[["path",{d:"M5 12h14",key:"1ays0h"}]],a5=Me("minus",xH);const gH=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],vH=Me("monitor",gH);const yH=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],bH=Me("moon",yH);const wH=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],sl=Me("pen",wH);const SH=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],NH=Me("pin-off",SH);const kH=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],_H=Me("pin",kH);const jH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ir=Me("plus",jH);const EH=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],co=Me("refresh-cw",EH);const TH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],i5=Me("rotate-ccw",TH);const CH=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],s5=Me("search",CH);const AH=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],OH=Me("send",AH);const DH=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],mo=Me("settings",DH);const IH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],RH=Me("shield-check",IH);const MH=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],PH=Me("shield",MH);const FH=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ea=Me("sparkles",FH);const LH=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],BH=Me("square-check-big",LH);const UH=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],zH=Me("sun",UH);const $H=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],HH=Me("tag",$H);const VH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],gr=Me("target",VH);const GH=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],WH=Me("toggle-left",GH);const qH=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],ac=Me("trash-2",qH);const KH=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],tS=Me("trending-down",KH);const YH=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Ac=Me("trending-up",YH);const XH=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],jn=Me("triangle-alert",XH);const ZH=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],od=Me("upload",ZH);const QH=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],JH=Me("user-plus",QH);const eV=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],l5=Me("user",eV);const tV=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],rV=Me("users-round",tV);const nV=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ri=Me("users",nV);const aV=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],iV=Me("wand-sparkles",aV);const sV=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],B0=Me("x",sV);const lV=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],zT=Me("zap",lV),us=({to:e,icon:t,label:r,collapsed:n})=>o.jsxs(AI,{to:e,title:n?r:void 0,className:({isActive:a})=>`flex items-center h-7 transition-all duration-200 ${n?"justify-center":"gap-2 px-2"} ${a?"bg-sidebar-active text-sidebar-text border-l-2 border-l-accent-blue":"text-sidebar-text-muted hover:bg-sidebar-hover hover:text-sidebar-text border-l-2 border-l-transparent"}`,children:[o.jsx("span",{className:"flex-shrink-0",children:t}),!n&&o.jsx("span",{className:"text-[11px] truncate",children:r})]}),$T=({label:e,collapsed:t})=>t?o.jsx("div",{className:"mx-0.5 my-1 h-px bg-sidebar-border"}):o.jsx("div",{className:"px-2 py-1 mt-1",children:o.jsx("span",{className:"text-[10px] font-semibold text-sidebar-text-muted uppercase tracking-wider",children:e})}),oV="w-8",cV="w-36",uV=({expanded:e,onExpandedChange:t})=>{const[r,n]=k.useState(!1),[a,i]=k.useState(!1),s=r||a,c=!r&&a;return Nt.useEffect(()=>{t(r)},[r,t]),o.jsx(o.Fragment,{children:o.jsxs("aside",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),className:`fixed top-0 left-0 h-screen bg-sidebar-bg flex flex-col transition-all duration-200 z-40 ${s?cV:oV} ${c?"shadow-lg":""}`,children:[o.jsxs("div",{className:`h-8 flex items-center justify-between border-b border-sidebar-border ${s?"px-2":"px-1"}`,children:[o.jsxs("div",{className:`flex items-center overflow-hidden ${s?"gap-1.5":"justify-center w-full"}`,children:[o.jsx("div",{className:"w-5 h-5 bg-accent-blue flex items-center justify-center flex-shrink-0",children:o.jsx(gr,{className:"w-3 h-3 text-white"})}),s&&o.jsxs("span",{className:"text-xs font-semibold text-sidebar-text whitespace-nowrap",children:["Strat",o.jsx("span",{className:"text-accent-blue",children:"OS"})]})]}),s&&o.jsx("button",{onClick:()=>n(!r),className:"p-0.5 text-sidebar-text-muted hover:text-sidebar-text hover:bg-sidebar-hover rounded transition-colors",title:r?"Unpin sidebar (auto-collapse)":"Pin sidebar (stay open)",children:r?o.jsx(_H,{className:"w-3 h-3"}):o.jsx(NH,{className:"w-3 h-3"})})]}),o.jsxs("nav",{className:"flex-1 py-1 overflow-y-auto",children:[o.jsx(us,{to:"/",icon:o.jsx(Qf,{className:"w-4 h-4"}),label:"Dashboards",collapsed:!s}),o.jsx(us,{to:"/strategy",icon:o.jsx(gr,{className:"w-4 h-4"}),label:"Strategy",collapsed:!s}),o.jsx(us,{to:"/portfolio",icon:o.jsx(mc,{className:"w-4 h-4"}),label:"Portfolio",collapsed:!s}),o.jsx(us,{to:"/execution",icon:o.jsx(Ai,{className:"w-4 h-4"}),label:"Execution",collapsed:!s}),o.jsx(us,{to:"/insights",icon:o.jsx(L0,{className:"w-4 h-4"}),label:"AI Insights",collapsed:!s}),o.jsx("div",{className:`${s?"mx-2":"mx-0.5"} my-1 h-px bg-sidebar-border`}),o.jsx($T,{label:"Data",collapsed:!s}),o.jsx(us,{to:"/export",icon:o.jsx(Pf,{className:"w-4 h-4"}),label:"Export",collapsed:!s}),o.jsx(us,{to:"/import",icon:o.jsx(od,{className:"w-4 h-4"}),label:"Import",collapsed:!s}),o.jsx("div",{className:`${s?"mx-2":"mx-0.5"} my-1 h-px bg-sidebar-border`}),o.jsx($T,{label:"Manage",collapsed:!s}),o.jsx(us,{to:"/resources",icon:o.jsx(l5,{className:"w-4 h-4"}),label:"Resources",collapsed:!s}),o.jsx(us,{to:"/settings",icon:o.jsx(mo,{className:"w-4 h-4"}),label:"Settings",collapsed:!s}),o.jsx(us,{to:"/help",icon:o.jsx(QI,{className:"w-4 h-4"}),label:"Help",collapsed:!s})]}),o.jsx("div",{className:"border-t border-sidebar-border",children:o.jsxs("div",{className:`flex items-center py-1 hover:bg-sidebar-hover cursor-pointer transition-colors ${s?"gap-1.5 px-2":"justify-center"}`,title:s?void 0:"Jane Doe - PMO Director",children:[o.jsx("div",{className:"w-5 h-5 rounded-full bg-accent-purple flex items-center justify-center flex-shrink-0",children:o.jsx("span",{className:"text-white text-[8px] font-medium",children:"JD"})}),s&&o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-[10px] text-sidebar-text truncate",children:"Jane Doe"}),o.jsx("p",{className:"text-[8px] text-sidebar-text-muted truncate",children:"PMO"})]})]})})]})})},dV=()=>{const{theme:e,setTheme:t}=hz(),r=[{value:"light",icon:zH,label:"Light"},{value:"dark",icon:bH,label:"Dark"},{value:"system",icon:vH,label:"System"}];return o.jsx("div",{className:"flex items-center",children:r.map((n,a)=>o.jsx("button",{onClick:()=>t(n.value),className:`h-8 px-3 flex items-center gap-2 transition-colors duration-70 text-sm ${e===n.value?"bg-[var(--cds-layer-selected-01)] text-[var(--cds-text-primary)]":"bg-[var(--cds-field-01)] text-[var(--cds-text-secondary)] hover:bg-[var(--cds-field-hover-01)]"} ${a===0?"":"border-l border-[var(--cds-border-subtle-01)]"}`,title:n.label,children:o.jsx(n.icon,{className:"w-4 h-4"})},n.value))})},fV={"":"Dashboards",strategy:"Strategy Hub",portfolio:"Initiative Portfolio",execution:"Project Execution",insights:"AI Insights Center",export:"Export Template",import:"Import Data",resources:"Resources",settings:"Settings"},hV=({visible:e})=>{const r=Ns().pathname.split("/").filter(Boolean),{selectedOrgUnitId:n,setSelectedOrgUnitId:a}=Xw(),{getOrgUnit:i,getChildOrgUnits:s,getOrgConfig:c,state:d}=Pt(),[f,h]=Nt.useState(!1),p=Nt.useRef(null);c();const g=d.orgUnits||[],v=n?i(n):null;(d.corporateEntities||[]).find(N=>N.entityType==="corporation"&&!N.parentEntityId),Nt.useEffect(()=>{const N=C=>{p.current&&!p.current.contains(C.target)&&h(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]);const y=[{label:"Home",path:"/"}];let w="";r.forEach(N=>{w+=`/${N}`;const C=fV[N]||N;y.push({label:C,path:w})});const j=g.filter(N=>!N.parentId&&N.isActive),T=(N,C=0)=>{if(!N)return null;const E=s(N.id);return o.jsxs(Nt.Fragment,{children:[o.jsx("button",{onClick:()=>{a(N.id),h(!1)},className:`w-full text-left px-2 py-1 text-xs hover:bg-[var(--cds-background-hover)] ${n===N.id?"bg-[var(--cds-background-active)] text-[var(--cds-link-primary)]":""}`,style:{paddingLeft:`${C*12+8}px`},children:N.name}),E.map(O=>T(O,C+1))]},N.id)};return o.jsxs("header",{className:`h-8 bg-[var(--cds-layer-01)] border-b border-[var(--cds-border-subtle-00)] px-3 flex items-center justify-between transition-all duration-200 ${e?"translate-y-0 opacity-100":"-translate-y-full opacity-0 absolute"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[g.length>0&&o.jsxs("div",{className:"relative",ref:p,children:[o.jsxs("button",{onClick:()=>h(!f),className:"flex items-center gap-1.5 px-2 py-1 rounded text-xs text-[var(--cds-text-secondary)] hover:bg-[var(--cds-background-hover)] transition-colors",children:[o.jsx(gl,{className:"w-3 h-3"}),o.jsx("span",{className:"max-w-[120px] truncate",children:v?v.name:"All Org"}),o.jsx(Ra,{className:"w-3 h-3"})]}),f&&o.jsxs("div",{className:"absolute top-full left-0 mt-1 w-48 bg-[var(--cds-layer-01)] border border-[var(--cds-border-subtle-00)] rounded shadow-lg z-50 py-1 max-h-64 overflow-y-auto",children:[o.jsx("button",{onClick:()=>{a(null),h(!1)},className:`w-full text-left px-2 py-1 text-xs hover:bg-[var(--cds-background-hover)] ${n?"":"bg-[var(--cds-background-active)] text-[var(--cds-link-primary)]"}`,children:"All Organizations"}),o.jsx("div",{className:"border-t border-[var(--cds-border-subtle-00)] my-1"}),j.map(N=>T(N))]})]}),g.length>0&&o.jsx("div",{className:"h-4 w-px bg-[var(--cds-border-subtle-00)]"}),o.jsx("nav",{className:"flex items-center gap-1 text-xs",children:y.map((N,C)=>o.jsxs(Nt.Fragment,{children:[C>0&&o.jsx(ha,{className:"w-3 h-3 text-[var(--cds-text-helper)]"}),C===y.length-1?o.jsx("span",{className:"text-[var(--cds-text-primary)]",children:N.label}):o.jsx(Xn,{to:N.path,className:"text-[var(--cds-link-primary)] hover:text-[var(--cds-link-primary-hover)] hover:underline",children:N.label})]},N.path))})]}),o.jsxs("div",{className:"flex items-center gap-0.5",children:[o.jsxs("div",{className:"relative",children:[o.jsx(s5,{className:"absolute left-2 top-1/2 -translate-y-1/2 w-3 h-3 text-[var(--cds-icon-secondary)]"}),o.jsx("input",{type:"text",placeholder:"Search...",className:"w-40 h-6 pl-7 pr-2 bg-[var(--cds-field-01)] border-b border-[var(--cds-border-strong-01)] text-xs text-[var(--cds-text-primary)] placeholder:text-[var(--cds-text-placeholder)] focus:outline-none focus:border-b-2 focus:border-[var(--cds-focus)] transition-colors"})]}),o.jsxs("button",{className:"h-6 px-2 flex items-center gap-1 bg-transparent text-[var(--cds-link-primary)] hover:bg-[var(--cds-background-hover)] transition-colors text-xs",children:[o.jsx(Ea,{className:"w-3 h-3"}),o.jsx("span",{children:"AI"})]}),o.jsx(dV,{}),o.jsxs("button",{className:"relative w-6 h-6 flex items-center justify-center text-[var(--cds-icon-secondary)] hover:bg-[var(--cds-background-hover)] transition-colors",children:[o.jsx(a$,{className:"w-3.5 h-3.5"}),o.jsx("span",{className:"absolute top-0.5 right-0.5 w-1.5 h-1.5 bg-[var(--cds-support-error)] rounded-full"})]}),o.jsx("button",{className:"w-6 h-6 flex items-center justify-center hover:bg-[var(--cds-background-hover)] transition-colors",children:o.jsx("div",{className:"w-5 h-5 rounded-full bg-[#8a3ffc] flex items-center justify-center",children:o.jsx("span",{className:"text-white text-[8px] font-medium",children:"JD"})})})]})]})},mV=({selectedPillar:e,selectedProject:t})=>{const r=Ns(),[n,a]=k.useState(!1),[i,s]=k.useState(!1),[c,d]=k.useState([{id:"1",role:"assistant",content:`Hi! I'm your AI Strategy Assistant. I can help you with:

 Understanding BSC methodology
 Suggesting KPIs for your objectives
 Generating WBS for projects
 Ideating strategic initiatives

How can I help you today?`,timestamp:new Date,type:"text"}]),[f,h]=k.useState(""),[p,g]=k.useState(!1),[v,b]=k.useState(!0),y=k.useRef(null),w=VI();k.useEffect(()=>{y.current?.scrollIntoView({behavior:"smooth"})},[c]);const j=E=>{const O={...E,id:Date.now().toString(),timestamp:new Date};return d(A=>[...A,O]),O},T=async()=>{if(!f.trim()||p)return;const E=f.trim();h(""),j({role:"user",content:E,type:"text"}),g(!0),b(!1);try{const O=c.filter(D=>D.role!=="system").map(D=>({role:D.role,content:D.content})),A=await wz(E,{currentPage:r.pathname,selectedPillar:e,selectedProject:t},O);j({role:"assistant",content:A,type:"text"})}catch(O){j({role:"system",content:`Error: ${O instanceof Error?O.message:"Failed to get response"}`,type:"text"})}finally{g(!1)}},N=async E=>{b(!1),E==="kpi"?j({role:"assistant",content:`I can suggest KPIs for your strategic objectives. Please describe your objective and I'll recommend relevant KPIs.

For example: "Improve customer satisfaction" or "Reduce operational costs by 20%"`,type:"text"}):E==="wbs"?j({role:"assistant",content:`I can generate a Work Breakdown Structure for your project. Please describe the project and its scope.

For example: "Implement a new CRM system for the sales team" or "Launch mobile app for customer self-service"`,type:"text"}):E==="initiative"&&j({role:"assistant",content:`I can suggest strategic initiatives to achieve your objectives. Please describe your goal.

For example: "Increase market share in the enterprise segment" or "Build a culture of continuous improvement"`,type:"text"})},C=E=>{E.key==="Enter"&&!E.shiftKey&&(E.preventDefault(),T())};return w?o.jsxs("div",{className:"fixed bottom-6 right-6 z-50",children:[!n&&o.jsx("button",{onClick:()=>a(!0),className:"w-14 h-14 bg-accent-blue rounded-full shadow-lg flex items-center justify-center hover:bg-accent-blue/90 transition-colors group",children:o.jsx(Ea,{className:"w-6 h-6 text-white"})}),n&&o.jsxs("div",{className:`bg-bg-card border border-border rounded-lg shadow-xl transition-all ${i?"w-80 h-14":"w-96 h-[500px]"}`,children:[o.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border bg-bg-secondary rounded-t-lg",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ea,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"font-medium text-text-primary",children:"AI Assistant"})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("button",{onClick:()=>s(!i),className:"p-1 text-text-muted hover:text-text-primary transition-colors",children:i?o.jsx(ZI,{className:"w-4 h-4"}):o.jsx(Ra,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>a(!1),className:"p-1 text-text-muted hover:text-text-primary transition-colors",children:o.jsx(B0,{className:"w-4 h-4"})})]})]}),!i&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 h-[360px]",children:[c.map(E=>o.jsx("div",{className:`flex ${E.role==="user"?"justify-end":"justify-start"}`,children:o.jsxs("div",{className:`max-w-[85%] rounded-lg px-3 py-2 ${E.role==="user"?"bg-accent-blue text-white":E.role==="system"?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-bg-secondary text-text-primary"}`,children:[o.jsx("p",{className:"text-sm whitespace-pre-wrap",children:E.content}),o.jsx("p",{className:"text-xs opacity-60 mt-1",children:E.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},E.id)),p&&o.jsx("div",{className:"flex justify-start",children:o.jsx("div",{className:"bg-bg-secondary rounded-lg px-3 py-2",children:o.jsx(il,{className:"w-4 h-4 animate-spin text-accent-blue"})})}),v&&c.length===1&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-xs text-text-muted",children:"Quick actions:"}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsxs("button",{onClick:()=>N("kpi"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-bg-secondary rounded-lg text-xs text-text-primary hover:bg-bg-hover transition-colors",children:[o.jsx(gr,{className:"w-3 h-3 text-green-400"}),"Suggest KPIs"]}),o.jsxs("button",{onClick:()=>N("wbs"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-bg-secondary rounded-lg text-xs text-text-primary hover:bg-bg-hover transition-colors",children:[o.jsx(Lx,{className:"w-3 h-3 text-blue-400"}),"Generate WBS"]}),o.jsxs("button",{onClick:()=>N("initiative"),className:"flex items-center gap-1.5 px-3 py-1.5 bg-bg-secondary rounded-lg text-xs text-text-primary hover:bg-bg-hover transition-colors",children:[o.jsx(L0,{className:"w-3 h-3 text-amber-400"}),"Ideate Initiatives"]})]})]}),o.jsx("div",{ref:y})]}),o.jsx("div",{className:"p-3 border-t border-border",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",value:f,onChange:E=>h(E.target.value),onKeyPress:C,placeholder:"Ask me anything...",className:"flex-1 px-3 py-2 bg-bg-primary border border-border rounded-lg text-sm text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-blue",disabled:p}),o.jsx("button",{onClick:T,disabled:!f.trim()||p,className:"p-2 bg-accent-blue rounded-lg text-white disabled:opacity-50 disabled:cursor-not-allowed hover:bg-accent-blue/90 transition-colors",children:o.jsx(OH,{className:"w-4 h-4"})})]})})]})]})]}):o.jsxs("div",{className:"fixed bottom-6 right-6 z-50",children:[o.jsx("button",{onClick:()=>a(!n),className:"w-14 h-14 bg-bg-card border border-border rounded-full shadow-lg flex items-center justify-center hover:bg-bg-hover transition-colors group",title:"AI Assistant (Configure API key in Settings)",children:o.jsx(pH,{className:"w-6 h-6 text-text-muted group-hover:text-text-secondary"})}),n&&o.jsx("div",{className:"absolute bottom-16 right-0 w-80 bg-bg-card border border-border rounded-lg shadow-xl p-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(_n,{className:"w-5 h-5 text-amber-400 flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-primary font-medium",children:"AI Assistant Not Configured"}),o.jsx("p",{className:"text-xs text-text-secondary mt-1",children:"Add your Claude API key in Settings to enable the AI Assistant."}),o.jsx("a",{href:"#/settings",className:"inline-block mt-2 text-xs text-accent-blue hover:underline",children:"Go to Settings "})]})]})})]})},pV=()=>{const[e,t]=k.useState(!0),[r,n]=k.useState(!0),a=k.useRef(null),i=k.useRef(0);return k.useEffect(()=>{const s=a.current;if(!s)return;const c=()=>{const d=s.scrollTop;d<=10?t(!0):d>i.current&&d>50?t(!1):d<i.current&&t(!0),i.current=d};return s.addEventListener("scroll",c,{passive:!0}),()=>s.removeEventListener("scroll",c)},[]),o.jsxs("div",{className:"flex min-h-screen bg-bg-primary",children:[o.jsx(uV,{expanded:r,onExpandedChange:n}),o.jsxs("div",{className:`fixed top-0 right-0 bottom-0 flex flex-col overflow-hidden transition-all duration-200 ${r?"left-36":"left-8"}`,children:[o.jsx(hV,{visible:e}),o.jsx("main",{ref:a,className:"flex-1 px-6 py-4 overflow-auto",children:o.jsx(vU,{})})]}),o.jsx(mV,{})]})},kp={red:{bg:"bg-rag-red",text:"text-rag-red",label:"Red Status"},amber:{bg:"bg-rag-amber",text:"text-rag-amber",label:"Amber Status"},green:{bg:"bg-rag-green",text:"text-rag-green",label:"Green Status"}},xV={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"},ic=({status:e,size:t="md",showLabel:r=!1,onClick:n})=>{const a=kp[e]?e:"green",{bg:i,text:s,label:c}=kp[a],d=!!n;return o.jsxs("div",{className:`flex items-center gap-2 ${d?"cursor-pointer hover:opacity-80 transition-opacity":""}`,onClick:n,role:d?"button":void 0,tabIndex:d?0:void 0,onKeyDown:d?f=>f.key==="Enter"&&n?.():void 0,children:[o.jsx("span",{className:`${xV[t]} ${i} rounded-full`}),r&&o.jsx("span",{className:`text-sm font-medium ${s} capitalize`,children:e})]})},_p=({status:e,onClick:t})=>{const r=kp[e]?e:"green",{bg:n}=kp[r],a=!!t;return o.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n} text-white capitalize ${a?"cursor-pointer hover:opacity-80 transition-opacity":""}`,onClick:t,role:a?"button":void 0,tabIndex:a?0:void 0,onKeyDown:a?i=>i.key==="Enter"&&t?.():void 0,children:e})},gV={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"},Ta=({isOpen:e,onClose:t,title:r,children:n,size:a="md"})=>(k.useEffect(()=>{const i=s=>{s.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",i),document.body.style.overflow="unset"}},[e,t]),e?o.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[o.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:t}),o.jsxs("div",{className:`relative ${gV[a]} w-full mx-4 border border-border rounded-xl shadow-2xl overflow-hidden`,style:{backgroundColor:"var(--cds-layer-02, #393939)"},children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-border",style:{backgroundColor:"var(--cds-layer-02, #393939)"},children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:r}),o.jsx("button",{onClick:t,className:"p-1 text-text-muted hover:text-text-primary transition-colors rounded",children:o.jsx(B0,{className:"w-5 h-5"})})]}),o.jsx("div",{className:"px-6 py-4 max-h-[70vh] overflow-y-auto",style:{backgroundColor:"var(--cds-layer-02, #393939)"},children:n})]})]}):null),vV={primary:"bg-accent-blue hover:bg-accent-blue/90 text-white border-transparent",secondary:"bg-bg-card hover:bg-bg-hover text-text-primary border-border",danger:"bg-rag-red hover:bg-rag-red/90 text-white border-transparent",ghost:"bg-transparent hover:bg-bg-hover text-text-secondary hover:text-text-primary border-transparent"},yV={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},Xe=({variant:e="primary",size:t="md",children:r,icon:n,className:a="",disabled:i,...s})=>o.jsxs("button",{className:`
        inline-flex items-center justify-center gap-2 font-medium rounded-lg border
        transition-colors focus:outline-none focus:ring-2 focus:ring-accent-blue/50
        disabled:opacity-50 disabled:cursor-not-allowed
        ${vV[e]}
        ${yV[t]}
        ${a}
      `,disabled:i,...s,children:[n,r]}),qu=({content:e,title:t,position:r="top",size:n="sm",className:a=""})=>{const[i,s]=k.useState(!1),[c,d]=k.useState(r),f=k.useRef(null),h=k.useRef(null),p={sm:"w-3.5 h-3.5",md:"w-4 h-4",lg:"w-5 h-5"},g={sm:"w-48",md:"w-64",lg:"w-80"};k.useEffect(()=>{if(i&&f.current&&h.current){const y=f.current.getBoundingClientRect(),w=h.current.getBoundingClientRect(),j=window.innerWidth,T=window.innerHeight;let N=r;r==="top"&&w.top-y.height<10?N="bottom":r==="bottom"&&w.bottom+y.height>T-10&&(N="top"),r==="left"&&w.left-y.width<10?N="right":r==="right"&&w.right+y.width>j-10&&(N="left"),d(N)}},[i,r]);const v={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},b={top:"top-full left-1/2 -translate-x-1/2 border-l-transparent border-r-transparent border-b-transparent border-t-[var(--cds-border-subtle-01)]",bottom:"bottom-full left-1/2 -translate-x-1/2 border-l-transparent border-r-transparent border-t-transparent border-b-[var(--cds-border-subtle-01)]",left:"left-full top-1/2 -translate-y-1/2 border-t-transparent border-b-transparent border-r-transparent border-l-[var(--cds-border-subtle-01)]",right:"right-full top-1/2 -translate-y-1/2 border-t-transparent border-b-transparent border-l-transparent border-r-[var(--cds-border-subtle-01)]"};return o.jsxs("div",{className:`relative inline-flex items-center ${a}`,children:[o.jsx("button",{ref:h,type:"button",onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),onFocus:()=>s(!0),onBlur:()=>s(!1),onClick:y=>{y.preventDefault(),y.stopPropagation(),s(!i)},className:"p-0.5 text-text-muted hover:text-accent-blue transition-colors rounded-full hover:bg-accent-blue/10 focus:outline-none focus:ring-2 focus:ring-accent-blue/50","aria-label":"More information",children:o.jsx(Gu,{className:p[n]})}),i&&o.jsxs("div",{ref:f,className:`absolute z-[100] ${v[c]} ${g[n]} p-3 rounded-lg border border-border shadow-lg`,style:{backgroundColor:"var(--cds-layer-02, #393939)"},role:"tooltip",children:[t&&o.jsx("p",{className:"text-sm font-semibold text-text-primary mb-1",children:t}),o.jsx("div",{className:"text-xs text-text-secondary leading-relaxed",children:e}),o.jsx("div",{className:`absolute w-0 h-0 border-[6px] ${b[c]}`})]})]})},Mn=[];for(let e=0;e<256;++e)Mn.push((e+256).toString(16).slice(1));function bV(e,t=0){return(Mn[e[t+0]]+Mn[e[t+1]]+Mn[e[t+2]]+Mn[e[t+3]]+"-"+Mn[e[t+4]]+Mn[e[t+5]]+"-"+Mn[e[t+6]]+Mn[e[t+7]]+"-"+Mn[e[t+8]]+Mn[e[t+9]]+"-"+Mn[e[t+10]]+Mn[e[t+11]]+Mn[e[t+12]]+Mn[e[t+13]]+Mn[e[t+14]]+Mn[e[t+15]]).toLowerCase()}let l1;const wV=new Uint8Array(16);function SV(){if(!l1){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");l1=crypto.getRandomValues.bind(crypto)}return l1(wV)}const NV=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),HT={randomUUID:NV};function kV(e,t,r){e=e||{};const n=e.random??e.rng?.()??SV();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,bV(n)}function No(e,t,r){return HT.randomUUID&&!e?HT.randomUUID():kV(e)}const _V=({pillarId:e,kpi:t,onClose:r})=>{const{state:n,dispatch:a}=Pt(),{pillars:i}=n,[s,c]=k.useState({pillarId:t?.pillarId||e||"",name:t?.name||"",targetValue:t?.targetValue||100,currentValue:t?.currentValue||0,previousValue:t?.previousValue||0,unit:t?.unit||"%",lastUpdated:t?.lastUpdated||new Date().toISOString().split("T")[0]}),d=g=>{g.preventDefault();const v={id:t?.id||No(),pillarId:s.pillarId,name:s.name,targetValue:s.targetValue,currentValue:s.currentValue,previousValue:s.previousValue,unit:s.unit,lastUpdated:s.lastUpdated};a(t?{type:"UPDATE_KPI",payload:v}:{type:"ADD_KPI",payload:v}),r()},f=()=>{t&&confirm("Are you sure you want to delete this KPI?")&&(a({type:"DELETE_KPI",payload:t.id}),r())},h=s.targetValue>0?Math.round(s.currentValue/s.targetValue*100):0,p=s.currentValue>s.previousValue?"up":s.currentValue<s.previousValue?"down":"neutral";return o.jsxs("form",{onSubmit:d,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"KPI Name *"}),o.jsx("input",{type:"text",value:s.name,onChange:g=>c({...s,name:g.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Strategy Pillar *"}),o.jsxs("select",{value:s.pillarId,onChange:g=>c({...s,pillarId:g.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0,children:[o.jsx("option",{value:"",children:"Select Pillar"}),i.map(g=>o.jsx("option",{value:g.id,children:g.name},g.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Unit"}),o.jsxs("select",{value:s.unit,onChange:g=>c({...s,unit:g.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"%",children:"Percentage (%)"}),o.jsx("option",{value:"$",children:"Currency ($)"}),o.jsx("option",{value:"score",children:"Score"}),o.jsx("option",{value:"number",children:"Number"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Target Value"}),o.jsx("input",{type:"number",value:s.targetValue,onChange:g=>c({...s,targetValue:Number(g.target.value)}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Current Value"}),o.jsx("input",{type:"number",value:s.currentValue,onChange:g=>c({...s,currentValue:Number(g.target.value)}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Previous Value"}),o.jsx("input",{type:"number",value:s.previousValue,onChange:g=>c({...s,previousValue:Number(g.target.value)}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Last Updated"}),o.jsx("input",{type:"date",value:s.lastUpdated,onChange:g=>c({...s,lastUpdated:g.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Progress toward target:"}),o.jsxs("span",{className:h>=100?"text-rag-green":h>=70?"text-rag-amber":"text-rag-red",children:[h,"%"]})]}),o.jsx("div",{className:"h-2 bg-bg-primary rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all ${h>=100?"bg-rag-green":h>=70?"bg-rag-amber":"bg-rag-red"}`,style:{width:`${Math.min(h,100)}%`}})}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Trend:"}),o.jsx("span",{className:p==="up"?"text-rag-green":p==="down"?"text-rag-red":"text-text-muted",children:p==="up"?"Improving":p==="down"?"Declining":"Stable"})]})]}),o.jsxs("div",{className:"flex justify-between pt-4 border-t border-border",children:[o.jsx("div",{children:t&&o.jsx(Xe,{type:"button",variant:"danger",onClick:f,children:"Delete"})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),o.jsx(Xe,{type:"submit",children:t?"Update":"Create"})]})]})]})},jV=({pillar:e,kpis:t,aiInsight:r})=>{const n=fa(),[a,i]=k.useState(null),[s,c]=k.useState(!1),d=t[0],f=t[1],h=(y,w)=>{w.stopPropagation(),i(y),c(!0)},p={red:"border-l-rag-red",amber:"border-l-rag-amber",green:"border-l-rag-green"},g=(y,w)=>y>w?"up":y<w?"down":"neutral",v=y=>{switch(y.unit){case"%":return`${y.currentValue}%`;case"$":return`$${y.currentValue.toLocaleString()}`;case"score":return y.currentValue.toString();default:return y.currentValue.toString()}},b=({current:y,previous:w})=>{const j=g(y,w);return j==="up"?o.jsx(Ac,{className:"w-4 h-4 text-rag-green"}):j==="down"?o.jsx(tS,{className:"w-4 h-4 text-rag-red"}):o.jsx(a5,{className:"w-4 h-4 text-text-muted"})};return o.jsxs("div",{onClick:()=>n(`/portfolio?pillar=${e.id}`),className:`
        bg-bg-card rounded-xl border border-border border-l-4 ${p[e.ragStatus]}
        p-5 cursor-pointer hover:bg-bg-hover transition-colors
      `,children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:e.name}),o.jsx(ic,{status:e.ragStatus,showLabel:!0,size:"sm"})]}),d&&o.jsxs("div",{onClick:y=>h(d,y),className:"mb-3 p-2 -mx-2 rounded-lg hover:bg-bg-hover/50 cursor-pointer transition-colors group",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-sm text-text-secondary",children:[d.name,":"]}),o.jsx("span",{className:"text-xl font-bold text-text-primary",children:v(d)}),o.jsx(b,{current:d.currentValue,previous:d.previousValue}),o.jsx(sl,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity ml-auto"})]}),o.jsxs("span",{className:"text-xs text-text-muted",children:["Target: ",d.unit==="%"?`${d.targetValue}%`:d.targetValue]})]}),f&&o.jsxs("div",{onClick:y=>h(f,y),className:"mb-4 text-sm p-2 -mx-2 rounded-lg hover:bg-bg-hover/50 cursor-pointer transition-colors group flex items-center",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("span",{className:"text-text-secondary",children:[f.name,": "]}),o.jsx("span",{className:"text-text-primary font-medium",children:v(f)}),o.jsxs("span",{className:"text-text-muted",children:[" (Target: ",f.targetValue,")"]})]}),o.jsx(sl,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),r&&o.jsx("div",{className:"pt-3 border-t border-border",children:o.jsxs("p",{className:"text-sm text-accent-cyan",children:[o.jsx("span",{className:"font-medium",children:"AI Insight:"})," ",r]})}),o.jsx(Ta,{isOpen:s,onClose:()=>c(!1),title:a?`Edit KPI: ${a.name}`:"KPI",size:"md",children:a&&o.jsx(_V,{kpi:a,onClose:()=>c(!1)})})]})};function o5(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=o5(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function tr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=o5(e))&&(n&&(n+=" "),n+=t);return n}var EV=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function rS(e){if(typeof e!="string")return!1;var t=EV;return t.includes(e)}var TV=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],CV=new Set(TV);function c5(e){return typeof e!="string"?!1:CV.has(e)}function u5(e){return typeof e=="string"&&e.startsWith("data-")}function ll(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(c5(r)||u5(r))&&(t[r]=e[r]);return t}function nS(e){if(e==null)return null;if(k.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return ll(t)}return typeof e=="object"&&!Array.isArray(e)?ll(e):null}function Di(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(c5(r)||u5(r)||rS(r))&&(t[r]=e[r]);return t}var AV=["children","width","height","viewBox","className","style","title","desc"];function N2(){return N2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},N2.apply(null,arguments)}function OV(e,t){if(e==null)return{};var r,n,a=DV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function DV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var d5=k.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:c,title:d,desc:f}=e,h=OV(e,AV),p=i||{width:n,height:a,x:0,y:0},g=tr("recharts-surface",s);return k.createElement("svg",N2({},Di(h),{className:g,width:n,height:a,style:c,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:t}),k.createElement("title",null,d),k.createElement("desc",null,f),r)}),IV=["children","className"];function k2(){return k2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},k2.apply(null,arguments)}function RV(e,t){if(e==null)return{};var r,n,a=MV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function MV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bs=k.forwardRef((e,t)=>{var{children:r,className:n}=e,a=RV(e,IV),i=tr("recharts-layer",n);return k.createElement("g",k2({className:i},Di(a),{ref:t}),r)}),PV=k.createContext(null);function ir(e){return function(){return e}}const f5=Math.cos,jp=Math.sin,as=Math.sqrt,Ep=Math.PI,Bx=2*Ep,_2=Math.PI,j2=2*_2,Yo=1e-6,FV=j2-Yo;function h5(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function LV(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return h5;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class BV{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?h5:LV(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,c=this._y1,d=n-t,f=a-r,h=s-t,p=c-r,g=h*h+p*p;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(g>Yo)if(!(Math.abs(p*d-f*h)>Yo)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let v=n-s,b=a-c,y=d*d+f*f,w=v*v+b*b,j=Math.sqrt(y),T=Math.sqrt(g),N=i*Math.tan((_2-Math.acos((y+g-w)/(2*j*T)))/2),C=N/T,E=N/j;Math.abs(C-1)>Yo&&this._append`L${t+C*h},${r+C*p}`,this._append`A${i},${i},0,0,${+(p*v>h*b)},${this._x1=t+E*d},${this._y1=r+E*f}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(a),d=n*Math.sin(a),f=t+c,h=r+d,p=1^s,g=s?a-i:i-a;this._x1===null?this._append`M${f},${h}`:(Math.abs(this._x1-f)>Yo||Math.abs(this._y1-h)>Yo)&&this._append`L${f},${h}`,n&&(g<0&&(g=g%j2+j2),g>FV?this._append`A${n},${n},0,1,${p},${t-c},${r-d}A${n},${n},0,1,${p},${this._x1=f},${this._y1=h}`:g>Yo&&this._append`A${n},${n},0,${+(g>=_2)},${p},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function aS(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new BV(t)}function iS(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function m5(e){this._context=e}m5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ux(e){return new m5(e)}function p5(e){return e[0]}function x5(e){return e[1]}function g5(e,t){var r=ir(!0),n=null,a=Ux,i=null,s=aS(c);e=typeof e=="function"?e:e===void 0?p5:ir(e),t=typeof t=="function"?t:t===void 0?x5:ir(t);function c(d){var f,h=(d=iS(d)).length,p,g=!1,v;for(n==null&&(i=a(v=s())),f=0;f<=h;++f)!(f<h&&r(p=d[f],f,d))===g&&((g=!g)?i.lineStart():i.lineEnd()),g&&i.point(+e(p,f,d),+t(p,f,d));if(v)return i=null,v+""||null}return c.x=function(d){return arguments.length?(e=typeof d=="function"?d:ir(+d),c):e},c.y=function(d){return arguments.length?(t=typeof d=="function"?d:ir(+d),c):t},c.defined=function(d){return arguments.length?(r=typeof d=="function"?d:ir(!!d),c):r},c.curve=function(d){return arguments.length?(a=d,n!=null&&(i=a(n)),c):a},c.context=function(d){return arguments.length?(d==null?n=i=null:i=a(n=d),c):n},c}function Im(e,t,r){var n=null,a=ir(!0),i=null,s=Ux,c=null,d=aS(f);e=typeof e=="function"?e:e===void 0?p5:ir(+e),t=typeof t=="function"?t:ir(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?x5:ir(+r);function f(p){var g,v,b,y=(p=iS(p)).length,w,j=!1,T,N=new Array(y),C=new Array(y);for(i==null&&(c=s(T=d())),g=0;g<=y;++g){if(!(g<y&&a(w=p[g],g,p))===j)if(j=!j)v=g,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),b=g-1;b>=v;--b)c.point(N[b],C[b]);c.lineEnd(),c.areaEnd()}j&&(N[g]=+e(w,g,p),C[g]=+t(w,g,p),c.point(n?+n(w,g,p):N[g],r?+r(w,g,p):C[g]))}if(T)return c=null,T+""||null}function h(){return g5().defined(a).curve(s).context(i)}return f.x=function(p){return arguments.length?(e=typeof p=="function"?p:ir(+p),n=null,f):e},f.x0=function(p){return arguments.length?(e=typeof p=="function"?p:ir(+p),f):e},f.x1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:ir(+p),f):n},f.y=function(p){return arguments.length?(t=typeof p=="function"?p:ir(+p),r=null,f):t},f.y0=function(p){return arguments.length?(t=typeof p=="function"?p:ir(+p),f):t},f.y1=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:ir(+p),f):r},f.lineX0=f.lineY0=function(){return h().x(e).y(t)},f.lineY1=function(){return h().x(e).y(r)},f.lineX1=function(){return h().x(n).y(t)},f.defined=function(p){return arguments.length?(a=typeof p=="function"?p:ir(!!p),f):a},f.curve=function(p){return arguments.length?(s=p,i!=null&&(c=s(i)),f):s},f.context=function(p){return arguments.length?(p==null?i=c=null:c=s(i=p),f):i},f}class v5{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function UV(e){return new v5(e,!0)}function zV(e){return new v5(e,!1)}const sS={draw(e,t){const r=as(t/Ep);e.moveTo(r,0),e.arc(0,0,r,0,Bx)}},$V={draw(e,t){const r=as(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},y5=as(1/3),HV=y5*2,VV={draw(e,t){const r=as(t/HV),n=r*y5;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},GV={draw(e,t){const r=as(t),n=-r/2;e.rect(n,n,r,r)}},WV=.8908130915292852,b5=jp(Ep/10)/jp(7*Ep/10),qV=jp(Bx/10)*b5,KV=-f5(Bx/10)*b5,YV={draw(e,t){const r=as(t*WV),n=qV*r,a=KV*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Bx*i/5,c=f5(s),d=jp(s);e.lineTo(d*r,-c*r),e.lineTo(c*n-d*a,d*n+c*a)}e.closePath()}},o1=as(3),XV={draw(e,t){const r=-as(t/(o1*3));e.moveTo(0,r*2),e.lineTo(-o1*r,-r),e.lineTo(o1*r,-r),e.closePath()}},yi=-.5,bi=as(3)/2,E2=1/as(12),ZV=(E2/2+1)*3,QV={draw(e,t){const r=as(t/ZV),n=r/2,a=r*E2,i=n,s=r*E2+r,c=-i,d=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(c,d),e.lineTo(yi*n-bi*a,bi*n+yi*a),e.lineTo(yi*i-bi*s,bi*i+yi*s),e.lineTo(yi*c-bi*d,bi*c+yi*d),e.lineTo(yi*n+bi*a,yi*a-bi*n),e.lineTo(yi*i+bi*s,yi*s-bi*i),e.lineTo(yi*c+bi*d,yi*d-bi*c),e.closePath()}};function JV(e,t){let r=null,n=aS(a);e=typeof e=="function"?e:ir(e||sS),t=typeof t=="function"?t:ir(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:ir(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:ir(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Tp(){}function Cp(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function w5(e){this._context=e}w5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Cp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Cp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eG(e){return new w5(e)}function S5(e){this._context=e}S5.prototype={areaStart:Tp,areaEnd:Tp,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Cp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tG(e){return new S5(e)}function N5(e){this._context=e}N5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Cp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rG(e){return new N5(e)}function k5(e){this._context=e}k5.prototype={areaStart:Tp,areaEnd:Tp,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function nG(e){return new k5(e)}function VT(e){return e<0?-1:1}function GT(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),c=(i*a+s*n)/(n+a);return(VT(i)+VT(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(c))||0}function WT(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function c1(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,c=(i-n)/3;e._context.bezierCurveTo(n+c,a+c*t,i-c,s-c*r,i,s)}function Ap(e){this._context=e}Ap.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:c1(this,this._t0,WT(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,c1(this,WT(this,r=GT(this,e,t)),r);break;default:c1(this,this._t0,r=GT(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function _5(e){this._context=new j5(e)}(_5.prototype=Object.create(Ap.prototype)).point=function(e,t){Ap.prototype.point.call(this,t,e)};function j5(e){this._context=e}j5.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function aG(e){return new Ap(e)}function iG(e){return new _5(e)}function E5(e){this._context=e}E5.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=qT(e),a=qT(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function qT(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function sG(e){return new E5(e)}function zx(e,t){this._context=e,this._t=t}zx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function lG(e){return new zx(e,.5)}function oG(e){return new zx(e,0)}function cG(e){return new zx(e,1)}function pc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,c=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<c;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function T2(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function uG(e,t){return e[t]}function dG(e){const t=[];return t.key=e,t}function fG(){var e=ir([]),t=T2,r=pc,n=uG;function a(i){var s=Array.from(e.apply(this,arguments),dG),c,d=s.length,f=-1,h;for(const p of i)for(c=0,++f;c<d;++c)(s[c][f]=[0,+n(p,s[c].key,f,i)]).data=p;for(c=0,h=iS(t(s));c<d;++c)s[h[c]].index=c;return r(s,h),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:ir(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:ir(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?T2:typeof i=="function"?i:ir(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??pc,a):r},a}function hG(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}pc(e,t)}}function mG(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,c=0;s<a;++s)c+=e[s][r][1]||0;n[r][1]+=n[r][0]=-c/2}pc(e,t)}}function pG(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var c=0,d=0,f=0;c<s;++c){for(var h=e[t[c]],p=h[n][1]||0,g=h[n-1][1]||0,v=(p-g)/2,b=0;b<c;++b){var y=e[t[b]],w=y[n][1]||0,j=y[n-1][1]||0;v+=w-j}d+=p,f+=v*p}a[n-1][1]+=a[n-1][0]=r,d&&(r-=f/d)}a[n-1][1]+=a[n-1][0]=r,pc(e,t)}}var u1={},d1={},KT;function xG(){return KT||(KT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(d1)),d1}var f1={},YT;function T5(){return YT||(YT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(f1)),f1}var h1={},XT;function lS(){return XT||(XT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(h1)),h1}var m1={},p1={},ZT;function gG(){return ZT||(ZT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(p1)),p1}var QT;function oS(){return QT||(QT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gG(),r=lS();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],s=a.length;if(s===0)return i;let c=0,d="",f="",h=!1;for(a.charCodeAt(0)===46&&(i.push(""),c++);c<s;){const p=a[c];f?p==="\\"&&c+1<s?(c++,d+=a[c]):p===f?f="":d+=p:h?p==='"'||p==="'"?f=p:p==="]"?(h=!1,i.push(d),d=""):d+=p:p==="["?(h=!0,d&&(i.push(d),d="")):p==="."?d&&(i.push(d),d=""):d+=p,c++}return d&&i.push(d),i}e.toPath=n})(m1)),m1}var JT;function cS(){return JT||(JT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xG(),r=T5(),n=lS(),a=oS();function i(c,d,f){if(c==null)return f;switch(typeof d){case"string":{if(t.isUnsafeProperty(d))return f;const h=c[d];return h===void 0?r.isDeepKey(d)?i(c,a.toPath(d),f):f:h}case"number":case"symbol":{typeof d=="number"&&(d=n.toKey(d));const h=c[d];return h===void 0?f:h}default:{if(Array.isArray(d))return s(c,d,f);if(Object.is(d?.valueOf(),-0)?d="-0":d=String(d),t.isUnsafeProperty(d))return f;const h=c[d];return h===void 0?f:h}}}function s(c,d,f){if(d.length===0)return f;let h=c;for(let p=0;p<d.length;p++){if(h==null||t.isUnsafeProperty(d[p]))return f;h=h[d[p]]}return h===void 0?f:h}e.get=i})(u1)),u1}var x1,eC;function vG(){return eC||(eC=1,x1=cS().get),x1}var yG=vG();const Ku=xl(yG);var bG=4;function io(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bG,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function Ar(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,i,s)=>{var c=r[s-1];return typeof c=="string"?a+c+i:c!==void 0?a+io(c)+i:a+i},"")}var qi=e=>e===0?0:e>0?1:-1,ol=e=>typeof e=="number"&&e!=+e,cl=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,st=e=>(typeof e=="number"||e instanceof Number)&&!ol(e),ws=e=>st(e)||typeof e=="string",wG=0,Jf=e=>{var t=++wG;return"".concat(e||"").concat(t)},po=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!st(t)&&typeof t!="string")return n;var i;if(cl(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return ol(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},C5=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Ka(e,t,r){return st(e)&&st(t)?io(e+r*(t-e)):t}function A5(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Ku(n,t))===r)}var SG=e=>{for(var t=e.length,r=0,n=0,a=0,i=0,s=1/0,c=-1/0,d=0,f=0,h=0;h<t;h++){var p,g;d=((p=e[h])===null||p===void 0?void 0:p.cx)||0,f=((g=e[h])===null||g===void 0?void 0:g.cy)||0,r+=d,n+=f,a+=d*f,i+=d*d,s=Math.min(s,d),c=Math.max(c,d)}var v=t*i!==r*r?(t*a-r*n)/(t*i-r*r):0;return{xmin:s,xmax:c,a:v,b:(n-v*r)/t}},zr=e=>e===null||typeof e>"u",U0=e=>zr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function NG(e){return e!=null}function z0(){}var kG=["type","size","sizeType"];function C2(){return C2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},C2.apply(null,arguments)}function tC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tC(Object(r),!0).forEach(function(n){_G(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _G(e,t,r){return(t=jG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jG(e){var t=EG(e,"string");return typeof t=="symbol"?t:t+""}function EG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TG(e,t){if(e==null)return{};var r,n,a=CG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function CG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var O5={symbolCircle:sS,symbolCross:$V,symbolDiamond:VV,symbolSquare:GV,symbolStar:YV,symbolTriangle:XV,symbolWye:QV},AG=Math.PI/180,OG=e=>{var t="symbol".concat(U0(e));return O5[t]||sS},DG=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*AG;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},IG=(e,t)=>{O5["symbol".concat(U0(e))]=t},uS=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=TG(e,kG),i=rC(rC({},a),{},{type:t,size:r,sizeType:n}),s="circle";typeof t=="string"&&(s=t);var c=()=>{var g=OG(s),v=JV().type(g).size(DG(r,n,s)),b=v();if(b!==null)return b},{className:d,cx:f,cy:h}=i,p=Di(i);return st(f)&&st(h)&&st(r)?k.createElement("path",C2({},p,{className:tr("recharts-symbols",d),transform:"translate(".concat(f,", ").concat(h,")"),d:c()})):null};uS.registerSymbol=IG;var D5=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,RG=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(k.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{rS(a)&&(n[a]=(i=>r[a](r,i)))}),n},MG=(e,t,r)=>n=>(e(t,r,n),null),I5=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];rS(a)&&typeof i=="function"&&(n||(n={}),n[a]=MG(i,t,r))}),n},PG=e=>Array.isArray(e)&&e.length>0;function nC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FG(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nC(Object(r),!0).forEach(function(n){LG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LG(e,t,r){return(t=BG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BG(e){var t=UG(e,"string");return typeof t=="symbol"?t:t+""}function UG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ma(e,t){var r=FG({},e),n=t,a=Object.keys(t),i=a.reduce((s,c)=>(s[c]===void 0&&n[c]!==void 0&&(s[c]=n[c]),s),r);return i}var g1={},v1={},aC;function zG(){return aC||(aC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],c=n(s);a.has(c)||a.set(c,s)}return Array.from(a.values())}e.uniqBy=t})(v1)),v1}var y1={},iC;function R5(){return iC||(iC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(y1)),y1}var b1={},w1={},S1={},sC;function $G(){return sC||(sC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(S1)),S1}var lC;function dS(){return lC||(lC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$G();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(w1)),w1}var N1={},oC;function HG(){return oC||(oC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(N1)),N1}var cC;function VG(){return cC||(cC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dS(),r=HG();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(b1)),b1}var k1={},_1={},uC;function GG(){return uC||(uC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cS();function r(n){return function(a){return t.get(a,n)}}e.property=r})(_1)),_1}var j1={},E1={},T1={},C1={},dC;function M5(){return dC||(dC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(C1)),C1}var A1={},fC;function P5(){return fC||(fC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(A1)),A1}var O1={},hC;function F5(){return hC||(hC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(O1)),O1}var mC;function WG(){return mC||(mC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=M5(),r=P5(),n=F5();function a(h,p,g){return typeof g!="function"?a(h,p,()=>{}):i(h,p,function v(b,y,w,j,T,N){const C=g(b,y,w,j,T,N);return C!==void 0?!!C:i(b,y,v,N)},new Map)}function i(h,p,g,v){if(p===h)return!0;switch(typeof p){case"object":return s(h,p,g,v);case"function":return Object.keys(p).length>0?i(h,{...p},g,v):n.eq(h,p);default:return t.isObject(h)?typeof p=="string"?p==="":!0:n.eq(h,p)}}function s(h,p,g,v){if(p==null)return!0;if(Array.isArray(p))return d(h,p,g,v);if(p instanceof Map)return c(h,p,g,v);if(p instanceof Set)return f(h,p,g,v);const b=Object.keys(p);if(h==null||r.isPrimitive(h))return b.length===0;if(b.length===0)return!0;if(v?.has(p))return v.get(p)===h;v?.set(p,h);try{for(let y=0;y<b.length;y++){const w=b[y];if(!r.isPrimitive(h)&&!(w in h)||p[w]===void 0&&h[w]!==void 0||p[w]===null&&h[w]!==null||!g(h[w],p[w],w,h,p,v))return!1}return!0}finally{v?.delete(p)}}function c(h,p,g,v){if(p.size===0)return!0;if(!(h instanceof Map))return!1;for(const[b,y]of p.entries()){const w=h.get(b);if(g(w,y,b,h,p,v)===!1)return!1}return!0}function d(h,p,g,v){if(p.length===0)return!0;if(!Array.isArray(h))return!1;const b=new Set;for(let y=0;y<p.length;y++){const w=p[y];let j=!1;for(let T=0;T<h.length;T++){if(b.has(T))continue;const N=h[T];let C=!1;if(g(N,w,y,h,p,v)&&(C=!0),C){b.add(T),j=!0;break}}if(!j)return!1}return!0}function f(h,p,g,v){return p.size===0?!0:h instanceof Set?d([...h],[...p],g,v):!1}e.isMatchWith=a,e.isSetMatch=f})(T1)),T1}var pC;function L5(){return pC||(pC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WG();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(E1)),E1}var D1={},I1={},R1={},xC;function qG(){return xC||(xC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(R1)),R1}var M1={},gC;function B5(){return gC||(gC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(M1)),M1}var P1={},vC;function U5(){return vC||(vC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",c="[object Date]",d="[object Map]",f="[object Set]",h="[object Array]",p="[object Function]",g="[object ArrayBuffer]",v="[object Object]",b="[object Error]",y="[object DataView]",w="[object Uint8Array]",j="[object Uint8ClampedArray]",T="[object Uint16Array]",N="[object Uint32Array]",C="[object BigUint64Array]",E="[object Int8Array]",O="[object Int16Array]",A="[object Int32Array]",D="[object BigInt64Array]",M="[object Float32Array]",P="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=g,e.arrayTag=h,e.bigInt64ArrayTag=D,e.bigUint64ArrayTag=C,e.booleanTag=a,e.dataViewTag=y,e.dateTag=c,e.errorTag=b,e.float32ArrayTag=M,e.float64ArrayTag=P,e.functionTag=p,e.int16ArrayTag=O,e.int32ArrayTag=A,e.int8ArrayTag=E,e.mapTag=d,e.numberTag=n,e.objectTag=v,e.regexpTag=t,e.setTag=f,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=T,e.uint32ArrayTag=N,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=j})(P1)),P1}var F1={},yC;function KG(){return yC||(yC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(F1)),F1}var bC;function z5(){return bC||(bC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qG(),r=B5(),n=U5(),a=P5(),i=KG();function s(h,p){return c(h,void 0,h,new Map,p)}function c(h,p,g,v=new Map,b=void 0){const y=b?.(h,p,g,v);if(y!==void 0)return y;if(a.isPrimitive(h))return h;if(v.has(h))return v.get(h);if(Array.isArray(h)){const w=new Array(h.length);v.set(h,w);for(let j=0;j<h.length;j++)w[j]=c(h[j],j,g,v,b);return Object.hasOwn(h,"index")&&(w.index=h.index),Object.hasOwn(h,"input")&&(w.input=h.input),w}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const w=new RegExp(h.source,h.flags);return w.lastIndex=h.lastIndex,w}if(h instanceof Map){const w=new Map;v.set(h,w);for(const[j,T]of h)w.set(j,c(T,j,g,v,b));return w}if(h instanceof Set){const w=new Set;v.set(h,w);for(const j of h)w.add(c(j,void 0,g,v,b));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(i.isTypedArray(h)){const w=new(Object.getPrototypeOf(h)).constructor(h.length);v.set(h,w);for(let j=0;j<h.length;j++)w[j]=c(h[j],j,g,v,b);return w}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const w=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return v.set(h,w),d(w,h,g,v,b),w}if(typeof File<"u"&&h instanceof File){const w=new File([h],h.name,{type:h.type});return v.set(h,w),d(w,h,g,v,b),w}if(typeof Blob<"u"&&h instanceof Blob){const w=new Blob([h],{type:h.type});return v.set(h,w),d(w,h,g,v,b),w}if(h instanceof Error){const w=new h.constructor;return v.set(h,w),w.message=h.message,w.name=h.name,w.stack=h.stack,w.cause=h.cause,d(w,h,g,v,b),w}if(h instanceof Boolean){const w=new Boolean(h.valueOf());return v.set(h,w),d(w,h,g,v,b),w}if(h instanceof Number){const w=new Number(h.valueOf());return v.set(h,w),d(w,h,g,v,b),w}if(h instanceof String){const w=new String(h.valueOf());return v.set(h,w),d(w,h,g,v,b),w}if(typeof h=="object"&&f(h)){const w=Object.create(Object.getPrototypeOf(h));return v.set(h,w),d(w,h,g,v,b),w}return h}function d(h,p,g=h,v,b){const y=[...Object.keys(p),...t.getSymbols(p)];for(let w=0;w<y.length;w++){const j=y[w],T=Object.getOwnPropertyDescriptor(h,j);(T==null||T.writable)&&(h[j]=c(p[j],j,g,v,b))}}function f(h){switch(r.getTag(h)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=c,e.copyProperties=d})(I1)),I1}var wC;function YG(){return wC||(wC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z5();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(D1)),D1}var SC;function XG(){return SC||(SC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L5(),r=YG();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(j1)),j1}var L1={},B1={},U1={},NC;function ZG(){return NC||(NC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=z5(),r=U5();function n(a,i){return t.cloneDeepWith(a,(s,c,d,f)=>{const h=i?.(s,c,d,f);if(h!==void 0)return h;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const p=new a.constructor(a?.valueOf());return t.copyProperties(p,a),p}case r.argumentsTag:{const p={};return t.copyProperties(p,a),p.length=a.length,p[Symbol.iterator]=a[Symbol.iterator],p}default:return}})}e.cloneDeepWith=n})(U1)),U1}var kC;function QG(){return kC||(kC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZG();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(B1)),B1}var z1={},$1={},_C;function $5(){return _C||(_C=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})($1)),$1}var H1={},jC;function JG(){return jC||(jC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B5();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(H1)),H1}var EC;function eW(){return EC||(EC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=T5(),r=$5(),n=JG(),a=oS();function i(s,c){let d;if(Array.isArray(c)?d=c:typeof c=="string"&&t.isDeepKey(c)&&s?.[c]==null?d=a.toPath(c):d=[c],d.length===0)return!1;let f=s;for(let h=0;h<d.length;h++){const p=d[h];if((f==null||!Object.hasOwn(f,p))&&!((Array.isArray(f)||n.isArguments(f))&&r.isIndex(p)&&p<f.length))return!1;f=f[p]}return!0}e.has=i})(z1)),z1}var TC;function tW(){return TC||(TC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L5(),r=lS(),n=QG(),a=cS(),i=eW();function s(c,d){switch(typeof c){case"object":{Object.is(c?.valueOf(),-0)&&(c="-0");break}case"number":{c=r.toKey(c);break}}return d=n.cloneDeep(d),function(f){const h=a.get(f,c);return h===void 0?i.has(f,c):d===void 0?h===void 0:t.isMatch(h,d)}}e.matchesProperty=s})(L1)),L1}var CC;function rW(){return CC||(CC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=R5(),r=GG(),n=XG(),a=tW();function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(k1)),k1}var AC;function nW(){return AC||(AC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zG(),r=R5(),n=VG(),a=rW();function i(s,c=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(c)):[]}e.uniqBy=i})(g1)),g1}var V1,OC;function aW(){return OC||(OC=1,V1=nW().uniqBy),V1}var iW=aW();const DC=xl(iW);function sW(e,t,r){return t===!0?DC(e,r):typeof t=="function"?DC(e,t):e}var G1={exports:{}},W1={},q1={exports:{}},K1={};var IC;function lW(){if(IC)return K1;IC=1;var e=ad();function t(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,s=e.useDebugValue;function c(p,g){var v=g(),b=n({inst:{value:v,getSnapshot:g}}),y=b[0].inst,w=b[1];return i(function(){y.value=v,y.getSnapshot=g,d(y)&&w({inst:y})},[p,v,g]),a(function(){return d(y)&&w({inst:y}),p(function(){d(y)&&w({inst:y})})},[p]),s(v),v}function d(p){var g=p.getSnapshot;p=p.value;try{var v=g();return!r(p,v)}catch{return!0}}function f(p,g){return g()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:c;return K1.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:h,K1}var RC;function oW(){return RC||(RC=1,q1.exports=lW()),q1.exports}var MC;function cW(){if(MC)return W1;MC=1;var e=ad(),t=oW();function r(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,s=e.useEffect,c=e.useMemo,d=e.useDebugValue;return W1.useSyncExternalStoreWithSelector=function(f,h,p,g,v){var b=i(null);if(b.current===null){var y={hasValue:!1,value:null};b.current=y}else y=b.current;b=c(function(){function j(O){if(!T){if(T=!0,N=O,O=g(O),v!==void 0&&y.hasValue){var A=y.value;if(v(A,O))return C=A}return C=O}if(A=C,n(N,O))return A;var D=g(O);return v!==void 0&&v(A,D)?(N=O,A):(N=O,C=D)}var T=!1,N,C,E=p===void 0?null:p;return[function(){return j(h())},E===null?void 0:function(){return j(E())}]},[h,p,g,v]);var w=a(f,b[0],b[1]);return s(function(){y.hasValue=!0,y.value=w},[w]),d(w),w},W1}var PC;function uW(){return PC||(PC=1,G1.exports=cW()),G1.exports}var dW=uW(),fS=k.createContext(null),fW=e=>e,Mr=()=>{var e=k.useContext(fS);return e?e.store.dispatch:fW},pp=()=>{},hW=()=>pp,mW=(e,t)=>e===t;function at(e){var t=k.useContext(fS);return dW.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:hW,t?t.store.getState:pp,t?t.store.getState:pp,t?e:pp,mW)}function pW(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function xW(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function gW(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var FC=e=>Array.isArray(e)?e:[e];function vW(e){const t=Array.isArray(e[0])?e[0]:e;return gW(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function yW(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var bW=class{constructor(e){this.value=e}deref(){return this.value}},wW=typeof WeakRef<"u"?WeakRef:bW,SW=0,LC=1;function Rm(){return{s:SW,v:void 0,o:null,p:null}}function H5(e,t={}){let r=Rm();const{resultEqualityCheck:n}=t;let a,i=0;function s(){let c=r;const{length:d}=arguments;for(let p=0,g=d;p<g;p++){const v=arguments[p];if(typeof v=="function"||typeof v=="object"&&v!==null){let b=c.o;b===null&&(c.o=b=new WeakMap);const y=b.get(v);y===void 0?(c=Rm(),b.set(v,c)):c=y}else{let b=c.p;b===null&&(c.p=b=new Map);const y=b.get(v);y===void 0?(c=Rm(),b.set(v,c)):c=y}}const f=c;let h;if(c.s===LC)h=c.v;else if(h=e.apply(null,arguments),i++,n){const p=a?.deref?.()??a;p!=null&&n(p,h)&&(h=p,i!==0&&i--),a=typeof h=="object"&&h!==null||typeof h=="function"?new wW(h):h}return f.s=LC,f.v=h,h}return s.clearCache=()=>{r=Rm(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function NW(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,c,d={},f=a.pop();typeof f=="object"&&(d=f,f=a.pop()),pW(f,`createSelector expects an output function after the inputs, but received: [${typeof f}]`);const h={...r,...d},{memoize:p,memoizeOptions:g=[],argsMemoize:v=H5,argsMemoizeOptions:b=[]}=h,y=FC(g),w=FC(b),j=vW(a),T=p(function(){return i++,f.apply(null,arguments)},...y),N=v(function(){s++;const E=yW(j,arguments);return c=T.apply(null,E),c},...w);return Object.assign(N,{resultFunc:f,memoizedResultFunc:T,dependencies:j,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>c,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:p,argsMemoize:v})};return Object.assign(n,{withTypes:()=>n}),n}var Ne=NW(H5),kW=Object.assign((e,t=Ne)=>{xW(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,c,d)=>(s[r[d]]=c,s),{}))},{withTypes:()=>kW}),Y1={},X1={},Z1={},BC;function _W(){return BC||(BC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),c=t(a);if(s===c&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?c-s:s-c}return 0};e.compareValues=r})(Z1)),Z1}var Q1={},J1={},UC;function V5(){return UC||(UC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(J1)),J1}var zC;function jW(){return zC||(zC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V5(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(Q1)),Q1}var $C;function EW(){return $C||($C=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_W(),r=jW(),n=oS();function a(i,s,c,d){if(i==null)return[];c=d?void 0:c,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(v=>String(v));const f=(v,b)=>{let y=v;for(let w=0;w<b.length&&y!=null;++w)y=y[b[w]];return y},h=(v,b)=>b==null||v==null?b:typeof v=="object"&&"key"in v?Object.hasOwn(b,v.key)?b[v.key]:f(b,v.path):typeof v=="function"?v(b):Array.isArray(v)?f(b,v):typeof b=="object"?b[v]:b,p=s.map(v=>(Array.isArray(v)&&v.length===1&&(v=v[0]),v==null||typeof v=="function"||Array.isArray(v)||r.isKey(v)?v:{key:v,path:n.toPath(v)}));return i.map(v=>({original:v,criteria:p.map(b=>h(b,v))})).slice().sort((v,b)=>{for(let y=0;y<p.length;y++){const w=t.compareValues(v.criteria[y],b.criteria[y],c[y]);if(w!==0)return w}return 0}).map(v=>v.original)}e.orderBy=a})(X1)),X1}var eb={},HC;function TW(){return HC||(HC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(c,d)=>{for(let f=0;f<c.length;f++){const h=c[f];Array.isArray(h)&&d<i?s(h,d+1):a.push(h)}};return s(r,0),a}e.flatten=t})(eb)),eb}var tb={},VC;function G5(){return VC||(VC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$5(),r=dS(),n=M5(),a=F5();function i(s,c,d){return n.isObject(d)&&(typeof c=="number"&&r.isArrayLike(d)&&t.isIndex(c)&&c<d.length||typeof c=="string"&&c in d)?a.eq(d[c],s):!1}e.isIterateeCall=i})(tb)),tb}var GC;function CW(){return GC||(GC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EW(),r=TW(),n=G5();function a(i,...s){const c=s.length;return c>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:c>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(Y1)),Y1}var rb,WC;function AW(){return WC||(WC=1,rb=CW().sortBy),rb}var OW=AW();const $x=xl(OW);var W5=e=>e.legend.settings,DW=e=>e.legend.size,IW=e=>e.legend.payload;Ne([IW,W5],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?$x(n,r):n});var Mm=1;function RW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=k.useState({height:0,left:0,top:0,width:0}),n=k.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>Mm||Math.abs(s.left-t.left)>Mm||Math.abs(s.top-t.top)>Mm||Math.abs(s.width-t.width)>Mm)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Fn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var MW=typeof Symbol=="function"&&Symbol.observable||"@@observable",qC=MW,nb=()=>Math.random().toString(36).substring(7).split("").join("."),PW={INIT:`@@redux/INIT${nb()}`,REPLACE:`@@redux/REPLACE${nb()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${nb()}`},Op=PW;function hS(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function q5(e,t,r){if(typeof e!="function")throw new Error(Fn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Fn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Fn(1));return r(q5)(e,t)}let n=e,a=t,i=new Map,s=i,c=0,d=!1;function f(){s===i&&(s=new Map,i.forEach((w,j)=>{s.set(j,w)}))}function h(){if(d)throw new Error(Fn(3));return a}function p(w){if(typeof w!="function")throw new Error(Fn(4));if(d)throw new Error(Fn(5));let j=!0;f();const T=c++;return s.set(T,w),function(){if(j){if(d)throw new Error(Fn(6));j=!1,f(),s.delete(T),i=null}}}function g(w){if(!hS(w))throw new Error(Fn(7));if(typeof w.type>"u")throw new Error(Fn(8));if(typeof w.type!="string")throw new Error(Fn(17));if(d)throw new Error(Fn(9));try{d=!0,a=n(a,w)}finally{d=!1}return(i=s).forEach(T=>{T()}),w}function v(w){if(typeof w!="function")throw new Error(Fn(10));n=w,g({type:Op.REPLACE})}function b(){const w=p;return{subscribe(j){if(typeof j!="object"||j===null)throw new Error(Fn(11));function T(){const C=j;C.next&&C.next(h())}return T(),{unsubscribe:w(T)}},[qC](){return this}}}return g({type:Op.INIT}),{dispatch:g,subscribe:p,getState:h,replaceReducer:v,[qC]:b}}function FW(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Op.INIT})>"u")throw new Error(Fn(12));if(typeof r(void 0,{type:Op.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Fn(13))})}function K5(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{FW(r)}catch(i){a=i}return function(s={},c){if(a)throw a;let d=!1;const f={};for(let h=0;h<n.length;h++){const p=n[h],g=r[p],v=s[p],b=g(v,c);if(typeof b>"u")throw c&&c.type,new Error(Fn(14));f[p]=b,d=d||b!==v}return d=d||n.length!==Object.keys(s).length,d?f:s}}function Dp(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function LW(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(Fn(15))};const s={getState:a.getState,dispatch:(d,...f)=>i(d,...f)},c=e.map(d=>d(s));return i=Dp(...c)(a.dispatch),{...a,dispatch:i}}}function Y5(e){return hS(e)&&"type"in e&&typeof e.type=="string"}var X5=Symbol.for("immer-nothing"),KC=Symbol.for("immer-draftable"),da=Symbol.for("immer-state");function Vi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Qa=Object,Yu=Qa.getPrototypeOf,Ip="constructor",Hx="prototype",A2="configurable",Rp="enumerable",xp="writable",e0="value",ul=e=>!!e&&!!e[da];function Ji(e){return e?Z5(e)||Vx(e)||!!e[KC]||!!e[Ip]?.[KC]||Gx(e)||Wx(e):!1}var BW=Qa[Hx][Ip].toString(),YC=new WeakMap;function Z5(e){if(!e||!mS(e))return!1;const t=Yu(e);if(t===null||t===Qa[Hx])return!0;const r=Qa.hasOwnProperty.call(t,Ip)&&t[Ip];if(r===Object)return!0;if(!Ou(r))return!1;let n=YC.get(r);return n===void 0&&(n=Function.toString.call(r),YC.set(r,n)),n===BW}function $0(e,t,r=!0){H0(e)===0?(r?Reflect.ownKeys(e):Qa.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function H0(e){const t=e[da];return t?t.type_:Vx(e)?1:Gx(e)?2:Wx(e)?3:0}var XC=(e,t,r=H0(e))=>r===2?e.has(t):Qa[Hx].hasOwnProperty.call(e,t),O2=(e,t,r=H0(e))=>r===2?e.get(t):e[t],Mp=(e,t,r,n=H0(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function UW(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var Vx=Array.isArray,Gx=e=>e instanceof Map,Wx=e=>e instanceof Set,mS=e=>typeof e=="object",Ou=e=>typeof e=="function",ab=e=>typeof e=="boolean",qs=e=>e.copy_||e.base_,pS=e=>e.modified_?e.copy_:e.base_;function D2(e,t){if(Gx(e))return new Map(e);if(Wx(e))return new Set(e);if(Vx(e))return Array[Hx].slice.call(e);const r=Z5(e);if(t===!0||t==="class_only"&&!r){const n=Qa.getOwnPropertyDescriptors(e);delete n[da];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],c=n[s];c[xp]===!1&&(c[xp]=!0,c[A2]=!0),(c.get||c.set)&&(n[s]={[A2]:!0,[xp]:!0,[Rp]:c[Rp],[e0]:e[s]})}return Qa.create(Yu(e),n)}else{const n=Yu(e);if(n!==null&&r)return{...e};const a=Qa.create(n);return Qa.assign(a,e)}}function xS(e,t=!1){return qx(e)||ul(e)||!Ji(e)||(H0(e)>1&&Qa.defineProperties(e,{set:Pm,add:Pm,clear:Pm,delete:Pm}),Qa.freeze(e),t&&$0(e,(r,n)=>{xS(n,!0)},!1)),e}function zW(){Vi(2)}var Pm={[e0]:zW};function qx(e){return e===null||!mS(e)?!0:Qa.isFrozen(e)}var Pp="MapSet",I2="Patches",Q5={};function Xu(e){const t=Q5[e];return t||Vi(0,e),t}var $W=e=>!!Q5[e],t0,J5=()=>t0,HW=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:$W(Pp)?Xu(Pp):void 0});function ZC(e,t){t&&(e.patchPlugin_=Xu(I2),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function R2(e){M2(e),e.drafts_.forEach(VW),e.drafts_=null}function M2(e){e===t0&&(t0=e.parent_)}var QC=e=>t0=HW(t0,e);function VW(e){const t=e[da];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function JC(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[da].modified_&&(R2(t),Vi(4)),Ji(e)&&(e=e4(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[da].base_,e,t)}else e=e4(t,r);return GW(t,e,!0),R2(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==X5?e:void 0}function e4(e,t){if(qx(t))return t;const r=t[da];if(!r)return gS(t,e.handledSet_,e);if(!Kx(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);rR(r,e)}return r.copy_}function GW(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&xS(t,r)}function eR(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var Kx=(e,t)=>e.scope_===t,WW=[];function tR(e,t,r,n){const a=qs(e),i=e.type_;if(n!==void 0&&O2(a,n,i)===t){Mp(a,n,r,i);return}if(!e.draftLocations_){const c=e.draftLocations_=new Map;$0(a,(d,f)=>{if(ul(f)){const h=c.get(f)||[];h.push(d),c.set(f,h)}})}const s=e.draftLocations_.get(t)??WW;for(const c of s)Mp(a,c,r,i)}function qW(e,t,r){e.callbacks_.push(function(a){const i=t;if(!i||!Kx(i,a))return;a.mapSetPlugin_?.fixSetContents(i);const s=pS(i);tR(e,i.draft_??i,s,r),rR(i,a)})}function rR(e,t){if(e.modified_&&!e.finalized_&&(e.type_===3||(e.assigned_?.size??0)>0)){const{patchPlugin_:n}=t;if(n){const a=n.getPath(e);a&&n.generatePatches_(e,a,t)}eR(e)}}function KW(e,t,r){const{scope_:n}=e;if(ul(r)){const a=r[da];Kx(a,n)&&a.callbacks_.push(function(){gp(e);const s=pS(a);tR(e,r,s,t)})}else Ji(r)&&e.callbacks_.push(function(){const i=qs(e);O2(i,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&gS(O2(e.copy_,t,e.type_),n.handledSet_,n)})}function gS(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||ul(e)||t.has(e)||!Ji(e)||qx(e)||(t.add(e),$0(e,(n,a)=>{if(ul(a)){const i=a[da];if(Kx(i,r)){const s=pS(i);Mp(e,n,s,e.type_),eR(i)}}else Ji(a)&&gS(a,t,r)})),e}function YW(e,t){const r=Vx(e),n={type_:r?1:0,scope_:t?t.scope_:J5(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,i=vS;r&&(a=[n],i=r0);const{revoke:s,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=s,[c,n]}var vS={get(e,t){if(t===da)return e;const r=qs(e);if(!XC(r,t,e.type_))return XW(e,r,t);const n=r[t];if(e.finalized_||!Ji(n))return n;if(n===ib(e.base_,t)){gp(e);const a=e.type_===1?+t:t,i=F2(e.scope_,n,e,a);return e.copy_[a]=i}return n},has(e,t){return t in qs(e)},ownKeys(e){return Reflect.ownKeys(qs(e))},set(e,t,r){const n=nR(qs(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=ib(qs(e),t),i=a?.[da];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(UW(r,a)&&(r!==void 0||XC(e.base_,t,e.type_)))return!0;gp(e),P2(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),KW(e,t,r)),!0},deleteProperty(e,t){return gp(e),ib(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),P2(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=qs(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[xp]:!0,[A2]:e.type_!==1||t!=="length",[Rp]:n[Rp],[e0]:r[t]}},defineProperty(){Vi(11)},getPrototypeOf(e){return Yu(e.base_)},setPrototypeOf(){Vi(12)}},r0={};$0(vS,(e,t)=>{r0[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}});r0.deleteProperty=function(e,t){return r0.set.call(this,e,t,void 0)};r0.set=function(e,t,r){return vS.set.call(this,e[0],t,r,e[0])};function ib(e,t){const r=e[da];return(r?qs(r):e)[t]}function XW(e,t,r){const n=nR(t,r);return n?e0 in n?n[e0]:n.get?.call(e.draft_):void 0}function nR(e,t){if(!(t in e))return;let r=Yu(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Yu(r)}}function P2(e){e.modified_||(e.modified_=!0,e.parent_&&P2(e.parent_))}function gp(e){e.copy_||(e.assigned_=new Map,e.copy_=D2(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var ZW=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Ou(r)&&!Ou(n)){const s=n;n=r;const c=this;return function(f=s,...h){return c.produce(f,p=>n.call(this,p,...h))}}Ou(n)||Vi(6),a!==void 0&&!Ou(a)&&Vi(7);let i;if(Ji(r)){const s=QC(this),c=F2(s,r,void 0);let d=!0;try{i=n(c),d=!1}finally{d?R2(s):M2(s)}return ZC(s,a),JC(i,s)}else if(!r||!mS(r)){if(i=n(r),i===void 0&&(i=r),i===X5&&(i=void 0),this.autoFreeze_&&xS(i,!0),a){const s=[],c=[];Xu(I2).generateReplacementPatches_(r,i,{patches_:s,inversePatches_:c}),a(s,c)}return i}else Vi(1,r)},this.produceWithPatches=(r,n)=>{if(Ou(r))return(c,...d)=>this.produceWithPatches(c,f=>r(f,...d));let a,i;return[this.produce(r,n,(c,d)=>{a=c,i=d}),a,i]},ab(t?.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),ab(t?.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),ab(t?.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){Ji(t)||Vi(8),ul(t)&&(t=Xi(t));const r=QC(this),n=F2(r,t,void 0);return n[da].isManual_=!0,M2(r),n}finishDraft(t,r){const n=t&&t[da];(!n||!n.isManual_)&&Vi(9);const{scope_:a}=n;return ZC(a,r),JC(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const i=r[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(r=r.slice(n+1));const a=Xu(I2).applyPatches_;return ul(t)?a(t,r):this.produce(t,i=>a(i,r))}};function F2(e,t,r,n){const[a,i]=Gx(t)?Xu(Pp).proxyMap_(t,r):Wx(t)?Xu(Pp).proxySet_(t,r):YW(t,r);return(r?.scope_??J5()).drafts_.push(a),i.callbacks_=r?.callbacks_??[],i.key_=n,r&&n!==void 0?qW(r,i,n):i.callbacks_.push(function(d){d.mapSetPlugin_?.fixSetContents(i);const{patchPlugin_:f}=d;i.modified_&&f&&f.generatePatches_(i,[],d)}),a}function Xi(e){return ul(e)||Vi(10,e),aR(e)}function aR(e){if(!Ji(e)||qx(e))return e;const t=e[da];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=D2(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=D2(e,!0);return $0(r,(a,i)=>{Mp(r,a,aR(i))},n),t&&(t.finalized_=!1),r}var QW=new ZW,iR=QW.produce;function sR(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var JW=sR(),eq=sR,tq=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Dp:Dp.apply(null,arguments)};function Ii(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(ei(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Y5(n)&&n.type===e,r}var lR=class Cf extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Cf.prototype)}static get[Symbol.species](){return Cf}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Cf(...t[0].concat(this)):new Cf(...t.concat(this))}};function t4(e){return Ji(e)?iR(e,()=>{}):e}function Fm(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function rq(e){return typeof e=="boolean"}var nq=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new lR;return r&&(rq(r)?s.push(JW):s.push(eq(r.extraArgument))),s},oR="RTK_autoBatch",xr=()=>e=>({payload:e,meta:{[oR]:!0}}),r4=e=>t=>{setTimeout(t,e)},cR=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const c=new Set,d=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:r4(10):e.type==="callback"?e.queueNotification:r4(e.timeout),f=()=>{s=!1,i&&(i=!1,c.forEach(h=>h()))};return Object.assign({},n,{subscribe(h){const p=()=>a&&h(),g=n.subscribe(p);return c.add(h),()=>{g(),c.delete(h)}},dispatch(h){try{return a=!h?.meta?.[oR],i=!a,i&&(s||(s=!0,d(f))),n.dispatch(h)}finally{a=!0}}})},aq=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new lR(e);return n&&a.push(cR(typeof n=="object"?n:void 0)),a};function iq(e){const t=nq(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(hS(r))c=K5(r);else throw new Error(ei(1));let d;typeof n=="function"?d=n(t):d=t();let f=Dp;a&&(f=tq({trace:!1,...typeof a=="object"&&a}));const h=LW(...d),p=aq(h);let g=typeof s=="function"?s(p):p();const v=f(...g);return q5(c,i,v)}function uR(e){const t={},r=[];let n;const a={addCase(i,s){const c=typeof i=="string"?i:i.type;if(!c)throw new Error(ei(28));if(c in t)throw new Error(ei(29));return t[c]=s,a},addAsyncThunk(i,s){return s.pending&&(t[i.pending.type]=s.pending),s.rejected&&(t[i.rejected.type]=s.rejected),s.fulfilled&&(t[i.fulfilled.type]=s.fulfilled),s.settled&&r.push({matcher:i.settled,reducer:s.settled}),a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function sq(e){return typeof e=="function"}function lq(e,t){let[r,n,a]=uR(t),i;if(sq(e))i=()=>t4(e());else{const c=t4(e);i=()=>c}function s(c=i(),d){let f=[r[d.type],...n.filter(({matcher:h})=>h(d)).map(({reducer:h})=>h)];return f.filter(h=>!!h).length===0&&(f=[a]),f.reduce((h,p)=>{if(p)if(ul(h)){const v=p(h,d);return v===void 0?h:v}else{if(Ji(h))return iR(h,g=>p(g,d));{const g=p(h,d);if(g===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return h},c)}return s.getInitialState=i,s}var oq="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",cq=(e=21)=>{let t="",r=e;for(;r--;)t+=oq[Math.random()*64|0];return t},uq=Symbol.for("rtk-slice-createasyncthunk");function dq(e,t){return`${e}/${t}`}function fq({creators:e}={}){const t=e?.asyncThunk?.[uq];return function(n){const{name:a,reducerPath:i=a}=n;if(!a)throw new Error(ei(11));const s=(typeof n.reducers=="function"?n.reducers(mq()):n.reducers)||{},c=Object.keys(s),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(N,C){const E=typeof N=="string"?N:N.type;if(!E)throw new Error(ei(12));if(E in d.sliceCaseReducersByType)throw new Error(ei(13));return d.sliceCaseReducersByType[E]=C,f},addMatcher(N,C){return d.sliceMatchers.push({matcher:N,reducer:C}),f},exposeAction(N,C){return d.actionCreators[N]=C,f},exposeCaseReducer(N,C){return d.sliceCaseReducersByName[N]=C,f}};c.forEach(N=>{const C=s[N],E={reducerName:N,type:dq(a,N),createNotation:typeof n.reducers=="function"};xq(C)?vq(E,C,f,t):pq(E,C,f)});function h(){const[N={},C=[],E=void 0]=typeof n.extraReducers=="function"?uR(n.extraReducers):[n.extraReducers],O={...N,...d.sliceCaseReducersByType};return lq(n.initialState,A=>{for(let D in O)A.addCase(D,O[D]);for(let D of d.sliceMatchers)A.addMatcher(D.matcher,D.reducer);for(let D of C)A.addMatcher(D.matcher,D.reducer);E&&A.addDefaultCase(E)})}const p=N=>N,g=new Map,v=new WeakMap;let b;function y(N,C){return b||(b=h()),b(N,C)}function w(){return b||(b=h()),b.getInitialState()}function j(N,C=!1){function E(A){let D=A[N];return typeof D>"u"&&C&&(D=Fm(v,E,w)),D}function O(A=p){const D=Fm(g,C,()=>new WeakMap);return Fm(D,A,()=>{const M={};for(const[P,R]of Object.entries(n.selectors??{}))M[P]=hq(R,A,()=>Fm(v,A,w),C);return M})}return{reducerPath:N,getSelectors:O,get selectors(){return O(E)},selectSlice:E}}const T={name:a,reducer:y,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:w,...j(i),injectInto(N,{reducerPath:C,...E}={}){const O=C??i;return N.inject({reducerPath:O,reducer:y},E),{...T,...j(O,!0)}}};return T}}function hq(e,t,r,n){function a(i,...s){let c=t(i);return typeof c>"u"&&n&&(c=r()),e(c,...s)}return a.unwrapped=e,a}var Pa=fq();function mq(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function pq({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!gq(n))throw new Error(ei(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?Ii(e,s):Ii(e))}function xq(e){return e._reducerDefinitionType==="asyncThunk"}function gq(e){return e._reducerDefinitionType==="reducerWithPrepare"}function vq({type:e,reducerName:t},r,n,a){if(!a)throw new Error(ei(18));const{payloadCreator:i,fulfilled:s,pending:c,rejected:d,settled:f,options:h}=r,p=a(e,i,h);n.exposeAction(t,p),s&&n.addCase(p.fulfilled,s),c&&n.addCase(p.pending,c),d&&n.addCase(p.rejected,d),f&&n.addMatcher(p.settled,f),n.exposeCaseReducer(t,{fulfilled:s||Lm,pending:c||Lm,rejected:d||Lm,settled:f||Lm})}function Lm(){}var yq="task",dR="listener",fR="completed",yS="cancelled",bq=`task-${yS}`,wq=`task-${fR}`,L2=`${dR}-${yS}`,Sq=`${dR}-${fR}`,Yx=class{constructor(e){this.code=e,this.message=`${yq} ${yS} (reason: ${e})`}name="TaskAbortError";message},bS=(e,t)=>{if(typeof e!="function")throw new TypeError(ei(32))},Fp=()=>{},hR=(e,t=Fp)=>(e.catch(t),e),mR=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),sc=e=>{if(e.aborted)throw new Yx(e.reason)};function pR(e,t){let r=Fp;return new Promise((n,a)=>{const i=()=>a(new Yx(e.reason));if(e.aborted){i();return}r=mR(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=Fp})}var Nq=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Yx?"cancelled":"rejected",error:r}}finally{t?.()}},Lp=e=>t=>hR(pR(e,t).then(r=>(sc(e),r))),xR=e=>{const t=Lp(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Fu}=Object,n4={},Xx="listenerMiddleware",kq=(e,t)=>{const r=n=>mR(e,()=>n.abort(e.reason));return(n,a)=>{bS(n);const i=new AbortController;r(i);const s=Nq(async()=>{sc(e),sc(i.signal);const c=await n({pause:Lp(i.signal),delay:xR(i.signal),signal:i.signal});return sc(i.signal),c},()=>i.abort(wq));return a?.autoJoin&&t.push(s.catch(Fp)),{result:Lp(e)(s),cancel(){i.abort(bq)}}}},_q=(e,t)=>{const r=async(n,a)=>{sc(t);let i=()=>{};const c=[new Promise((d,f)=>{let h=e({predicate:n,effect:(p,g)=>{g.unsubscribe(),d([p,g.getState(),g.getOriginalState()])}});i=()=>{h(),f()}})];a!=null&&c.push(new Promise(d=>setTimeout(d,a,null)));try{const d=await pR(t,Promise.race(c));return sc(t),d}finally{i()}};return(n,a)=>hR(r(n,a))},gR=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=Ii(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(ei(21));return bS(i),{predicate:a,type:t,effect:i}},vR=Fu(e=>{const{type:t,predicate:r,effect:n}=gR(e);return{id:cq(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ei(22))}}},{withTypes:()=>vR}),a4=(e,t)=>{const{type:r,effect:n,predicate:a}=gR(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},B2=e=>{e.pending.forEach(t=>{t.abort(L2)})},jq=(e,t)=>()=>{for(const r of t.keys())B2(r);e.clear()},i4=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},yR=Fu(Ii(`${Xx}/add`),{withTypes:()=>yR}),Eq=Ii(`${Xx}/removeAll`),bR=Fu(Ii(`${Xx}/remove`),{withTypes:()=>bR}),Tq=(...e)=>{console.error(`${Xx}/error`,...e)},V0=(e={})=>{const t=new Map,r=new Map,n=v=>{const b=r.get(v)??0;r.set(v,b+1)},a=v=>{const b=r.get(v)??1;b===1?r.delete(v):r.set(v,b-1)},{extra:i,onError:s=Tq}=e;bS(s);const c=v=>(v.unsubscribe=()=>t.delete(v.id),t.set(v.id,v),b=>{v.unsubscribe(),b?.cancelActive&&B2(v)}),d=v=>{const b=a4(t,v)??vR(v);return c(b)};Fu(d,{withTypes:()=>d});const f=v=>{const b=a4(t,v);return b&&(b.unsubscribe(),v.cancelActive&&B2(b)),!!b};Fu(f,{withTypes:()=>f});const h=async(v,b,y,w)=>{const j=new AbortController,T=_q(d,j.signal),N=[];try{v.pending.add(j),n(v),await Promise.resolve(v.effect(b,Fu({},y,{getOriginalState:w,condition:(C,E)=>T(C,E).then(Boolean),take:T,delay:xR(j.signal),pause:Lp(j.signal),extra:i,signal:j.signal,fork:kq(j.signal,N),unsubscribe:v.unsubscribe,subscribe:()=>{t.set(v.id,v)},cancelActiveListeners:()=>{v.pending.forEach((C,E,O)=>{C!==j&&(C.abort(L2),O.delete(C))})},cancel:()=>{j.abort(L2),v.pending.delete(j)},throwIfCancelled:()=>{sc(j.signal)}})))}catch(C){C instanceof Yx||i4(s,C,{raisedBy:"effect"})}finally{await Promise.all(N),j.abort(Sq),a(v),v.pending.delete(j)}},p=jq(t,r);return{middleware:v=>b=>y=>{if(!Y5(y))return b(y);if(yR.match(y))return d(y.payload);if(Eq.match(y)){p();return}if(bR.match(y))return f(y.payload);let w=v.getState();const j=()=>{if(w===n4)throw new Error(ei(23));return w};let T;try{if(T=b(y),t.size>0){const N=v.getState(),C=Array.from(t.values());for(const E of C){let O=!1;try{O=E.predicate(y,N,w)}catch(A){O=!1,i4(s,A,{raisedBy:"predicate"})}O&&h(E,y,v,j)}}}finally{w=n4}return T},startListening:d,stopListening:f,clearListeners:p}};function ei(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Cq={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},wR=Pa({name:"chartLayout",initialState:Cq,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Aq,setLayout:Oq,setChartSize:Dq,setScale:Iq}=wR.actions,Rq=wR.reducer;function SR(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function en(e){return Number.isFinite(e)}function xo(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function s4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ru(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s4(Object(r),!0).forEach(function(n){Mq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mq(e,t,r){return(t=Pq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pq(e){var t=Fq(e,"string");return typeof t=="symbol"?t:t+""}function Fq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ln(e,t,r){return zr(e)||zr(t)?r:ws(t)?Ku(e,t,r):typeof t=="function"?t(e):r}var Lq=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:c}=t;if((c==="vertical"||c==="horizontal"&&s==="middle")&&i!=="center"&&st(e[i]))return Ru(Ru({},e),{},{[i]:e[i]+(n||0)});if((c==="horizontal"||c==="vertical"&&i==="center")&&s!=="middle"&&st(e[s]))return Ru(Ru({},e),{},{[s]:e[s]+(a||0)})}return e},Oc=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",l4=1e-4,Bq=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-l4,i=Math.max(n[0],n[1])+l4,s=e(t[0]),c=e(t[r-1]);(s<a||s>i||c<a||c>i)&&e.domain([t[0],t[r-1]])}},Uq=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,s=0,c=0;c<r;++c){var d=e[c],f=d?.[a];if(f!=null){var h=f[1],p=f[0],g=ol(h)?p:h;g>=0?(f[0]=i,f[1]=i+g,i=h):(f[0]=s,f[1]=s+g,s=h)}}}},zq=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,s=0;s<r;++s){var c=e[s],d=c?.[a];if(d!=null){var f=ol(d[1])?d[0]:d[1];f>=0?(d[0]=i,d[1]=i+f,i=d[1]):(d[0]=0,d[1]=0)}}}},$q={sign:Uq,expand:hG,none:pc,silhouette:mG,wiggle:pG,positive:zq},Hq=(e,t,r)=>{var n,a=(n=$q[r])!==null&&n!==void 0?n:pc,i=fG().keys(t).value((c,d)=>Number(ln(c,d,0))).order(T2).offset(a),s=i(e);return s.forEach((c,d)=>{c.forEach((f,h)=>{var p=ln(e[h],t[d],0);Array.isArray(p)&&p.length===2&&st(p[0])&&st(p[1])&&(f[0]=p[0],f[1]=p[1])})}),s};function o4(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:i,dataKey:s}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!zr(a[t.dataKey])){var c=A5(r,"value",a[t.dataKey]);if(c)return c.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var d=ln(a,zr(s)?t.dataKey:s);return zr(d)?null:t.scale(d)}var Vq=e=>{var t=e.flat(2).filter(st);return[Math.min(...t),Math.max(...t)]},Gq=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Wq=(e,t,r)=>{if(e!=null)return Gq(Object.keys(e).reduce((n,a)=>{var i=e[a];if(!i)return n;var{stackedData:s}=i,c=s.reduce((d,f)=>{var h=SR(f,t,r),p=Vq(h);return!en(p[0])||!en(p[1])?d:[Math.min(d[0],p[0]),Math.max(d[1],p[1])]},[1/0,-1/0]);return[Math.min(c[0],n[0]),Math.max(c[1],n[1])]},[1/0,-1/0]))},c4=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,u4=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,d4=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();return n}if(e&&t&&t.length>=2){for(var a=$x(t,h=>h.coordinate),i=1/0,s=1,c=a.length;s<c;s++){var d=a[s],f=a[s-1];i=Math.min((d?.coordinate||0)-(f?.coordinate||0),i)}return i===1/0?0:i}return r?void 0:0};function f4(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Ru(Ru({},t),{},{dataKey:r,payload:n,value:a,name:i})}function NR(e,t){if(e)return String(e);if(typeof t=="string")return t}var qq=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},Kq=(e,t)=>t==="centric"?e.angle:e.radius,vl=e=>e.layout.width,yl=e=>e.layout.height,Yq=e=>e.layout.scale,kR=e=>e.layout.margin,Zx=Ne(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Qx=Ne(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),_R="data-recharts-item-index",jR="data-recharts-item-id",G0=60;function h4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h4(Object(r),!0).forEach(function(n){Xq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xq(e,t,r){return(t=Zq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zq(e){var t=Qq(e,"string");return typeof t=="symbol"?t:t+""}function Qq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jq=e=>e.brush.height;function eK(e){var t=Qx(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:G0;return r+a}return r},0)}function tK(e){var t=Qx(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:G0;return r+a}return r},0)}function rK(e){var t=Zx(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function nK(e){var t=Zx(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Hn=Ne([vl,yl,kR,Jq,eK,tK,rK,nK,W5,DW],(e,t,r,n,a,i,s,c,d,f)=>{var h={left:(r.left||0)+a,right:(r.right||0)+i},p={top:(r.top||0)+s,bottom:(r.bottom||0)+c},g=Bm(Bm({},p),h),v=g.bottom;g.bottom+=n,g=Lq(g,d,f);var b=e-g.left-g.right,y=t-g.top-g.bottom;return Bm(Bm({brushBottom:v},g),{},{width:Math.max(b,0),height:Math.max(y,0)})}),aK=Ne(Hn,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),ER=Ne(vl,yl,(e,t)=>({x:0,y:0,width:e,height:t})),iK=k.createContext(null),si=()=>k.useContext(iK)!=null,Jx=e=>e.brush,eg=Ne([Jx,Hn,kR],(e,t,r)=>({height:e.height,x:st(e.x)?e.x:t.left,y:st(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:st(e.width)?e.width:t.width})),sb={},lb={},ob={},m4;function sK(){return m4||(m4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,c=null;const d=i!=null&&i.includes("leading"),f=i==null||i.includes("trailing"),h=()=>{c!==null&&(r.apply(s,c),s=void 0,c=null)},p=()=>{f&&h(),y()};let g=null;const v=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,p()},n)},b=()=>{g!==null&&(clearTimeout(g),g=null)},y=()=>{b(),s=void 0,c=null},w=()=>{h()},j=function(...T){if(a?.aborted)return;s=this,c=T;const N=g==null;v(),d&&N&&h()};return j.schedule=v,j.cancel=y,j.flush=w,a?.addEventListener("abort",y,{once:!0}),j}e.debounce=t})(ob)),ob}var p4;function lK(){return p4||(p4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sK();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:c=!0,maxWait:d}=i,f=Array(2);s&&(f[0]="leading"),c&&(f[1]="trailing");let h,p=null;const g=t.debounce(function(...y){h=n.apply(this,y),p=null},a,{edges:f}),v=function(...y){return d!=null&&(p===null&&(p=Date.now()),Date.now()-p>=d)?(h=n.apply(this,y),p=Date.now(),g.cancel(),g.schedule(),h):(g.apply(this,y),h)},b=()=>(g.flush(),h);return v.cancel=g.cancel,v.flush=b,v}e.debounce=r})(lb)),lb}var x4;function oK(){return x4||(x4=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lK();function r(n,a=0,i={}){const{leading:s=!0,trailing:c=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:c})}e.throttle=r})(sb)),sb}var cb,g4;function cK(){return g4||(g4=1,cb=oK().throttle),cb}var uK=cK();const dK=xl(uK);var v4=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;console.warn(r.replace(/%s/g,()=>a[s++]))}},TR=(e,t,r)=>{var{width:n="100%",height:a="100%",aspect:i,maxHeight:s}=r,c=cl(n)?e:Number(n),d=cl(a)?t:Number(a);return i&&i>0&&(c?d=c/i:d&&(c=d*i),s&&d!=null&&d>s&&(d=s)),{calculatedWidth:c,calculatedHeight:d}},fK={width:0,height:0,overflow:"visible"},hK={width:0,overflowX:"visible"},mK={height:0,overflowY:"visible"},pK={},xK=e=>{var{width:t,height:r}=e,n=cl(t),a=cl(r);return n&&a?fK:n?hK:a?mK:pK};function gK(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a="100%",i="100%"):a===void 0?a=n&&n>0?void 0:"100%":i===void 0&&(i=n&&n>0?void 0:"100%"),{width:a,height:i}}function U2(){return U2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U2.apply(null,arguments)}function y4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function b4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y4(Object(r),!0).forEach(function(n){vK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vK(e,t,r){return(t=yK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yK(e){var t=bK(e,"string");return typeof t=="symbol"?t:t+""}function bK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CR=k.createContext({width:-1,height:-1});function wK(e){return xo(e.width)&&xo(e.height)}function AR(e){var{children:t,width:r,height:n}=e,a=k.useMemo(()=>({width:r,height:n}),[r,n]);return wK(a)?k.createElement(CR.Provider,{value:a},t):null}var wS=()=>k.useContext(CR),SK=k.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a,height:i,minWidth:s=0,minHeight:c,maxHeight:d,children:f,debounce:h=0,id:p,className:g,onResize:v,style:b={}}=e,y=k.useRef(null),w=k.useRef();w.current=v,k.useImperativeHandle(t,()=>y.current);var[j,T]=k.useState({containerWidth:n.width,containerHeight:n.height}),N=k.useCallback((D,M)=>{T(P=>{var R=Math.round(D),L=Math.round(M);return P.containerWidth===R&&P.containerHeight===L?P:{containerWidth:R,containerHeight:L}})},[]);k.useEffect(()=>{if(y.current==null||typeof ResizeObserver>"u")return z0;var D=L=>{var te,{width:ee,height:ue}=L[0].contentRect;N(ee,ue),(te=w.current)===null||te===void 0||te.call(w,ee,ue)};h>0&&(D=dK(D,h,{trailing:!0,leading:!1}));var M=new ResizeObserver(D),{width:P,height:R}=y.current.getBoundingClientRect();return N(P,R),M.observe(y.current),()=>{M.disconnect()}},[N,h]);var{containerWidth:C,containerHeight:E}=j;v4(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:O,calculatedHeight:A}=TR(C,E,{width:a,height:i,aspect:r,maxHeight:d});return v4(O!=null&&O>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,A,a,i,s,c,r),k.createElement("div",{id:p?"".concat(p):void 0,className:tr("recharts-responsive-container",g),style:b4(b4({},b),{},{width:a,height:i,minWidth:s,minHeight:c,maxHeight:d}),ref:y},k.createElement("div",{style:xK({width:a,height:i})},k.createElement(AR,{width:O,height:A},f)))}),NK=k.forwardRef((e,t)=>{var r=wS();if(xo(r.width)&&xo(r.height))return e.children;var{width:n,height:a}=gK({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:s}=TR(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return st(i)&&st(s)?k.createElement(AR,{width:i,height:s},e.children):k.createElement(SK,U2({},e,{width:n,height:a,ref:t}))});function OR(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var W0=()=>{var e,t=si(),r=at(aK),n=at(eg),a=(e=at(Jx))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},kK={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},_K=()=>{var e;return(e=at(Hn))!==null&&e!==void 0?e:kK},jK=()=>at(vl),EK=()=>at(yl),jr=e=>e.layout.layoutType,tg=()=>at(jr),TK=()=>{var e=tg();return e!==void 0},rg=e=>{var t=Mr(),r=si(),{width:n,height:a}=e,i=wS(),s=n,c=a;return i&&(s=i.width>0?i.width:n,c=i.height>0?i.height:a),k.useEffect(()=>{!r&&xo(s)&&xo(c)&&t(Dq({width:s,height:c}))},[t,r,s,c]),null},DR=Symbol.for("immer-nothing"),w4=Symbol.for("immer-draftable"),ni=Symbol.for("immer-state");function Gi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var n0=Object.getPrototypeOf;function Zu(e){return!!e&&!!e[ni]}function xc(e){return e?IR(e)||Array.isArray(e)||!!e[w4]||!!e.constructor?.[w4]||q0(e)||ag(e):!1}var CK=Object.prototype.constructor.toString(),S4=new WeakMap;function IR(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=S4.get(r);return n===void 0&&(n=Function.toString.call(r),S4.set(r,n)),n===CK}function Bp(e,t,r=!0){ng(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function ng(e){const t=e[ni];return t?t.type_:Array.isArray(e)?1:q0(e)?2:ag(e)?3:0}function z2(e,t){return ng(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function RR(e,t,r){const n=ng(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function AK(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function q0(e){return e instanceof Map}function ag(e){return e instanceof Set}function Xo(e){return e.copy_||e.base_}function $2(e,t){if(q0(e))return new Map(e);if(ag(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=IR(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ni];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],c=n[s];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[s]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[s]})}return Object.create(n0(e),n)}else{const n=n0(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function SS(e,t=!1){return ig(e)||Zu(e)||!xc(e)||(ng(e)>1&&Object.defineProperties(e,{set:Um,add:Um,clear:Um,delete:Um}),Object.freeze(e),t&&Object.values(e).forEach(r=>SS(r,!0))),e}function OK(){Gi(2)}var Um={value:OK};function ig(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var DK={};function gc(e){const t=DK[e];return t||Gi(0,e),t}var a0;function MR(){return a0}function IK(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function N4(e,t){t&&(gc("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function H2(e){V2(e),e.drafts_.forEach(RK),e.drafts_=null}function V2(e){e===a0&&(a0=e.parent_)}function k4(e){return a0=IK(a0,e)}function RK(e){const t=e[ni];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function _4(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ni].modified_&&(H2(t),Gi(4)),xc(e)&&(e=Up(t,e),t.parent_||zp(t,e)),t.patches_&&gc("Patches").generateReplacementPatches_(r[ni].base_,e,t.patches_,t.inversePatches_)):e=Up(t,r,[]),H2(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==DR?e:void 0}function Up(e,t,r){if(ig(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[ni];if(!a)return Bp(t,(i,s)=>j4(e,a,t,i,s,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return zp(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let s=i,c=!1;a.type_===3&&(s=new Set(i),i.clear(),c=!0),Bp(s,(d,f)=>j4(e,a,i,d,f,r,c),n),zp(e,i,!1),r&&e.patches_&&gc("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function j4(e,t,r,n,a,i,s){if(a==null||typeof a!="object"&&!s)return;const c=ig(a);if(!(c&&!s)){if(Zu(a)){const d=i&&t&&t.type_!==3&&!z2(t.assigned_,n)?i.concat(n):void 0,f=Up(e,a,d);if(RR(r,n,f),Zu(f))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(xc(a)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&c)return;Up(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(q0(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&zp(e,a)}}}function zp(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&SS(t,r)}function MK(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:MR(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=NS;r&&(a=[n],i=i0);const{revoke:s,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=s,c}var NS={get(e,t){if(t===ni)return e;const r=Xo(e);if(!z2(r,t))return PK(e,r,t);const n=r[t];return e.finalized_||!xc(n)?n:n===ub(e.base_,t)?(db(e),e.copy_[t]=W2(n,e)):n},has(e,t){return t in Xo(e)},ownKeys(e){return Reflect.ownKeys(Xo(e))},set(e,t,r){const n=PR(Xo(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=ub(Xo(e),t),i=a?.[ni];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(AK(r,a)&&(r!==void 0||z2(e.base_,t)))return!0;db(e),G2(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return ub(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,db(e),G2(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Xo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Gi(11)},getPrototypeOf(e){return n0(e.base_)},setPrototypeOf(){Gi(12)}},i0={};Bp(NS,(e,t)=>{i0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});i0.deleteProperty=function(e,t){return i0.set.call(this,e,t,void 0)};i0.set=function(e,t,r){return NS.set.call(this,e[0],t,r,e[0])};function ub(e,t){const r=e[ni];return(r?Xo(r):e)[t]}function PK(e,t,r){const n=PR(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function PR(e,t){if(!(t in e))return;let r=n0(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=n0(r)}}function G2(e){e.modified_||(e.modified_=!0,e.parent_&&G2(e.parent_))}function db(e){e.copy_||(e.copy_=$2(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var FK=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(d=i,...f){return s.produce(d,h=>r.call(this,h,...f))}}typeof r!="function"&&Gi(6),n!==void 0&&typeof n!="function"&&Gi(7);let a;if(xc(t)){const i=k4(this),s=W2(t,void 0);let c=!0;try{a=r(s),c=!1}finally{c?H2(i):V2(i)}return N4(i,n),_4(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===DR&&(a=void 0),this.autoFreeze_&&SS(a,!0),n){const i=[],s=[];gc("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Gi(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...c)=>this.produceWithPatches(s,d=>t(d,...c));let n,a;return[this.produce(t,r,(s,c)=>{n=s,a=c}),n,a]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){xc(e)||Gi(8),Zu(e)&&(e=LK(e));const t=k4(this),r=W2(e,void 0);return r[ni].isManual_=!0,V2(t),r}finishDraft(e,t){const r=e&&e[ni];(!r||!r.isManual_)&&Gi(9);const{scope_:n}=r;return N4(n,t),_4(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=gc("Patches").applyPatches_;return Zu(e)?n(e,t):this.produce(e,a=>n(a,t))}};function W2(e,t){const r=q0(e)?gc("MapSet").proxyMap_(e,t):ag(e)?gc("MapSet").proxySet_(e,t):MK(e,t);return(t?t.scope_:MR()).drafts_.push(r),r}function LK(e){return Zu(e)||Gi(10,e),FR(e)}function FR(e){if(!xc(e)||ig(e))return e;const t=e[ni];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=$2(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=$2(e,!0);return Bp(r,(a,i)=>{RR(r,a,FR(i))},n),t&&(t.finalized_=!1),r}var BK=new FK;BK.produce;var UK={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},LR=Pa({name:"legend",initialState:UK,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:xr()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Xi(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:xr()},removeLegendPayload:{reducer(e,t){var r=Xi(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:xr()}}}),{setLegendSize:Gwe,setLegendSettings:Wwe,addLegendPayload:zK,replaceLegendPayload:$K,removeLegendPayload:HK}=LR.actions,VK=LR.reducer;function q2(){return q2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},q2.apply(null,arguments)}function E4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E4(Object(r),!0).forEach(function(n){GK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GK(e,t,r){return(t=WK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WK(e){var t=qK(e,"string");return typeof t=="symbol"?t:t+""}function qK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KK(e){return Array.isArray(e)&&ws(e[0])&&ws(e[1])?e.join(" ~ "):e}var YK=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:c,wrapperClassName:d,labelClassName:f,label:h,labelFormatter:p,accessibilityLayer:g=!1}=e,v=()=>{if(i&&i.length){var E={padding:0,margin:0},O=(c?$x(i,c):i).map((A,D)=>{if(A.type==="none")return null;var M=A.formatter||s||KK,{value:P,name:R}=A,L=P,te=R;if(M){var ee=M(P,R,A,D,i);if(Array.isArray(ee))[L,te]=ee;else if(ee!=null)L=ee;else return null}var ue=fb({display:"block",paddingTop:4,paddingBottom:4,color:A.color||"#000"},n);return k.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(D),style:ue},ws(te)?k.createElement("span",{className:"recharts-tooltip-item-name"},te):null,ws(te)?k.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,k.createElement("span",{className:"recharts-tooltip-item-value"},L),k.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return k.createElement("ul",{className:"recharts-tooltip-item-list",style:E},O)}return null},b=fb({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),y=fb({margin:0},a),w=!zr(h),j=w?h:"",T=tr("recharts-default-tooltip",d),N=tr("recharts-tooltip-label",f);w&&p&&i!==void 0&&i!==null&&(j=p(h,i));var C=g?{role:"status","aria-live":"assertive"}:{};return k.createElement("div",q2({className:T,style:b},C),k.createElement("p",{className:N,style:y},k.isValidElement(j)?j:"".concat(j)),v())},vf="recharts-tooltip-wrapper",XK={visibility:"hidden"};function ZK(e){var{coordinate:t,translateX:r,translateY:n}=e;return tr(vf,{["".concat(vf,"-right")]:st(r)&&t&&st(t.x)&&r>=t.x,["".concat(vf,"-left")]:st(r)&&t&&st(t.x)&&r<t.x,["".concat(vf,"-bottom")]:st(n)&&t&&st(t.y)&&n>=t.y,["".concat(vf,"-top")]:st(n)&&t&&st(t.y)&&n<t.y})}function T4(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:c,viewBox:d,viewBoxDimension:f}=e;if(i&&st(i[n]))return i[n];var h=r[n]-c-(a>0?a:0),p=r[n]+a;if(t[n])return s[n]?h:p;var g=d[n];if(g==null)return 0;if(s[n]){var v=h,b=g;return v<b?Math.max(p,g):Math.max(h,g)}if(f==null)return 0;var y=p+c,w=g+f;return y>w?Math.max(h,g):Math.max(p,g)}function QK(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function JK(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:c,viewBox:d}=e,f,h,p;return s.height>0&&s.width>0&&r?(h=T4({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:d,viewBoxDimension:d.width}),p=T4({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:d,viewBoxDimension:d.height}),f=QK({translateX:h,translateY:p,useTranslate3d:c})):f=XK,{cssProperties:f,cssClasses:ZK({translateX:h,translateY:p,coordinate:r})}}function C4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C4(Object(r),!0).forEach(function(n){K2(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K2(e,t,r){return(t=eY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eY(e){var t=tY(e,"string");return typeof t=="symbol"?t:t+""}function tY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class rY extends k.PureComponent{constructor(){super(...arguments),K2(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),K2(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:c,isAnimationActive:d,offset:f,position:h,reverseDirection:p,useTranslate3d:g,viewBox:v,wrapperStyle:b,lastBoundingBox:y,innerRef:w,hasPortalFromProps:j}=this.props,{cssClasses:T,cssProperties:N}=JK({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:f,position:h,reverseDirection:p,tooltipBox:{height:y.height,width:y.width},useTranslate3d:g,viewBox:v}),C=j?{}:zm(zm({transition:d&&t?"transform ".concat(n,"ms ").concat(a):void 0},N),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),E=zm(zm({},C),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},b);return k.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:E,ref:w},i)}}var BR=()=>{var e;return(e=at(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Y2(){return Y2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y2.apply(null,arguments)}function A4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function O4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A4(Object(r),!0).forEach(function(n){nY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nY(e,t,r){return(t=aY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aY(e){var t=iY(e,"string");return typeof t=="symbol"?t:t+""}function iY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var D4={curveBasisClosed:tG,curveBasisOpen:rG,curveBasis:eG,curveBumpX:UV,curveBumpY:zV,curveLinearClosed:nG,curveLinear:Ux,curveMonotoneX:aG,curveMonotoneY:iG,curveNatural:sG,curveStep:lG,curveStepAfter:cG,curveStepBefore:oG},$p=e=>en(e.x)&&en(e.y),I4=e=>e.base!=null&&$p(e.base)&&$p(e),yf=e=>e.x,bf=e=>e.y,sY=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(U0(e));return(r==="curveMonotone"||r==="curveBump")&&t?D4["".concat(r).concat(t==="vertical"?"Y":"X")]:D4[r]||Ux},lY=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=sY(t,a),c=i?r.filter($p):r,d;if(Array.isArray(n)){var f=r.map((v,b)=>O4(O4({},v),{},{base:n[b]}));a==="vertical"?d=Im().y(bf).x1(yf).x0(v=>v.base.x):d=Im().x(yf).y1(bf).y0(v=>v.base.y);var h=d.defined(I4).curve(s),p=i?f.filter(I4):f;return h(p)}a==="vertical"&&st(n)?d=Im().y(bf).x1(yf).x0(n):st(n)?d=Im().x(yf).y1(bf).y0(n):d=g5().x(yf).y(bf);var g=d.defined($p).curve(s);return g(c)},kS=e=>{var{className:t,points:r,path:n,pathRef:a}=e,i=tg();if((!r||!r.length)&&!n)return null;var s={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},c=r&&r.length?lY(s):n;return k.createElement("path",Y2({},ll(e),RG(e),{className:tr("recharts-curve",t),d:c===null?void 0:c,ref:a}))},oY=["x","y","top","left","width","height","className"];function X2(){return X2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},X2.apply(null,arguments)}function R4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R4(Object(r),!0).forEach(function(n){uY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uY(e,t,r){return(t=dY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dY(e){var t=fY(e,"string");return typeof t=="symbol"?t:t+""}function fY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function hY(e,t){if(e==null)return{};var r,n,a=mY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pY=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),xY=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:c}=e,d=hY(e,oY),f=cY({x:t,y:r,top:n,left:a,width:i,height:s},d);return!st(t)||!st(r)||!st(i)||!st(s)||!st(n)||!st(a)?null:k.createElement("path",X2({},Di(f),{className:tr("recharts-cross",c),d:pY(t,r,i,s,n,a)}))};function gY(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function M4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function P4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M4(Object(r),!0).forEach(function(n){vY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vY(e,t,r){return(t=yY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yY(e){var t=bY(e,"string");return typeof t=="symbol"?t:t+""}function bY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wY=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),UR=(e,t,r)=>e.map(n=>"".concat(wY(n)," ").concat(t,"ms ").concat(r)).join(","),SY=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),s0=(e,t)=>Object.keys(t).reduce((r,n)=>P4(P4({},r),{},{[n]:e(n,t[n])}),{});function F4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F4(Object(r),!0).forEach(function(n){NY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NY(e,t,r){return(t=kY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kY(e){var t=_Y(e,"string");return typeof t=="symbol"?t:t+""}function _Y(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hp=(e,t,r)=>e+(t-e)*r,Z2=e=>{var{from:t,to:r}=e;return t!==r},zR=(e,t,r)=>{var n=s0((a,i)=>{if(Z2(i)){var[s,c]=e(i.from,i.to,i.velocity);return nn(nn({},i),{},{from:s,velocity:c})}return i},t);return r<1?s0((a,i)=>Z2(i)&&n[a]!=null?nn(nn({},i),{},{velocity:Hp(i.velocity,n[a].velocity,r),from:Hp(i.from,n[a].from,r)}):i,t):zR(e,n,r-1)};function jY(e,t,r,n,a,i){var s,c=n.reduce((g,v)=>nn(nn({},g),{},{[v]:{from:e[v],velocity:0,to:t[v]}}),{}),d=()=>s0((g,v)=>v.from,c),f=()=>!Object.values(c).filter(Z2).length,h=null,p=g=>{s||(s=g);var v=g-s,b=v/r.dt;c=zR(r,c,b),a(nn(nn(nn({},e),t),d())),s=g,f()||(h=i.setTimeout(p))};return()=>(h=i.setTimeout(p),()=>{var g;(g=h)===null||g===void 0||g()})}function EY(e,t,r,n,a,i,s){var c=null,d=a.reduce((p,g)=>{var v=e[g],b=t[g];return v==null||b==null?p:nn(nn({},p),{},{[g]:[v,b]})},{}),f,h=p=>{f||(f=p);var g=(p-f)/n,v=s0((y,w)=>Hp(...w,r(g)),d);if(i(nn(nn(nn({},e),t),v)),g<1)c=s.setTimeout(h);else{var b=s0((y,w)=>Hp(...w,r(1)),d);i(nn(nn(nn({},e),t),b))}};return()=>(c=s.setTimeout(h),()=>{var p;(p=c)===null||p===void 0||p()})}const TY=(e,t,r,n,a,i)=>{var s=SY(e,t);return r==null?()=>(a(nn(nn({},e),t)),()=>{}):r.isStepper===!0?jY(e,t,r,s,a,i):EY(e,t,r,n,s,a,i)};var Vp=1e-4,$R=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],HR=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),L4=(e,t)=>r=>{var n=$R(e,t);return HR(n,r)},CY=(e,t)=>r=>{var n=$R(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return HR(a,r)},AY=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(i=>parseFloat(i));return[a[0],a[1],a[2],a[3]]},OY=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=AY(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},DY=(e,t,r,n)=>{var a=L4(e,r),i=L4(t,n),s=CY(e,r),c=f=>f>1?1:f<0?0:f,d=f=>{for(var h=f>1?1:f,p=h,g=0;g<8;++g){var v=a(p)-h,b=s(p);if(Math.abs(v-h)<Vp||b<Vp)return i(p);p=c(p-v/b)}return i(p)};return d.isStepper=!1,d},B4=function(){return DY(...OY(...arguments))},IY=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,c,d)=>{var f=-(s-c)*r,h=d*n,p=d+(f-h)*a/1e3,g=d*a/1e3+s;return Math.abs(g-c)<Vp&&Math.abs(p)<Vp?[c,0]:[g,p]};return i.isStepper=!0,i.dt=a,i},RY=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return B4(e);case"spring":return IY();default:if(e.split("(")[0]==="cubic-bezier")return B4(e)}return typeof e=="function"?e:null};function MY(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var c=s,[d,...f]=c;if(typeof d=="number"){a=e.setTimeout(i.bind(null,f),d);return}i(d),a=e.setTimeout(i.bind(null,f));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class PY{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{a!=null&&cancelAnimationFrame(a)}}}function FY(){return MY(new PY)}var LY=k.createContext(FY);function BY(e,t){var r=k.useContext(LY);return k.useMemo(()=>t??r(e),[e,t,r])}var UY=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),sg={isSsr:UY()},zY={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},U4={t:0},hb={t:1};function _S(e){var t=Ma(e,zY),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:c,onAnimationStart:d,children:f}=t,h=r==="auto"?!sg.isSsr:r,p=BY(t.animationId,t.animationManager),[g,v]=k.useState(h?U4:hb),b=k.useRef(null);return k.useEffect(()=>{h||v(hb)},[h]),k.useEffect(()=>{if(!h||!n)return z0;var y=TY(U4,hb,RY(i),a,v,p.getTimeoutController()),w=()=>{b.current=y()};return p.start([d,s,w,a,c]),()=>{p.stop(),b.current&&b.current(),c()}},[h,n,a,i,s,d,c,p]),f(g.t)}function jS(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=k.useRef(Jf(t)),n=k.useRef(e);return n.current!==e&&(r.current=Jf(t),n.current=e),r.current}var $Y=["radius"],HY=["radius"],z4,$4,H4,V4,G4,W4,q4,K4,Y4,X4;function Z4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Q4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z4(Object(r),!0).forEach(function(n){VY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VY(e,t,r){return(t=GY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GY(e){var t=WY(e,"string");return typeof t=="symbol"?t:t+""}function WY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gp(){return Gp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gp.apply(null,arguments)}function J4(e,t){if(e==null)return{};var r,n,a=qY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function qY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ds(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var eA=(e,t,r,n,a)=>{var i=io(r),s=io(n),c=Math.min(Math.abs(i)/2,Math.abs(s)/2),d=s>=0?1:-1,f=i>=0?1:-1,h=s>=0&&i>=0||s<0&&i<0?1:0,p;if(c>0&&a instanceof Array){for(var g=[0,0,0,0],v=0,b=4;v<b;v++)g[v]=a[v]>c?c:a[v];p=Ar(z4||(z4=ds(["M",",",""])),e,t+d*g[0]),g[0]>0&&(p+=Ar($4||($4=ds(["A ",",",",0,0,",",",",",""])),g[0],g[0],h,e+f*g[0],t)),p+=Ar(H4||(H4=ds(["L ",",",""])),e+r-f*g[1],t),g[1]>0&&(p+=Ar(V4||(V4=ds(["A ",",",",0,0,",`,
        `,",",""])),g[1],g[1],h,e+r,t+d*g[1])),p+=Ar(G4||(G4=ds(["L ",",",""])),e+r,t+n-d*g[2]),g[2]>0&&(p+=Ar(W4||(W4=ds(["A ",",",",0,0,",`,
        `,",",""])),g[2],g[2],h,e+r-f*g[2],t+n)),p+=Ar(q4||(q4=ds(["L ",",",""])),e+f*g[3],t+n),g[3]>0&&(p+=Ar(K4||(K4=ds(["A ",",",",0,0,",`,
        `,",",""])),g[3],g[3],h,e,t+n-d*g[3])),p+="Z"}else if(c>0&&a===+a&&a>0){var y=Math.min(c,a);p=Ar(Y4||(Y4=ds(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+d*y,y,y,h,e+f*y,t,e+r-f*y,t,y,y,h,e+r,t+d*y,e+r,t+n-d*y,y,y,h,e+r-f*y,t+n,e+f*y,t+n,y,y,h,e,t+n-d*y)}else p=Ar(X4||(X4=ds(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return p},tA={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},VR=e=>{var t=Ma(e,tA),r=k.useRef(null),[n,a]=k.useState(-1);k.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var K=r.current.getTotalLength();K&&a(K)}catch{}},[]);var{x:i,y:s,width:c,height:d,radius:f,className:h}=t,{animationEasing:p,animationDuration:g,animationBegin:v,isAnimationActive:b,isUpdateAnimationActive:y}=t,w=k.useRef(c),j=k.useRef(d),T=k.useRef(i),N=k.useRef(s),C=k.useMemo(()=>({x:i,y:s,width:c,height:d,radius:f}),[i,s,c,d,f]),E=jS(C,"rectangle-");if(i!==+i||s!==+s||c!==+c||d!==+d||c===0||d===0)return null;var O=tr("recharts-rectangle",h);if(!y){var A=Di(t),{radius:D}=A,M=J4(A,$Y);return k.createElement("path",Gp({},M,{x:io(i),y:io(s),width:io(c),height:io(d),radius:typeof f=="number"?f:void 0,className:O,d:eA(i,s,c,d,f)}))}var P=w.current,R=j.current,L=T.current,te=N.current,ee="0px ".concat(n===-1?1:n,"px"),ue="".concat(n,"px 0px"),V=UR(["strokeDasharray"],g,typeof p=="string"?p:tA.animationEasing);return k.createElement(_S,{animationId:E,key:E,canBegin:n>0,duration:g,easing:p,isActive:y,begin:v},K=>{var ie=Ka(P,c,K),re=Ka(R,d,K),me=Ka(L,i,K),W=Ka(te,s,K);r.current&&(w.current=ie,j.current=re,T.current=me,N.current=W);var F;b?K>0?F={transition:V,strokeDasharray:ue}:F={strokeDasharray:ee}:F={strokeDasharray:ue};var X=Di(t),{radius:q}=X,U=J4(X,HY);return k.createElement("path",Gp({},U,{radius:typeof f=="number"?f:void 0,className:O,d:eA(me,W,ie,re,f),ref:r,style:Q4(Q4({},F),t.style)}))})};function rA(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rA(Object(r),!0).forEach(function(n){KY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rA(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KY(e,t,r){return(t=YY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YY(e){var t=XY(e,"string");return typeof t=="symbol"?t:t+""}function XY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wp=Math.PI/180,ZY=e=>e*180/Math.PI,$n=(e,t,r,n)=>({x:e+Math.cos(-Wp*n)*r,y:t+Math.sin(-Wp*n)*r}),QY=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},JY=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},eX=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=JY({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var c=(r-a)/s,d=Math.acos(c);return n>i&&(d=2*Math.PI-d),{radius:s,angle:ZY(d),angleInRadian:d}},tX=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},rX=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},nX=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:i}=eX({x:r,y:n},t),{innerRadius:s,outerRadius:c}=t;if(a<s||a>c||a===0)return null;var{startAngle:d,endAngle:f}=tX(t),h=i,p;if(d<=f){for(;h>f;)h-=360;for(;h<d;)h+=360;p=h>=d&&h<=f}else{for(;h>d;)h-=360;for(;h<f;)h+=360;p=h>=f&&h<=d}return p?nA(nA({},t),{},{radius:a,angle:rX(h,t)}):null};function GR(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=$n(t,r,n,a),c=$n(t,r,n,i);return{points:[s,c],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}var aA,iA,sA,lA,oA,cA,uA;function Q2(){return Q2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q2.apply(null,arguments)}function ec(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var aX=(e,t)=>{var r=qi(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},$m=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:c,cornerIsExternal:d}=e,f=c*(s?1:-1)+n,h=Math.asin(c/f)/Wp,p=d?a:a+i*h,g=$n(t,r,f,p),v=$n(t,r,n,p),b=d?a-i*h:a,y=$n(t,r,f*Math.cos(h*Wp),b);return{center:g,circleTangency:v,lineTangency:y,theta:h}},WR=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,c=aX(i,s),d=i+c,f=$n(t,r,a,i),h=$n(t,r,a,d),p=Ar(aA||(aA=ec(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),f.x,f.y,a,a,+(Math.abs(c)>180),+(i>d),h.x,h.y);if(n>0){var g=$n(t,r,n,i),v=$n(t,r,n,d);p+=Ar(iA||(iA=ec(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),v.x,v.y,n,n,+(Math.abs(c)>180),+(i<=d),g.x,g.y)}else p+=Ar(sA||(sA=ec(["L ",","," Z"])),t,r);return p},iX=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:c,startAngle:d,endAngle:f}=e,h=qi(f-d),{circleTangency:p,lineTangency:g,theta:v}=$m({cx:t,cy:r,radius:a,angle:d,sign:h,cornerRadius:i,cornerIsExternal:c}),{circleTangency:b,lineTangency:y,theta:w}=$m({cx:t,cy:r,radius:a,angle:f,sign:-h,cornerRadius:i,cornerIsExternal:c}),j=c?Math.abs(d-f):Math.abs(d-f)-v-w;if(j<0)return s?Ar(lA||(lA=ec(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),g.x,g.y,i,i,i*2,i,i,-i*2):WR({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:d,endAngle:f});var T=Ar(oA||(oA=ec(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),g.x,g.y,i,i,+(h<0),p.x,p.y,a,a,+(j>180),+(h<0),b.x,b.y,i,i,+(h<0),y.x,y.y);if(n>0){var{circleTangency:N,lineTangency:C,theta:E}=$m({cx:t,cy:r,radius:n,angle:d,sign:h,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),{circleTangency:O,lineTangency:A,theta:D}=$m({cx:t,cy:r,radius:n,angle:f,sign:-h,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),M=c?Math.abs(d-f):Math.abs(d-f)-E-D;if(M<0&&i===0)return"".concat(T,"L").concat(t,",").concat(r,"Z");T+=Ar(cA||(cA=ec(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,i,i,+(h<0),O.x,O.y,n,n,+(M>180),+(h>0),N.x,N.y,i,i,+(h<0),C.x,C.y)}else T+=Ar(uA||(uA=ec(["L",",","Z"])),t,r);return T},sX={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},qR=e=>{var t=Ma(e,sX),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:c,cornerIsExternal:d,startAngle:f,endAngle:h,className:p}=t;if(i<a||f===h)return null;var g=tr("recharts-sector",p),v=i-a,b=po(s,v,0,!0),y;return b>0&&Math.abs(f-h)<360?y=iX({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(b,v/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:f,endAngle:h}):y=WR({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:f,endAngle:h}),k.createElement("path",Q2({},Di(t),{className:g,d:y}))};function lX(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(D5(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:i,outerRadius:s,angle:c}=t,d=$n(n,a,i,c),f=$n(n,a,s,c);return[{x:d.x,y:d.y},{x:f.x,y:f.y}]}return GR(t)}}var mb={},pb={},xb={},dA;function oX(){return dA||(dA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V5();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(xb)),xb}var fA;function cX(){return fA||(fA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oX();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(pb)),pb}var hA;function uX(){return hA||(hA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G5(),r=cX();function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const c=Math.max(Math.ceil((i-a)/(s||1)),0),d=new Array(c);for(let f=0;f<c;f++)d[f]=a,a+=s;return d}e.range=n})(mb)),mb}var gb,mA;function dX(){return mA||(mA=1,gb=uX().range),gb}var fX=dX();const KR=xl(fX);function uo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hX(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ES(e){let t,r,n;e.length!==2?(t=uo,r=(c,d)=>uo(e(c),d),n=(c,d)=>e(c)-d):(t=e===uo||e===hX?e:mX,r=e,n=e);function a(c,d,f=0,h=c.length){if(f<h){if(t(d,d)!==0)return h;do{const p=f+h>>>1;r(c[p],d)<0?f=p+1:h=p}while(f<h)}return f}function i(c,d,f=0,h=c.length){if(f<h){if(t(d,d)!==0)return h;do{const p=f+h>>>1;r(c[p],d)<=0?f=p+1:h=p}while(f<h)}return f}function s(c,d,f=0,h=c.length){const p=a(c,d,f,h-1);return p>f&&n(c[p-1],d)>-n(c[p],d)?p-1:p}return{left:a,center:s,right:i}}function mX(){return 0}function YR(e){return e===null?NaN:+e}function*pX(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const xX=ES(uo),K0=xX.right;ES(YR).center;class pA extends Map{constructor(t,r=yX){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(xA(this,t))}has(t){return super.has(xA(this,t))}set(t,r){return super.set(gX(this,t),r)}delete(t){return super.delete(vX(this,t))}}function xA({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function gX({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function vX({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function yX(e){return e!==null&&typeof e=="object"?e.valueOf():e}function bX(e=uo){if(e===uo)return XR;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function XR(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const wX=Math.sqrt(50),SX=Math.sqrt(10),NX=Math.sqrt(2);function qp(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=wX?10:i>=SX?5:i>=NX?2:1;let c,d,f;return a<0?(f=Math.pow(10,-a)/s,c=Math.round(e*f),d=Math.round(t*f),c/f<e&&++c,d/f>t&&--d,f=-f):(f=Math.pow(10,a)*s,c=Math.round(e/f),d=Math.round(t/f),c*f<e&&++c,d*f>t&&--d),d<c&&.5<=r&&r<2?qp(e,t,r*2):[c,d,f]}function J2(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?qp(t,e,r):qp(e,t,r);if(!(i>=a))return[];const c=i-a+1,d=new Array(c);if(n)if(s<0)for(let f=0;f<c;++f)d[f]=(i-f)/-s;else for(let f=0;f<c;++f)d[f]=(i-f)*s;else if(s<0)for(let f=0;f<c;++f)d[f]=(a+f)/-s;else for(let f=0;f<c;++f)d[f]=(a+f)*s;return d}function ew(e,t,r){return t=+t,e=+e,r=+r,qp(e,t,r)[2]}function tw(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?ew(t,e,r):ew(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function gA(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function vA(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function ZR(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?XR:bX(a);n>r;){if(n-r>600){const d=n-r+1,f=t-r+1,h=Math.log(d),p=.5*Math.exp(2*h/3),g=.5*Math.sqrt(h*p*(d-p)/d)*(f-d/2<0?-1:1),v=Math.max(r,Math.floor(t-f*p/d+g)),b=Math.min(n,Math.floor(t+(d-f)*p/d+g));ZR(e,t,v,b,a)}const i=e[t];let s=r,c=n;for(wf(e,r,t),a(e[n],i)>0&&wf(e,r,n);s<c;){for(wf(e,s,c),++s,--c;a(e[s],i)<0;)++s;for(;a(e[c],i)>0;)--c}a(e[r],i)===0?wf(e,r,c):(++c,wf(e,c,n)),c<=t&&(r=c+1),t<=c&&(n=c-1)}return e}function wf(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function kX(e,t,r){if(e=Float64Array.from(pX(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return vA(e);if(t>=1)return gA(e);var n,a=(n-1)*t,i=Math.floor(a),s=gA(ZR(e,i).subarray(0,i+1)),c=vA(e.subarray(i+1));return s+(c-s)*(a-i)}}function _X(e,t,r=YR){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return s+(c-s)*(a-i)}}function jX(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Mi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function bl(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const rw=Symbol("implicit");function TS(){var e=new pA,t=[],r=[],n=rw;function a(i){let s=e.get(i);if(s===void 0){if(n!==rw)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new pA;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return TS(t,r).unknown(n)},Mi.apply(a,arguments),a}function CS(){var e=TS().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,c=!1,d=0,f=0,h=.5;delete e.unknown;function p(){var g=t().length,v=a<n,b=v?a:n,y=v?n:a;i=(y-b)/Math.max(1,g-d+f*2),c&&(i=Math.floor(i)),b+=(y-b-i*(g-d))*h,s=i*(1-d),c&&(b=Math.round(b),s=Math.round(s));var w=jX(g).map(function(j){return b+i*j});return r(v?w.reverse():w)}return e.domain=function(g){return arguments.length?(t(g),p()):t()},e.range=function(g){return arguments.length?([n,a]=g,n=+n,a=+a,p()):[n,a]},e.rangeRound=function(g){return[n,a]=g,n=+n,a=+a,c=!0,p()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(g){return arguments.length?(c=!!g,p()):c},e.padding=function(g){return arguments.length?(d=Math.min(1,f=+g),p()):d},e.paddingInner=function(g){return arguments.length?(d=Math.min(1,g),p()):d},e.paddingOuter=function(g){return arguments.length?(f=+g,p()):f},e.align=function(g){return arguments.length?(h=Math.max(0,Math.min(1,g)),p()):h},e.copy=function(){return CS(t(),[n,a]).round(c).paddingInner(d).paddingOuter(f).align(h)},Mi.apply(p(),arguments)}function QR(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return QR(t())},e}function EX(){return QR(CS.apply(null,arguments).paddingInner(1))}function AS(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function JR(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Y0(){}var l0=.7,Kp=1/l0,Lu="\\s*([+-]?\\d+)\\s*",o0="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",gs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",TX=/^#([0-9a-f]{3,8})$/,CX=new RegExp(`^rgb\\(${Lu},${Lu},${Lu}\\)$`),AX=new RegExp(`^rgb\\(${gs},${gs},${gs}\\)$`),OX=new RegExp(`^rgba\\(${Lu},${Lu},${Lu},${o0}\\)$`),DX=new RegExp(`^rgba\\(${gs},${gs},${gs},${o0}\\)$`),IX=new RegExp(`^hsl\\(${o0},${gs},${gs}\\)$`),RX=new RegExp(`^hsla\\(${o0},${gs},${gs},${o0}\\)$`),yA={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};AS(Y0,c0,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:bA,formatHex:bA,formatHex8:MX,formatHsl:PX,formatRgb:wA,toString:wA});function bA(){return this.rgb().formatHex()}function MX(){return this.rgb().formatHex8()}function PX(){return eM(this).formatHsl()}function wA(){return this.rgb().formatRgb()}function c0(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=TX.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?SA(t):r===3?new Ca(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Hm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Hm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=CX.exec(e))?new Ca(t[1],t[2],t[3],1):(t=AX.exec(e))?new Ca(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=OX.exec(e))?Hm(t[1],t[2],t[3],t[4]):(t=DX.exec(e))?Hm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=IX.exec(e))?_A(t[1],t[2]/100,t[3]/100,1):(t=RX.exec(e))?_A(t[1],t[2]/100,t[3]/100,t[4]):yA.hasOwnProperty(e)?SA(yA[e]):e==="transparent"?new Ca(NaN,NaN,NaN,0):null}function SA(e){return new Ca(e>>16&255,e>>8&255,e&255,1)}function Hm(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ca(e,t,r,n)}function FX(e){return e instanceof Y0||(e=c0(e)),e?(e=e.rgb(),new Ca(e.r,e.g,e.b,e.opacity)):new Ca}function nw(e,t,r,n){return arguments.length===1?FX(e):new Ca(e,t,r,n??1)}function Ca(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}AS(Ca,nw,JR(Y0,{brighter(e){return e=e==null?Kp:Math.pow(Kp,e),new Ca(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?l0:Math.pow(l0,e),new Ca(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ca(lc(this.r),lc(this.g),lc(this.b),Yp(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:NA,formatHex:NA,formatHex8:LX,formatRgb:kA,toString:kA}));function NA(){return`#${tc(this.r)}${tc(this.g)}${tc(this.b)}`}function LX(){return`#${tc(this.r)}${tc(this.g)}${tc(this.b)}${tc((isNaN(this.opacity)?1:this.opacity)*255)}`}function kA(){const e=Yp(this.opacity);return`${e===1?"rgb(":"rgba("}${lc(this.r)}, ${lc(this.g)}, ${lc(this.b)}${e===1?")":`, ${e})`}`}function Yp(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function lc(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function tc(e){return e=lc(e),(e<16?"0":"")+e.toString(16)}function _A(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Wi(e,t,r,n)}function eM(e){if(e instanceof Wi)return new Wi(e.h,e.s,e.l,e.opacity);if(e instanceof Y0||(e=c0(e)),!e)return new Wi;if(e instanceof Wi)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,c=i-a,d=(i+a)/2;return c?(t===i?s=(r-n)/c+(r<n)*6:r===i?s=(n-t)/c+2:s=(t-r)/c+4,c/=d<.5?i+a:2-i-a,s*=60):c=d>0&&d<1?0:s,new Wi(s,c,d,e.opacity)}function BX(e,t,r,n){return arguments.length===1?eM(e):new Wi(e,t,r,n??1)}function Wi(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}AS(Wi,BX,JR(Y0,{brighter(e){return e=e==null?Kp:Math.pow(Kp,e),new Wi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?l0:Math.pow(l0,e),new Wi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Ca(vb(e>=240?e-240:e+120,a,n),vb(e,a,n),vb(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Wi(jA(this.h),Vm(this.s),Vm(this.l),Yp(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Yp(this.opacity);return`${e===1?"hsl(":"hsla("}${jA(this.h)}, ${Vm(this.s)*100}%, ${Vm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function jA(e){return e=(e||0)%360,e<0?e+360:e}function Vm(e){return Math.max(0,Math.min(1,e||0))}function vb(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const OS=e=>()=>e;function UX(e,t){return function(r){return e+r*t}}function zX(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function $X(e){return(e=+e)==1?tM:function(t,r){return r-t?zX(t,r,e):OS(isNaN(t)?r:t)}}function tM(e,t){var r=t-e;return r?UX(e,r):OS(isNaN(e)?t:e)}const EA=(function e(t){var r=$X(t);function n(a,i){var s=r((a=nw(a)).r,(i=nw(i)).r),c=r(a.g,i.g),d=r(a.b,i.b),f=tM(a.opacity,i.opacity);return function(h){return a.r=s(h),a.g=c(h),a.b=d(h),a.opacity=f(h),a+""}}return n.gamma=e,n})(1);function HX(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function VX(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function GX(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=cd(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(c){for(s=0;s<n;++s)i[s]=a[s](c);return i}}function WX(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Xp(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function qX(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=cd(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var aw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yb=new RegExp(aw.source,"g");function KX(e){return function(){return e}}function YX(e){return function(t){return e(t)+""}}function XX(e,t){var r=aw.lastIndex=yb.lastIndex=0,n,a,i,s=-1,c=[],d=[];for(e=e+"",t=t+"";(n=aw.exec(e))&&(a=yb.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[s]?c[s]+=i:c[++s]=i),(n=n[0])===(a=a[0])?c[s]?c[s]+=a:c[++s]=a:(c[++s]=null,d.push({i:s,x:Xp(n,a)})),r=yb.lastIndex;return r<t.length&&(i=t.slice(r),c[s]?c[s]+=i:c[++s]=i),c.length<2?d[0]?YX(d[0].x):KX(t):(t=d.length,function(f){for(var h=0,p;h<t;++h)c[(p=d[h]).i]=p.x(f);return c.join("")})}function cd(e,t){var r=typeof t,n;return t==null||r==="boolean"?OS(t):(r==="number"?Xp:r==="string"?(n=c0(t))?(t=n,EA):XX:t instanceof c0?EA:t instanceof Date?WX:VX(t)?HX:Array.isArray(t)?GX:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?qX:Xp)(e,t)}function DS(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function ZX(e,t){t===void 0&&(t=e,e=cd);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var c=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[c](s-c)}}function QX(e){return function(){return e}}function Zp(e){return+e}var TA=[0,1];function ca(e){return e}function iw(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:QX(isNaN(t)?NaN:.5)}function JX(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function eZ(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=iw(a,n),i=r(s,i)):(n=iw(n,a),i=r(i,s)),function(c){return i(n(c))}}function tZ(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=iw(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(c){var d=K0(e,c,1,n)-1;return i[d](a[d](c))}}function X0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function lg(){var e=TA,t=TA,r=cd,n,a,i,s=ca,c,d,f;function h(){var g=Math.min(e.length,t.length);return s!==ca&&(s=JX(e[0],e[g-1])),c=g>2?tZ:eZ,d=f=null,p}function p(g){return g==null||isNaN(g=+g)?i:(d||(d=c(e.map(n),t,r)))(n(s(g)))}return p.invert=function(g){return s(a((f||(f=c(t,e.map(n),Xp)))(g)))},p.domain=function(g){return arguments.length?(e=Array.from(g,Zp),h()):e.slice()},p.range=function(g){return arguments.length?(t=Array.from(g),h()):t.slice()},p.rangeRound=function(g){return t=Array.from(g),r=DS,h()},p.clamp=function(g){return arguments.length?(s=g?!0:ca,h()):s!==ca},p.interpolate=function(g){return arguments.length?(r=g,h()):r},p.unknown=function(g){return arguments.length?(i=g,p):i},function(g,v){return n=g,a=v,h()}}function IS(){return lg()(ca,ca)}function rZ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Qp(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Qu(e){return e=Qp(Math.abs(e)),e?e[1]:NaN}function nZ(e,t){return function(r,n){for(var a=r.length,i=[],s=0,c=e[0],d=0;a>0&&c>0&&(d+c+1>n&&(c=Math.max(1,n-d)),i.push(r.substring(a-=c,a+c)),!((d+=c+1)>n));)c=e[s=(s+1)%e.length];return i.reverse().join(t)}}function aZ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var iZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function u0(e){if(!(t=iZ.exec(e)))throw new Error("invalid format: "+e);var t;return new RS({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}u0.prototype=RS.prototype;function RS(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}RS.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function sZ(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var rM;function lZ(e,t){var r=Qp(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(rM=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Qp(e,Math.max(0,t+i-1))[0]}function CA(e,t){var r=Qp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const AA={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rZ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>CA(e*100,t),r:CA,s:lZ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function OA(e){return e}var DA=Array.prototype.map,IA=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function oZ(e){var t=e.grouping===void 0||e.thousands===void 0?OA:nZ(DA.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?OA:aZ(DA.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function f(p){p=u0(p);var g=p.fill,v=p.align,b=p.sign,y=p.symbol,w=p.zero,j=p.width,T=p.comma,N=p.precision,C=p.trim,E=p.type;E==="n"?(T=!0,E="g"):AA[E]||(N===void 0&&(N=12),C=!0,E="g"),(w||g==="0"&&v==="=")&&(w=!0,g="0",v="=");var O=y==="$"?r:y==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",A=y==="$"?n:/[%p]/.test(E)?s:"",D=AA[E],M=/[defgprs%]/.test(E);N=N===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function P(R){var L=O,te=A,ee,ue,V;if(E==="c")te=D(R)+te,R="";else{R=+R;var K=R<0||1/R<0;if(R=isNaN(R)?d:D(Math.abs(R),N),C&&(R=sZ(R)),K&&+R==0&&b!=="+"&&(K=!1),L=(K?b==="("?b:c:b==="-"||b==="("?"":b)+L,te=(E==="s"?IA[8+rM/3]:"")+te+(K&&b==="("?")":""),M){for(ee=-1,ue=R.length;++ee<ue;)if(V=R.charCodeAt(ee),48>V||V>57){te=(V===46?a+R.slice(ee+1):R.slice(ee))+te,R=R.slice(0,ee);break}}}T&&!w&&(R=t(R,1/0));var ie=L.length+R.length+te.length,re=ie<j?new Array(j-ie+1).join(g):"";switch(T&&w&&(R=t(re+R,re.length?j-te.length:1/0),re=""),v){case"<":R=L+R+te+re;break;case"=":R=L+re+R+te;break;case"^":R=re.slice(0,ie=re.length>>1)+L+R+te+re.slice(ie);break;default:R=re+L+R+te;break}return i(R)}return P.toString=function(){return p+""},P}function h(p,g){var v=f((p=u0(p),p.type="f",p)),b=Math.max(-8,Math.min(8,Math.floor(Qu(g)/3)))*3,y=Math.pow(10,-b),w=IA[8+b/3];return function(j){return v(y*j)+w}}return{format:f,formatPrefix:h}}var Gm,MS,nM;cZ({thousands:",",grouping:[3],currency:["$",""]});function cZ(e){return Gm=oZ(e),MS=Gm.format,nM=Gm.formatPrefix,Gm}function uZ(e){return Math.max(0,-Qu(Math.abs(e)))}function dZ(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qu(t)/3)))*3-Qu(Math.abs(e)))}function fZ(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Qu(t)-Qu(e))+1}function aM(e,t,r,n){var a=tw(e,t,r),i;switch(n=u0(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=dZ(a,s))&&(n.precision=i),nM(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=fZ(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=uZ(a))&&(n.precision=i-(n.type==="%")*2);break}}return MS(n)}function ko(e){var t=e.domain;return e.ticks=function(r){var n=t();return J2(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return aM(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],c=n[i],d,f,h=10;for(c<s&&(f=s,s=c,c=f,f=a,a=i,i=f);h-- >0;){if(f=ew(s,c,r),f===d)return n[a]=s,n[i]=c,t(n);if(f>0)s=Math.floor(s/f)*f,c=Math.ceil(c/f)*f;else if(f<0)s=Math.ceil(s*f)/f,c=Math.floor(c*f)/f;else break;d=f}return e},e}function iM(){var e=IS();return e.copy=function(){return X0(e,iM())},Mi.apply(e,arguments),ko(e)}function sM(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Zp),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return sM(e).unknown(t)},e=arguments.length?Array.from(e,Zp):[0,1],ko(r)}function lM(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function RA(e){return Math.log(e)}function MA(e){return Math.exp(e)}function hZ(e){return-Math.log(-e)}function mZ(e){return-Math.exp(-e)}function pZ(e){return isFinite(e)?+("1e"+e):e<0?0:e}function xZ(e){return e===10?pZ:e===Math.E?Math.exp:t=>Math.pow(e,t)}function gZ(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function PA(e){return(t,r)=>-e(-t,r)}function PS(e){const t=e(RA,MA),r=t.domain;let n=10,a,i;function s(){return a=gZ(n),i=xZ(n),r()[0]<0?(a=PA(a),i=PA(i),e(hZ,mZ)):e(RA,MA),t}return t.base=function(c){return arguments.length?(n=+c,s()):n},t.domain=function(c){return arguments.length?(r(c),s()):r()},t.ticks=c=>{const d=r();let f=d[0],h=d[d.length-1];const p=h<f;p&&([f,h]=[h,f]);let g=a(f),v=a(h),b,y;const w=c==null?10:+c;let j=[];if(!(n%1)&&v-g<w){if(g=Math.floor(g),v=Math.ceil(v),f>0){for(;g<=v;++g)for(b=1;b<n;++b)if(y=g<0?b/i(-g):b*i(g),!(y<f)){if(y>h)break;j.push(y)}}else for(;g<=v;++g)for(b=n-1;b>=1;--b)if(y=g>0?b/i(-g):b*i(g),!(y<f)){if(y>h)break;j.push(y)}j.length*2<w&&(j=J2(f,h,w))}else j=J2(g,v,Math.min(v-g,w)).map(i);return p?j.reverse():j},t.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=n===10?"s":","),typeof d!="function"&&(!(n%1)&&(d=u0(d)).precision==null&&(d.trim=!0),d=MS(d)),c===1/0)return d;const f=Math.max(1,n*c/t.ticks().length);return h=>{let p=h/i(Math.round(a(h)));return p*n<n-.5&&(p*=n),p<=f?d(h):""}},t.nice=()=>r(lM(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),t}function oM(){const e=PS(lg()).domain([1,10]);return e.copy=()=>X0(e,oM()).base(e.base()),Mi.apply(e,arguments),e}function FA(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function LA(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function FS(e){var t=1,r=e(FA(t),LA(t));return r.constant=function(n){return arguments.length?e(FA(t=+n),LA(t)):t},ko(r)}function cM(){var e=FS(lg());return e.copy=function(){return X0(e,cM()).constant(e.constant())},Mi.apply(e,arguments)}function BA(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function vZ(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function yZ(e){return e<0?-e*e:e*e}function LS(e){var t=e(ca,ca),r=1;function n(){return r===1?e(ca,ca):r===.5?e(vZ,yZ):e(BA(r),BA(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},ko(t)}function BS(){var e=LS(lg());return e.copy=function(){return X0(e,BS()).exponent(e.exponent())},Mi.apply(e,arguments),e}function bZ(){return BS.apply(null,arguments).exponent(.5)}function UA(e){return Math.sign(e)*e*e}function wZ(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function uM(){var e=IS(),t=[0,1],r=!1,n;function a(i){var s=wZ(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(UA(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,Zp)).map(UA)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return uM(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Mi.apply(a,arguments),ko(a)}function dM(){var e=[],t=[],r=[],n;function a(){var s=0,c=Math.max(1,t.length);for(r=new Array(c-1);++s<c;)r[s-1]=_X(e,s/c);return i}function i(s){return s==null||isNaN(s=+s)?n:t[K0(r,s)]}return i.invertExtent=function(s){var c=t.indexOf(s);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let c of s)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(uo),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return dM().domain(e).range(t).unknown(n)},Mi.apply(i,arguments)}function fM(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(d){return d!=null&&d<=d?a[K0(n,d,0,r)]:i}function c(){var d=-1;for(n=new Array(r);++d<r;)n[d]=((d+1)*t-(d-r)*e)/(r+1);return s}return s.domain=function(d){return arguments.length?([e,t]=d,e=+e,t=+t,c()):[e,t]},s.range=function(d){return arguments.length?(r=(a=Array.from(d)).length-1,c()):a.slice()},s.invertExtent=function(d){var f=a.indexOf(d);return f<0?[NaN,NaN]:f<1?[e,n[0]]:f>=r?[n[r-1],t]:[n[f-1],n[f]]},s.unknown=function(d){return arguments.length&&(i=d),s},s.thresholds=function(){return n.slice()},s.copy=function(){return fM().domain([e,t]).range(a).unknown(i)},Mi.apply(ko(s),arguments)}function hM(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[K0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return hM().domain(e).range(t).unknown(r)},Mi.apply(a,arguments)}const bb=new Date,wb=new Date;function cn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),c=a.ceil(i);return i-s<c-i?s:c},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,c)=>{const d=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<s)||!(c>0))return d;let f;do d.push(f=new Date(+i)),t(i,c),e(i);while(f<i&&i<s);return d},a.filter=i=>cn(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,c)=>{if(s>=s)if(c<0)for(;++c<=0;)for(;t(s,-1),!i(s););else for(;--c>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(bb.setTime(+i),wb.setTime(+s),e(bb),e(wb),Math.floor(r(bb,wb))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const Jp=cn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Jp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?cn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Jp);Jp.range;const Xs=1e3,Ci=Xs*60,Zs=Ci*60,dl=Zs*24,US=dl*7,zA=dl*30,Sb=dl*365,rc=cn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Xs)},(e,t)=>(t-e)/Xs,e=>e.getUTCSeconds());rc.range;const zS=cn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Xs)},(e,t)=>{e.setTime(+e+t*Ci)},(e,t)=>(t-e)/Ci,e=>e.getMinutes());zS.range;const $S=cn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ci)},(e,t)=>(t-e)/Ci,e=>e.getUTCMinutes());$S.range;const HS=cn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Xs-e.getMinutes()*Ci)},(e,t)=>{e.setTime(+e+t*Zs)},(e,t)=>(t-e)/Zs,e=>e.getHours());HS.range;const VS=cn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Zs)},(e,t)=>(t-e)/Zs,e=>e.getUTCHours());VS.range;const Z0=cn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ci)/dl,e=>e.getDate()-1);Z0.range;const og=cn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/dl,e=>e.getUTCDate()-1);og.range;const mM=cn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/dl,e=>Math.floor(e/dl));mM.range;function Dc(e){return cn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ci)/US)}const cg=Dc(0),ex=Dc(1),SZ=Dc(2),NZ=Dc(3),Ju=Dc(4),kZ=Dc(5),_Z=Dc(6);cg.range;ex.range;SZ.range;NZ.range;Ju.range;kZ.range;_Z.range;function Ic(e){return cn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/US)}const ug=Ic(0),tx=Ic(1),jZ=Ic(2),EZ=Ic(3),ed=Ic(4),TZ=Ic(5),CZ=Ic(6);ug.range;tx.range;jZ.range;EZ.range;ed.range;TZ.range;CZ.range;const GS=cn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());GS.range;const WS=cn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());WS.range;const fl=cn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());fl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});fl.range;const hl=cn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());hl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:cn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});hl.range;function pM(e,t,r,n,a,i){const s=[[rc,1,Xs],[rc,5,5*Xs],[rc,15,15*Xs],[rc,30,30*Xs],[i,1,Ci],[i,5,5*Ci],[i,15,15*Ci],[i,30,30*Ci],[a,1,Zs],[a,3,3*Zs],[a,6,6*Zs],[a,12,12*Zs],[n,1,dl],[n,2,2*dl],[r,1,US],[t,1,zA],[t,3,3*zA],[e,1,Sb]];function c(f,h,p){const g=h<f;g&&([f,h]=[h,f]);const v=p&&typeof p.range=="function"?p:d(f,h,p),b=v?v.range(f,+h+1):[];return g?b.reverse():b}function d(f,h,p){const g=Math.abs(h-f)/p,v=ES(([,,w])=>w).right(s,g);if(v===s.length)return e.every(tw(f/Sb,h/Sb,p));if(v===0)return Jp.every(Math.max(tw(f,h,p),1));const[b,y]=s[g/s[v-1][2]<s[v][2]/g?v-1:v];return b.every(y)}return[c,d]}const[AZ,OZ]=pM(hl,WS,ug,mM,VS,$S),[DZ,IZ]=pM(fl,GS,cg,Z0,HS,zS);function Nb(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function kb(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Sf(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function RZ(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,c=e.months,d=e.shortMonths,f=Nf(a),h=kf(a),p=Nf(i),g=kf(i),v=Nf(s),b=kf(s),y=Nf(c),w=kf(c),j=Nf(d),T=kf(d),N={a:K,A:ie,b:re,B:me,c:null,d:qA,e:qA,f:nQ,g:hQ,G:pQ,H:eQ,I:tQ,j:rQ,L:xM,m:aQ,M:iQ,p:W,q:F,Q:XA,s:ZA,S:sQ,u:lQ,U:oQ,V:cQ,w:uQ,W:dQ,x:null,X:null,y:fQ,Y:mQ,Z:xQ,"%":YA},C={a:X,A:q,b:U,B:G,c:null,d:KA,e:KA,f:bQ,g:AQ,G:DQ,H:gQ,I:vQ,j:yQ,L:vM,m:wQ,M:SQ,p:le,q:de,Q:XA,s:ZA,S:NQ,u:kQ,U:_Q,V:jQ,w:EQ,W:TQ,x:null,X:null,y:CQ,Y:OQ,Z:IQ,"%":YA},E={a:P,A:R,b:L,B:te,c:ee,d:GA,e:GA,f:XZ,g:VA,G:HA,H:WA,I:WA,j:WZ,L:YZ,m:GZ,M:qZ,p:M,q:VZ,Q:QZ,s:JZ,S:KZ,u:BZ,U:UZ,V:zZ,w:LZ,W:$Z,x:ue,X:V,y:VA,Y:HA,Z:HZ,"%":ZZ};N.x=O(r,N),N.X=O(n,N),N.c=O(t,N),C.x=O(r,C),C.X=O(n,C),C.c=O(t,C);function O(ne,oe){return function(Ae){var z=[],et=-1,Be=0,Je=ne.length,He,Ie,_t;for(Ae instanceof Date||(Ae=new Date(+Ae));++et<Je;)ne.charCodeAt(et)===37&&(z.push(ne.slice(Be,et)),(Ie=$A[He=ne.charAt(++et)])!=null?He=ne.charAt(++et):Ie=He==="e"?" ":"0",(_t=oe[He])&&(He=_t(Ae,Ie)),z.push(He),Be=et+1);return z.push(ne.slice(Be,et)),z.join("")}}function A(ne,oe){return function(Ae){var z=Sf(1900,void 0,1),et=D(z,ne,Ae+="",0),Be,Je;if(et!=Ae.length)return null;if("Q"in z)return new Date(z.Q);if("s"in z)return new Date(z.s*1e3+("L"in z?z.L:0));if(oe&&!("Z"in z)&&(z.Z=0),"p"in z&&(z.H=z.H%12+z.p*12),z.m===void 0&&(z.m="q"in z?z.q:0),"V"in z){if(z.V<1||z.V>53)return null;"w"in z||(z.w=1),"Z"in z?(Be=kb(Sf(z.y,0,1)),Je=Be.getUTCDay(),Be=Je>4||Je===0?tx.ceil(Be):tx(Be),Be=og.offset(Be,(z.V-1)*7),z.y=Be.getUTCFullYear(),z.m=Be.getUTCMonth(),z.d=Be.getUTCDate()+(z.w+6)%7):(Be=Nb(Sf(z.y,0,1)),Je=Be.getDay(),Be=Je>4||Je===0?ex.ceil(Be):ex(Be),Be=Z0.offset(Be,(z.V-1)*7),z.y=Be.getFullYear(),z.m=Be.getMonth(),z.d=Be.getDate()+(z.w+6)%7)}else("W"in z||"U"in z)&&("w"in z||(z.w="u"in z?z.u%7:"W"in z?1:0),Je="Z"in z?kb(Sf(z.y,0,1)).getUTCDay():Nb(Sf(z.y,0,1)).getDay(),z.m=0,z.d="W"in z?(z.w+6)%7+z.W*7-(Je+5)%7:z.w+z.U*7-(Je+6)%7);return"Z"in z?(z.H+=z.Z/100|0,z.M+=z.Z%100,kb(z)):Nb(z)}}function D(ne,oe,Ae,z){for(var et=0,Be=oe.length,Je=Ae.length,He,Ie;et<Be;){if(z>=Je)return-1;if(He=oe.charCodeAt(et++),He===37){if(He=oe.charAt(et++),Ie=E[He in $A?oe.charAt(et++):He],!Ie||(z=Ie(ne,Ae,z))<0)return-1}else if(He!=Ae.charCodeAt(z++))return-1}return z}function M(ne,oe,Ae){var z=f.exec(oe.slice(Ae));return z?(ne.p=h.get(z[0].toLowerCase()),Ae+z[0].length):-1}function P(ne,oe,Ae){var z=v.exec(oe.slice(Ae));return z?(ne.w=b.get(z[0].toLowerCase()),Ae+z[0].length):-1}function R(ne,oe,Ae){var z=p.exec(oe.slice(Ae));return z?(ne.w=g.get(z[0].toLowerCase()),Ae+z[0].length):-1}function L(ne,oe,Ae){var z=j.exec(oe.slice(Ae));return z?(ne.m=T.get(z[0].toLowerCase()),Ae+z[0].length):-1}function te(ne,oe,Ae){var z=y.exec(oe.slice(Ae));return z?(ne.m=w.get(z[0].toLowerCase()),Ae+z[0].length):-1}function ee(ne,oe,Ae){return D(ne,t,oe,Ae)}function ue(ne,oe,Ae){return D(ne,r,oe,Ae)}function V(ne,oe,Ae){return D(ne,n,oe,Ae)}function K(ne){return s[ne.getDay()]}function ie(ne){return i[ne.getDay()]}function re(ne){return d[ne.getMonth()]}function me(ne){return c[ne.getMonth()]}function W(ne){return a[+(ne.getHours()>=12)]}function F(ne){return 1+~~(ne.getMonth()/3)}function X(ne){return s[ne.getUTCDay()]}function q(ne){return i[ne.getUTCDay()]}function U(ne){return d[ne.getUTCMonth()]}function G(ne){return c[ne.getUTCMonth()]}function le(ne){return a[+(ne.getUTCHours()>=12)]}function de(ne){return 1+~~(ne.getUTCMonth()/3)}return{format:function(ne){var oe=O(ne+="",N);return oe.toString=function(){return ne},oe},parse:function(ne){var oe=A(ne+="",!1);return oe.toString=function(){return ne},oe},utcFormat:function(ne){var oe=O(ne+="",C);return oe.toString=function(){return ne},oe},utcParse:function(ne){var oe=A(ne+="",!0);return oe.toString=function(){return ne},oe}}}var $A={"-":"",_:" ",0:"0"},En=/^\s*\d+/,MZ=/^%/,PZ=/[\\^$*+?|[\]().{}]/g;function Dt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function FZ(e){return e.replace(PZ,"\\$&")}function Nf(e){return new RegExp("^(?:"+e.map(FZ).join("|")+")","i")}function kf(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function LZ(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function BZ(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function UZ(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function zZ(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function $Z(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function HA(e,t,r){var n=En.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function VA(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function HZ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function VZ(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function GZ(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function GA(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function WZ(e,t,r){var n=En.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function WA(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function qZ(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function KZ(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function YZ(e,t,r){var n=En.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function XZ(e,t,r){var n=En.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function ZZ(e,t,r){var n=MZ.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function QZ(e,t,r){var n=En.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function JZ(e,t,r){var n=En.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function qA(e,t){return Dt(e.getDate(),t,2)}function eQ(e,t){return Dt(e.getHours(),t,2)}function tQ(e,t){return Dt(e.getHours()%12||12,t,2)}function rQ(e,t){return Dt(1+Z0.count(fl(e),e),t,3)}function xM(e,t){return Dt(e.getMilliseconds(),t,3)}function nQ(e,t){return xM(e,t)+"000"}function aQ(e,t){return Dt(e.getMonth()+1,t,2)}function iQ(e,t){return Dt(e.getMinutes(),t,2)}function sQ(e,t){return Dt(e.getSeconds(),t,2)}function lQ(e){var t=e.getDay();return t===0?7:t}function oQ(e,t){return Dt(cg.count(fl(e)-1,e),t,2)}function gM(e){var t=e.getDay();return t>=4||t===0?Ju(e):Ju.ceil(e)}function cQ(e,t){return e=gM(e),Dt(Ju.count(fl(e),e)+(fl(e).getDay()===4),t,2)}function uQ(e){return e.getDay()}function dQ(e,t){return Dt(ex.count(fl(e)-1,e),t,2)}function fQ(e,t){return Dt(e.getFullYear()%100,t,2)}function hQ(e,t){return e=gM(e),Dt(e.getFullYear()%100,t,2)}function mQ(e,t){return Dt(e.getFullYear()%1e4,t,4)}function pQ(e,t){var r=e.getDay();return e=r>=4||r===0?Ju(e):Ju.ceil(e),Dt(e.getFullYear()%1e4,t,4)}function xQ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Dt(t/60|0,"0",2)+Dt(t%60,"0",2)}function KA(e,t){return Dt(e.getUTCDate(),t,2)}function gQ(e,t){return Dt(e.getUTCHours(),t,2)}function vQ(e,t){return Dt(e.getUTCHours()%12||12,t,2)}function yQ(e,t){return Dt(1+og.count(hl(e),e),t,3)}function vM(e,t){return Dt(e.getUTCMilliseconds(),t,3)}function bQ(e,t){return vM(e,t)+"000"}function wQ(e,t){return Dt(e.getUTCMonth()+1,t,2)}function SQ(e,t){return Dt(e.getUTCMinutes(),t,2)}function NQ(e,t){return Dt(e.getUTCSeconds(),t,2)}function kQ(e){var t=e.getUTCDay();return t===0?7:t}function _Q(e,t){return Dt(ug.count(hl(e)-1,e),t,2)}function yM(e){var t=e.getUTCDay();return t>=4||t===0?ed(e):ed.ceil(e)}function jQ(e,t){return e=yM(e),Dt(ed.count(hl(e),e)+(hl(e).getUTCDay()===4),t,2)}function EQ(e){return e.getUTCDay()}function TQ(e,t){return Dt(tx.count(hl(e)-1,e),t,2)}function CQ(e,t){return Dt(e.getUTCFullYear()%100,t,2)}function AQ(e,t){return e=yM(e),Dt(e.getUTCFullYear()%100,t,2)}function OQ(e,t){return Dt(e.getUTCFullYear()%1e4,t,4)}function DQ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?ed(e):ed.ceil(e),Dt(e.getUTCFullYear()%1e4,t,4)}function IQ(){return"+0000"}function YA(){return"%"}function XA(e){return+e}function ZA(e){return Math.floor(+e/1e3)}var Su,bM,wM;RQ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function RQ(e){return Su=RZ(e),bM=Su.format,Su.parse,wM=Su.utcFormat,Su.utcParse,Su}function MQ(e){return new Date(e)}function PQ(e){return e instanceof Date?+e:+new Date(+e)}function qS(e,t,r,n,a,i,s,c,d,f){var h=IS(),p=h.invert,g=h.domain,v=f(".%L"),b=f(":%S"),y=f("%I:%M"),w=f("%I %p"),j=f("%a %d"),T=f("%b %d"),N=f("%B"),C=f("%Y");function E(O){return(d(O)<O?v:c(O)<O?b:s(O)<O?y:i(O)<O?w:n(O)<O?a(O)<O?j:T:r(O)<O?N:C)(O)}return h.invert=function(O){return new Date(p(O))},h.domain=function(O){return arguments.length?g(Array.from(O,PQ)):g().map(MQ)},h.ticks=function(O){var A=g();return e(A[0],A[A.length-1],O??10)},h.tickFormat=function(O,A){return A==null?E:f(A)},h.nice=function(O){var A=g();return(!O||typeof O.range!="function")&&(O=t(A[0],A[A.length-1],O??10)),O?g(lM(A,O)):h},h.copy=function(){return X0(h,qS(e,t,r,n,a,i,s,c,d,f))},h}function FQ(){return Mi.apply(qS(DZ,IZ,fl,GS,cg,Z0,HS,zS,rc,bM).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function LQ(){return Mi.apply(qS(AZ,OZ,hl,WS,ug,og,VS,$S,rc,wM).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dg(){var e=0,t=1,r,n,a,i,s=ca,c=!1,d;function f(p){return p==null||isNaN(p=+p)?d:s(a===0?.5:(p=(i(p)-r)*a,c?Math.max(0,Math.min(1,p)):p))}f.domain=function(p){return arguments.length?([e,t]=p,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),f):[e,t]},f.clamp=function(p){return arguments.length?(c=!!p,f):c},f.interpolator=function(p){return arguments.length?(s=p,f):s};function h(p){return function(g){var v,b;return arguments.length?([v,b]=g,s=p(v,b),f):[s(0),s(1)]}}return f.range=h(cd),f.rangeRound=h(DS),f.unknown=function(p){return arguments.length?(d=p,f):d},function(p){return i=p,r=p(e),n=p(t),a=r===n?0:1/(n-r),f}}function _o(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function SM(){var e=ko(dg()(ca));return e.copy=function(){return _o(e,SM())},bl.apply(e,arguments)}function NM(){var e=PS(dg()).domain([1,10]);return e.copy=function(){return _o(e,NM()).base(e.base())},bl.apply(e,arguments)}function kM(){var e=FS(dg());return e.copy=function(){return _o(e,kM()).constant(e.constant())},bl.apply(e,arguments)}function KS(){var e=LS(dg());return e.copy=function(){return _o(e,KS()).exponent(e.exponent())},bl.apply(e,arguments)}function BQ(){return KS.apply(null,arguments).exponent(.5)}function _M(){var e=[],t=ca;function r(n){if(n!=null&&!isNaN(n=+n))return t((K0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(uo),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>kX(e,i/n))},r.copy=function(){return _M(t).domain(e)},bl.apply(r,arguments)}function fg(){var e=0,t=.5,r=1,n=1,a,i,s,c,d,f=ca,h,p=!1,g;function v(y){return isNaN(y=+y)?g:(y=.5+((y=+h(y))-i)*(n*y<n*i?c:d),f(p?Math.max(0,Math.min(1,y)):y))}v.domain=function(y){return arguments.length?([e,t,r]=y,a=h(e=+e),i=h(t=+t),s=h(r=+r),c=a===i?0:.5/(i-a),d=i===s?0:.5/(s-i),n=i<a?-1:1,v):[e,t,r]},v.clamp=function(y){return arguments.length?(p=!!y,v):p},v.interpolator=function(y){return arguments.length?(f=y,v):f};function b(y){return function(w){var j,T,N;return arguments.length?([j,T,N]=w,f=ZX(y,[j,T,N]),v):[f(0),f(.5),f(1)]}}return v.range=b(cd),v.rangeRound=b(DS),v.unknown=function(y){return arguments.length?(g=y,v):g},function(y){return h=y,a=y(e),i=y(t),s=y(r),c=a===i?0:.5/(i-a),d=i===s?0:.5/(s-i),n=i<a?-1:1,v}}function jM(){var e=ko(fg()(ca));return e.copy=function(){return _o(e,jM())},bl.apply(e,arguments)}function EM(){var e=PS(fg()).domain([.1,1,10]);return e.copy=function(){return _o(e,EM()).base(e.base())},bl.apply(e,arguments)}function TM(){var e=FS(fg());return e.copy=function(){return _o(e,TM()).constant(e.constant())},bl.apply(e,arguments)}function YS(){var e=LS(fg());return e.copy=function(){return _o(e,YS()).exponent(e.exponent())},bl.apply(e,arguments)}function UQ(){return YS.apply(null,arguments).exponent(.5)}const Af=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:CS,scaleDiverging:jM,scaleDivergingLog:EM,scaleDivergingPow:YS,scaleDivergingSqrt:UQ,scaleDivergingSymlog:TM,scaleIdentity:sM,scaleImplicit:rw,scaleLinear:iM,scaleLog:oM,scaleOrdinal:TS,scalePoint:EX,scalePow:BS,scaleQuantile:dM,scaleQuantize:fM,scaleRadial:uM,scaleSequential:SM,scaleSequentialLog:NM,scaleSequentialPow:KS,scaleSequentialQuantile:_M,scaleSequentialSqrt:BQ,scaleSequentialSymlog:kM,scaleSqrt:bZ,scaleSymlog:cM,scaleThreshold:hM,scaleTime:FQ,scaleUtc:LQ,tickFormat:aM},Symbol.toStringTag,{value:"Module"}));var jo=e=>e.chartData,zQ=Ne([jo],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),XS=(e,t,r,n)=>n?zQ(e):jo(e);function go(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(en(t)&&en(r))return!0}return!1}function QA(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function CM(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(en(r))a=r;else if(typeof r=="function")return;if(en(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(go(s))return s}}function $Q(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(go(n))return QA(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,c;if(a==="auto")t!=null&&(s=Math.min(...t));else if(st(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t?.[0]))}catch{}else if(typeof a=="string"&&c4.test(a)){var d=c4.exec(a);if(d==null||d[1]==null||t==null)s=void 0;else{var f=+d[1];s=t[0]-f}}else s=t?.[0];if(i==="auto")t!=null&&(c=Math.max(...t));else if(st(i))c=i;else if(typeof i=="function")try{t!=null&&(c=i(t?.[1]))}catch{}else if(typeof i=="string"&&u4.test(i)){var h=u4.exec(i);if(h==null||h[1]==null||t==null)c=void 0;else{var p=+h[1];c=t[1]+p}}else c=t?.[1];var g=[s,c];if(go(g))return t==null?g:QA(g,t,r)}}}var ud=1e9,HQ={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},QS,vr=!0,Ri="[DecimalError] ",oc=Ri+"Invalid argument: ",ZS=Ri+"Exponent out of range: ",dd=Math.floor,Zo=Math.pow,VQ=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ya,bn=1e7,ur=7,AM=9007199254740991,rx=dd(AM/ur),$e={};$e.absoluteValue=$e.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};$e.comparedTo=$e.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};$e.decimalPlaces=$e.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ur;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};$e.dividedBy=$e.div=function(e){return tl(this,new this.constructor(e))};$e.dividedToIntegerBy=$e.idiv=function(e){var t=this,r=t.constructor;return er(tl(t,new r(e),0,1),r.precision)};$e.equals=$e.eq=function(e){return!this.cmp(e)};$e.exponent=function(){return Jr(this)};$e.greaterThan=$e.gt=function(e){return this.cmp(e)>0};$e.greaterThanOrEqualTo=$e.gte=function(e){return this.cmp(e)>=0};$e.isInteger=$e.isint=function(){return this.e>this.d.length-2};$e.isNegative=$e.isneg=function(){return this.s<0};$e.isPositive=$e.ispos=function(){return this.s>0};$e.isZero=function(){return this.s===0};$e.lessThan=$e.lt=function(e){return this.cmp(e)<0};$e.lessThanOrEqualTo=$e.lte=function(e){return this.cmp(e)<1};$e.logarithm=$e.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ya))throw Error(Ri+"NaN");if(r.s<1)throw Error(Ri+(r.s?"NaN":"-Infinity"));return r.eq(Ya)?new n(0):(vr=!1,t=tl(d0(r,i),d0(e,i),i),vr=!0,er(t,a))};$e.minus=$e.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?IM(t,e):OM(t,(e.s=-e.s,e))};$e.modulo=$e.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Ri+"NaN");return r.s?(vr=!1,t=tl(r,e,0,1).times(e),vr=!0,r.minus(t)):er(new n(r),a)};$e.naturalExponential=$e.exp=function(){return DM(this)};$e.naturalLogarithm=$e.ln=function(){return d0(this)};$e.negated=$e.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};$e.plus=$e.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?OM(t,e):IM(t,(e.s=-e.s,e))};$e.precision=$e.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(oc+e);if(t=Jr(a)+1,n=a.d.length-1,r=n*ur+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};$e.squareRoot=$e.sqrt=function(){var e,t,r,n,a,i,s,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(Ri+"NaN")}for(e=Jr(c),vr=!1,a=Math.sqrt(+c),a==0||a==1/0?(t=ps(c.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=dd((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new d(t)):n=new d(a.toString()),r=d.precision,a=s=r+3;;)if(i=n,n=i.plus(tl(c,i,s+2)).times(.5),ps(i.d).slice(0,s)===(t=ps(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(er(i,r+1,0),i.times(i).eq(c)){n=i;break}}else if(t!="9999")break;s+=4}return vr=!0,er(n,r)};$e.times=$e.mul=function(e){var t,r,n,a,i,s,c,d,f,h=this,p=h.constructor,g=h.d,v=(e=new p(e)).d;if(!h.s||!e.s)return new p(0);for(e.s*=h.s,r=h.e+e.e,d=g.length,f=v.length,d<f&&(i=g,g=v,v=i,s=d,d=f,f=s),i=[],s=d+f,n=s;n--;)i.push(0);for(n=f;--n>=0;){for(t=0,a=d+n;a>n;)c=i[a]+v[n]*g[a-n-1]+t,i[a--]=c%bn|0,t=c/bn|0;i[a]=(i[a]+t)%bn|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,vr?er(e,p.precision):e};$e.toDecimalPlaces=$e.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Ss(e,0,ud),t===void 0?t=n.rounding:Ss(t,0,8),er(r,e+Jr(r)+1,t))};$e.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=vc(n,!0):(Ss(e,0,ud),t===void 0?t=a.rounding:Ss(t,0,8),n=er(new a(n),e+1,t),r=vc(n,!0,e+1)),r};$e.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?vc(a):(Ss(e,0,ud),t===void 0?t=i.rounding:Ss(t,0,8),n=er(new i(a),e+Jr(a)+1,t),r=vc(n.abs(),!1,e+Jr(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};$e.toInteger=$e.toint=function(){var e=this,t=e.constructor;return er(new t(e),Jr(e)+1,t.rounding)};$e.toNumber=function(){return+this};$e.toPower=$e.pow=function(e){var t,r,n,a,i,s,c=this,d=c.constructor,f=12,h=+(e=new d(e));if(!e.s)return new d(Ya);if(c=new d(c),!c.s){if(e.s<1)throw Error(Ri+"Infinity");return c}if(c.eq(Ya))return c;if(n=d.precision,e.eq(Ya))return er(c,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=c.s,s){if((r=h<0?-h:h)<=AM){for(a=new d(Ya),t=Math.ceil(n/ur+4),vr=!1;r%2&&(a=a.times(c),e3(a.d,t)),r=dd(r/2),r!==0;)c=c.times(c),e3(c.d,t);return vr=!0,e.s<0?new d(Ya).div(a):er(a,n)}}else if(i<0)throw Error(Ri+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,vr=!1,a=e.times(d0(c,n+f)),vr=!0,a=DM(a),a.s=i,a};$e.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Jr(a),n=vc(a,r<=i.toExpNeg||r>=i.toExpPos)):(Ss(e,1,ud),t===void 0?t=i.rounding:Ss(t,0,8),a=er(new i(a),e,t),r=Jr(a),n=vc(a,e<=r||r<=i.toExpNeg,e)),n};$e.toSignificantDigits=$e.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Ss(e,1,ud),t===void 0?t=n.rounding:Ss(t,0,8)),er(new n(r),e,t)};$e.toString=$e.valueOf=$e.val=$e.toJSON=$e[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Jr(e),r=e.constructor;return vc(e,t<=r.toExpNeg||t>=r.toExpPos)};function OM(e,t){var r,n,a,i,s,c,d,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s||(t=new h(e)),vr?er(t,p):t;if(d=e.d,f=t.d,s=e.e,a=t.e,d=d.slice(),i=s-a,i){for(i<0?(n=d,i=-i,c=f.length):(n=f,a=s,c=d.length),s=Math.ceil(p/ur),c=s>c?s+1:c+1,i>c&&(i=c,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(c=d.length,i=f.length,c-i<0&&(i=c,n=f,f=d,d=n),r=0;i;)r=(d[--i]=d[i]+f[i]+r)/bn|0,d[i]%=bn;for(r&&(d.unshift(r),++a),c=d.length;d[--c]==0;)d.pop();return t.d=d,t.e=a,vr?er(t,p):t}function Ss(e,t,r){if(e!==~~e||e<t||e>r)throw Error(oc+e)}function ps(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=ur-n.length,r&&(i+=to(r)),i+=n;s=e[t],n=s+"",r=ur-n.length,r&&(i+=to(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var tl=(function(){function e(n,a){var i,s=0,c=n.length;for(n=n.slice();c--;)i=n[c]*a+s,n[c]=i%bn|0,s=i/bn|0;return s&&n.unshift(s),n}function t(n,a,i,s){var c,d;if(i!=s)d=i>s?1:-1;else for(c=d=0;c<i;c++)if(n[c]!=a[c]){d=n[c]>a[c]?1:-1;break}return d}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*bn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var c,d,f,h,p,g,v,b,y,w,j,T,N,C,E,O,A,D,M=n.constructor,P=n.s==a.s?1:-1,R=n.d,L=a.d;if(!n.s)return new M(n);if(!a.s)throw Error(Ri+"Division by zero");for(d=n.e-a.e,A=L.length,E=R.length,v=new M(P),b=v.d=[],f=0;L[f]==(R[f]||0);)++f;if(L[f]>(R[f]||0)&&--d,i==null?T=i=M.precision:s?T=i+(Jr(n)-Jr(a))+1:T=i,T<0)return new M(0);if(T=T/ur+2|0,f=0,A==1)for(h=0,L=L[0],T++;(f<E||h)&&T--;f++)N=h*bn+(R[f]||0),b[f]=N/L|0,h=N%L|0;else{for(h=bn/(L[0]+1)|0,h>1&&(L=e(L,h),R=e(R,h),A=L.length,E=R.length),C=A,y=R.slice(0,A),w=y.length;w<A;)y[w++]=0;D=L.slice(),D.unshift(0),O=L[0],L[1]>=bn/2&&++O;do h=0,c=t(L,y,A,w),c<0?(j=y[0],A!=w&&(j=j*bn+(y[1]||0)),h=j/O|0,h>1?(h>=bn&&(h=bn-1),p=e(L,h),g=p.length,w=y.length,c=t(p,y,g,w),c==1&&(h--,r(p,A<g?D:L,g))):(h==0&&(c=h=1),p=L.slice()),g=p.length,g<w&&p.unshift(0),r(y,p,w),c==-1&&(w=y.length,c=t(L,y,A,w),c<1&&(h++,r(y,A<w?D:L,w))),w=y.length):c===0&&(h++,y=[0]),b[f++]=h,c&&y[0]?y[w++]=R[C]||0:(y=[R[C]],w=1);while((C++<E||y[0]!==void 0)&&T--)}return b[0]||b.shift(),v.e=d,er(v,s?i+Jr(v)+1:i)}})();function DM(e,t){var r,n,a,i,s,c,d=0,f=0,h=e.constructor,p=h.precision;if(Jr(e)>16)throw Error(ZS+Jr(e));if(!e.s)return new h(Ya);for(vr=!1,c=p,s=new h(.03125);e.abs().gte(.1);)e=e.times(s),f+=5;for(n=Math.log(Zo(2,f))/Math.LN10*2+5|0,c+=n,r=a=i=new h(Ya),h.precision=c;;){if(a=er(a.times(e),c),r=r.times(++d),s=i.plus(tl(a,r,c)),ps(s.d).slice(0,c)===ps(i.d).slice(0,c)){for(;f--;)i=er(i.times(i),c);return h.precision=p,t==null?(vr=!0,er(i,p)):i}i=s}}function Jr(e){for(var t=e.e*ur,r=e.d[0];r>=10;r/=10)t++;return t}function _b(e,t,r){if(t>e.LN10.sd())throw vr=!0,r&&(e.precision=r),Error(Ri+"LN10 precision limit exceeded");return er(new e(e.LN10),t)}function to(e){for(var t="";e--;)t+="0";return t}function d0(e,t){var r,n,a,i,s,c,d,f,h,p=1,g=10,v=e,b=v.d,y=v.constructor,w=y.precision;if(v.s<1)throw Error(Ri+(v.s?"NaN":"-Infinity"));if(v.eq(Ya))return new y(0);if(t==null?(vr=!1,f=w):f=t,v.eq(10))return t==null&&(vr=!0),_b(y,f);if(f+=g,y.precision=f,r=ps(b),n=r.charAt(0),i=Jr(v),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)v=v.times(e),r=ps(v.d),n=r.charAt(0),p++;i=Jr(v),n>1?(v=new y("0."+r),i++):v=new y(n+"."+r.slice(1))}else return d=_b(y,f+2,w).times(i+""),v=d0(new y(n+"."+r.slice(1)),f-g).plus(d),y.precision=w,t==null?(vr=!0,er(v,w)):v;for(c=s=v=tl(v.minus(Ya),v.plus(Ya),f),h=er(v.times(v),f),a=3;;){if(s=er(s.times(h),f),d=c.plus(tl(s,new y(a),f)),ps(d.d).slice(0,f)===ps(c.d).slice(0,f))return c=c.times(2),i!==0&&(c=c.plus(_b(y,f+2,w).times(i+""))),c=tl(c,new y(p),f),y.precision=w,t==null?(vr=!0,er(c,w)):c;c=d,a+=2}}function JA(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=dd(r/ur),e.d=[],n=(r+1)%ur,r<0&&(n+=ur),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=ur;n<a;)e.d.push(+t.slice(n,n+=ur));t=t.slice(n),n=ur-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),vr&&(e.e>rx||e.e<-rx))throw Error(ZS+r)}else e.s=0,e.e=0,e.d=[0];return e}function er(e,t,r){var n,a,i,s,c,d,f,h,p=e.d;for(s=1,i=p[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=ur,a=t,f=p[h=0];else{if(h=Math.ceil((n+1)/ur),i=p.length,h>=i)return e;for(f=i=p[h],s=1;i>=10;i/=10)s++;n%=ur,a=n-ur+s}if(r!==void 0&&(i=Zo(10,s-a-1),c=f/i%10|0,d=t<0||p[h+1]!==void 0||f%i,d=r<4?(c||d)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||d||r==6&&(n>0?a>0?f/Zo(10,s-a):0:p[h-1])%10&1||r==(e.s<0?8:7))),t<1||!p[0])return d?(i=Jr(e),p.length=1,t=t-i-1,p[0]=Zo(10,(ur-t%ur)%ur),e.e=dd(-t/ur)||0):(p.length=1,p[0]=e.e=e.s=0),e;if(n==0?(p.length=h,i=1,h--):(p.length=h+1,i=Zo(10,ur-n),p[h]=a>0?(f/Zo(10,s-a)%Zo(10,a)|0)*i:0),d)for(;;)if(h==0){(p[0]+=i)==bn&&(p[0]=1,++e.e);break}else{if(p[h]+=i,p[h]!=bn)break;p[h--]=0,i=1}for(n=p.length;p[--n]===0;)p.pop();if(vr&&(e.e>rx||e.e<-rx))throw Error(ZS+Jr(e));return e}function IM(e,t){var r,n,a,i,s,c,d,f,h,p,g=e.constructor,v=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),vr?er(t,v):t;if(d=e.d,p=t.d,n=t.e,f=e.e,d=d.slice(),s=f-n,s){for(h=s<0,h?(r=d,s=-s,c=p.length):(r=p,n=f,c=d.length),a=Math.max(Math.ceil(v/ur),c)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=d.length,c=p.length,h=a<c,h&&(c=a),a=0;a<c;a++)if(d[a]!=p[a]){h=d[a]<p[a];break}s=0}for(h&&(r=d,d=p,p=r,t.s=-t.s),c=d.length,a=p.length-c;a>0;--a)d[c++]=0;for(a=p.length;a>s;){if(d[--a]<p[a]){for(i=a;i&&d[--i]===0;)d[i]=bn-1;--d[i],d[a]+=bn}d[a]-=p[a]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--n;return d[0]?(t.d=d,t.e=n,vr?er(t,v):t):new g(0)}function vc(e,t,r){var n,a=Jr(e),i=ps(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+to(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+to(-a-1)+i,r&&(n=r-s)>0&&(i+=to(n))):a>=s?(i+=to(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+to(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=to(n))),e.s<0?"-"+i:i}function e3(e,t){if(e.length>t)return e.length=t,!0}function RM(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(oc+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return JA(s,i.toString())}else if(typeof i!="string")throw Error(oc+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,VQ.test(i))JA(s,i);else throw Error(oc+i)}if(a.prototype=$e,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=RM,a.config=a.set=GQ,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function GQ(e){if(!e||typeof e!="object")throw Error(Ri+"Object expected");var t,r,n,a=["precision",1,ud,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(dd(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(oc+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(oc+r+": "+n);return this}var QS=RM(HQ);Ya=new QS(1);const $t=QS;var WQ=e=>e,MM={},PM=e=>e===MM,t3=e=>function t(){return arguments.length===0||arguments.length===1&&PM(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},FM=(e,t)=>e===1?t:t3(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==MM).length;return i>=e?t(...n):FM(e-i,t3(function(){for(var s=arguments.length,c=new Array(s),d=0;d<s;d++)c[d]=arguments[d];var f=n.map(h=>PM(h)?c.shift():h);return t(...f,...c)}))}),qQ=e=>FM(e.length,e),sw=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},KQ=qQ((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),YQ=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return WQ;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((c,d)=>d(c),i(...arguments))}};function LM(e){var t;return e===0?t=1:t=Math.floor(new $t(e).abs().log(10).toNumber())+1,t}function BM(e,t,r){for(var n=new $t(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var UM=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},zM=(e,t,r)=>{if(e.lte(0))return new $t(0);var n=LM(e.toNumber()),a=new $t(10).pow(n),i=e.div(a),s=n!==1?.05:.1,c=new $t(Math.ceil(i.div(s).toNumber())).add(r).mul(s),d=c.mul(a);return t?new $t(d.toNumber()):new $t(Math.ceil(d.toNumber()))},XQ=(e,t,r)=>{var n=new $t(1),a=new $t(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new $t(10).pow(LM(e)-1),a=new $t(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new $t(Math.floor(e)))}else e===0?a=new $t(Math.floor((t-1)/2)):r||(a=new $t(Math.floor(e)));var s=Math.floor((t-1)/2),c=YQ(KQ(d=>a.add(new $t(d-s).mul(n)).toNumber()),sw);return c(0,t)},$M=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new $t(0),tickMin:new $t(0),tickMax:new $t(0)};var s=zM(new $t(r).sub(t).div(n-1),a,i),c;t<=0&&r>=0?c=new $t(0):(c=new $t(t).add(r).div(2),c=c.sub(new $t(c).mod(s)));var d=Math.ceil(c.sub(t).div(s).toNumber()),f=Math.ceil(new $t(r).sub(c).div(s).toNumber()),h=d+f+1;return h>n?$M(t,r,n,a,i+1):(h<n&&(f=r>0?f+(n-h):f,d=r>0?d:d+(n-h)),{step:s,tickMin:c.sub(new $t(d).mul(s)),tickMax:c.add(new $t(f).mul(s))})},ZQ=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),[c,d]=UM([r,n]);if(c===-1/0||d===1/0){var f=d===1/0?[c,...sw(0,a-1).map(()=>1/0)]:[...sw(0,a-1).map(()=>-1/0),d];return r>n?f.reverse():f}if(c===d)return XQ(c,a,i);var{step:h,tickMin:p,tickMax:g}=$M(c,d,s,i,0),v=BM(p,g.add(new $t(.1).mul(h)),h);return r>n?v.reverse():v},QQ=function(t,r){var[n,a]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,c]=UM([n,a]);if(s===-1/0||c===1/0)return[n,a];if(s===c)return[s];var d=Math.max(r,2),f=zM(new $t(c).sub(s).div(d-1),i,0),h=[...BM(new $t(s),new $t(c),f),c];return i===!1&&(h=h.map(p=>Math.round(p))),n>a?h.reverse():h},JQ=e=>e.rootProps.barCategoryGap,hg=e=>e.rootProps.stackOffset,HM=e=>e.rootProps.reverseStackOrder,JS=e=>e.options.chartName,eN=e=>e.rootProps.syncId,VM=e=>e.rootProps.syncMethod,tN=e=>e.options.eventEmitter,Ja={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Ks={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Ga={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},mg=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},eJ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ks.angleAxisId,includeHidden:!1,name:void 0,reversed:Ks.reversed,scale:Ks.scale,tick:Ks.tick,tickCount:void 0,ticks:void 0,type:Ks.type,unit:void 0},tJ={allowDataOverflow:Ga.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ga.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ga.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ga.scale,tick:Ga.tick,tickCount:Ga.tickCount,ticks:void 0,type:Ga.type,unit:void 0},rJ={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ks.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ks.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ks.scale,tick:Ks.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},nJ={allowDataOverflow:Ga.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ga.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ga.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ga.scale,tick:Ga.tick,tickCount:Ga.tickCount,ticks:void 0,type:"category",unit:void 0},rN=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?rJ:eJ,nN=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?nJ:tJ,pg=e=>e.polarOptions,aN=Ne([vl,yl,Hn],QY),GM=Ne([pg,aN],(e,t)=>{if(e!=null)return po(e.innerRadius,t,0)}),WM=Ne([pg,aN],(e,t)=>{if(e!=null)return po(e.outerRadius,t,t*.8)}),aJ=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},qM=Ne([pg],aJ);Ne([rN,qM],mg);var KM=Ne([aN,GM,WM],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Ne([nN,KM],mg);var YM=Ne([jr,pg,GM,WM,vl,yl],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:c,startAngle:d,endAngle:f}=t;return{cx:po(s,a,a/2),cy:po(c,i,i/2),innerRadius:r,outerRadius:n,startAngle:d,endAngle:f,clockWise:!1}}}),un=(e,t)=>t,xg=(e,t,r)=>r;function XM(e){return e?.id}function ZM(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,s=new Map;return e.forEach(c=>{var d,f=(d=c.data)!==null&&d!==void 0?d:n;if(!(f==null||f.length===0)){var h=XM(c);f.forEach((p,g)=>{var v=i==null||a?g:String(ln(p,i,null)),b=ln(p,c.dataKey,0),y;s.has(v)?y=s.get(v):y={},Object.assign(y,{[h]:b}),s.set(v,y)})}}),Array.from(s.values())}function iN(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var gg=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function vg(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function iJ(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var dn=e=>{var t=jr(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},fd=e=>e.tooltip.settings.axisId;function r3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r3(Object(r),!0).forEach(function(n){sJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sJ(e,t,r){return(t=lJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lJ(e){var t=oJ(e,"string");return typeof t=="symbol"?t:t+""}function oJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lw=[0,"auto"],vn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},QM=(e,t)=>e.cartesianAxis.xAxis[t],wl=(e,t)=>{var r=QM(e,t);return r??vn},yn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:lw,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:G0},JM=(e,t)=>e.cartesianAxis.yAxis[t],Sl=(e,t)=>{var r=JM(e,t);return r??yn},Qs={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},sN=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Qs},ma=(e,t,r)=>{switch(t){case"xAxis":return wl(e,r);case"yAxis":return Sl(e,r);case"zAxis":return sN(e,r);case"angleAxis":return rN(e,r);case"radiusAxis":return nN(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},cJ=(e,t,r)=>{switch(t){case"xAxis":return wl(e,r);case"yAxis":return Sl(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Q0=(e,t,r)=>{switch(t){case"xAxis":return wl(e,r);case"yAxis":return Sl(e,r);case"angleAxis":return rN(e,r);case"radiusAxis":return nN(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},eP=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function tP(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var rP=e=>e.graphicalItems.cartesianItems,uJ=Ne([un,xg],tP),nP=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),J0=Ne([rP,ma,uJ],nP,{memoizeOptions:{resultEqualityCheck:vg}}),aP=Ne([J0],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(iN)),iP=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),dJ=Ne([J0],iP),sP=e=>e.map(t=>t.data).filter(Boolean).flat(1),fJ=Ne([J0],sP,{memoizeOptions:{resultEqualityCheck:vg}}),lP=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},lN=Ne([fJ,XS],lP),oP=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:ln(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:ln(a,n)}))):e.map(n=>({value:n})),yg=Ne([lN,ma,J0],oP);function cP(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function vp(e){if(ws(e)||e instanceof Date){var t=Number(e);if(en(t))return t}}function n3(e){if(Array.isArray(e)){var t=[vp(e[0]),vp(e[1])];return go(t)?t:void 0}var r=vp(e);if(r!=null)return[r,r]}function ml(e){return e.map(vp).filter(NG)}function hJ(e,t,r){return!r||typeof t!="number"||ol(t)?[]:r.length?ml(r.flatMap(n=>{var a=ln(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!en(i)||!en(s)))return[t-i,t+s]})):[]}var fn=e=>{var t=dn(e),r=fd(e);return Q0(e,t,r)},eh=Ne([fn],e=>e?.dataKey),mJ=Ne([aP,XS,fn],ZM),uP=(e,t,r,n)=>{var a={},i=t.reduce((s,c)=>{if(c.stackId==null)return s;var d=s[c.stackId];return d==null&&(d=[]),d.push(c),s[c.stackId]=d,s},a);return Object.fromEntries(Object.entries(i).map(s=>{var[c,d]=s,f=n?[...d].reverse():d,h=f.map(XM);return[c,{stackedData:Hq(e,h,r),graphicalItems:f}]}))},pJ=Ne([mJ,aP,hg,HM],uP),dP=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var s=Wq(e,a,i);if(!(s!=null&&s[0]===0&&s[1]===0))return s}},xJ=Ne([ma],e=>e.allowDataOverflow),oN=e=>{var t;if(e==null||!("domain"in e))return lw;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=ml(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:lw},fP=Ne([ma],oN),hP=Ne([fP,xJ],CM),gJ=Ne([pJ,jo,un,hP],dP,{memoizeOptions:{resultEqualityCheck:gg}}),cN=e=>e.errorBars,vJ=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>cP(r,n)),ax=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),c=Math.max(...i);return[s,c]}},mP=(e,t,r,n,a)=>{var i,s;if(r.length>0&&e.forEach(c=>{r.forEach(d=>{var f,h,p=(f=n[d.id])===null||f===void 0?void 0:f.filter(j=>cP(a,j)),g=ln(c,(h=t.dataKey)!==null&&h!==void 0?h:d.dataKey),v=hJ(c,g,p);if(v.length>=2){var b=Math.min(...v),y=Math.max(...v);(i==null||b<i)&&(i=b),(s==null||y>s)&&(s=y)}var w=n3(g);w!=null&&(i=i==null?w[0]:Math.min(i,w[0]),s=s==null?w[1]:Math.max(s,w[1]))})}),t?.dataKey!=null&&e.forEach(c=>{var d=n3(ln(c,t.dataKey));d!=null&&(i=i==null?d[0]:Math.min(i,d[0]),s=s==null?d[1]:Math.max(s,d[1]))}),en(i)&&en(s))return[i,s]},yJ=Ne([lN,ma,dJ,cN,un],mP,{memoizeOptions:{resultEqualityCheck:gg}});function bJ(e){var{value:t}=e;if(ws(t)||t instanceof Date)return t}var wJ=(e,t,r)=>{var n=e.map(bJ).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&C5(n))?KR(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},pP=e=>e.referenceElements.dots,hd=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),SJ=Ne([pP,un,xg],hd),xP=e=>e.referenceElements.areas,NJ=Ne([xP,un,xg],hd),gP=e=>e.referenceElements.lines,kJ=Ne([gP,un,xg],hd),vP=(e,t)=>{if(e!=null){var r=ml(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},_J=Ne(SJ,un,vP),yP=(e,t)=>{if(e!=null){var r=ml(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},jJ=Ne([NJ,un],yP);function EJ(e){var t;if(e.x!=null)return ml([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:ml(r)}function TJ(e){var t;if(e.y!=null)return ml([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:ml(r)}var bP=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?EJ(n):TJ(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},CJ=Ne([kJ,un],bP),AJ=Ne(_J,CJ,jJ,(e,t,r)=>ax(e,r,t)),wP=(e,t,r,n,a,i,s,c)=>{if(r!=null)return r;var d=s==="vertical"&&c==="xAxis"||s==="horizontal"&&c==="yAxis",f=d?ax(n,i,a):ax(i,a);return $Q(t,f,e.allowDataOverflow)},OJ=Ne([ma,fP,hP,gJ,yJ,AJ,jr,un],wP,{memoizeOptions:{resultEqualityCheck:gg}}),DJ=[0,1],SP=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:c,type:d}=e,f=Oc(t,i);if(f&&c==null){var h;return KR(0,(h=r?.length)!==null&&h!==void 0?h:0)}return d==="category"?wJ(n,e,f):a==="expand"?DJ:s}},uN=Ne([ma,jr,lN,yg,hg,un,OJ],SP),NP=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var c="scale".concat(U0(i));return c in Af?c:"point"}}},th=Ne([ma,jr,eP,JS,un],NP);function IJ(e){if(e!=null){if(e in Af)return Af[e]();var t="scale".concat(U0(e));if(t in Af)return Af[t]()}}function dN(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=IJ(t);if(a!=null){var i=a.domain(r).range(n);return Bq(i),i}}}var kP=(e,t,r)=>{var n=oN(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&go(e))return ZQ(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&go(e))return QQ(e,t.tickCount,t.allowDecimals)}},fN=Ne([uN,Q0,th],kP),_P=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&go(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],c=r[r.length-1];return[Math.min(a,i),Math.max(s,c)]}return t},RJ=Ne([ma,uN,fN,un],_P),MJ=Ne(yg,ma,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(ml(e.map(p=>p.value))).sort((p,g)=>p-g),a=n[0],i=n[n.length-1];if(a==null||i==null)return 1/0;var s=i-a;if(s===0)return 1/0;for(var c=0;c<n.length-1;c++){var d=n[c],f=n[c+1];if(!(d==null||f==null)){var h=f-d;r=Math.min(r,h)}}return r/s}}),jP=Ne(MJ,jr,JQ,Hn,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!en(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=po(r,e*i),c=e*i/2;return c-s-(c-s)/i*s}return 0}),PJ=(e,t,r)=>{var n=wl(e,t);return n==null||typeof n.padding!="string"?0:jP(e,"xAxis",t,r,n.padding)},FJ=(e,t,r)=>{var n=Sl(e,t);return n==null||typeof n.padding!="string"?0:jP(e,"yAxis",t,r,n.padding)},LJ=Ne(wl,PJ,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),BJ=Ne(Sl,FJ,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),UJ=Ne([Hn,LJ,eg,Jx,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),zJ=Ne([Hn,jr,BJ,eg,Jx,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),rh=(e,t,r,n)=>{var a;switch(t){case"xAxis":return UJ(e,r,n);case"yAxis":return zJ(e,r,n);case"zAxis":return(a=sN(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return qM(e);case"radiusAxis":return KM(e,r);default:return}},EP=Ne([ma,rh],mg),bg=Ne([ma,th,RJ,EP],dN);Ne([J0,cN,un],vJ);function TP(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var wg=(e,t)=>t,Sg=(e,t,r)=>r,$J=Ne(Zx,wg,Sg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(TP)),HJ=Ne(Qx,wg,Sg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(TP)),CP=(e,t)=>({width:e.width,height:t.height}),VJ=(e,t)=>{var r=typeof t.width=="number"?t.width:G0;return{width:r,height:e.height}},GJ=Ne(Hn,wl,CP),WJ=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},qJ=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},KJ=Ne(yl,Hn,$J,wg,Sg,(e,t,r,n,a)=>{var i={},s;return r.forEach(c=>{var d=CP(t,c);s==null&&(s=WJ(t,n,e));var f=n==="top"&&!a||n==="bottom"&&a;i[c.id]=s-Number(f)*d.height,s+=(f?-1:1)*d.height}),i}),YJ=Ne(vl,Hn,HJ,wg,Sg,(e,t,r,n,a)=>{var i={},s;return r.forEach(c=>{var d=VJ(t,c);s==null&&(s=qJ(t,n,e));var f=n==="left"&&!a||n==="right"&&a;i[c.id]=s-Number(f)*d.width,s+=(f?-1:1)*d.width}),i}),XJ=(e,t)=>{var r=wl(e,t);if(r!=null)return KJ(e,r.orientation,r.mirror)},ZJ=Ne([Hn,wl,XJ,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),QJ=(e,t)=>{var r=Sl(e,t);if(r!=null)return YJ(e,r.orientation,r.mirror)},JJ=Ne([Hn,Sl,QJ,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r?.[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),eee=Ne(Hn,Sl,(e,t)=>{var r=typeof t.width=="number"?t.width:G0;return{width:r,height:e.height}}),AP=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,c=Oc(e,n),d=t.map(f=>f.value);if(s&&c&&i==="category"&&a&&C5(d))return d}},hN=Ne([jr,yg,ma,un],AP),OP=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Oc(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(c=>c.value)}},mN=Ne([jr,yg,Q0,un],OP);Ne([jr,cJ,th,bg,hN,mN,rh,fN,un],(e,t,r,n,a,i,s,c,d)=>{if(t!=null){var f=Oc(e,d);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:d,categoricalDomain:i,duplicateDomain:a,isCategorical:f,niceTicks:c,range:s,realScaleType:r,scale:n}}});var tee=(e,t,r,n,a,i,s,c,d)=>{if(!(t==null||n==null)){var f=Oc(e,d),{type:h,ticks:p,tickCount:g}=t,v=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,b=h==="category"&&n.bandwidth?n.bandwidth()/v:0;b=d==="angleAxis"&&i!=null&&i.length>=2?qi(i[0]-i[1])*2*b:b;var y=p||a;if(y){var w=y.map((j,T)=>{var N=s?s.indexOf(j):j;return{index:T,coordinate:n(N)+b,value:j,offset:b}});return w.filter(j=>en(j.coordinate))}return f&&c?c.map((j,T)=>({coordinate:n(j)+b,value:j,index:T,offset:b})).filter(j=>en(j.coordinate)):n.ticks?n.ticks(g).map(j=>({coordinate:n(j)+b,value:j,offset:b})):n.domain().map((j,T)=>({coordinate:n(j)+b,value:s?s[j]:j,index:T,offset:b}))}},DP=Ne([jr,Q0,th,bg,fN,rh,hN,mN,un],tee),ree=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var c=Oc(e,s),{tickCount:d}=t,f=0;return f=s==="angleAxis"&&n?.length>=2?qi(n[0]-n[1])*2*f:f,c&&i?i.map((h,p)=>({coordinate:r(h)+f,value:h,index:p,offset:f})):r.ticks?r.ticks(d).map(h=>({coordinate:r(h)+f,value:h,offset:f})):r.domain().map((h,p)=>({coordinate:r(h)+f,value:a?a[h]:h,index:p,offset:f}))}},IP=Ne([jr,Q0,bg,rh,hN,mN,un],ree),RP=Ne(ma,bg,(e,t)=>{if(!(e==null||t==null))return nx(nx({},e),{},{scale:t})}),nee=Ne([ma,th,uN,EP],dN),aee=Ne((e,t,r)=>sN(e,r),nee,(e,t)=>{if(!(e==null||t==null))return nx(nx({},e),{},{scale:t})}),iee=Ne([jr,Zx,Qx],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),MP=e=>e.options.defaultTooltipEventType,PP=e=>e.options.validateTooltipEventTypes;function FP(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function pN(e,t){var r=MP(e),n=PP(e);return FP(t,r,n)}function see(e){return at(t=>pN(t,e))}var LP=(e,t)=>{var r,n=Number(t);if(!(ol(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},lee=e=>e.tooltip.settings,ao={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},oee={itemInteraction:{click:ao,hover:ao},axisInteraction:{click:ao,hover:ao},keyboardInteraction:ao,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},BP=Pa({name:"tooltip",initialState:oee,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:xr()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Xi(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:xr()},removeTooltipEntrySettings:{reducer(e,t){var r=Xi(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:xr()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:cee,replaceTooltipEntrySettings:uee,removeTooltipEntrySettings:dee,setTooltipSettingsState:fee,setActiveMouseOverItemIndex:UP,mouseLeaveItem:hee,mouseLeaveChart:zP,setActiveClickItemIndex:mee,setMouseOverAxisIndex:$P,setMouseClickAxisIndex:pee,setSyncInteraction:ow,setKeyboardInteraction:cw}=BP.actions,xee=BP.reducer;function a3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a3(Object(r),!0).forEach(function(n){gee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gee(e,t,r){return(t=vee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vee(e){var t=yee(e,"string");return typeof t=="symbol"?t:t+""}function yee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bee(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function wee(e){return e.index!=null}var HP=(e,t,r,n)=>{if(t==null)return ao;var a=bee(e,t,r);if(a==null)return ao;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(wee(a)){if(i)return Wm(Wm({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return Wm(Wm({},ao),{},{coordinate:a.coordinate})};function See(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function Nee(e,t){var r=See(e),n=t[0],a=t[1];if(r===void 0)return!1;var i=Math.min(n,a),s=Math.max(n,a);return r>=i&&r<=s}function kee(e,t,r){if(r==null||t==null)return!0;var n=ln(e,t);return n==null||!go(r)?!0:Nee(n,r)}var xN=(e,t,r,n)=>{var a=e?.index;if(a==null)return null;var i=Number(a);if(!en(i))return a;var s=0,c=1/0;t.length>0&&(c=t.length-1);var d=Math.max(s,Math.min(i,c)),f=t[d];return f==null||kee(f,r,n)?String(d):null},VP=(e,t,r,n,a,i,s,c)=>{if(!(i==null||c==null)){var d=s[0],f=d==null?void 0:c(d.positions,i);if(f!=null)return f;var h=a?.[Number(i)];if(h)return r==="horizontal"?{x:h.coordinate,y:(n.top+t)/2}:{x:(n.left+e)/2,y:h.coordinate}}},GP=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(s=>{var c;return((c=s.settings)===null||c===void 0?void 0:c.graphicalItemId)===a})},nh=e=>e.options.tooltipPayloadSearcher,md=e=>e.tooltip;function i3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i3(Object(r),!0).forEach(function(n){_ee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ee(e,t,r){return(t=jee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jee(e){var t=Eee(e,"string");return typeof t=="symbol"?t:t+""}function Eee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tee(e,t){return e??t}var WP=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:c,computedData:d,dataStartIndex:f,dataEndIndex:h}=r,p=[];return e.reduce((g,v)=>{var b,{dataDefinedOnItem:y,settings:w}=v,j=Tee(y,c),T=Array.isArray(j)?SR(j,f,h):j,N=(b=w?.dataKey)!==null&&b!==void 0?b:n,C=w?.nameKey,E;if(n&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?E=A5(T,n,a):E=i(T,t,d,C),Array.isArray(E))E.forEach(A=>{var D=s3(s3({},w),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});g.push(f4({tooltipEntrySettings:D,dataKey:A.dataKey,payload:A.payload,value:ln(A.payload,A.dataKey),name:A.name}))});else{var O;g.push(f4({tooltipEntrySettings:w,dataKey:N,payload:E,value:ln(E,N),name:(O=ln(E,C))!==null&&O!==void 0?O:w?.name}))}return g},p)}},gN=Ne([fn,jr,eP,JS,dn],NP),Cee=Ne([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Aee=Ne([dn,fd],tP),pd=Ne([Cee,fn,Aee],nP,{memoizeOptions:{resultEqualityCheck:vg}}),Oee=Ne([pd],e=>e.filter(iN)),Dee=Ne([pd],sP,{memoizeOptions:{resultEqualityCheck:vg}}),xd=Ne([Dee,jo],lP),Iee=Ne([Oee,jo,fn],ZM),vN=Ne([xd,fn,pd],oP),qP=Ne([fn],oN),Ree=Ne([fn],e=>e.allowDataOverflow),KP=Ne([qP,Ree],CM),Mee=Ne([pd],e=>e.filter(iN)),Pee=Ne([Iee,Mee,hg,HM],uP),Fee=Ne([Pee,jo,dn,KP],dP),Lee=Ne([pd],iP),Bee=Ne([xd,fn,Lee,cN,dn],mP,{memoizeOptions:{resultEqualityCheck:gg}}),Uee=Ne([pP,dn,fd],hd),zee=Ne([Uee,dn],vP),$ee=Ne([xP,dn,fd],hd),Hee=Ne([$ee,dn],yP),Vee=Ne([gP,dn,fd],hd),Gee=Ne([Vee,dn],bP),Wee=Ne([zee,Gee,Hee],ax),qee=Ne([fn,qP,KP,Fee,Bee,Wee,jr,dn],wP),ah=Ne([fn,jr,xd,vN,hg,dn,qee],SP),Kee=Ne([ah,fn,gN],kP),Yee=Ne([fn,ah,Kee,dn],_P),YP=e=>{var t=dn(e),r=fd(e),n=!1;return rh(e,t,r,n)},XP=Ne([fn,YP],mg),ZP=Ne([fn,gN,Yee,XP],dN),Xee=Ne([jr,vN,fn,dn],AP),Zee=Ne([jr,vN,fn,dn],OP),Qee=(e,t,r,n,a,i,s,c)=>{if(t){var{type:d}=t,f=Oc(e,c);if(n){var h=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,p=d==="category"&&n.bandwidth?n.bandwidth()/h:0;return p=c==="angleAxis"&&a!=null&&a?.length>=2?qi(a[0]-a[1])*2*p:p,f&&s?s.map((g,v)=>({coordinate:n(g)+p,value:g,index:v,offset:p})):n.domain().map((g,v)=>({coordinate:n(g)+p,value:i?i[g]:g,index:v,offset:p}))}}},Nl=Ne([jr,fn,gN,ZP,YP,Xee,Zee,dn],Qee),yN=Ne([MP,PP,lee],(e,t,r)=>FP(r.shared,e,t)),QP=e=>e.tooltip.settings.trigger,bN=e=>e.tooltip.settings.defaultIndex,ih=Ne([md,yN,QP,bN],HP),f0=Ne([ih,xd,eh,ah],xN),JP=Ne([Nl,f0],LP),Jee=Ne([ih],e=>{if(e)return e.dataKey});Ne([ih],e=>{if(e)return e.graphicalItemId});var e6=Ne([md,yN,QP,bN],GP),ete=Ne([vl,yl,jr,Hn,Nl,bN,e6,nh],VP),tte=Ne([ih,ete],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),rte=Ne([ih],e=>{var t;return(t=e?.active)!==null&&t!==void 0?t:!1}),nte=Ne([e6,f0,jo,eh,JP,nh,yN],WP);Ne([nte],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function l3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l3(Object(r),!0).forEach(function(n){ate(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ate(e,t,r){return(t=ite(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ite(e){var t=ste(e,"string");return typeof t=="symbol"?t:t+""}function ste(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lte=()=>at(fn),ote=()=>{var e=lte(),t=at(Nl),r=at(ZP);return d4(!e||!r?void 0:o3(o3({},e),{},{scale:r}),t)};function c3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c3(Object(r),!0).forEach(function(n){cte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cte(e,t,r){return(t=ute(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ute(e){var t=dte(e,"string");return typeof t=="symbol"?t:t+""}function dte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fte=(e,t,r,n)=>{var a=t.find(i=>i&&i.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},hte=(e,t,r,n)=>{var a=t.find(f=>f&&f.index===r);if(a){if(e==="centric"){var i=a.coordinate,{radius:s}=n;return Nu(Nu(Nu({},n),$n(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var c=a.coordinate,{angle:d}=n;return Nu(Nu(Nu({},n),$n(n.cx,n.cy,c,d)),{},{angle:d,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function mte(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var t6=(e,t,r,n,a)=>{var i,s=(i=t?.length)!==null&&i!==void 0?i:0;if(s<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<s;c++){var d,f,h,p,g,v=c>0?(d=r[c-1])===null||d===void 0?void 0:d.coordinate:(f=r[s-1])===null||f===void 0?void 0:f.coordinate,b=(h=r[c])===null||h===void 0?void 0:h.coordinate,y=c>=s-1?(p=r[0])===null||p===void 0?void 0:p.coordinate:(g=r[c+1])===null||g===void 0?void 0:g.coordinate,w=void 0;if(!(v==null||b==null||y==null))if(qi(b-v)!==qi(y-b)){var j=[];if(qi(y-b)===qi(a[1]-a[0])){w=y;var T=b+a[1]-a[0];j[0]=Math.min(T,(T+v)/2),j[1]=Math.max(T,(T+v)/2)}else{w=v;var N=y+a[1]-a[0];j[0]=Math.min(b,(N+b)/2),j[1]=Math.max(b,(N+b)/2)}var C=[Math.min(b,(w+b)/2),Math.max(b,(w+b)/2)];if(e>C[0]&&e<=C[1]||e>=j[0]&&e<=j[1]){var E;return(E=r[c])===null||E===void 0?void 0:E.index}}else{var O=Math.min(v,y),A=Math.max(v,y);if(e>(O+b)/2&&e<=(A+b)/2){var D;return(D=r[c])===null||D===void 0?void 0:D.index}}}else if(t)for(var M=0;M<s;M++){var P=t[M];if(P!=null){var R=t[M+1],L=t[M-1];if(M===0&&R!=null&&e<=(P.coordinate+R.coordinate)/2||M===s-1&&L!=null&&e>(P.coordinate+L.coordinate)/2||M>0&&M<s-1&&L!=null&&R!=null&&e>(P.coordinate+L.coordinate)/2&&e<=(P.coordinate+R.coordinate)/2)return P.index}}return-1},pte=()=>at(JS),wN=(e,t)=>t,r6=(e,t,r)=>r,SN=(e,t,r,n)=>n,xte=Ne(Nl,e=>$x(e,t=>t.coordinate)),NN=Ne([md,wN,r6,SN],HP),kN=Ne([NN,xd,eh,ah],xN),gte=(e,t,r)=>{if(t!=null){var n=md(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},n6=Ne([md,wN,r6,SN],GP),ix=Ne([vl,yl,jr,Hn,Nl,SN,n6,nh],VP),vte=Ne([NN,ix],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),a6=Ne([Nl,kN],LP),yte=Ne([n6,kN,jo,eh,a6,nh,wN],WP),bte=Ne([NN,kN],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),wte=(e,t,r,n,a,i,s)=>{if(!(!e||!r||!n||!a)&&mte(e,s)){var c=qq(e,t),d=t6(c,i,a,r,n),f=fte(t,a,d,e);return{activeIndex:String(d),activeCoordinate:f}}},Ste=(e,t,r,n,a,i,s)=>{if(!(!e||!n||!a||!i||!r)){var c=nX(e,r);if(c){var d=Kq(c,t),f=t6(d,s,i,n,a),h=hte(t,i,f,c);return{activeIndex:String(f),activeCoordinate:h}}}},Nte=(e,t,r,n,a,i,s,c)=>{if(!(!e||!t||!n||!a||!i))return t==="horizontal"||t==="vertical"?wte(e,t,n,a,i,s,c):Ste(e,t,r,n,a,i,s)},kte=Ne(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),_te=Ne(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Ja)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:iJ}});function u3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function d3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u3(Object(r),!0).forEach(function(n){jte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jte(e,t,r){return(t=Ete(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ete(e){var t=Tte(e,"string");return typeof t=="symbol"?t:t+""}function Tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cte={},Ate={zIndexMap:Object.values(Ja).reduce((e,t)=>d3(d3({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),Cte)},Ote=new Set(Object.values(Ja));function Dte(e){return Ote.has(e)}var i6=Pa({name:"zIndex",initialState:Ate,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:xr()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!Dte(r)&&delete e.zIndexMap[r])},prepare:xr()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:xr()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:xr()}}}),{registerZIndexPortal:Ite,unregisterZIndexPortal:Rte,registerZIndexPortalElement:Mte,unregisterZIndexPortalElement:Pte}=i6.actions,Fte=i6.reducer;function Rc(e){var{zIndex:t,children:r}=e,n=TK(),a=n&&t!==void 0&&t!==0,i=si(),s=Mr();k.useLayoutEffect(()=>a?(s(Ite({zIndex:t})),()=>{s(Rte({zIndex:t}))}):z0,[s,t,a]);var c=at(d=>kte(d,t,i));return a?c?Jo.createPortal(r,c):null:r}function uw(){return uw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uw.apply(null,arguments)}function f3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?f3(Object(r),!0).forEach(function(n){Lte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lte(e,t,r){return(t=Bte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bte(e){var t=Ute(e,"string");return typeof t=="symbol"?t:t+""}function Ute(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zte(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return k.isValidElement(t)?k.cloneElement(t,n):k.createElement(r,n)}function $te(e){var t,{coordinate:r,payload:n,index:a,offset:i,tooltipAxisBandSize:s,layout:c,cursor:d,tooltipEventType:f,chartName:h}=e,p=r,g=n,v=a;if(!d||!p||h!=="ScatterChart"&&f!=="axis")return null;var b,y,w;if(h==="ScatterChart")b=p,y=xY,w=Ja.cursorLine;else if(h==="BarChart")b=gY(c,p,i,s),y=VR,w=Ja.cursorRectangle;else if(c==="radial"&&D5(p)){var{cx:j,cy:T,radius:N,startAngle:C,endAngle:E}=GR(p);b={cx:j,cy:T,startAngle:C,endAngle:E,innerRadius:N,outerRadius:N},y=qR,w=Ja.cursorLine}else b={points:lX(c,p,i)},y=kS,w=Ja.cursorLine;var O=typeof d=="object"&&"className"in d?d.className:void 0,A=qm(qm(qm(qm({stroke:"#ccc",pointerEvents:"none"},i),b),nS(d)),{},{payload:g,payloadIndex:v,className:tr("recharts-tooltip-cursor",O)});return k.createElement(Rc,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:w},k.createElement(zte,{cursor:d,cursorComp:y,cursorProps:A}))}function Hte(e){var t=ote(),r=_K(),n=tg(),a=pte();return t==null||r==null||n==null||a==null?null:k.createElement($te,uw({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var s6=k.createContext(null),Vte=()=>k.useContext(s6),jb={exports:{}},h3;function Gte(){return h3||(h3=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(d,f,h){this.fn=d,this.context=f,this.once=h||!1}function i(d,f,h,p,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var v=new a(h,p||d,g),b=r?r+f:f;return d._events[b]?d._events[b].fn?d._events[b]=[d._events[b],v]:d._events[b].push(v):(d._events[b]=v,d._eventsCount++),d}function s(d,f){--d._eventsCount===0?d._events=new n:delete d._events[f]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var f=[],h,p;if(this._eventsCount===0)return f;for(p in h=this._events)t.call(h,p)&&f.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},c.prototype.listeners=function(f){var h=r?r+f:f,p=this._events[h];if(!p)return[];if(p.fn)return[p.fn];for(var g=0,v=p.length,b=new Array(v);g<v;g++)b[g]=p[g].fn;return b},c.prototype.listenerCount=function(f){var h=r?r+f:f,p=this._events[h];return p?p.fn?1:p.length:0},c.prototype.emit=function(f,h,p,g,v,b){var y=r?r+f:f;if(!this._events[y])return!1;var w=this._events[y],j=arguments.length,T,N;if(w.fn){switch(w.once&&this.removeListener(f,w.fn,void 0,!0),j){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,h),!0;case 3:return w.fn.call(w.context,h,p),!0;case 4:return w.fn.call(w.context,h,p,g),!0;case 5:return w.fn.call(w.context,h,p,g,v),!0;case 6:return w.fn.call(w.context,h,p,g,v,b),!0}for(N=1,T=new Array(j-1);N<j;N++)T[N-1]=arguments[N];w.fn.apply(w.context,T)}else{var C=w.length,E;for(N=0;N<C;N++)switch(w[N].once&&this.removeListener(f,w[N].fn,void 0,!0),j){case 1:w[N].fn.call(w[N].context);break;case 2:w[N].fn.call(w[N].context,h);break;case 3:w[N].fn.call(w[N].context,h,p);break;case 4:w[N].fn.call(w[N].context,h,p,g);break;default:if(!T)for(E=1,T=new Array(j-1);E<j;E++)T[E-1]=arguments[E];w[N].fn.apply(w[N].context,T)}}return!0},c.prototype.on=function(f,h,p){return i(this,f,h,p,!1)},c.prototype.once=function(f,h,p){return i(this,f,h,p,!0)},c.prototype.removeListener=function(f,h,p,g){var v=r?r+f:f;if(!this._events[v])return this;if(!h)return s(this,v),this;var b=this._events[v];if(b.fn)b.fn===h&&(!g||b.once)&&(!p||b.context===p)&&s(this,v);else{for(var y=0,w=[],j=b.length;y<j;y++)(b[y].fn!==h||g&&!b[y].once||p&&b[y].context!==p)&&w.push(b[y]);w.length?this._events[v]=w.length===1?w[0]:w:s(this,v)}return this},c.prototype.removeAllListeners=function(f){var h;return f?(h=r?r+f:f,this._events[h]&&s(this,h)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(jb)),jb.exports}var Wte=Gte();const qte=xl(Wte);var h0=new qte,dw="recharts.syncEvent.tooltip",m3="recharts.syncEvent.brush";function Kte(e,t){if(t){var r=Number.parseInt(t,10);if(!ol(r))return e?.[r]}}var Yte={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},l6=Pa({name:"options",initialState:Yte,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Xte=l6.reducer,{createEventEmitter:Zte}=l6.actions;function Qte(e){return e.tooltip.syncInteraction}var Jte={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},o6=Pa({name:"chartData",initialState:Jte,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:p3,setDataStartEndIndexes:ere,setComputedData:qwe}=o6.actions,tre=o6.reducer,rre=["x","y"];function x3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ku(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x3(Object(r),!0).forEach(function(n){nre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nre(e,t,r){return(t=are(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function are(e){var t=ire(e,"string");return typeof t=="symbol"?t:t+""}function ire(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sre(e,t){if(e==null)return{};var r,n,a=lre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ore(){var e=at(eN),t=at(tN),r=Mr(),n=at(VM),a=at(Nl),i=tg(),s=W0(),c=at(d=>d.rootProps.className);k.useEffect(()=>{if(e==null)return z0;var d=(f,h,p)=>{if(t!==p&&e===f){if(n==="index"){var g;if(s&&h!==null&&h!==void 0&&(g=h.payload)!==null&&g!==void 0&&g.coordinate&&h.payload.sourceViewBox){var v=h.payload.coordinate,{x:b,y}=v,w=sre(v,rre),{x:j,y:T,width:N,height:C}=h.payload.sourceViewBox,E=ku(ku({},w),{},{x:s.x+(N?(b-j)/N:0)*s.width,y:s.y+(C?(y-T)/C:0)*s.height});r(ku(ku({},h),{},{payload:ku(ku({},h.payload),{},{coordinate:E})}))}else r(h);return}if(a!=null){var O;if(typeof n=="function"){var A={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},D=n(a,A);O=a[D]}else n==="value"&&(O=a.find(V=>String(V.value)===h.payload.label));var{coordinate:M}=h.payload;if(O==null||h.payload.active===!1||M==null||s==null){r(ow({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:P,y:R}=M,L=Math.min(P,s.x+s.width),te=Math.min(R,s.y+s.height),ee={x:i==="horizontal"?O.coordinate:L,y:i==="horizontal"?te:O.coordinate},ue=ow({active:h.payload.active,coordinate:ee,dataKey:h.payload.dataKey,index:String(O.index),label:h.payload.label,sourceViewBox:h.payload.sourceViewBox,graphicalItemId:h.payload.graphicalItemId});r(ue)}}};return h0.on(dw,d),()=>{h0.off(dw,d)}},[c,r,t,e,n,a,i,s])}function cre(){var e=at(eN),t=at(tN),r=Mr();k.useEffect(()=>{if(e==null)return z0;var n=(a,i,s)=>{t!==s&&e===a&&r(ere(i))};return h0.on(m3,n),()=>{h0.off(m3,n)}},[r,t,e])}function ure(){var e=Mr();k.useEffect(()=>{e(Zte())},[e]),ore(),cre()}function dre(e,t,r,n,a,i){var s=at(v=>gte(v,e,t)),c=at(tN),d=at(eN),f=at(VM),h=at(Qte),p=h?.active,g=W0();k.useEffect(()=>{if(!p&&d!=null&&c!=null){var v=ow({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:g,graphicalItemId:void 0});h0.emit(dw,d,v,c)}},[p,r,s,a,n,c,d,f,i,g])}function g3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function v3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g3(Object(r),!0).forEach(function(n){fre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fre(e,t,r){return(t=hre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hre(e){var t=mre(e,"string");return typeof t=="symbol"?t:t+""}function mre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pre(e){return e.dataKey}function xre(e,t){return k.isValidElement(e)?k.cloneElement(e,t):typeof e=="function"?k.createElement(e,t):k.createElement(YK,t)}var y3=[],gre={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function vre(e){var t,r,n=Ma(e,gre),{active:a,allowEscapeViewBox:i,animationDuration:s,animationEasing:c,content:d,filterNull:f,isAnimationActive:h,offset:p,payloadUniqBy:g,position:v,reverseDirection:b,useTranslate3d:y,wrapperStyle:w,cursor:j,shared:T,trigger:N,defaultIndex:C,portal:E,axisId:O}=n,A=Mr(),D=typeof C=="number"?String(C):C;k.useEffect(()=>{A(fee({shared:T,trigger:N,axisId:O,active:a,defaultIndex:D}))},[A,T,N,O,a,D]);var M=W0(),P=BR(),R=see(T),{activeIndex:L,isActive:te}=(t=at(le=>bte(le,R,N,D)))!==null&&t!==void 0?t:{},ee=at(le=>yte(le,R,N,D)),ue=at(le=>a6(le,R,N,D)),V=at(le=>vte(le,R,N,D)),K=ee,ie=Vte(),re=(r=a??te)!==null&&r!==void 0?r:!1,[me,W]=RW([K,re]),F=R==="axis"?ue:void 0;dre(R,N,V,F,L,re);var X=E??ie;if(X==null||M==null||R==null)return null;var q=K??y3;re||(q=y3),f&&q.length&&(q=sW(q.filter(le=>le.value!=null&&(le.hide!==!0||n.includeHidden)),g,pre));var U=q.length>0,G=k.createElement(rY,{allowEscapeViewBox:i,animationDuration:s,animationEasing:c,isAnimationActive:h,active:re,coordinate:V,hasPayload:U,offset:p,position:v,reverseDirection:b,useTranslate3d:y,viewBox:M,wrapperStyle:w,lastBoundingBox:me,innerRef:W,hasPortalFromProps:!!E},xre(d,v3(v3({},n),{},{payload:q,label:F,active:re,activeIndex:L,coordinate:V,accessibilityLayer:P})));return k.createElement(k.Fragment,null,Jo.createPortal(G,X),re&&k.createElement(Hte,{cursor:j,tooltipEventType:R,coordinate:V,payload:q,index:L}))}var _N=e=>null;_N.displayName="Cell";function yre(e,t,r){return(t=bre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bre(e){var t=wre(e,"string");return typeof t=="symbol"?t:t+""}function wre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Sre{constructor(t){yre(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function b3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Nre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b3(Object(r),!0).forEach(function(n){kre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kre(e,t,r){return(t=_re(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _re(e){var t=jre(e,"string");return typeof t=="symbol"?t:t+""}function jre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ere={cacheSize:2e3,enableCache:!0},c6=Nre({},Ere),w3=new Sre(c6.cacheSize),Tre={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},S3="recharts_measurement_span";function Cre(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(c)}var N3=(e,t)=>{try{var r=document.getElementById(S3);r||(r=document.createElement("span"),r.setAttribute("id",S3),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Tre,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ff=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||sg.isSsr)return{width:0,height:0};if(!c6.enableCache)return N3(t,r);var n=Cre(t,r),a=w3.get(n);if(a)return a;var i=N3(t,r);return w3.set(n,i),i},u6;function Are(e,t,r){return(t=Ore(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ore(e){var t=Dre(e,"string");return typeof t=="symbol"?t:t+""}function Dre(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,_3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Ire=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Rre=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Mre={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Pre=["cm","mm","pt","pc","in","Q","px"];function Fre(e){return Pre.includes(e)}var Mu="NaN";function Lre(e,t){return e*Mre[t]}class Ln{static parse(t){var r,[,n,a]=(r=Rre.exec(t))!==null&&r!==void 0?r:[];return n==null?Ln.NaN:new Ln(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,ol(t)&&(this.unit=""),r!==""&&!Ire.test(r)&&(this.num=NaN,this.unit=""),Fre(r)&&(this.num=Lre(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new Ln(NaN,""):new Ln(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new Ln(NaN,""):new Ln(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Ln(NaN,""):new Ln(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new Ln(NaN,""):new Ln(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return ol(this.num)}}u6=Ln;Are(Ln,"NaN",new u6(NaN,""));function d6(e){if(e==null||e.includes(Mu))return Mu;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=k3.exec(t))!==null&&r!==void 0?r:[],s=Ln.parse(n??""),c=Ln.parse(i??""),d=a==="*"?s.multiply(c):s.divide(c);if(d.isNaN())return Mu;t=t.replace(k3,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,[,h,p,g]=(f=_3.exec(t))!==null&&f!==void 0?f:[],v=Ln.parse(h??""),b=Ln.parse(g??""),y=p==="+"?v.add(b):v.subtract(b);if(y.isNaN())return Mu;t=t.replace(_3,y.toString())}return t}var j3=/\(([^()]*)\)/;function Bre(e){for(var t=e,r;(r=j3.exec(t))!=null;){var[,n]=r;t=t.replace(j3,d6(n))}return t}function Ure(e){var t=e.replace(/\s+/g,"");return t=Bre(t),t=d6(t),t}function zre(e){try{return Ure(e)}catch{return Mu}}function Eb(e){var t=zre(e.slice(5,-1));return t===Mu?"":t}var $re=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],Hre=["dx","dy","angle","className","breakAll"];function fw(){return fw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fw.apply(null,arguments)}function E3(e,t){if(e==null)return{};var r,n,a=Vre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Vre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var f6=/[ \f\n\r\t\v\u2028\u2029]+/,h6=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];zr(t)||(r?a=t.toString().split(""):a=t.toString().split(f6));var i=a.map(c=>({word:c,width:Ff(c,n).width})),s=r?0:Ff("",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}};function Gre(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var m6=(e,t,r,n)=>e.reduce((a,i)=>{var{word:s,width:c}=i,d=a[a.length-1];if(d&&c!=null&&(t==null||n||d.width+c+r<Number(t)))d.words.push(s),d.width+=c+r;else{var f={words:[s],width:c};a.push(f)}return a},[]),p6=e=>e.reduce((t,r)=>t.width>r.width?t:r),Wre="",T3=(e,t,r,n,a,i,s,c)=>{var d=e.slice(0,t),f=h6({breakAll:r,style:n,children:d+Wre});if(!f)return[!1,[]];var h=m6(f.wordsWithComputedWidth,i,s,c),p=h.length>a||p6(h).width>Number(i);return[p,h]},qre=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:c,breakAll:d}=e,f=st(i),h=String(s),p=m6(t,n,r,a);if(!f||a)return p;var g=p.length>i||p6(p).width>Number(n);if(!g)return p;for(var v=0,b=h.length-1,y=0,w;v<=b&&y<=h.length-1;){var j=Math.floor((v+b)/2),T=j-1,[N,C]=T3(h,T,d,c,i,n,r,a),[E]=T3(h,j,d,c,i,n,r,a);if(!N&&!E&&(v=j+1),N&&E&&(b=j-1),!N&&E){w=C;break}y++}return w||p},C3=e=>{var t=zr(e)?[]:e.toString().split(f6);return[{words:t,width:void 0}]},Kre=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!sg.isSsr){var c,d,f=h6({breakAll:i,children:n,style:a});if(f){var{wordsWithComputedWidth:h,spaceWidth:p}=f;c=h,d=p}else return C3(n);return qre({breakAll:i,children:n,maxLines:s,style:a},c,d,t,!!r)}return C3(n)},x6="#808080",Yre={angle:0,breakAll:!1,capHeight:"0.71em",fill:x6,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},jN=k.forwardRef((e,t)=>{var r=Ma(e,Yre),{x:n,y:a,lineHeight:i,capHeight:s,fill:c,scaleToFit:d,textAnchor:f,verticalAnchor:h}=r,p=E3(r,$re),g=k.useMemo(()=>Kre({breakAll:p.breakAll,children:p.children,maxLines:p.maxLines,scaleToFit:d,style:p.style,width:p.width}),[p.breakAll,p.children,p.maxLines,d,p.style,p.width]),{dx:v,dy:b,angle:y,className:w,breakAll:j}=p,T=E3(p,Hre);if(!ws(n)||!ws(a)||g.length===0)return null;var N=Number(n)+(st(v)?v:0),C=Number(a)+(st(b)?b:0);if(!en(N)||!en(C))return null;var E;switch(h){case"start":E=Eb("calc(".concat(s,")"));break;case"middle":E=Eb("calc(".concat((g.length-1)/2," * -").concat(i," + (").concat(s," / 2))"));break;default:E=Eb("calc(".concat(g.length-1," * -").concat(i,")"));break}var O=[];if(d){var A=g[0].width,{width:D}=p;O.push("scale(".concat(st(D)&&st(A)?D/A:1,")"))}return y&&O.push("rotate(".concat(y,", ").concat(N,", ").concat(C,")")),O.length&&(T.transform=O.join(" ")),k.createElement("text",fw({},Di(T),{ref:t,x:N,y:C,className:tr("recharts-text",w),textAnchor:f,fill:c.includes("url")?x6:c}),g.map((M,P)=>{var R=M.words.join(j?"":" ");return k.createElement("tspan",{x:N,dy:P===0?E:i,key:"".concat(R,"-").concat(P)},R)}))});jN.displayName="Text";var Xre=["labelRef"],Zre=["content"];function A3(e,t){if(e==null)return{};var r,n,a=Qre(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Qre(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function O3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O3(Object(r),!0).forEach(function(n){Jre(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jre(e,t,r){return(t=ene(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ene(e){var t=tne(e,"string");return typeof t=="symbol"?t:t+""}function tne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ys(){return Ys=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ys.apply(null,arguments)}var g6=k.createContext(null),rne=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:s,children:c}=e,d=k.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:s}),[t,r,n,a,i,s]);return k.createElement(g6.Provider,{value:d},c)},v6=()=>{var e=k.useContext(g6),t=W0();return e||OR(t)},nne=k.createContext(null),ane=()=>{var e=k.useContext(nne),t=at(YM);return e||t},ine=e=>{var{value:t,formatter:r}=e,n=zr(e.children)?t:e.children;return typeof r=="function"?r(n):n},EN=e=>e!=null&&typeof e=="function",sne=(e,t)=>{var r=qi(t-e),n=Math.min(Math.abs(t-e),360);return r*n},lne=(e,t,r,n,a)=>{var{offset:i,className:s}=e,{cx:c,cy:d,innerRadius:f,outerRadius:h,startAngle:p,endAngle:g,clockWise:v}=a,b=(f+h)/2,y=sne(p,g),w=y>=0?1:-1,j,T;switch(t){case"insideStart":j=p+w*i,T=v;break;case"insideEnd":j=g-w*i,T=!v;break;case"end":j=g+w*i,T=v;break;default:throw new Error("Unsupported position ".concat(t))}T=y<=0?T:!T;var N=$n(c,d,b,j),C=$n(c,d,b,j+(T?1:-1)*359),E="M".concat(N.x,",").concat(N.y,`
    A`).concat(b,",").concat(b,",0,1,").concat(T?0:1,`,
    `).concat(C.x,",").concat(C.y),O=zr(e.id)?Jf("recharts-radial-line-"):e.id;return k.createElement("text",Ys({},n,{dominantBaseline:"central",className:tr("recharts-radial-bar-label",s)}),k.createElement("defs",null,k.createElement("path",{id:O,d:E})),k.createElement("textPath",{xlinkHref:"#".concat(O)},r))},one=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:s,startAngle:c,endAngle:d}=e,f=(c+d)/2;if(r==="outside"){var{x:h,y:p}=$n(n,a,s+t,f);return{x:h,y:p,textAnchor:h>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var g=(i+s)/2,{x:v,y:b}=$n(n,a,g,f);return{x:v,y:b,textAnchor:"middle",verticalAnchor:"middle"}},hw=e=>"cx"in e&&st(e.cx),cne=(e,t)=>{var{parentViewBox:r,offset:n,position:a}=e,i;r!=null&&!hw(r)&&(i=r);var{x:s,y:c,upperWidth:d,lowerWidth:f,height:h}=t,p=s,g=s+(d-f)/2,v=(p+g)/2,b=(d+f)/2,y=p+d/2,w=h>=0?1:-1,j=w*n,T=w>0?"end":"start",N=w>0?"start":"end",C=d>=0?1:-1,E=C*n,O=C>0?"end":"start",A=C>0?"start":"end";if(a==="top"){var D={x:p+d/2,y:c-j,textAnchor:"middle",verticalAnchor:T};return Ur(Ur({},D),i?{height:Math.max(c-i.y,0),width:d}:{})}if(a==="bottom"){var M={x:g+f/2,y:c+h+j,textAnchor:"middle",verticalAnchor:N};return Ur(Ur({},M),i?{height:Math.max(i.y+i.height-(c+h),0),width:f}:{})}if(a==="left"){var P={x:v-E,y:c+h/2,textAnchor:O,verticalAnchor:"middle"};return Ur(Ur({},P),i?{width:Math.max(P.x-i.x,0),height:h}:{})}if(a==="right"){var R={x:v+b+E,y:c+h/2,textAnchor:A,verticalAnchor:"middle"};return Ur(Ur({},R),i?{width:Math.max(i.x+i.width-R.x,0),height:h}:{})}var L=i?{width:b,height:h}:{};return a==="insideLeft"?Ur({x:v+E,y:c+h/2,textAnchor:A,verticalAnchor:"middle"},L):a==="insideRight"?Ur({x:v+b-E,y:c+h/2,textAnchor:O,verticalAnchor:"middle"},L):a==="insideTop"?Ur({x:p+d/2,y:c+j,textAnchor:"middle",verticalAnchor:N},L):a==="insideBottom"?Ur({x:g+f/2,y:c+h-j,textAnchor:"middle",verticalAnchor:T},L):a==="insideTopLeft"?Ur({x:p+E,y:c+j,textAnchor:A,verticalAnchor:N},L):a==="insideTopRight"?Ur({x:p+d-E,y:c+j,textAnchor:O,verticalAnchor:N},L):a==="insideBottomLeft"?Ur({x:g+E,y:c+h-j,textAnchor:A,verticalAnchor:T},L):a==="insideBottomRight"?Ur({x:g+f-E,y:c+h-j,textAnchor:O,verticalAnchor:T},L):a&&typeof a=="object"&&(st(a.x)||cl(a.x))&&(st(a.y)||cl(a.y))?Ur({x:s+po(a.x,b),y:c+po(a.y,h),textAnchor:"end",verticalAnchor:"end"},L):Ur({x:y,y:c+h/2,textAnchor:"middle",verticalAnchor:"middle"},L)},une={angle:0,offset:5,zIndex:Ja.label,position:"middle",textBreakAll:!1};function ro(e){var t=Ma(e,une),{viewBox:r,position:n,value:a,children:i,content:s,className:c="",textBreakAll:d,labelRef:f}=t,h=ane(),p=v6(),g=n==="center"?p:h??p,v,b,y;if(r==null?v=g:hw(r)?v=r:v=OR(r),!v||zr(a)&&zr(i)&&!k.isValidElement(s)&&typeof s!="function")return null;var w=Ur(Ur({},t),{},{viewBox:v});if(k.isValidElement(s)){var{labelRef:j}=w,T=A3(w,Xre);return k.cloneElement(s,T)}if(typeof s=="function"){var{content:N}=w,C=A3(w,Zre);if(b=k.createElement(s,C),k.isValidElement(b))return b}else b=ine(t);var E=Di(t);if(hw(v)){if(n==="insideStart"||n==="insideEnd"||n==="end")return lne(t,n,b,E,v);y=one(v,t.offset,t.position)}else y=cne(t,v);return k.createElement(Rc,{zIndex:t.zIndex},k.createElement(jN,Ys({ref:f,className:tr("recharts-label",c)},E,y,{textAnchor:Gre(E.textAnchor)?E.textAnchor:y.textAnchor,breakAll:d}),b))}ro.displayName="Label";var dne=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?k.createElement(ro,Ys({key:"label-implicit"},n)):ws(e)?k.createElement(ro,Ys({key:"label-implicit",value:e},n)):k.isValidElement(e)?e.type===ro?k.cloneElement(e,Ur({key:"label-implicit"},n)):k.createElement(ro,Ys({key:"label-implicit",content:e},n)):EN(e)?k.createElement(ro,Ys({key:"label-implicit",content:e},n)):e&&typeof e=="object"?k.createElement(ro,Ys({},e,{key:"label-implicit"},n)):null};function fne(e){var{label:t,labelRef:r}=e,n=v6();return dne(t,n,r)||null}var Tb={},Cb={},D3;function hne(){return D3||(D3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Cb)),Cb}var Ab={},I3;function mne(){return I3||(I3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Ab)),Ab}var R3;function pne(){return R3||(R3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hne(),r=mne(),n=dS();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})(Tb)),Tb}var Ob,M3;function xne(){return M3||(M3=1,Ob=pne().last),Ob}var gne=xne();const vne=xl(gne);var yne=["valueAccessor"],bne=["dataKey","clockWise","id","textBreakAll","zIndex"];function sx(){return sx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sx.apply(null,arguments)}function P3(e,t){if(e==null)return{};var r,n,a=wne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function wne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Sne=e=>Array.isArray(e.value)?vne(e.value):e.value,y6=k.createContext(void 0),Nne=y6.Provider,b6=k.createContext(void 0);b6.Provider;function kne(){return k.useContext(y6)}function _ne(){return k.useContext(b6)}function yp(e){var{valueAccessor:t=Sne}=e,r=P3(e,yne),{dataKey:n,clockWise:a,id:i,textBreakAll:s,zIndex:c}=r,d=P3(r,bne),f=kne(),h=_ne(),p=f||h;return!p||!p.length?null:k.createElement(Rc,{zIndex:c??Ja.label},k.createElement(bs,{className:"recharts-label-list"},p.map((g,v)=>{var b,y=zr(n)?t(g,v):ln(g&&g.payload,n),w=zr(i)?{}:{id:"".concat(i,"-").concat(v)};return k.createElement(ro,sx({key:"label-".concat(v)},Di(g),d,w,{fill:(b=r.fill)!==null&&b!==void 0?b:g.fill,parentViewBox:g.parentViewBox,value:y,textBreakAll:s,viewBox:g.viewBox,index:v,zIndex:0}))})))}yp.displayName="LabelList";function jne(e){var{label:t}=e;return t?t===!0?k.createElement(yp,{key:"labelList-implicit"}):k.isValidElement(t)||EN(t)?k.createElement(yp,{key:"labelList-implicit",content:t}):typeof t=="object"?k.createElement(yp,sx({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var Ene={radiusAxis:{},angleAxis:{}},w6=Pa({name:"polarAxis",initialState:Ene,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Kwe,removeRadiusAxis:Ywe,addAngleAxis:Xwe,removeAngleAxis:Zwe}=w6.actions,Tne=w6.reducer,Db={exports:{}},qt={};var F3;function Cne(){if(F3)return qt;F3=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),s=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.view_transition"),v=Symbol.for("react.client.reference");function b(y){if(typeof y=="object"&&y!==null){var w=y.$$typeof;switch(w){case e:switch(y=y.type,y){case r:case a:case n:case d:case f:case g:return y;default:switch(y=y&&y.$$typeof,y){case s:case c:case p:case h:return y;case i:return y;default:return w}}case t:return w}}}return qt.ContextConsumer=i,qt.ContextProvider=s,qt.Element=e,qt.ForwardRef=c,qt.Fragment=r,qt.Lazy=p,qt.Memo=h,qt.Portal=t,qt.Profiler=a,qt.StrictMode=n,qt.Suspense=d,qt.SuspenseList=f,qt.isContextConsumer=function(y){return b(y)===i},qt.isContextProvider=function(y){return b(y)===s},qt.isElement=function(y){return typeof y=="object"&&y!==null&&y.$$typeof===e},qt.isForwardRef=function(y){return b(y)===c},qt.isFragment=function(y){return b(y)===r},qt.isLazy=function(y){return b(y)===p},qt.isMemo=function(y){return b(y)===h},qt.isPortal=function(y){return b(y)===t},qt.isProfiler=function(y){return b(y)===a},qt.isStrictMode=function(y){return b(y)===n},qt.isSuspense=function(y){return b(y)===d},qt.isSuspenseList=function(y){return b(y)===f},qt.isValidElementType=function(y){return typeof y=="string"||typeof y=="function"||y===r||y===a||y===n||y===d||y===f||typeof y=="object"&&y!==null&&(y.$$typeof===p||y.$$typeof===h||y.$$typeof===s||y.$$typeof===i||y.$$typeof===c||y.$$typeof===v||y.getModuleId!==void 0)},qt.typeOf=b,qt}var L3;function Ane(){return L3||(L3=1,Db.exports=Cne()),Db.exports}var One=Ane(),B3=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",U3=null,Ib=null,S6=e=>{if(e===U3&&Array.isArray(Ib))return Ib;var t=[];return k.Children.forEach(e,r=>{zr(r)||(One.isFragment(r)?t=t.concat(S6(r.props.children)):t.push(r))}),Ib=t,U3=e,t};function Dne(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>B3(a)):n=[B3(t)],S6(e).forEach(a=>{var i=Ku(a,"type.displayName")||Ku(a,"type.name");i&&n.indexOf(i)!==-1&&r.push(a)}),r}var Rb={},z3;function Ine(){return z3||(z3=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!Object.getOwnPropertyDescriptor(r,Symbol.toStringTag)?.writable?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(Rb)),Rb}var Mb,$3;function Rne(){return $3||($3=1,Mb=Ine().isPlainObject),Mb}var Mne=Rne();const Pne=xl(Mne);var H3,V3,G3,W3,q3;function K3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K3(Object(r),!0).forEach(function(n){Fne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fne(e,t,r){return(t=Lne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lne(e){var t=Bne(e,"string");return typeof t=="symbol"?t:t+""}function Bne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lx(){return lx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lx.apply(null,arguments)}function _f(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var X3=(e,t,r,n,a)=>{var i=r-n,s;return s=Ar(H3||(H3=_f(["M ",",",""])),e,t),s+=Ar(V3||(V3=_f(["L ",",",""])),e+r,t),s+=Ar(G3||(G3=_f(["L ",",",""])),e+r-i/2,t+a),s+=Ar(W3||(W3=_f(["L ",",",""])),e+r-i/2-n,t+a),s+=Ar(q3||(q3=_f(["L ",","," Z"])),e,t),s},Une={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},zne=e=>{var t=Ma(e,Une),{x:r,y:n,upperWidth:a,lowerWidth:i,height:s,className:c}=t,{animationEasing:d,animationDuration:f,animationBegin:h,isUpdateAnimationActive:p}=t,g=k.useRef(null),[v,b]=k.useState(-1),y=k.useRef(a),w=k.useRef(i),j=k.useRef(s),T=k.useRef(r),N=k.useRef(n),C=jS(e,"trapezoid-");if(k.useEffect(()=>{if(g.current&&g.current.getTotalLength)try{var ee=g.current.getTotalLength();ee&&b(ee)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||s!==+s||a===0&&i===0||s===0)return null;var E=tr("recharts-trapezoid",c);if(!p)return k.createElement("g",null,k.createElement("path",lx({},Di(t),{className:E,d:X3(r,n,a,i,s)})));var O=y.current,A=w.current,D=j.current,M=T.current,P=N.current,R="0px ".concat(v===-1?1:v,"px"),L="".concat(v,"px 0px"),te=UR(["strokeDasharray"],f,d);return k.createElement(_S,{animationId:C,key:C,canBegin:v>0,duration:f,easing:d,isActive:p,begin:h},ee=>{var ue=Ka(O,a,ee),V=Ka(A,i,ee),K=Ka(D,s,ee),ie=Ka(M,r,ee),re=Ka(P,n,ee);g.current&&(y.current=ue,w.current=V,j.current=K,T.current=ie,N.current=re);var me=ee>0?{transition:te,strokeDasharray:L}:{strokeDasharray:R};return k.createElement("path",lx({},Di(t),{className:E,d:X3(ie,re,ue,V,K),ref:g,style:Y3(Y3({},me),t.style)}))})},$ne=["option","shapeType","activeClassName"];function Hne(e,t){if(e==null)return{};var r,n,a=Vne(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Vne(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Z3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ox(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z3(Object(r),!0).forEach(function(n){Gne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gne(e,t,r){return(t=Wne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wne(e){var t=qne(e,"string");return typeof t=="symbol"?t:t+""}function qne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kne(e,t){return ox(ox({},t),e)}function Yne(e,t){return e==="symbols"}function Q3(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return k.createElement(VR,r);case"trapezoid":return k.createElement(zne,r);case"sector":return k.createElement(qR,r);case"symbols":if(Yne(t))return k.createElement(uS,r);break;case"curve":return k.createElement(kS,r);default:return null}}function Xne(e){return k.isValidElement(e)?e.props:e}function J3(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=Hne(e,$ne),i;if(k.isValidElement(t))i=k.cloneElement(t,ox(ox({},a),Xne(t)));else if(typeof t=="function")i=t(a,a.index);else if(Pne(t)&&typeof t!="boolean"){var s=Kne(t,a);i=k.createElement(Q3,{shapeType:r,elementProps:s})}else{var c=a;i=k.createElement(Q3,{shapeType:r,elementProps:c})}return a.isActive?k.createElement(bs,{className:n},i):i}var Zne=(e,t,r)=>{var n=Mr();return(a,i)=>s=>{e?.(a,i,s),n(UP({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},Qne=e=>{var t=Mr();return(r,n)=>a=>{e?.(r,n,a),t(hee())}},Jne=(e,t,r)=>{var n=Mr();return(a,i)=>s=>{e?.(a,i,s),n(mee({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function eae(e){var{tooltipEntrySettings:t}=e,r=Mr(),n=si(),a=k.useRef(null);return k.useLayoutEffect(()=>{n||(a.current===null?r(cee(t)):a.current!==t&&r(uee({prev:a.current,next:t})),a.current=t)},[t,r,n]),k.useLayoutEffect(()=>()=>{a.current&&(r(dee(a.current)),a.current=null)},[r]),null}function tae(e){var{legendPayload:t}=e,r=Mr(),n=si(),a=k.useRef(null);return k.useLayoutEffect(()=>{n||(a.current===null?r(zK(t)):a.current!==t&&r($K({prev:a.current,next:t})),a.current=t)},[r,n,t]),k.useLayoutEffect(()=>()=>{a.current&&(r(HK(a.current)),a.current=null)},[r]),null}var Pb,rae=()=>{var[e]=k.useState(()=>Jf("uid-"));return e},nae=(Pb=fI.useId)!==null&&Pb!==void 0?Pb:rae;function aae(e,t){var r=nae();return t||(e?"".concat(e,"-").concat(r):r)}var iae=k.createContext(void 0),sae=e=>{var{id:t,type:r,children:n}=e,a=aae("recharts-".concat(r),t);return k.createElement(iae.Provider,{value:a},n(a))},lae={cartesianItems:[],polarItems:[]},N6=Pa({name:"graphicalItems",initialState:lae,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:xr()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Xi(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:xr()},removeCartesianGraphicalItem:{reducer(e,t){var r=Xi(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:xr()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:xr()},removePolarGraphicalItem:{reducer(e,t){var r=Xi(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:xr()}}}),{addCartesianGraphicalItem:oae,replaceCartesianGraphicalItem:cae,removeCartesianGraphicalItem:uae,addPolarGraphicalItem:Qwe,removePolarGraphicalItem:Jwe}=N6.actions,dae=N6.reducer,fae=e=>{var t=Mr(),r=k.useRef(null);return k.useLayoutEffect(()=>{r.current===null?t(oae(e)):r.current!==e&&t(cae({prev:r.current,next:e})),r.current=e},[t,e]),k.useLayoutEffect(()=>()=>{r.current&&(t(uae(r.current)),r.current=null)},[t]),null},hae=k.memo(fae);function eO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eO(Object(r),!0).forEach(function(n){mae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mae(e,t,r){return(t=pae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pae(e){var t=xae(e,"string");return typeof t=="symbol"?t:t+""}function xae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gae={xAxis:{},yAxis:{},zAxis:{}},k6=Pa({name:"cartesianAxis",initialState:gae,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:xr()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:xr()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:xr()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:xr()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:xr()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:xr()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:xr()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:xr()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:xr()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i=a.widthHistory||[];if(i.length===3&&i[0]===i[2]&&n===i[1]&&n!==a.width&&Math.abs(n-i[0])<=1)return;var s=[...i,n].slice(-3);e.yAxis[r]=tO(tO({},e.yAxis[r]),{},{width:n,widthHistory:s})}}}}),{addXAxis:vae,replaceXAxis:yae,removeXAxis:bae,addYAxis:wae,replaceYAxis:Sae,removeYAxis:Nae,addZAxis:kae,replaceZAxis:_ae,removeZAxis:jae,updateYAxisWidth:Eae}=k6.actions,Tae=k6.reducer,Cae=Ne([Hn],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),Aae=Ne([Cae,vl,yl],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),_6=()=>at(Aae),Oae=e=>{var{chartData:t}=e,r=Mr(),n=si();return k.useEffect(()=>n?()=>{}:(r(p3(t)),()=>{r(p3(void 0))}),[t,r,n]),null},rO={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},j6=Pa({name:"brush",initialState:rO,reducers:{setBrushSettings(e,t){return t.payload==null?rO:t.payload}}}),{setBrushSettings:eSe}=j6.actions,Dae=j6.reducer;function Iae(e,t,r){return(t=Rae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rae(e){var t=Mae(e,"string");return typeof t=="symbol"?t:t+""}function Mae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class TN{static create(t){return new TN(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var i=this.bandwidth?this.bandwidth():0;return this.scale(t)+i}default:return this.scale(t)}if(r){var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],a=r[r.length-1];return n<=a?t>=n&&t<=a:t>=a&&t<=n}}Iae(TN,"EPS",1e-4);function Pae(e){return(e%180+180)%180}var Fae=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Pae(a),s=i*Math.PI/180,c=Math.atan(n/r),d=s>c&&s<Math.PI-c?n/Math.sin(s):r/Math.cos(s);return Math.abs(d)},Lae={dots:[],areas:[],lines:[]},E6=Pa({name:"referenceElements",initialState:Lae,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Xi(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Xi(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Xi(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:tSe,removeDot:rSe,addArea:nSe,removeArea:aSe,addLine:iSe,removeLine:sSe}=E6.actions,Bae=E6.reducer,Uae=k.createContext(void 0),zae=e=>{var{children:t}=e,[r]=k.useState("".concat(Jf("recharts"),"-clip")),n=_6();if(n==null)return null;var{x:a,y:i,width:s,height:c}=n;return k.createElement(Uae.Provider,{value:r},k.createElement("defs",null,k.createElement("clipPath",{id:r},k.createElement("rect",{x:a,y:i,height:c,width:s}))),t)};function T6(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function $ae(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Fae(n,r)}function Hae(e,t,r){var n=r==="width",{x:a,y:i,width:s,height:c}=e;return t===1?{start:n?a:i,end:n?a+s:i+c}:{start:n?a+s:i+c,end:n?a:i}}function m0(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function Vae(e,t){return T6(e,t+1)}function Gae(e,t,r,n,a){for(var i=(n||[]).slice(),{start:s,end:c}=t,d=0,f=1,h=s,p=function(){var b=n?.[d];if(b===void 0)return{v:T6(n,f)};var y=d,w,j=()=>(w===void 0&&(w=r(b,y)),w),T=b.coordinate,N=d===0||m0(e,T,j,h,c);N||(d=0,h=s,f+=1),N&&(h=T+e*(j()/2+a),d+=f)},g;f<=i.length;)if(g=p(),g)return g.v;return[]}function Wae(e,t,r,n,a){var i=(n||[]).slice(),s=i.length;if(s===0)return[];for(var{start:c,end:d}=t,f=1;f<=s;f++){for(var h=(s-1)%f,p=c,g=!0,v=function(){var T=n[b],N=b,C,E=()=>(C===void 0&&(C=r(T,N)),C),O=T.coordinate,A=b===h||m0(e,O,E,p,d);if(!A)return g=!1,1;A&&(p=O+e*(E()/2+a))},b=h;b<s&&!v();b+=f);if(g){for(var y=[],w=h;w<s;w+=f)y.push(n[w]);return y}}return[]}function nO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Yn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nO(Object(r),!0).forEach(function(n){qae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qae(e,t,r){return(t=Kae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kae(e){var t=Yae(e,"string");return typeof t=="symbol"?t:t+""}function Yae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xae(e,t,r,n,a){for(var i=(n||[]).slice(),s=i.length,{start:c}=t,{end:d}=t,f=function(g){var v=i[g],b,y=()=>(b===void 0&&(b=r(v,g)),b);if(g===s-1){var w=e*(v.coordinate+e*y()/2-d);i[g]=v=Yn(Yn({},v),{},{tickCoord:w>0?v.coordinate-w*e:v.coordinate})}else i[g]=v=Yn(Yn({},v),{},{tickCoord:v.coordinate});if(v.tickCoord!=null){var j=m0(e,v.tickCoord,y,c,d);j&&(d=v.tickCoord-e*(y()/2+a),i[g]=Yn(Yn({},v),{},{isShow:!0}))}},h=s-1;h>=0;h--)f(h);return i}function Zae(e,t,r,n,a,i){var s=(n||[]).slice(),c=s.length,{start:d,end:f}=t;if(i){var h=n[c-1],p=r(h,c-1),g=e*(h.coordinate+e*p/2-f);if(s[c-1]=h=Yn(Yn({},h),{},{tickCoord:g>0?h.coordinate-g*e:h.coordinate}),h.tickCoord!=null){var v=m0(e,h.tickCoord,()=>p,d,f);v&&(f=h.tickCoord-e*(p/2+a),s[c-1]=Yn(Yn({},h),{},{isShow:!0}))}}for(var b=i?c-1:c,y=function(T){var N=s[T],C,E=()=>(C===void 0&&(C=r(N,T)),C);if(T===0){var O=e*(N.coordinate-e*E()/2-d);s[T]=N=Yn(Yn({},N),{},{tickCoord:O<0?N.coordinate-O*e:N.coordinate})}else s[T]=N=Yn(Yn({},N),{},{tickCoord:N.coordinate});if(N.tickCoord!=null){var A=m0(e,N.tickCoord,E,d,f);A&&(d=N.tickCoord+e*(E()/2+a),s[T]=Yn(Yn({},N),{},{isShow:!0}))}},w=0;w<b;w++)y(w);return s}function Qae(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:s,orientation:c,interval:d,tickFormatter:f,unit:h,angle:p}=e;if(!a||!a.length||!n)return[];if(st(d)||sg.isSsr){var g;return(g=Vae(a,st(d)?d:0))!==null&&g!==void 0?g:[]}var v=[],b=c==="top"||c==="bottom"?"width":"height",y=h&&b==="width"?Ff(h,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=(N,C)=>{var E=typeof f=="function"?f(N.value,C):N.value;return b==="width"?$ae(Ff(E,{fontSize:t,letterSpacing:r}),y,p):Ff(E,{fontSize:t,letterSpacing:r})[b]},j=a.length>=2?qi(a[1].coordinate-a[0].coordinate):1,T=Hae(i,j,b);return d==="equidistantPreserveStart"?Gae(j,T,w,a,s):d==="equidistantPreserveEnd"?Wae(j,T,w,a,s):(d==="preserveStart"||d==="preserveStartEnd"?v=Zae(j,T,w,a,s,d==="preserveStartEnd"):v=Xae(j,T,w,a,s),v.filter(N=>N.isShow))}var Jae=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,s=0;if(t){Array.from(t).forEach(h=>{if(h){var p=h.getBoundingClientRect();p.width>s&&(s=p.width)}});var c=r?r.getBoundingClientRect().width:0,d=a+i,f=s+d+c+(r?n:0);return Math.round(f)}return 0},eie=["axisLine","width","height","className","hide","ticks","axisType"];function tie(e,t){if(e==null)return{};var r,n,a=rie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yc(){return yc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yc.apply(null,arguments)}function aO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aO(Object(r),!0).forEach(function(n){nie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nie(e,t,r){return(t=aie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aie(e){var t=iie(e,"string");return typeof t=="symbol"?t:t+""}function iie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cc={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Ja.axis};function sie(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:s,axisLine:c,otherSvgProps:d}=e;if(!c)return null;var f=Qr(Qr(Qr({},d),ll(c)),{},{fill:"none"});if(i==="top"||i==="bottom"){var h=+(i==="top"&&!s||i==="bottom"&&s);f=Qr(Qr({},f),{},{x1:t,y1:r+h*a,x2:t+n,y2:r+h*a})}else{var p=+(i==="left"&&!s||i==="right"&&s);f=Qr(Qr({},f),{},{x1:t+p*n,y1:r,x2:t+p*n,y2:r+a})}return k.createElement("line",yc({},f,{className:tr("recharts-cartesian-axis-line",Ku(c,"className"))}))}function lie(e,t,r,n,a,i,s,c,d){var f,h,p,g,v,b,y=c?-1:1,w=e.tickSize||s,j=st(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":f=h=e.coordinate,g=r+ +!c*a,p=g-y*w,b=p-y*d,v=j;break;case"left":p=g=e.coordinate,h=t+ +!c*n,f=h-y*w,v=f-y*d,b=j;break;case"right":p=g=e.coordinate,h=t+ +c*n,f=h+y*w,v=f+y*d,b=j;break;default:f=h=e.coordinate,g=r+ +c*a,p=g+y*w,b=p+y*d,v=j;break}return{line:{x1:f,y1:p,x2:h,y2:g},tick:{x:v,y:b}}}function oie(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function cie(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function uie(e){var{option:t,tickProps:r,value:n}=e,a,i=tr(r.className,"recharts-cartesian-axis-tick-value");if(k.isValidElement(t))a=k.cloneElement(t,Qr(Qr({},r),{},{className:i}));else if(typeof t=="function")a=t(Qr(Qr({},r),{},{className:i}));else{var s="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(s=tr(s,t?.className)),a=k.createElement(jN,yc({},r,{className:s}),n)}return a}var die=k.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:i,tickFormatter:s,unit:c,padding:d,tickTextProps:f,orientation:h,mirror:p,x:g,y:v,width:b,height:y,tickSize:w,tickMargin:j,fontSize:T,letterSpacing:N,getTicksConfig:C,events:E,axisType:O}=e,A=Qae(Qr(Qr({},C),{},{ticks:r}),T,N),D=oie(h,p),M=cie(h,p),P=ll(C),R=nS(n),L={};typeof a=="object"&&(L=a);var te=Qr(Qr({},P),{},{fill:"none"},L),ee=A.map(K=>Qr({entry:K},lie(K,g,v,b,y,h,w,p,j))),ue=ee.map(K=>{var{entry:ie,line:re}=K;return k.createElement(bs,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(ie.value,"-").concat(ie.coordinate,"-").concat(ie.tickCoord)},a&&k.createElement("line",yc({},te,re,{className:tr("recharts-cartesian-axis-tick-line",Ku(a,"className"))})))}),V=ee.map((K,ie)=>{var{entry:re,tick:me}=K,W=Qr(Qr(Qr(Qr({textAnchor:D,verticalAnchor:M},P),{},{stroke:"none",fill:i},R),me),{},{index:ie,payload:re,visibleTicksCount:A.length,tickFormatter:s,padding:d},f);return k.createElement(bs,yc({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(re.value,"-").concat(re.coordinate,"-").concat(re.tickCoord)},I5(E,re,ie)),n&&k.createElement(uie,{option:n,tickProps:W,value:"".concat(typeof s=="function"?s(re.value,ie):re.value).concat(c||"")}))});return k.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(O,"-ticks")},V.length>0&&k.createElement(Rc,{zIndex:Ja.label},k.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(O,"-tick-labels"),ref:t},V)),ue.length>0&&k.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(O,"-tick-lines")},ue))}),fie=k.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:s,ticks:c,axisType:d}=e,f=tie(e,eie),[h,p]=k.useState(""),[g,v]=k.useState(""),b=k.useRef(null);k.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var w;return Jae({ticks:b.current,label:(w=e.labelRef)===null||w===void 0?void 0:w.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var y=k.useCallback(w=>{if(w){var j=w.getElementsByClassName("recharts-cartesian-axis-tick-value");b.current=j;var T=j[0];if(T){var N=window.getComputedStyle(T),C=N.fontSize,E=N.letterSpacing;(C!==h||E!==g)&&(p(C),v(E))}}},[h,g]);return s||n!=null&&n<=0||a!=null&&a<=0?null:k.createElement(Rc,{zIndex:e.zIndex},k.createElement(bs,{className:tr("recharts-cartesian-axis",i)},k.createElement(sie,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:ll(e)}),k.createElement(die,{ref:y,axisType:d,events:f,fontSize:h,getTicksConfig:e,height:e.height,letterSpacing:g,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:c,unit:e.unit,width:e.width,x:e.x,y:e.y}),k.createElement(rne,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},k.createElement(fne,{label:e.label,labelRef:e.labelRef}),e.children)))}),CN=k.forwardRef((e,t)=>{var r=Ma(e,cc);return k.createElement(fie,yc({},r,{ref:t}))});CN.displayName="CartesianAxis";var hie={},C6=Pa({name:"errorBars",initialState:hie,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:lSe,replaceErrorBar:oSe,removeErrorBar:cSe}=C6.actions,mie=C6.reducer,pie=["children"];function xie(e,t){if(e==null)return{};var r,n,a=gie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vie={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},yie=k.createContext(vie);function bie(e){var{children:t}=e,r=xie(e,pie);return k.createElement(yie.Provider,{value:r},t)}function A6(e,t){var r,n,a=at(f=>wl(f,e)),i=at(f=>Sl(f,t)),s=(r=a?.allowDataOverflow)!==null&&r!==void 0?r:vn.allowDataOverflow,c=(n=i?.allowDataOverflow)!==null&&n!==void 0?n:yn.allowDataOverflow,d=s||c;return{needClip:d,needClipX:s,needClipY:c}}function wie(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=_6(),{needClipX:i,needClipY:s,needClip:c}=A6(t,r);if(!c||!a)return null;var{x:d,y:f,width:h,height:p}=a;return k.createElement("clipPath",{id:"clipPath-".concat(n)},k.createElement("rect",{x:i?d:d-h/2,y:s?f:f-p/2,width:i?h:h*2,height:s?p:p*2}))}var Fb={exports:{}},Lb={};var iO;function Sie(){if(iO)return Lb;iO=1;var e=ad();function t(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,s=e.useMemo,c=e.useDebugValue;return Lb.useSyncExternalStoreWithSelector=function(d,f,h,p,g){var v=a(null);if(v.current===null){var b={hasValue:!1,value:null};v.current=b}else b=v.current;v=s(function(){function w(E){if(!j){if(j=!0,T=E,E=p(E),g!==void 0&&b.hasValue){var O=b.value;if(g(O,E))return N=O}return N=E}if(O=N,r(T,E))return O;var A=p(E);return g!==void 0&&g(O,A)?(T=E,O):(T=E,N=A)}var j=!1,T,N,C=h===void 0?null:h;return[function(){return w(f())},C===null?void 0:function(){return w(C())}]},[f,h,p,g]);var y=n(d,v[0],v[1]);return i(function(){b.hasValue=!0,b.value=y},[y]),c(y),y},Lb}var sO;function Nie(){return sO||(sO=1,Fb.exports=Sie()),Fb.exports}Nie();function kie(e){e()}function _ie(){let e=null,t=null;return{clear(){e=null,t=null},notify(){kie(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var lO={notify(){},get:()=>[]};function jie(e,t){let r,n=lO,a=0,i=!1;function s(y){h();const w=n.subscribe(y);let j=!1;return()=>{j||(j=!0,w(),p())}}function c(){n.notify()}function d(){b.onStateChange&&b.onStateChange()}function f(){return i}function h(){a++,r||(r=e.subscribe(d),n=_ie())}function p(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=lO)}function g(){i||(i=!0,h())}function v(){i&&(i=!1,p())}const b={addNestedSub:s,notifyNestedSubs:c,handleChangeWrapper:d,isSubscribed:f,trySubscribe:g,tryUnsubscribe:v,getListeners:()=>n};return b}var Eie=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Tie=Eie(),Cie=()=>typeof navigator<"u"&&navigator.product==="ReactNative",Aie=Cie(),Oie=()=>Tie||Aie?k.useLayoutEffect:k.useEffect,Die=Oie();function oO(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function Iie(e,t){if(oO(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!oO(e[r[a]],t[r[a]]))return!1;return!0}var Rie=Symbol.for("react-redux-context"),Mie=typeof globalThis<"u"?globalThis:{};function Pie(){if(!k.createContext)return{};const e=Mie[Rie]??=new Map;let t=e.get(k.createContext);return t||(t=k.createContext(null),e.set(k.createContext,t)),t}var Fie=Pie();function Lie(e){const{children:t,context:r,serverState:n,store:a}=e,i=k.useMemo(()=>{const d=jie(a);return{store:a,subscription:d,getServerState:n?()=>n:void 0}},[a,n]),s=k.useMemo(()=>a.getState(),[a]);Die(()=>{const{subscription:d}=i;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),s!==a.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[i,s]);const c=r||Fie;return k.createElement(c.Provider,{value:i},t)}var Bie=Lie,Uie=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function zie(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function AN(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(Uie.has(n)){if(e[n]==null&&t[n]==null)continue;if(!Iie(e[n],t[n]))return!1}else if(!zie(e[n],t[n]))return!1;return!0}var $ie=["option","isActive"];function Lf(){return Lf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lf.apply(null,arguments)}function Hie(e,t){if(e==null)return{};var r,n,a=Vie(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Vie(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Gie(e){var{option:t,isActive:r}=e,n=Hie(e,$ie);return typeof t=="string"?k.createElement(J3,Lf({option:k.createElement(uS,Lf({type:t},n)),isActive:r,shapeType:"symbols"},n)):k.createElement(J3,Lf({option:t,isActive:r,shapeType:"symbols"},n))}var Wie=(e,t,r,n,a,i,s)=>RP(e,"xAxis",t,s),qie=(e,t,r,n,a,i,s)=>IP(e,"xAxis",t,s),Kie=(e,t,r,n,a,i,s)=>RP(e,"yAxis",r,s),Yie=(e,t,r,n,a,i,s)=>IP(e,"yAxis",r,s),Xie=(e,t,r,n)=>aee(e,"zAxis",n,!1),Zie=(e,t,r,n,a)=>a,Qie=(e,t,r,n,a,i)=>i,Jie=(e,t,r,n,a,i,s)=>XS(e,void 0,void 0,s),ese=Ne([rP,Zie],(e,t)=>e.filter(r=>r.type==="scatter").find(r=>r.id===t)),tse=Ne([Jie,Wie,qie,Kie,Yie,Xie,ese,Qie],(e,t,r,n,a,i,s,c)=>{var{chartData:d,dataStartIndex:f,dataEndIndex:h}=e;if(s!=null){var p;if(s?.data!=null&&s.data.length>0?p=s.data:p=d?.slice(f,h+1),!(p==null||t==null||n==null||r==null||a==null||r?.length===0||a?.length===0))return pse({displayedData:p,xAxis:t,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:r,yAxisTicks:a,cells:c})}}),rse=["id"],nse=["onMouseEnter","onClick","onMouseLeave"],ase=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function mw(e,t){if(e==null)return{};var r,n,a=ise(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ise(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bc(){return bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bc.apply(null,arguments)}function cO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Aa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cO(Object(r),!0).forEach(function(n){sse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sse(e,t,r){return(t=lse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lse(e){var t=ose(e,"string");return typeof t=="symbol"?t:t+""}function ose(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cse=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:NR(r,t),payload:e}]},use=k.memo(e=>{var{dataKey:t,points:r,stroke:n,strokeWidth:a,fill:i,name:s,hide:c,tooltipType:d,id:f}=e,h={dataDefinedOnItem:r?.map(p=>p.tooltipPayload),positions:r?.map(p=>p.tooltipPosition),settings:{stroke:n,strokeWidth:a,fill:i,nameKey:void 0,dataKey:t,name:NR(s,t),hide:c,type:d,color:i,unit:"",graphicalItemId:f}};return k.createElement(eae,{tooltipEntrySettings:h})});function dse(e){var{points:t,props:r}=e,{line:n,lineType:a,lineJointType:i}=r;if(!n)return null;var s=ll(r),c=nS(n),d,f;if(a==="joint")d=t.map(w=>{var j,T;return{x:(j=w.cx)!==null&&j!==void 0?j:null,y:(T=w.cy)!==null&&T!==void 0?T:null}});else if(a==="fitting"){var{xmin:h,xmax:p,a:g,b:v}=SG(t),b=w=>g*w+v;d=[{x:h,y:b(h)},{x:p,y:b(p)}]}var y=Aa(Aa(Aa({},s),{},{fill:"none",stroke:s&&s.fill},c),{},{points:d});return k.isValidElement(n)?f=k.cloneElement(n,y):typeof n=="function"?f=n(y):f=k.createElement(kS,bc({},y,{type:i})),k.createElement(bs,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}function fse(e){var{showLabels:t,points:r,children:n}=e,a=W0(),i=k.useMemo(()=>r?.map(s=>{var c,d,f={x:(c=s.x)!==null&&c!==void 0?c:0,y:(d=s.y)!==null&&d!==void 0?d:0,width:s.width,height:s.height,lowerWidth:s.width,upperWidth:s.width};return Aa(Aa({},f),{},{value:void 0,payload:s.payload,viewBox:f,parentViewBox:a,fill:void 0})}),[a,r]);return k.createElement(Nne,{value:t?i:void 0},n)}function hse(e){var{points:t,allOtherScatterProps:r}=e,{shape:n,activeShape:a,dataKey:i}=r,{id:s}=r,c=mw(r,rse),d=at(f0),{onMouseEnter:f,onClick:h,onMouseLeave:p}=r,g=mw(r,nse),v=Zne(f,i,s),b=Qne(p),y=Jne(h,i,s);if(!PG(t))return null;var w=ll(c);return k.createElement(k.Fragment,null,k.createElement(dse,{points:t,props:c}),t.map((j,T)=>{var N=a!=null&&a!==!1,C=N&&d===String(T),E=N&&C?a:n,O=Aa(Aa(Aa({},w),j),{},{[_R]:T,[jR]:String(s)});return k.createElement(Rc,{key:"symbol-".concat(j?.cx,"-").concat(j?.cy,"-").concat(j?.size,"-").concat(T),zIndex:C?Ja.activeDot:void 0},k.createElement(bs,bc({className:"recharts-scatter-symbol"},I5(g,j,T),{onMouseEnter:v(j,T),onMouseLeave:b(j,T),onClick:y(j,T)}),k.createElement(Gie,bc({option:E,isActive:C},O))))}))}function mse(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:c}=r,d=t.current,f=jS(r,"recharts-scatter-"),[h,p]=k.useState(!1),g=k.useCallback(()=>{p(!1)},[]),v=k.useCallback(()=>{p(!0)},[]),b=!h;return k.createElement(fse,{showLabels:b,points:n},r.children,k.createElement(_S,{animationId:f,begin:i,duration:s,isActive:a,easing:c,onAnimationEnd:g,onAnimationStart:v,key:f},y=>{var w=y===1?n:n?.map((j,T)=>{var N=d&&d[T];return N?Aa(Aa({},j),{},{cx:j.cx==null?void 0:Ka(N.cx,j.cx,y),cy:j.cy==null?void 0:Ka(N.cy,j.cy,y),size:Ka(N.size,j.size,y)}):Aa(Aa({},j),{},{size:Ka(0,j.size,y)})});return y>0&&(t.current=w),k.createElement(bs,null,k.createElement(hse,{points:w,allOtherScatterProps:r,showLabels:b}))}),k.createElement(jne,{label:r.label}))}function pse(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:a,scatterSettings:i,xAxisTicks:s,yAxisTicks:c,cells:d}=e,f=zr(r.dataKey)?i.dataKey:r.dataKey,h=zr(n.dataKey)?i.dataKey:n.dataKey,p=a&&a.dataKey,g=a?a.range:Qs.range,v=g&&g[0],b=r.scale.bandwidth?r.scale.bandwidth():0,y=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((w,j)=>{var T=ln(w,f),N=ln(w,h),C=!zr(p)&&ln(w,p)||"-",E=[{name:zr(r.dataKey)?i.name:r.name||String(r.dataKey),unit:r.unit||"",value:T,payload:w,dataKey:f,type:i.tooltipType},{name:zr(n.dataKey)?i.name:n.name||String(n.dataKey),unit:n.unit||"",value:N,payload:w,dataKey:h,type:i.tooltipType}];C!=="-"&&E.push({name:a.name||a.dataKey,unit:a.unit||"",value:C,payload:w,dataKey:p,type:i.tooltipType});var O=o4({axis:r,ticks:s,bandSize:b,entry:w,index:j,dataKey:f}),A=o4({axis:n,ticks:c,bandSize:y,entry:w,index:j,dataKey:h}),D=C!=="-"?a.scale(C):v,M=Math.sqrt(Math.max(D,0)/Math.PI);return Aa(Aa({},w),{},{cx:O,cy:A,x:O==null?void 0:O-M,y:A==null?void 0:A-M,width:2*M,height:2*M,size:D,node:{x:T,y:N,z:C},tooltipPayload:E,tooltipPosition:{x:O,y:A},payload:w},d&&d[j]&&d[j].props)})}var xse=(e,t,r)=>({x:e.cx,y:e.cy,value:Number(r==="x"?e.node.x:e.node.y),errorVal:ln(e,t)});function gse(e){var{hide:t,points:r,className:n,needClip:a,xAxisId:i,yAxisId:s,id:c}=e,d=k.useRef(null);if(t)return null;var f=tr("recharts-scatter",n),h=c;return k.createElement(Rc,{zIndex:e.zIndex},k.createElement(bs,{className:f,clipPath:a?"url(#clipPath-".concat(h,")"):void 0,id:c},a&&k.createElement("defs",null,k.createElement(wie,{clipPathId:h,xAxisId:i,yAxisId:s})),k.createElement(bie,{xAxisId:i,yAxisId:s,data:r,dataPointFormatter:xse,errorBarOffset:0},k.createElement(bs,{key:"recharts-scatter-symbols"},k.createElement(mse,{props:e,previousPointsRef:d})))))}var O6={xAxisId:0,yAxisId:0,zAxisId:0,label:!1,line:!1,legendType:"circle",lineType:"joint",lineJointType:"linear",shape:"circle",hide:!1,isAnimationActive:"auto",animationBegin:0,animationDuration:400,animationEasing:"linear",zIndex:Ja.scatter};function vse(e){var t=Ma(e,O6),{animationBegin:r,animationDuration:n,animationEasing:a,hide:i,isAnimationActive:s,legendType:c,lineJointType:d,lineType:f,shape:h,xAxisId:p,yAxisId:g,zAxisId:v}=t,b=mw(t,ase),{needClip:y}=A6(p,g),w=k.useMemo(()=>Dne(e.children,_N),[e.children]),j=si(),T=at(N=>tse(N,p,g,v,e.id,w,j));return y==null||T==null?null:k.createElement(k.Fragment,null,k.createElement(use,{dataKey:e.dataKey,points:T,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:e.id}),k.createElement(gse,bc({},b,{xAxisId:p,yAxisId:g,zAxisId:v,lineType:f,lineJointType:d,legendType:c,shape:h,hide:i,isAnimationActive:s,animationBegin:r,animationDuration:n,animationEasing:a,points:T,needClip:y})))}function yse(e){var t=Ma(e,O6),r=si();return k.createElement(sae,{id:t.id,type:"scatter"},n=>k.createElement(k.Fragment,null,k.createElement(tae,{legendPayload:cse(t)}),k.createElement(hae,{type:"scatter",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:t.zAxisId,dataKey:t.dataKey,hide:t.hide,name:t.name,tooltipType:t.tooltipType,isPanorama:r}),k.createElement(vse,bc({},t,{id:n}))))}var D6=k.memo(yse,AN);D6.displayName="Scatter";var bse=["domain","range"],wse=["domain","range"];function uO(e,t){if(e==null)return{};var r,n,a=Sse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Sse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dO(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function I6(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=uO(e,bse),{domain:i,range:s}=t,c=uO(t,wse);return!dO(r,i)||!dO(n,s)?!1:AN(a,c)}var Nse=["dangerouslySetInnerHTML","ticks","scale"],kse=["id","scale"];function pw(){return pw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pw.apply(null,arguments)}function fO(e,t){if(e==null)return{};var r,n,a=_se(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _se(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function jse(e){var t=Mr(),r=k.useRef(null);return k.useLayoutEffect(()=>{r.current===null?t(vae(e)):r.current!==e&&t(yae({prev:r.current,next:e})),r.current=e},[e,t]),k.useLayoutEffect(()=>()=>{r.current&&(t(bae(r.current)),r.current=null)},[t]),null}var Ese=e=>{var{xAxisId:t,className:r}=e,n=at(ER),a=si(),i="xAxis",s=at(j=>DP(j,i,t,a)),c=at(j=>GJ(j,t)),d=at(j=>ZJ(j,t)),f=at(j=>QM(j,t));if(c==null||d==null||f==null)return null;var{dangerouslySetInnerHTML:h,ticks:p,scale:g}=e,v=fO(e,Nse),{id:b,scale:y}=f,w=fO(f,kse);return k.createElement(CN,pw({},v,w,{x:d.x,y:d.y,width:c.width,height:c.height,className:tr("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:s,axisType:i}))},Tse={allowDataOverflow:vn.allowDataOverflow,allowDecimals:vn.allowDecimals,allowDuplicatedCategory:vn.allowDuplicatedCategory,angle:vn.angle,axisLine:cc.axisLine,height:vn.height,hide:!1,includeHidden:vn.includeHidden,interval:vn.interval,minTickGap:vn.minTickGap,mirror:vn.mirror,orientation:vn.orientation,padding:vn.padding,reversed:vn.reversed,scale:vn.scale,tick:vn.tick,tickCount:vn.tickCount,tickLine:cc.tickLine,tickSize:cc.tickSize,type:vn.type,xAxisId:0},Cse=e=>{var t=Ma(e,Tse);return k.createElement(k.Fragment,null,k.createElement(jse,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),k.createElement(Ese,t))},R6=k.memo(Cse,I6);R6.displayName="XAxis";var Ase=["dangerouslySetInnerHTML","ticks","scale"],Ose=["id","scale"];function xw(){return xw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xw.apply(null,arguments)}function hO(e,t){if(e==null)return{};var r,n,a=Dse(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Dse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ise(e){var t=Mr(),r=k.useRef(null);return k.useLayoutEffect(()=>{r.current===null?t(wae(e)):r.current!==e&&t(Sae({prev:r.current,next:e})),r.current=e},[e,t]),k.useLayoutEffect(()=>()=>{r.current&&(t(Nae(r.current)),r.current=null)},[t]),null}var Rse=e=>{var{yAxisId:t,className:r,width:n,label:a}=e,i=k.useRef(null),s=k.useRef(null),c=at(ER),d=si(),f=Mr(),h="yAxis",p=at(O=>eee(O,t)),g=at(O=>JJ(O,t)),v=at(O=>DP(O,h,t,d)),b=at(O=>JM(O,t));if(k.useLayoutEffect(()=>{if(!(n!=="auto"||!p||EN(a)||k.isValidElement(a)||b==null)){var O=i.current;if(O){var A=O.getCalculatedWidth();Math.round(p.width)!==Math.round(A)&&f(Eae({id:t,width:A}))}}},[v,p,f,a,t,n,b]),p==null||g==null||b==null)return null;var{dangerouslySetInnerHTML:y,ticks:w,scale:j}=e,T=hO(e,Ase),{id:N,scale:C}=b,E=hO(b,Ose);return k.createElement(CN,xw({},T,E,{ref:i,labelRef:s,x:g.x,y:g.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:p.width,height:p.height,className:tr("recharts-".concat(h," ").concat(h),r),viewBox:c,ticks:v,axisType:h}))},Mse={allowDataOverflow:yn.allowDataOverflow,allowDecimals:yn.allowDecimals,allowDuplicatedCategory:yn.allowDuplicatedCategory,angle:yn.angle,axisLine:cc.axisLine,hide:!1,includeHidden:yn.includeHidden,interval:yn.interval,minTickGap:yn.minTickGap,mirror:yn.mirror,orientation:yn.orientation,padding:yn.padding,reversed:yn.reversed,scale:yn.scale,tick:yn.tick,tickCount:yn.tickCount,tickLine:cc.tickLine,tickSize:cc.tickSize,type:yn.type,width:yn.width,yAxisId:0},Pse=e=>{var t=Ma(e,Mse);return k.createElement(k.Fragment,null,k.createElement(Ise,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),k.createElement(Rse,t))},M6=k.memo(Pse,I6);M6.displayName="YAxis";function Fse(e){var t=Mr(),r=k.useRef(null);return k.useLayoutEffect(()=>{r.current===null?t(kae(e)):r.current!==e&&t(_ae({prev:r.current,next:e})),r.current=e},[e,t]),k.useLayoutEffect(()=>()=>{r.current&&(t(jae(r.current)),r.current=null)},[t]),null}var Lse={zAxisId:0,range:Qs.range,scale:Qs.scale,type:Qs.type};function P6(e){var t=Ma(e,Lse);return k.createElement(Fse,{domain:t.domain,id:t.zAxisId,dataKey:t.dataKey,name:t.name,unit:t.unit,range:t.range,scale:t.scale,type:t.type,allowDuplicatedCategory:Qs.allowDuplicatedCategory,allowDataOverflow:Qs.allowDataOverflow,reversed:Qs.reversed,includeHidden:Qs.includeHidden})}P6.displayName="ZAxis";var Bse=(e,t)=>t,ON=Ne([Bse,jr,YM,dn,XP,Nl,xte,Hn],Nte),DN=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},F6=Ii("mouseClick"),L6=V0();L6.startListening({actionCreator:F6,effect:(e,t)=>{var r=e.payload,n=ON(t.getState(),DN(r));n?.activeIndex!=null&&t.dispatch(pee({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var gw=Ii("mouseMove"),B6=V0(),Km=null;B6.startListening({actionCreator:gw,effect:(e,t)=>{var r=e.payload;Km!==null&&cancelAnimationFrame(Km);var n=DN(r);Km=requestAnimationFrame(()=>{var a=t.getState(),i=pN(a,a.tooltip.settings.shared);if(i==="axis"){var s=ON(a,n);s?.activeIndex!=null?t.dispatch($P({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(zP())}Km=null})}});function Use(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var mO={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},U6=Pa({name:"rootProps",initialState:mO,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:mO.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),zse=U6.reducer,{updateOptions:$se}=U6.actions,z6=Pa({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:uSe}=z6.actions,Hse=z6.reducer,$6=Ii("keyDown"),H6=Ii("focus"),IN=V0();IN.startListening({actionCreator:$6,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=xN(a,xd(r),eh(r),ah(r)),c=s==null?-1:Number(s);if(!(!Number.isFinite(c)||c<0)){var d=Nl(r);if(i==="Enter"){var f=ix(r,"axis","hover",String(a.index));t.dispatch(cw({active:!a.active,activeIndex:a.index,activeCoordinate:f}));return}var h=iee(r),p=h==="left-to-right"?1:-1,g=i==="ArrowRight"?1:-1,v=c+g*p;if(!(d==null||v>=d.length||v<0)){var b=ix(r,"axis","hover",String(v));t.dispatch(cw({active:!0,activeIndex:v.toString(),activeCoordinate:b}))}}}}}});IN.startListening({actionCreator:H6,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=ix(r,"axis","hover",String(i));t.dispatch(cw({active:!0,activeIndex:i,activeCoordinate:s}))}}}});var Si=Ii("externalEvent"),V6=V0(),Bb=new Map;V6.startListening({actionCreator:Si,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,i=Bb.get(a);i!==void 0&&cancelAnimationFrame(i);var s=requestAnimationFrame(()=>{try{var c=t.getState(),d={activeCoordinate:tte(c),activeDataKey:Jee(c),activeIndex:f0(c),activeLabel:JP(c),activeTooltipIndex:f0(c),isTooltipActive:rte(c)};r(d,n)}finally{Bb.delete(a)}});Bb.set(a,s)}}});var Vse=Ne([md],e=>e.tooltipItemPayloads),Gse=Ne([Vse,nh,(e,t)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(c=>c.settings.graphicalItemId===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),G6=Ii("touchMove"),W6=V0();W6.startListening({actionCreator:G6,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=pN(n,n.tooltip.settings.shared);if(a==="axis"){var i=r.touches[0];if(i==null)return;var s=ON(n,DN({clientX:i.clientX,clientY:i.clientY,currentTarget:r.currentTarget}));s?.activeIndex!=null&&t.dispatch($P({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(a==="item"){var c,d=r.touches[0];if(document.elementFromPoint==null||d==null)return;var f=document.elementFromPoint(d.clientX,d.clientY);if(!f||!f.getAttribute)return;var h=f.getAttribute(_R),p=(c=f.getAttribute(jR))!==null&&c!==void 0?c:void 0,g=pd(n).find(y=>y.id===p);if(h==null||g==null||p==null)return;var{dataKey:v}=g,b=Gse(n,h,p);t.dispatch(UP({activeDataKey:v,activeIndex:h,activeCoordinate:b,activeGraphicalItemId:p}))}}}});var Wse=K5({brush:Dae,cartesianAxis:Tae,chartData:tre,errorBars:mie,graphicalItems:dae,layout:Rq,legend:VK,options:Xte,polarAxis:Tne,polarOptions:Hse,referenceElements:Bae,rootProps:zse,tooltip:xee,zIndex:Fte}),qse=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return iq({reducer:Wse,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([L6.middleware,B6.middleware,IN.middleware,V6.middleware,W6.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(cR({type:"raf"}))},devTools:{serialize:{replacer:Use},name:"recharts-".concat(r)}})};function Kse(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=si(),i=k.useRef(null);if(a)return r;i.current==null&&(i.current=qse(t,n));var s=fS;return k.createElement(Bie,{context:s,store:i.current},r)}function Yse(e){var{layout:t,margin:r}=e,n=Mr(),a=si();return k.useEffect(()=>{a||(n(Oq(t)),n(Aq(r)))},[n,a,t,r]),null}var Xse=k.memo(Yse,AN);function Zse(e){var t=Mr();return k.useEffect(()=>{t($se(e))},[t,e]),null}function pO(e){var{zIndex:t,isPanorama:r}=e,n=k.useRef(null),a=Mr();return k.useLayoutEffect(()=>(n.current&&a(Mte({zIndex:t,element:n.current,isPanorama:r})),()=>{a(Pte({zIndex:t,isPanorama:r}))}),[a,t,r]),k.createElement("g",{tabIndex:-1,ref:n})}function xO(e){var{children:t,isPanorama:r}=e,n=at(_te);if(!n||n.length===0)return t;var a=n.filter(s=>s<0),i=n.filter(s=>s>0);return k.createElement(k.Fragment,null,a.map(s=>k.createElement(pO,{key:s,zIndex:s,isPanorama:r})),t,i.map(s=>k.createElement(pO,{key:s,zIndex:s,isPanorama:r})))}var Qse=["children"];function Jse(e,t){if(e==null)return{};var r,n,a=ele(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ele(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function cx(){return cx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cx.apply(null,arguments)}var tle={width:"100%",height:"100%",display:"block"},rle=k.forwardRef((e,t)=>{var r=jK(),n=EK(),a=BR();if(!xo(r)||!xo(n))return null;var{children:i,otherAttributes:s,title:c,desc:d}=e,f,h;return s!=null&&(typeof s.tabIndex=="number"?f=s.tabIndex:f=a?0:void 0,typeof s.role=="string"?h=s.role:h=a?"application":void 0),k.createElement(d5,cx({},s,{title:c,desc:d,role:h,tabIndex:f,width:r,height:n,style:tle,ref:t}),i)}),nle=e=>{var{children:t}=e,r=at(eg);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return k.createElement(d5,{width:n,height:a,x:s,y:i},t)},gO=k.forwardRef((e,t)=>{var{children:r}=e,n=Jse(e,Qse),a=si();return a?k.createElement(nle,null,k.createElement(xO,{isPanorama:!0},r)):k.createElement(rle,cx({ref:t},n),k.createElement(xO,{isPanorama:!1},r))});function ale(){var e=Mr(),[t,r]=k.useState(null),n=at(Yq);return k.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;en(i)&&i!==n&&e(Iq(i))}},[t,e,n]),r}function vO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ile(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vO(Object(r),!0).forEach(function(n){sle(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sle(e,t,r){return(t=lle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lle(e){var t=ole(e,"string");return typeof t=="symbol"?t:t+""}function ole(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wc(){return wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wc.apply(null,arguments)}var cle=()=>(ure(),null);function ux(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var ule=k.forwardRef((e,t)=>{var r,n,a=k.useRef(null),[i,s]=k.useState({containerWidth:ux((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:ux((n=e.style)===null||n===void 0?void 0:n.height)}),c=k.useCallback((f,h)=>{s(p=>{var g=Math.round(f),v=Math.round(h);return p.containerWidth===g&&p.containerHeight===v?p:{containerWidth:g,containerHeight:v}})},[]),d=k.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null&&typeof ResizeObserver<"u"){var{width:h,height:p}=f.getBoundingClientRect();c(h,p);var g=b=>{var{width:y,height:w}=b[0].contentRect;c(y,w)},v=new ResizeObserver(g);v.observe(f),a.current=v}},[t,c]);return k.useEffect(()=>()=>{var f=a.current;f?.disconnect()},[c]),k.createElement(k.Fragment,null,k.createElement(rg,{width:i.containerWidth,height:i.containerHeight}),k.createElement("div",wc({ref:d},e)))}),dle=k.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=k.useState({containerWidth:ux(r),containerHeight:ux(n)}),s=k.useCallback((d,f)=>{i(h=>{var p=Math.round(d),g=Math.round(f);return h.containerWidth===p&&h.containerHeight===g?h:{containerWidth:p,containerHeight:g}})},[]),c=k.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null){var{width:f,height:h}=d.getBoundingClientRect();s(f,h)}},[t,s]);return k.createElement(k.Fragment,null,k.createElement(rg,{width:a.containerWidth,height:a.containerHeight}),k.createElement("div",wc({ref:c},e)))}),fle=k.forwardRef((e,t)=>{var{width:r,height:n}=e;return k.createElement(k.Fragment,null,k.createElement(rg,{width:r,height:n}),k.createElement("div",wc({ref:t},e)))}),hle=k.forwardRef((e,t)=>{var{width:r,height:n}=e;return cl(r)||cl(n)?k.createElement(dle,wc({},e,{ref:t})):k.createElement(fle,wc({},e,{ref:t}))});function mle(e){return e===!0?ule:hle}var ple=k.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:c,onMouseDown:d,onMouseEnter:f,onMouseLeave:h,onMouseMove:p,onMouseUp:g,onTouchEnd:v,onTouchMove:b,onTouchStart:y,style:w,width:j,responsive:T,dispatchTouchEvents:N=!0}=e,C=k.useRef(null),E=Mr(),[O,A]=k.useState(null),[D,M]=k.useState(null),P=ale(),R=wS(),L=R?.width>0?R.width:j,te=R?.height>0?R.height:a,ee=k.useCallback(ne=>{P(ne),typeof t=="function"&&t(ne),A(ne),M(ne),ne!=null&&(C.current=ne)},[P,t,A,M]),ue=k.useCallback(ne=>{E(F6(ne)),E(Si({handler:i,reactEvent:ne}))},[E,i]),V=k.useCallback(ne=>{E(gw(ne)),E(Si({handler:f,reactEvent:ne}))},[E,f]),K=k.useCallback(ne=>{E(zP()),E(Si({handler:h,reactEvent:ne}))},[E,h]),ie=k.useCallback(ne=>{E(gw(ne)),E(Si({handler:p,reactEvent:ne}))},[E,p]),re=k.useCallback(()=>{E(H6())},[E]),me=k.useCallback(ne=>{E($6(ne.key))},[E]),W=k.useCallback(ne=>{E(Si({handler:s,reactEvent:ne}))},[E,s]),F=k.useCallback(ne=>{E(Si({handler:c,reactEvent:ne}))},[E,c]),X=k.useCallback(ne=>{E(Si({handler:d,reactEvent:ne}))},[E,d]),q=k.useCallback(ne=>{E(Si({handler:g,reactEvent:ne}))},[E,g]),U=k.useCallback(ne=>{E(Si({handler:y,reactEvent:ne}))},[E,y]),G=k.useCallback(ne=>{N&&E(G6(ne)),E(Si({handler:b,reactEvent:ne}))},[E,N,b]),le=k.useCallback(ne=>{E(Si({handler:v,reactEvent:ne}))},[E,v]),de=mle(T);return k.createElement(s6.Provider,{value:O},k.createElement(PV.Provider,{value:D},k.createElement(de,{width:L??w?.width,height:te??w?.height,className:tr("recharts-wrapper",n),style:ile({position:"relative",cursor:"default",width:L,height:te},w),onClick:ue,onContextMenu:W,onDoubleClick:F,onFocus:re,onKeyDown:me,onMouseDown:X,onMouseEnter:V,onMouseLeave:K,onMouseMove:ie,onMouseUp:q,onTouchEnd:le,onTouchMove:G,onTouchStart:U,ref:ee},k.createElement(cle,null),r)))}),xle=["width","height","responsive","children","className","style","compact","title","desc"];function gle(e,t){if(e==null)return{};var r,n,a=vle(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yle=k.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:s,style:c,compact:d,title:f,desc:h}=e,p=gle(e,xle),g=ll(p);return d?k.createElement(k.Fragment,null,k.createElement(rg,{width:r,height:n}),k.createElement(gO,{otherAttributes:g,title:f,desc:h},i)):k.createElement(ple,{className:s,style:c,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},k.createElement(gO,{otherAttributes:g,title:f,desc:h,ref:t},k.createElement(zae,null,i)))});function vw(){return vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vw.apply(null,arguments)}var ble={top:5,right:5,bottom:5,left:5},wle={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:ble,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},Sle=k.forwardRef(function(t,r){var n,a=Ma(t.categoricalChartProps,wle),{chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,categoricalChartProps:f}=t,h={chartName:i,defaultTooltipEventType:s,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return k.createElement(Kse,{preloadedState:{options:h},reduxStoreName:(n=f.id)!==null&&n!==void 0?n:i},k.createElement(Oae,{chartData:f.data}),k.createElement(Xse,{layout:a.layout,margin:a.margin}),k.createElement(Zse,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),k.createElement(yle,vw({},a,{ref:r})))}),Nle=["item"],kle=k.forwardRef((e,t)=>k.createElement(Sle,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Nle,tooltipPayloadSearcher:Kte,categoricalChartProps:e,ref:t}));const dx=({pillarId:e,initiative:t,onClose:r,onNavigate:n})=>{const{state:a,dispatch:i}=Pt(),{pillars:s,resources:c}=a,[d,f]=k.useState({pillarId:t?.pillarId||e||"",name:t?.name||"",description:t?.description||"",ownerId:t?.ownerId||"",startDate:t?.startDate||new Date().toISOString().split("T")[0],endDate:t?.endDate||new Date(Date.now()+2160*60*60*1e3).toISOString().split("T")[0],budget:t?.budget||1e5,spentBudget:t?.spentBudget||0,ragStatus:t?.ragStatus||"green"}),h=b=>{b.preventDefault();const y={id:t?.id||No(),pillarId:d.pillarId,name:d.name,description:d.description,ownerId:d.ownerId,startDate:d.startDate,endDate:d.endDate,budget:d.budget,spentBudget:d.spentBudget,ragStatus:d.ragStatus};i(t?{type:"UPDATE_INITIATIVE",payload:y}:{type:"ADD_INITIATIVE",payload:y}),r()},p=()=>{t&&confirm("Are you sure you want to delete this initiative? This will also delete all associated projects and tasks.")&&(i({type:"DELETE_INITIATIVE",payload:t.id}),r())},g=d.spentBudget-d.budget,v=d.budget>0?Math.round(d.spentBudget/d.budget*100):0;return o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Initiative Name *"}),o.jsx("input",{type:"text",value:d.name,onChange:b=>f({...d,name:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Description"}),o.jsx("textarea",{value:d.description,onChange:b=>f({...d,description:b.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue resize-none"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Strategy Pillar *"}),o.jsxs("select",{value:d.pillarId,onChange:b=>f({...d,pillarId:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0,children:[o.jsx("option",{value:"",children:"Select Pillar"}),s.map(b=>o.jsx("option",{value:b.id,children:b.name},b.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Owner"}),o.jsxs("select",{value:d.ownerId,onChange:b=>f({...d,ownerId:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"",children:"Unassigned"}),c.map(b=>o.jsxs("option",{value:b.id,children:[b.name," (",b.role,")"]},b.id))]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Start Date"}),o.jsx("input",{type:"date",value:d.startDate,onChange:b=>f({...d,startDate:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"End Date"}),o.jsx("input",{type:"date",value:d.endDate,onChange:b=>f({...d,endDate:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Budget ($)"}),o.jsx("input",{type:"number",value:d.budget,onChange:b=>f({...d,budget:Number(b.target.value)}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Spent Budget ($)"}),o.jsx("input",{type:"number",value:d.spentBudget,onChange:b=>f({...d,spentBudget:Number(b.target.value)}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"RAG Status"}),o.jsxs("select",{value:d.ragStatus,onChange:b=>f({...d,ragStatus:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"green",children:"Green - On Track"}),o.jsx("option",{value:"amber",children:"Amber - At Risk"}),o.jsx("option",{value:"red",children:"Red - Critical"})]})]})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Budget Usage:"}),o.jsxs("span",{className:g>0?"text-rag-red":"text-rag-green",children:[v,"% (",g>0?"+":"","$",g.toLocaleString(),")"]})]}),o.jsx("div",{className:"mt-2 h-2 bg-bg-primary rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all ${v>100?"bg-rag-red":v>80?"bg-rag-amber":"bg-rag-green"}`,style:{width:`${Math.min(v,100)}%`}})})]}),o.jsxs("div",{className:"flex justify-between pt-4 border-t border-border",children:[o.jsxs("div",{className:"flex gap-2",children:[t&&o.jsx(Xe,{type:"button",variant:"danger",onClick:p,children:"Delete"}),t&&n&&o.jsxs(Xe,{type:"button",variant:"secondary",onClick:n,children:[o.jsx(JI,{className:"w-4 h-4 mr-1"}),"View in Portfolio"]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),o.jsx(Xe,{type:"submit",children:t?"Update":"Create"})]})]})]})},yO={red:"#ef4444",amber:"#f59e0b",green:"#22c55e"},_le=({active:e,payload:t})=>{if(e&&t&&t.length){const r=t[0].payload;return o.jsxs("div",{className:"bg-bg-card border border-border rounded-lg p-3 shadow-lg",children:[o.jsx("p",{className:"font-medium text-text-primary mb-1",children:r.name}),o.jsxs("p",{className:"text-sm text-text-secondary",children:["Pillar: ",r.pillarName]}),o.jsxs("p",{className:"text-sm text-text-secondary",children:["Budget: $",(r.budget/1e6).toFixed(1),"M"]}),o.jsxs("p",{className:"text-sm text-text-secondary capitalize",children:["Status: ",r.ragStatus]}),o.jsx("p",{className:"text-xs text-accent-blue mt-2",children:"Click to view/edit"})]})}return null},jle=({initiatives:e,pillars:t})=>{const r=fa(),[n,a]=k.useState(null),[i,s]=k.useState(!1),c=e.map(h=>{const p=t.find(j=>j.id===h.pillarId),g=p?.displayOrder||1,v=Math.min(h.budget/1e6,5),b=Math.min(10,(5-g)*2+v),y=h.spentBudget/h.budget*100;let w=8;return h.ragStatus==="red"?w=3:h.ragStatus==="amber"&&(w=6),y>100&&(w-=2),{id:h.id,name:h.name,strategicImportance:Math.max(1,Math.min(10,b+Math.random()*2)),executionHealth:Math.max(1,Math.min(10,w+Math.random()*2)),budget:h.budget,ragStatus:h.ragStatus,pillarId:h.pillarId,pillarName:p?.name||"Unknown"}}),d=h=>{const p=e.find(g=>g.id===h.id);p&&(a(p),s(!0))},f=()=>{n&&(r(`/portfolio?pillar=${n.pillarId}`),s(!1))};return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Strategic Initiative Heatmap"}),o.jsx("div",{className:"h-80",children:o.jsx(NK,{width:"100%",height:"100%",children:o.jsxs(kle,{margin:{top:20,right:20,bottom:40,left:40},children:[o.jsx(R6,{type:"number",dataKey:"executionHealth",name:"Execution Health",domain:[0,10],tick:{fill:"#94a3b8",fontSize:12},tickLine:{stroke:"#2d3748"},axisLine:{stroke:"#2d3748"},label:{value:"Execution Health",position:"bottom",offset:20,fill:"#94a3b8",fontSize:12}}),o.jsx(M6,{type:"number",dataKey:"strategicImportance",name:"Strategic Importance",domain:[0,10],tick:{fill:"#94a3b8",fontSize:12},tickLine:{stroke:"#2d3748"},axisLine:{stroke:"#2d3748"},label:{value:"Strategic Importance",angle:-90,position:"insideLeft",offset:10,fill:"#94a3b8",fontSize:12}}),o.jsx(P6,{type:"number",dataKey:"budget",range:[100,800],name:"Budget"}),o.jsx(vre,{content:o.jsx(_le,{})}),o.jsx(D6,{data:c,onClick:(h,p)=>{p!==void 0&&c[p]&&d(c[p])},cursor:"pointer",children:c.map((h,p)=>o.jsx(_N,{fill:yO[h.ragStatus],fillOpacity:.7,stroke:yO[h.ragStatus],strokeWidth:2,className:"cursor-pointer hover:opacity-100 transition-opacity"},`cell-${p}`))})]})})}),o.jsxs("div",{className:"flex justify-center gap-6 mt-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-green"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"On Track"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-amber"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"At Risk"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-red"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Critical"})]})]}),o.jsx(Ta,{isOpen:i,onClose:()=>s(!1),title:n?`Edit Initiative: ${n.name}`:"Initiative",size:"lg",children:n&&o.jsx(dx,{initiative:n,onClose:()=>s(!1),onNavigate:f})})]})},Ele=()=>{const e=fa(),{state:t,getKPIsByPillar:r,getOrgUnit:n,getOrgUnitDescendants:a,getOrgConfig:i}=Pt(),{selectedOrgUnitId:s,isFiltering:c}=Xw(),{isConfigured:d,isLoading:f,getExecutiveSummary:h,getPillarInsight:p,refreshAnalysis:g}=Yw(),v=i(),b=s?n(s):null,{pillars:y,initiatives:w}=k.useMemo(()=>{if(!c)return{pillars:t.pillars,initiatives:t.initiatives};const N=new Set([s]);a(s).forEach(O=>N.add(O.id));const C=t.pillars.filter(O=>N.has(O.orgUnitId||"org-company")),E=t.initiatives.filter(O=>N.has(O.orgUnitId||"org-company"));return{pillars:C,initiatives:E}},[t.pillars,t.initiatives,s,c,a]),j=w.filter(N=>N.ragStatus==="red"||N.ragStatus==="amber"),T=y.filter(N=>N.ragStatus==="green").length;return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Strategic Command Center"}),o.jsx("p",{className:"text-text-secondary mt-1",children:c&&b?`Viewing: ${b.name} (${v.levelNames[b.level]})`:"Board of Directors View"})]}),o.jsx("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:c&&b?o.jsxs(o.Fragment,{children:[o.jsx(gl,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"text-sm text-text-secondary",children:b.name})]}):o.jsxs(o.Fragment,{children:[o.jsx(gr,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"All Organizations"})]})})]}),(h()||f)&&o.jsx("div",{onClick:()=>e("/insights"),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"p-2 bg-accent-purple/20 rounded-lg",children:f?o.jsx(il,{className:"w-5 h-5 text-accent-purple animate-spin"}):o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h3",{className:"text-sm font-semibold text-accent-purple",children:"AI Executive Summary"}),o.jsx(qu,{content:"AI-generated analysis of your organization's strategic health, highlighting key risks, opportunities, and recommendations. Configure Claude API in Settings to enable.",position:"bottom",size:"md"}),!d&&o.jsxs("button",{onClick:N=>{N.stopPropagation(),e("/settings")},className:"text-xs text-accent-purple/70 hover:text-accent-purple flex items-center gap-1",children:[o.jsx(mo,{className:"w-3 h-3"})," Configure API"]}),d&&o.jsxs("button",{onClick:N=>{N.stopPropagation(),g(!0)},className:"text-xs text-accent-purple/70 hover:text-accent-purple flex items-center gap-1",disabled:f,children:[o.jsx(co,{className:`w-3 h-3 ${f?"animate-spin":""}`})," Refresh"]})]}),o.jsx("p",{className:"text-text-primary",children:f?"Analyzing organizational data...":h()})]}),o.jsx(Kt,{className:"w-5 h-5 text-accent-purple opacity-0 group-hover:opacity-100 transition-opacity mt-1"})]})}),y.length>0&&w.length===0&&o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-6 text-center",children:[o.jsx(gr,{className:"w-12 h-12 text-accent-blue mx-auto mb-3"}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"Get Started with Initiatives"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"Your strategy pillars are set up. Create initiatives to start tracking your strategic programs."}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx("button",{onClick:()=>e("/portfolio"),className:"px-4 py-2 bg-accent-blue text-white rounded-lg hover:bg-accent-blue/90 transition-colors",children:"Go to Portfolio"}),o.jsx("button",{onClick:()=>e("/import"),className:"px-4 py-2 border border-border text-text-primary rounded-lg hover:bg-bg-hover transition-colors",children:"Import Data"})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Balanced Scorecard Pillars"}),o.jsx(qu,{content:"The four strategic perspectives: Financial (shareholder value), Customer (satisfaction & retention), Internal Processes (operational excellence), and Learning & Growth (innovation & capability). Each pillar has KPIs and linked initiatives.",position:"right",size:"lg"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:y.sort((N,C)=>N.displayOrder-C.displayOrder).map(N=>o.jsx(jV,{pillar:N,kpis:r(N.id),aiInsight:p(N.id)},N.id))})]}),o.jsx(jle,{initiatives:w,pillars:y}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsx("div",{onClick:()=>e("/portfolio"),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-accent-blue/20 rounded-lg",children:o.jsx(gr,{className:"w-5 h-5 text-accent-blue"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:w.length}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Active Initiatives"})]})]}),o.jsx(Kt,{className:"w-5 h-5 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>e("/portfolio?filter=at-risk"),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-rag-amber/20 rounded-lg",children:o.jsx(jn,{className:"w-5 h-5 text-rag-amber"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:j.length}),o.jsx("p",{className:"text-sm text-text-secondary",children:"At Risk Initiatives"})]})]}),o.jsx(Kt,{className:"w-5 h-5 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>e("/strategy"),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-rag-green/20 rounded-lg",children:o.jsx(Ac,{className:"w-5 h-5 text-rag-green"})}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[T,"/",y.length]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Pillars On Track"})]})]}),o.jsx(Kt,{className:"w-5 h-5 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})})]})]})},Tle=({initiatives:e,projects:t})=>{const r=fa(),[n]=Hw(),a=e.length,i=t.filter(g=>g.ragStatus==="red").length,s=e.reduce((g,v)=>g+v.budget,0),c=e.reduce((g,v)=>g+v.spentBudget,0),d=s>0?Math.round(c/s*100):0,f="Critical bottleneck identified: 'Cloud Architects' are allocated at 140% capacity across 5 priority projects for the next 6 weeks.",h=n.get("pillar"),p=h?`/portfolio?pillar=${h}`:"/portfolio";return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5 mb-6",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-4",children:[o.jsxs("div",{onClick:()=>r(p),className:"flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer hover:bg-bg-hover transition-colors group",children:[o.jsx(Ai,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"text-text-secondary",children:"Total Active Initiatives:"}),o.jsx("span",{className:"text-xl font-bold text-accent-blue",children:a}),o.jsx(Kt,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsxs("div",{onClick:()=>r(`${p}${h?"&":"?"}filter=projects-at-risk`),className:"flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer hover:bg-bg-hover transition-colors group",children:[o.jsx(_n,{className:"w-5 h-5 text-rag-red"}),o.jsx("span",{className:"text-text-secondary",children:"Projects at Risk (Red):"}),o.jsx("span",{className:"text-xl font-bold text-rag-red",children:i}),o.jsx(Kt,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsxs("div",{onClick:()=>r(`${p}${h?"&":"?"}view=budget`),className:"flex items-center gap-2 px-3 py-2 rounded-lg cursor-pointer hover:bg-bg-hover transition-colors group",children:[o.jsx(sd,{className:"w-5 h-5 text-rag-amber"}),o.jsx("span",{className:"text-text-secondary",children:"Budget Burn Rate:"}),o.jsxs("span",{className:`text-xl font-bold ${d>100?"text-rag-red":d>90?"text-rag-amber":"text-rag-green"}`,children:[d,"%"]}),o.jsx(Kt,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})]}),o.jsxs("div",{onClick:()=>r("/resources"),className:"flex items-start gap-3 p-3 bg-rag-amber/10 rounded-lg border border-rag-amber/30 cursor-pointer hover:bg-rag-amber/20 transition-colors group",children:[o.jsx(jn,{className:"w-5 h-5 text-rag-amber flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:"text-sm font-semibold text-rag-amber",children:"AI Resource Alert: "}),o.jsx("span",{className:"text-sm text-text-primary",children:f})]}),o.jsx(Kt,{className:"w-4 h-4 text-rag-amber opacity-0 group-hover:opacity-100 transition-opacity mt-0.5"})]})]})},Cle=({initiatives:e,pillars:t})=>{const r=fa(),[n,a]=k.useState(null),[i,s]=k.useState(!1),c=C=>{a(C),s(!0)},d=()=>{n&&(r(`/portfolio?pillar=${n.pillarId}`),s(!1))},f=e.flatMap(C=>[new Date(C.startDate),new Date(C.endDate)]),h=new Date(Math.min(...f.map(C=>C.getTime()))),p=new Date(Math.max(...f.map(C=>C.getTime()))),g=[],v=new Date(h);for(v.setDate(1);v<=p;)g.push({label:v.toLocaleDateString("en-US",{month:"short"}),date:new Date(v)}),v.setMonth(v.getMonth()+1);const b=p.getTime()-h.getTime(),y=C=>(new Date(C).getTime()-h.getTime())/b*100,w=(C,E)=>{const O=y(C);return y(E)-O},j=C=>{const E=new Date,O=new Date(C.startDate),A=new Date(C.endDate);if(E<O)return 0;if(E>A)return 100;const D=A.getTime()-O.getTime(),M=E.getTime()-O.getTime();return Math.round(M/D*100)},T=t.map(C=>({pillar:C,initiatives:e.filter(E=>E.pillarId===C.id)})),N={red:"bg-rag-red",amber:"bg-rag-amber",green:"bg-rag-green"};return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5 mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Initiative Roadmap"}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-2 bg-accent-blue rounded"}),o.jsx("span",{className:"text-text-secondary",children:"Planned vs. actual"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-8 h-2 bg-rag-red/50 rounded border border-dashed border-rag-red"}),o.jsx("span",{className:"text-text-secondary",children:"AI-predicted slippage"})]})]})]}),o.jsxs("div",{className:"flex border-b border-border mb-4",children:[o.jsx("div",{className:"w-48 flex-shrink-0 py-2 px-3 text-sm font-medium text-text-secondary",children:"Strategy pillar"}),o.jsx("div",{className:"flex-1 flex",children:g.map((C,E)=>o.jsx("div",{className:"flex-1 py-2 text-center text-sm text-text-secondary border-l border-border",children:C.label},E))})]}),o.jsx("div",{className:"space-y-1",children:T.map(({pillar:C,initiatives:E})=>o.jsxs(Nt.Fragment,{children:[o.jsxs("div",{className:"flex items-center py-2 bg-bg-hover rounded",children:[o.jsx("div",{className:"w-48 flex-shrink-0 px-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ic,{status:C.ragStatus,size:"sm"}),o.jsx("span",{className:"text-sm font-medium text-text-primary",children:C.name})]})}),o.jsx("div",{className:"flex-1"})]}),E.map(O=>{const A=y(new Date(O.startDate)),D=w(new Date(O.startDate),new Date(O.endDate)),M=j(O);return o.jsxs("div",{onClick:()=>c(O),className:"flex items-center py-2 hover:bg-bg-hover/50 cursor-pointer group",children:[o.jsx("div",{className:"w-48 flex-shrink-0 px-3 pl-8",children:o.jsx("span",{className:"text-sm text-text-secondary truncate block group-hover:text-accent-blue transition-colors",children:O.name})}),o.jsxs("div",{className:"flex-1 relative h-6",children:[o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 h-4 bg-accent-blue/30 rounded-full group-hover:bg-accent-blue/40 transition-colors",style:{left:`${A}%`,width:`${D}%`},children:o.jsx("div",{className:`h-full ${N[O.ragStatus]} rounded-full`,style:{width:`${M}%`}})}),(O.ragStatus==="amber"||O.ragStatus==="red")&&o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 h-4 bg-rag-red/20 rounded-r-full border border-dashed border-rag-red",style:{left:`${A+D}%`,width:`${Math.min(D*.2,10)}%`}}),o.jsx("div",{className:"absolute top-1/2 -translate-y-1/2",style:{left:`${A+D}%`},children:o.jsx(A$,{className:`w-4 h-4 -ml-2 ${O.ragStatus==="red"?"text-rag-red fill-rag-red":"text-rag-amber fill-rag-amber"}`})})]})]},O.id)})]},C.id))}),o.jsx(Ta,{isOpen:i,onClose:()=>s(!1),title:n?`Edit Initiative: ${n.name}`:"Initiative",size:"lg",children:n&&o.jsx(dx,{initiative:n,onClose:()=>s(!1),onNavigate:d})})]})},bO=e=>e>=1e6?`$${(e/1e6).toFixed(1)}M`:e>=1e3?`$${(e/1e3).toFixed(0)}K`:`$${e.toFixed(0)}`,Ale=M0.weights,sh=M0.thresholds,q6=M0.riskLevels;function wO(e,t){return Math.round((t.getTime()-e.getTime())/864e5)}function yw(e,t){const r=new Date(e),n=new Date(t),a=new Date,i=wO(r,n);if(i<=0)return 100;const s=wO(r,a);return Math.min(100,Math.max(0,s/i*100))}function K6(e){return e>=1?0:e>=.95?10:e>=.9?25:e>=.85?40:e>=.8?55:e>=.7?70:e>=.6?85:100}function Oa(e){return e<=30?"low":e<=60?"medium":e<=80?"high":"critical"}function Ole(e,t=q6){return e<=t.low?"low":e<=t.medium?"medium":e<=t.high?"high":"critical"}function Dle(e,t,r,n=sh){const a=[];let i=0;const s=t.length>0?t.reduce((y,w)=>y+w.completionPercentage,0)/t.length:0,c=yw(e.startDate,e.endDate),d=e.spiOverride??(c>0?s/c:1),f=K6(d);f>0&&(a.push({category:"schedule",name:"Schedule Performance Index",description:d<n.spi.warning?`Behind schedule: ${(d*100).toFixed(0)}% of planned progress achieved`:`Slightly behind schedule: SPI = ${d.toFixed(2)}`,score:f,weight:.4,severity:Oa(f),rawValue:d,threshold:"SPI < 1.0 indicates behind schedule"}),i+=f*.4);const h=new Date,p=r.filter(y=>y.kanbanStatus!=="done"),g=p.filter(y=>new Date(y.dueDate)<h),v=p.length>0?g.length/p.length:0;if(v>n.overdueRatio.good){const y=v>n.overdueRatio.critical?100:v>n.overdueRatio.warning?60:30;a.push({category:"schedule",name:"Overdue Tasks",description:`${g.length} of ${p.length} tasks are overdue (${(v*100).toFixed(0)}%)`,score:y,weight:.35,severity:Oa(y),rawValue:g.length,threshold:`>${(n.overdueRatio.good*100).toFixed(0)}% overdue triggers warning`}),i+=y*.35}const b=t.filter(y=>{const w=yw(y.startDate,y.endDate);return y.completionPercentage<w-15});if(b.length>0){const y=b.length/t.length,w=y>.5?80:y>.25?50:25;a.push({category:"schedule",name:"Projects Behind Schedule",description:`${b.length} of ${t.length} projects are significantly behind schedule`,score:w,weight:.25,severity:Oa(w),rawValue:b.length}),i+=w*.25}return{score:Math.min(100,i),spi:d,factors:a}}function Ile(e,t,r=sh){const n=[];let a=0;const i=t.length>0?t.reduce((p,g)=>p+g.completionPercentage,0)/t.length:0,s=e.budget>0?e.spentBudget/e.budget*100:0,c=e.cpiOverride??(s>0?i/s:1),d=K6(c);d>0&&(n.push({category:"cost",name:"Cost Performance Index",description:c<r.cpi.warning?`Over budget: Getting ${(c*100).toFixed(0)}% value per dollar spent`:`Slightly over budget: CPI = ${c.toFixed(2)}`,score:d,weight:.5,severity:Oa(d),rawValue:c,threshold:"CPI < 1.0 indicates over budget"}),a+=d*.5);const f=e.budget>0?(e.spentBudget-e.budget)/e.budget*100:0;if(f>r.budgetVariance.good){const p=f>r.budgetVariance.critical?100:f>r.budgetVariance.warning?60:30;n.push({category:"cost",name:"Budget Overrun",description:`${f.toFixed(1)}% over allocated budget`,score:p,weight:.35,severity:Oa(p),rawValue:f,threshold:`>${r.budgetVariance.good}% triggers warning`}),a+=p*.35}const h=t.filter(p=>p.spentBudget>p.budget);if(h.length>0){const p=h.length/t.length,g=p>.5?70:p>.25?40:20;n.push({category:"cost",name:"Projects Over Budget",description:`${h.length} of ${t.length} projects have exceeded their budget`,score:g,weight:.15,severity:Oa(g),rawValue:h.length}),a+=g*.15}return{score:Math.min(100,a),cpi:c,factors:n}}function Rle(e,t,r){const n=[];let a=0;const i=yw(e.startDate,e.endDate),s=t.length>0?t.reduce((g,v)=>g+v.completionPercentage,0)/t.length:0,c=i>0?s/i:1;if(c<.9&&i>20){const g=c<.6?80:c<.75?55:30;n.push({category:"scope",name:"Delivery Progress",description:`${s.toFixed(0)}% complete with ${i.toFixed(0)}% of timeline elapsed`,score:g,weight:.5,severity:Oa(g),rawValue:c}),a+=g*.5}const d=t.reduce((g,v)=>g+(v.scopeChangeCount||0),0);if(d>0){const g=d/t.length,v=g>5?70:g>3?45:g>1?20:0;v>0&&(n.push({category:"scope",name:"Scope Changes",description:`${d} scope change request(s) across projects`,score:v,weight:.3,severity:Oa(v),rawValue:d}),a+=v*.3)}const f=r.filter(g=>g.kanbanStatus==="done").length,h=r.length>0?f/r.length:0,p=i/100;if(h<p-.15&&r.length>=5){const g=h<p-.3?60:30;n.push({category:"scope",name:"Task Completion Rate",description:`${(h*100).toFixed(0)}% of tasks complete vs ${(p*100).toFixed(0)}% expected`,score:g,weight:.2,severity:Oa(g),rawValue:h}),a+=g*.2}return{score:Math.min(100,a),scopePerformance:c,factors:n}}function Mle(e,t,r=sh){const n=[];let a=0;const i=new Map;e.forEach(p=>{if(p.kanbanStatus==="done")return;const g=i.get(p.assigneeId),v=t.find(b=>b.id===p.assigneeId);v&&(g?(g.totalHours+=p.estimatedHours||0,g.taskCount++,g.projectIds.add(p.projectId)):i.set(p.assigneeId,{resource:v,totalHours:p.estimatedHours||0,taskCount:1,projectIds:new Set([p.projectId])}))});const s=[];let c=0;if(i.forEach(({resource:p,totalHours:g})=>{const v=p.weeklyCapacity*4,b=v>0?g/v*100:0;c=Math.max(c,b),b>r.resourceUtilization.warning&&s.push(p.name)}),s.length>0){const p=c>r.resourceUtilization.critical?80:c>r.resourceUtilization.warning?50:25;n.push({category:"resource",name:"Over-allocated Resources",description:`${s.length} resource(s) over capacity: ${s.slice(0,3).join(", ")}${s.length>3?"...":""}`,score:p,weight:.5,severity:Oa(p),rawValue:s.length,threshold:`>${r.resourceUtilization.warning}% utilization`}),a+=p*.5}const d=[];if(i.forEach(({resource:p,projectIds:g})=>{(g.size>=3||p.isKeyResource&&g.size>=2)&&d.push(p.name)}),d.length>0){const p=d.length>=3?60:35;n.push({category:"resource",name:"Key Person Dependency",description:`${d.length} resource(s) spread across multiple projects: ${d.slice(0,2).join(", ")}`,score:p,weight:.3,severity:Oa(p),rawValue:d.length}),a+=p*.3}const f=e.filter(p=>p.kanbanStatus!=="done"&&(!p.assigneeId||!t.find(g=>g.id===p.assigneeId)));if(f.length>0){const p=f.length/e.filter(v=>v.kanbanStatus!=="done").length,g=p>.3?50:p>.15?30:15;n.push({category:"resource",name:"Unassigned Work",description:`${f.length} task(s) without assigned resources`,score:g,weight:.2,severity:Oa(g),rawValue:f.length}),a+=g*.2}const h=Math.max(0,1-a/100);return{score:Math.min(100,a),resourceIndex:h,factors:n}}function Ple(e,t,r,n=sh){const a=[];let i=0;const s=r.filter(p=>p.kanbanStatus!=="done"),c=r.filter(p=>p.kanbanStatus==="blocked"),d=s.length>0?c.length/s.length:0;if(d>n.blockedRatio.good){const p=d>n.blockedRatio.critical?80:d>n.blockedRatio.warning?50:25;a.push({category:"quality",name:"Blocked Tasks",description:`${c.length} task(s) blocked (${(d*100).toFixed(0)}% of active work)`,score:p,weight:.4,severity:Oa(p),rawValue:c.length,threshold:`>${(n.blockedRatio.good*100).toFixed(0)}% blocked triggers warning`}),i+=p*.4}e.ragStatus==="red"?(a.push({category:"status",name:"Initiative Status",description:"Initiative marked as Red (critical) status",score:60,weight:.35,severity:"high",rawValue:"red"}),i+=60*.35):e.ragStatus==="amber"&&(a.push({category:"status",name:"Initiative Status",description:"Initiative marked as Amber (at risk) status",score:30,weight:.35,severity:"medium",rawValue:"amber"}),i+=30*.35);const f=t.filter(p=>p.ragStatus==="red").length,h=t.filter(p=>p.ragStatus==="amber").length;if(f>0||h>0){const p=f>0?Math.min(80,30+f*20):Math.min(50,h*15);a.push({category:"status",name:"Project Health",description:f>0?`${f} project(s) in Red status`:`${h} project(s) in Amber status`,score:p,weight:.25,severity:Oa(p),rawValue:f>0?f:h}),i+=p*.25}return{score:Math.min(100,i),factors:a}}function Fle(e,t,r,n,a){const i=Ale,s=sh,c=q6,d=Dle(e,t,r,s),f=Ile(e,t,s),h=Rle(e,t,r),p=Mle(r,n,s),g=Ple(e,t,r,s),v=[...d.factors,...f.factors,...h.factors,...p.factors,...g.factors],b=Math.round(d.score*i.schedule+f.score*i.cost+h.score*i.scope+p.score*i.resource+g.score*i.quality);return{totalScore:Math.min(100,Math.max(0,b)),riskLevel:Ole(b,c),factors:v.sort((y,w)=>w.score-y.score),indices:{spi:d.spi,cpi:f.cpi,scopePerformance:h.scopePerformance,resourceIndex:p.resourceIndex},summary:{scheduleScore:Math.round(d.score),costScore:Math.round(f.score),scopeScore:Math.round(h.score),resourceScore:Math.round(p.score),qualityScore:Math.round(g.score)},calculatedAt:new Date().toISOString()}}function SO(e){return e>=1?`${(e*100).toFixed(0)}% `:e>=.9?`${(e*100).toFixed(0)}%`:`${(e*100).toFixed(0)}% `}function Lle(e){switch(e){case"low":return"text-rag-green";case"medium":return"text-rag-amber";case"high":return"text-rag-red";case"critical":return"text-rag-red"}}const Ble=({initiatives:e,projects:t,pillars:r,resources:n})=>{const a=fa(),[i,s]=k.useState(new Set),[c,d]=k.useState(null),[f,h]=k.useState(null),[p,g]=k.useState(!1),v=N=>{const C=new Set(i);C.has(N)?C.delete(N):C.add(N),s(C)},{state:b}=Pt(),y=b.tasks,w=N=>r.find(C=>C.id===N)?.name||"Unknown",j=N=>t.filter(C=>C.initiativeId===N).length,T=N=>{const C=t.filter(E=>E.initiativeId===N).map(E=>E.id);return y.filter(E=>C.includes(E.projectId))};return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border overflow-hidden",children:[o.jsxs("div",{className:"px-5 py-4 border-b border-border flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Initiative & Project Data Grid"}),r.length>0&&o.jsxs("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-accent-blue hover:bg-accent-blue/10 rounded-lg transition-colors",children:[o.jsx(Ir,{className:"w-4 h-4"}),"Add Initiative"]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"bg-bg-hover",children:[o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-text-secondary",children:"Initiative / Project"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-text-secondary",children:"Work ID"}),o.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-text-secondary",children:"Linked Strategy Pillar"}),o.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-text-secondary",children:"# of Projects"}),o.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-text-secondary",children:"Overall Status (RAG)"}),o.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-text-secondary",children:"Budget Variance"}),o.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-text-secondary",children:o.jsxs("div",{className:"flex items-center justify-center gap-1",children:["Risk Score",o.jsx(qu,{title:"Risk Score Calculation",content:o.jsxs("div",{className:"space-y-1",children:[o.jsx("p",{children:"Base: 50 points"}),o.jsx("p",{children:"Red status: +30"}),o.jsx("p",{children:"Amber status: +15"}),o.jsx("p",{children:"Budget >10% over: +20"}),o.jsx("p",{children:"Each red project: +10"}),o.jsx("p",{className:"pt-1 border-t border-border mt-1",children:"0-50: Low | 51-70: Medium | 71-100: High"})]}),position:"bottom",size:"md"})]})})]})}),o.jsxs("tbody",{children:[e.map(N=>{const C=t.filter(P=>P.initiativeId===N.id),E=T(N.id),O=i.has(N.id),A=N.spentBudget-N.budget,D=Fle(N,C,E,n),M=D.totalScore;return o.jsxs(Nt.Fragment,{children:[o.jsxs("tr",{className:"border-b border-border hover:bg-bg-hover cursor-pointer group",onClick:()=>v(N.id),children:[o.jsx("td",{className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[O?o.jsx(Ra,{className:"w-4 h-4 text-text-muted"}):o.jsx(ha,{className:"w-4 h-4 text-text-muted"}),o.jsx("span",{className:"text-sm font-medium text-text-primary",children:N.name}),o.jsx("button",{onClick:P=>{P.stopPropagation(),d(N)},className:"p-1 text-text-muted hover:text-accent-blue opacity-0 group-hover:opacity-100 transition-opacity",title:"Edit Initiative",children:o.jsx(sl,{className:"w-3.5 h-3.5"})})]})}),o.jsx("td",{className:"px-4 py-3 text-sm text-text-muted",children:"-"}),o.jsx("td",{className:"px-4 py-3 text-sm text-text-secondary",children:w(N.pillarId)}),o.jsx("td",{className:"px-4 py-3 text-center text-sm text-text-primary",children:j(N.id)}),o.jsx("td",{className:"px-4 py-3 text-center",children:o.jsx(_p,{status:N.ragStatus,onClick:()=>{d(N)}})}),o.jsxs("td",{onClick:P=>{P.stopPropagation(),d(N)},className:`px-4 py-3 text-right text-sm font-medium cursor-pointer hover:underline ${A>0?"text-rag-red":"text-rag-green"}`,children:[A>0?"+":"",bO(A)]}),o.jsxs("td",{className:"px-4 py-3 text-center relative",children:[o.jsxs("div",{onClick:P=>{P.stopPropagation(),h(f===N.id?null:N.id)},className:`inline-flex items-center gap-1 text-sm font-medium cursor-pointer hover:underline ${M>60?"text-rag-red":M>30?"text-rag-amber":"text-rag-green"}`,children:[M,o.jsx(Gu,{className:"w-3.5 h-3.5"})]}),f===N.id&&o.jsxs("div",{className:"absolute right-0 top-full mt-1 z-50 w-80 p-4 bg-bg-card border border-border rounded-lg shadow-lg text-left",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(jn,{className:`w-4 h-4 ${Lle(D.riskLevel)}`}),o.jsxs("span",{className:"text-sm font-semibold text-text-primary",children:["Risk Score: ",M]})]}),o.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full capitalize ${D.riskLevel==="low"?"bg-rag-green/20 text-rag-green":D.riskLevel==="medium"?"bg-rag-amber/20 text-rag-amber":"bg-rag-red/20 text-rag-red"}`,children:D.riskLevel})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3 pb-3 border-b border-border",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(fo,{className:"w-3.5 h-3.5 text-text-muted"}),o.jsx("span",{className:"text-xs text-text-secondary",children:"SPI:"}),o.jsx("span",{className:`text-xs font-medium ${D.indices.spi>=.9?"text-rag-green":D.indices.spi>=.8?"text-rag-amber":"text-rag-red"}`,children:SO(D.indices.spi)})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(sd,{className:"w-3.5 h-3.5 text-text-muted"}),o.jsx("span",{className:"text-xs text-text-secondary",children:"CPI:"}),o.jsx("span",{className:`text-xs font-medium ${D.indices.cpi>=.9?"text-rag-green":D.indices.cpi>=.8?"text-rag-amber":"text-rag-red"}`,children:SO(D.indices.cpi)})]})]}),o.jsxs("div",{className:"grid grid-cols-5 gap-1 mb-3 text-center",children:[o.jsxs("div",{title:"Schedule",children:[o.jsx("div",{className:"text-[10px] text-text-muted",children:"Time"}),o.jsx("div",{className:`text-xs font-medium ${D.summary.scheduleScore<=30?"text-rag-green":D.summary.scheduleScore<=60?"text-rag-amber":"text-rag-red"}`,children:D.summary.scheduleScore})]}),o.jsxs("div",{title:"Cost",children:[o.jsx("div",{className:"text-[10px] text-text-muted",children:"Cost"}),o.jsx("div",{className:`text-xs font-medium ${D.summary.costScore<=30?"text-rag-green":D.summary.costScore<=60?"text-rag-amber":"text-rag-red"}`,children:D.summary.costScore})]}),o.jsxs("div",{title:"Scope",children:[o.jsx("div",{className:"text-[10px] text-text-muted",children:"Scope"}),o.jsx("div",{className:`text-xs font-medium ${D.summary.scopeScore<=30?"text-rag-green":D.summary.scopeScore<=60?"text-rag-amber":"text-rag-red"}`,children:D.summary.scopeScore})]}),o.jsxs("div",{title:"Resource",children:[o.jsx("div",{className:"text-[10px] text-text-muted",children:"Team"}),o.jsx("div",{className:`text-xs font-medium ${D.summary.resourceScore<=30?"text-rag-green":D.summary.resourceScore<=60?"text-rag-amber":"text-rag-red"}`,children:D.summary.resourceScore})]}),o.jsxs("div",{title:"Quality",children:[o.jsx("div",{className:"text-[10px] text-text-muted",children:"Quality"}),o.jsx("div",{className:`text-xs font-medium ${D.summary.qualityScore<=30?"text-rag-green":D.summary.qualityScore<=60?"text-rag-amber":"text-rag-red"}`,children:D.summary.qualityScore})]})]}),D.factors.length>0&&o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("div",{className:"text-[10px] font-medium text-text-muted uppercase tracking-wider",children:"Risk Factors"}),D.factors.slice(0,4).map((P,R)=>o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("span",{className:`w-1.5 h-1.5 rounded-full mt-1.5 flex-shrink-0 ${P.severity==="critical"||P.severity==="high"?"bg-rag-red":P.severity==="medium"?"bg-rag-amber":"bg-rag-green"}`}),o.jsx("p",{className:"text-xs text-text-secondary",children:P.description})]},R))]}),D.factors.length===0&&o.jsx("p",{className:"text-xs text-rag-green",children:"No significant risk factors detected"})]})]})]}),O&&C.map(P=>{const R=P.spentBudget-P.budget,L=Un[P.departmentCode];return o.jsxs("tr",{className:"border-b border-border bg-bg-primary hover:bg-bg-hover cursor-pointer group",onClick:te=>{te.stopPropagation(),a(`/execution/${P.id}`)},children:[o.jsx("td",{className:"px-4 py-3 pl-12",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:P.name}),o.jsx("button",{onClick:te=>{te.stopPropagation(),a(`/project/${P.id}`)},className:"p-1 text-text-muted hover:text-accent-blue opacity-0 group-hover:opacity-100 transition-opacity",title:"View Project Charter",children:o.jsx(eS,{className:"w-3.5 h-3.5"})})]})}),o.jsx("td",{className:"px-4 py-3",children:o.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-mono font-medium",style:{backgroundColor:`${L?.color}20`,color:L?.color},children:P.workId})}),o.jsx("td",{className:"px-4 py-3 text-sm text-text-muted",children:w(N.pillarId)}),o.jsx("td",{className:"px-4 py-3 text-center text-sm text-text-muted",children:"-"}),o.jsx("td",{className:"px-4 py-3 text-center",children:o.jsx(_p,{status:P.ragStatus})}),o.jsxs("td",{className:`px-4 py-3 text-right text-sm ${R>0?"text-rag-red":"text-rag-green"}`,children:[R>0?"+":"",bO(R)]}),o.jsx("td",{className:"px-4 py-3 text-center text-sm text-text-muted",children:"-"})]},P.id)})]},N.id)}),e.length===0&&o.jsx("tr",{children:o.jsxs("td",{colSpan:7,className:"px-4 py-12 text-center",children:[o.jsx("div",{className:"text-text-muted mb-2",children:"No initiatives found"}),r.length>0?o.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center gap-2 px-4 py-2 text-sm text-accent-blue hover:bg-accent-blue/10 rounded-lg transition-colors",children:[o.jsx(Ir,{className:"w-4 h-4"}),"Add your first initiative"]}):o.jsx("div",{className:"text-sm text-text-secondary",children:"Create strategy pillars first in the Strategy Hub"})]})})]})]})}),o.jsx(Ta,{isOpen:!!c,onClose:()=>d(null),title:"Edit Initiative",size:"lg",children:c&&o.jsx(dx,{initiative:c,onClose:()=>d(null),onNavigate:()=>{d(null),a(`/portfolio?pillar=${c.pillarId}`)}})}),o.jsx(Ta,{isOpen:p,onClose:()=>g(!1),title:"Add New Initiative",size:"lg",children:o.jsx(dx,{onClose:()=>g(!1)})})]})},Ule=()=>{const{state:e,getOrgUnit:t,getOrgUnitDescendants:r,getOrgConfig:n}=Pt(),{selectedOrgUnitId:a,isFiltering:i}=Xw(),{pillars:s,resources:c}=e,[d]=Hw(),f=n(),h=a?t(a):null,{orgFilteredInitiatives:p,orgFilteredProjects:g}=k.useMemo(()=>{if(!i)return{orgFilteredInitiatives:e.initiatives,orgFilteredProjects:e.projects};const T=new Set([a]);return r(a).forEach(N=>T.add(N.id)),{orgFilteredInitiatives:e.initiatives.filter(N=>T.has(N.orgUnitId||"org-company")),orgFilteredProjects:e.projects.filter(N=>T.has(N.orgUnitId||"org-company"))}},[e.initiatives,e.projects,a,i,r]),v=d.get("pillar"),b=d.get("filter");let y=v?p.filter(T=>T.pillarId===v):p;b==="at-risk"&&(y=y.filter(T=>T.ragStatus==="red"||T.ragStatus==="amber"));let w=v?g.filter(T=>p.find(C=>C.id===T.initiativeId)?.pillarId===v):g;if(b==="at-risk"){const T=y.map(N=>N.id);w=w.filter(N=>T.includes(N.initiativeId)||N.ragStatus==="red"||N.ragStatus==="amber")}if(b==="projects-at-risk"){w=w.filter(N=>N.ragStatus==="red");const T=[...new Set(w.map(N=>N.initiativeId))];y=y.filter(N=>T.includes(N.id))}const j=v?s.find(T=>T.id===v):null;return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("h1",{className:"text-2xl font-bold text-text-primary",children:["Portfolio Oversight Hub",j&&o.jsxs("span",{className:"text-text-secondary font-normal",children:[" ","- ",j.name]}),b==="at-risk"&&o.jsxs("span",{className:"text-rag-amber font-normal",children:[" ","- At Risk Initiatives"]}),b==="projects-at-risk"&&o.jsxs("span",{className:"text-rag-red font-normal",children:[" ","- Projects at Risk"]})]}),o.jsx("p",{className:"text-text-secondary mt-1",children:i&&h?`Viewing: ${h.name} (${f.levelNames[h.level]})`:"PMO View"})]}),o.jsx("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:i&&h?o.jsxs(o.Fragment,{children:[o.jsx(gl,{className:"w-5 h-5 text-accent-purple"}),o.jsx("span",{className:"text-sm text-text-secondary",children:h.name})]}):o.jsxs(o.Fragment,{children:[o.jsx(mc,{className:"w-5 h-5 text-accent-purple"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"All Organizations"})]})})]}),o.jsx(Tle,{initiatives:y,projects:w}),o.jsx(Cle,{initiatives:y,pillars:s}),o.jsx(Ble,{initiatives:y,projects:w,pillars:s,resources:c})]})};function zle(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return k.useMemo(()=>n=>{t.forEach(a=>a(n))},t)}const Ng=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function gd(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function RN(e){return"nodeType"in e}function pa(e){var t,r;return e?gd(e)?e:RN(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function MN(e){const{Document:t}=pa(e);return e instanceof t}function lh(e){return gd(e)?!1:e instanceof pa(e).HTMLElement}function Y6(e){return e instanceof pa(e).SVGElement}function vd(e){return e?gd(e)?e.document:RN(e)?MN(e)?e:lh(e)||Y6(e)?e.ownerDocument:document:document:document}const es=Ng?k.useLayoutEffect:k.useEffect;function kg(e){const t=k.useRef(e);return es(()=>{t.current=e}),k.useCallback(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.current==null?void 0:t.current(...n)},[])}function $le(){const e=k.useRef(null),t=k.useCallback((n,a)=>{e.current=setInterval(n,a)},[]),r=k.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function p0(e,t){t===void 0&&(t=[e]);const r=k.useRef(e);return es(()=>{r.current!==e&&(r.current=e)},t),r}function oh(e,t){const r=k.useRef();return k.useMemo(()=>{const n=e(r.current);return r.current=n,n},[...t])}function fx(e){const t=kg(e),r=k.useRef(null),n=k.useCallback(a=>{a!==r.current&&t?.(a,r.current),r.current=a},[]);return[r,n]}function hx(e){const t=k.useRef();return k.useEffect(()=>{t.current=e},[e]),t.current}let Ub={};function ch(e,t){return k.useMemo(()=>{if(t)return t;const r=Ub[e]==null?0:Ub[e]+1;return Ub[e]=r,e+"-"+r},[e,t])}function X6(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return n.reduce((i,s)=>{const c=Object.entries(s);for(const[d,f]of c){const h=i[d];h!=null&&(i[d]=h+e*f)}return i},{...t})}}const Bu=X6(1),mx=X6(-1);function Hle(e){return"clientX"in e&&"clientY"in e}function _g(e){if(!e)return!1;const{KeyboardEvent:t}=pa(e.target);return t&&e instanceof t}function Vle(e){if(!e)return!1;const{TouchEvent:t}=pa(e.target);return t&&e instanceof t}function px(e){if(Vle(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return Hle(e)?{x:e.clientX,y:e.clientY}:null}const vo=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[vo.Translate.toString(e),vo.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),NO="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Gle(e){return e.matches(NO)?e:e.querySelector(NO)}const Wle={display:"none"};function qle(e){let{id:t,value:r}=e;return Nt.createElement("div",{id:t,style:Wle},r)}function Kle(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Nt.createElement("div",{id:t,style:a,role:"status","aria-live":n,"aria-atomic":!0},r)}function Yle(){const[e,t]=k.useState("");return{announce:k.useCallback(n=>{n!=null&&t(n)},[]),announcement:e}}const Z6=k.createContext(null);function Xle(e){const t=k.useContext(Z6);k.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Zle(){const[e]=k.useState(()=>new Set),t=k.useCallback(n=>(e.add(n),()=>e.delete(n)),[e]);return[k.useCallback(n=>{let{type:a,event:i}=n;e.forEach(s=>{var c;return(c=s[a])==null?void 0:c.call(s,i)})},[e]),t]}const Qle={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Jle={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function eoe(e){let{announcements:t=Jle,container:r,hiddenTextDescribedById:n,screenReaderInstructions:a=Qle}=e;const{announce:i,announcement:s}=Yle(),c=ch("DndLiveRegion"),[d,f]=k.useState(!1);if(k.useEffect(()=>{f(!0)},[]),Xle(k.useMemo(()=>({onDragStart(p){let{active:g}=p;i(t.onDragStart({active:g}))},onDragMove(p){let{active:g,over:v}=p;t.onDragMove&&i(t.onDragMove({active:g,over:v}))},onDragOver(p){let{active:g,over:v}=p;i(t.onDragOver({active:g,over:v}))},onDragEnd(p){let{active:g,over:v}=p;i(t.onDragEnd({active:g,over:v}))},onDragCancel(p){let{active:g,over:v}=p;i(t.onDragCancel({active:g,over:v}))}}),[i,t])),!d)return null;const h=Nt.createElement(Nt.Fragment,null,Nt.createElement(qle,{id:n,value:a.draggable}),Nt.createElement(Kle,{id:c,announcement:s}));return r?Jo.createPortal(h,r):h}var an;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(an||(an={}));function xx(){}function Sc(e,t){return k.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function jg(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return k.useMemo(()=>[...t].filter(n=>n!=null),[...t])}const ts=Object.freeze({x:0,y:0});function Q6(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function toe(e,t){const r=px(e);if(!r)return"0 0";const n={x:(r.x-t.left)/t.width*100,y:(r.y-t.top)/t.height*100};return n.x+"% "+n.y+"%"}function J6(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function roe(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function kO(e){let{left:t,top:r,height:n,width:a}=e;return[{x:t,y:r},{x:t+a,y:r},{x:t,y:r+n},{x:t+a,y:r+n}]}function noe(e,t){if(!e||e.length===0)return null;const[r]=e;return r[t]}function _O(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}const PN=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=_O(t,t.left,t.top),i=[];for(const s of n){const{id:c}=s,d=r.get(c);if(d){const f=Q6(_O(d),a);i.push({id:c,data:{droppableContainer:s,value:f}})}}return i.sort(J6)},aoe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=kO(t),i=[];for(const s of n){const{id:c}=s,d=r.get(c);if(d){const f=kO(d),h=a.reduce((g,v,b)=>g+Q6(f[b],v),0),p=Number((h/4).toFixed(4));i.push({id:c,data:{droppableContainer:s,value:p}})}}return i.sort(J6)};function ioe(e,t){const r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),s=a-n,c=i-r;if(n<a&&r<i){const d=t.width*t.height,f=e.width*e.height,h=s*c,p=h/(d+f-h);return Number(p.toFixed(4))}return 0}const soe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e;const a=[];for(const i of n){const{id:s}=i,c=r.get(s);if(c){const d=ioe(c,t);d>0&&a.push({id:s,data:{droppableContainer:i,value:d}})}}return a.sort(roe)};function loe(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function e8(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ts}function ooe(e){return function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return a.reduce((s,c)=>({...s,top:s.top+e*c.y,bottom:s.bottom+e*c.y,left:s.left+e*c.x,right:s.right+e*c.x}),{...r})}}const coe=ooe(1);function t8(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function uoe(e,t,r){const n=t8(t);if(!n)return e;const{scaleX:a,scaleY:i,x:s,y:c}=n,d=e.left-s-(1-a)*parseFloat(r),f=e.top-c-(1-i)*parseFloat(r.slice(r.indexOf(" ")+1)),h=a?e.width/a:e.width,p=i?e.height/i:e.height;return{width:h,height:p,top:f,right:d+h,bottom:f+p,left:d}}const doe={ignoreTransform:!1};function yd(e,t){t===void 0&&(t=doe);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:f,transformOrigin:h}=pa(e).getComputedStyle(e);f&&(r=uoe(r,f,h))}const{top:n,left:a,width:i,height:s,bottom:c,right:d}=r;return{top:n,left:a,width:i,height:s,bottom:c,right:d}}function jO(e){return yd(e,{ignoreTransform:!0})}function foe(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function hoe(e,t){return t===void 0&&(t=pa(e).getComputedStyle(e)),t.position==="fixed"}function moe(e,t){t===void 0&&(t=pa(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const i=t[a];return typeof i=="string"?r.test(i):!1})}function FN(e,t){const r=[];function n(a){if(t!=null&&r.length>=t||!a)return r;if(MN(a)&&a.scrollingElement!=null&&!r.includes(a.scrollingElement))return r.push(a.scrollingElement),r;if(!lh(a)||Y6(a)||r.includes(a))return r;const i=pa(e).getComputedStyle(a);return a!==e&&moe(a,i)&&r.push(a),hoe(a,i)?r:n(a.parentNode)}return e?n(e):r}function r8(e){const[t]=FN(e,1);return t??null}function zb(e){return!Ng||!e?null:gd(e)?e:RN(e)?MN(e)||e===vd(e).scrollingElement?window:lh(e)?e:null:null}function n8(e){return gd(e)?e.scrollX:e.scrollLeft}function a8(e){return gd(e)?e.scrollY:e.scrollTop}function bw(e){return{x:n8(e),y:a8(e)}}var Sn;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Sn||(Sn={}));function i8(e){return!Ng||!e?!1:e===document.scrollingElement}function s8(e){const t={x:0,y:0},r=i8(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},a=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,s=e.scrollTop>=n.y,c=e.scrollLeft>=n.x;return{isTop:a,isLeft:i,isBottom:s,isRight:c,maxScroll:n,minScroll:t}}const poe={x:.2,y:.2};function xoe(e,t,r,n,a){let{top:i,left:s,right:c,bottom:d}=r;n===void 0&&(n=10),a===void 0&&(a=poe);const{isTop:f,isBottom:h,isLeft:p,isRight:g}=s8(e),v={x:0,y:0},b={x:0,y:0},y={height:t.height*a.y,width:t.width*a.x};return!f&&i<=t.top+y.height?(v.y=Sn.Backward,b.y=n*Math.abs((t.top+y.height-i)/y.height)):!h&&d>=t.bottom-y.height&&(v.y=Sn.Forward,b.y=n*Math.abs((t.bottom-y.height-d)/y.height)),!g&&c>=t.right-y.width?(v.x=Sn.Forward,b.x=n*Math.abs((t.right-y.width-c)/y.width)):!p&&s<=t.left+y.width&&(v.x=Sn.Backward,b.x=n*Math.abs((t.left+y.width-s)/y.width)),{direction:v,speed:b}}function goe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:s}=window;return{top:0,left:0,right:i,bottom:s,width:i,height:s}}const{top:t,left:r,right:n,bottom:a}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:a,width:e.clientWidth,height:e.clientHeight}}function l8(e){return e.reduce((t,r)=>Bu(t,bw(r)),ts)}function voe(e){return e.reduce((t,r)=>t+n8(r),0)}function yoe(e){return e.reduce((t,r)=>t+a8(r),0)}function o8(e,t){if(t===void 0&&(t=yd),!e)return;const{top:r,left:n,bottom:a,right:i}=t(e);r8(e)&&(a<=0||i<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const boe=[["x",["left","right"],voe],["y",["top","bottom"],yoe]];class LN{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const n=FN(r),a=l8(n);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,s,c]of boe)for(const d of s)Object.defineProperty(this,d,{get:()=>{const f=c(n),h=a[i]-f;return this.rect[d]+h},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Bf{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var a;(a=this.target)==null||a.addEventListener(t,r,n),this.listeners.push([t,r,n])}}function woe(e){const{EventTarget:t}=pa(e);return e instanceof t?e:vd(e)}function $b(e,t){const r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var Ti;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ti||(Ti={}));function EO(e){e.preventDefault()}function Soe(e){e.stopPropagation()}var Mt;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Mt||(Mt={}));const c8={start:[Mt.Space,Mt.Enter],cancel:[Mt.Esc],end:[Mt.Space,Mt.Enter,Mt.Tab]},Noe=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Mt.Right:return{...r,x:r.x+25};case Mt.Left:return{...r,x:r.x-25};case Mt.Down:return{...r,y:r.y+25};case Mt.Up:return{...r,y:r.y-25}}};class u8{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:r}}=t;this.props=t,this.listeners=new Bf(vd(r)),this.windowListeners=new Bf(pa(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ti.Resize,this.handleCancel),this.windowListeners.add(Ti.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ti.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&o8(n),r(ts)}handleKeyDown(t){if(_g(t)){const{active:r,context:n,options:a}=this.props,{keyboardCodes:i=c8,coordinateGetter:s=Noe,scrollBehavior:c="smooth"}=a,{code:d}=t;if(i.end.includes(d)){this.handleEnd(t);return}if(i.cancel.includes(d)){this.handleCancel(t);return}const{collisionRect:f}=n.current,h=f?{x:f.left,y:f.top}:ts;this.referenceCoordinates||(this.referenceCoordinates=h);const p=s(t,{active:r,context:n.current,currentCoordinates:h});if(p){const g=mx(p,h),v={x:0,y:0},{scrollableAncestors:b}=n.current;for(const y of b){const w=t.code,{isTop:j,isRight:T,isLeft:N,isBottom:C,maxScroll:E,minScroll:O}=s8(y),A=goe(y),D={x:Math.min(w===Mt.Right?A.right-A.width/2:A.right,Math.max(w===Mt.Right?A.left:A.left+A.width/2,p.x)),y:Math.min(w===Mt.Down?A.bottom-A.height/2:A.bottom,Math.max(w===Mt.Down?A.top:A.top+A.height/2,p.y))},M=w===Mt.Right&&!T||w===Mt.Left&&!N,P=w===Mt.Down&&!C||w===Mt.Up&&!j;if(M&&D.x!==p.x){const R=y.scrollLeft+g.x,L=w===Mt.Right&&R<=E.x||w===Mt.Left&&R>=O.x;if(L&&!g.y){y.scrollTo({left:R,behavior:c});return}L?v.x=y.scrollLeft-R:v.x=w===Mt.Right?y.scrollLeft-E.x:y.scrollLeft-O.x,v.x&&y.scrollBy({left:-v.x,behavior:c});break}else if(P&&D.y!==p.y){const R=y.scrollTop+g.y,L=w===Mt.Down&&R<=E.y||w===Mt.Up&&R>=O.y;if(L&&!g.x){y.scrollTo({top:R,behavior:c});return}L?v.y=y.scrollTop-R:v.y=w===Mt.Down?y.scrollTop-E.y:y.scrollTop-O.y,v.y&&y.scrollBy({top:-v.y,behavior:c});break}}this.handleMove(t,Bu(mx(p,this.referenceCoordinates),v))}}}handleMove(t,r){const{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){const{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){const{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}u8.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=c8,onActivation:a}=t,{active:i}=r;const{code:s}=e.nativeEvent;if(n.start.includes(s)){const c=i.activatorNode.current;return c&&e.target!==c?!1:(e.preventDefault(),a?.({event:e.nativeEvent}),!0)}return!1}}];function TO(e){return!!(e&&"distance"in e)}function CO(e){return!!(e&&"delay"in e)}class BN{constructor(t,r,n){var a;n===void 0&&(n=woe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;const{event:i}=t,{target:s}=i;this.props=t,this.events=r,this.document=vd(s),this.documentListeners=new Bf(this.document),this.listeners=new Bf(n),this.windowListeners=new Bf(pa(s)),this.initialCoordinates=(a=px(i))!=null?a:ts,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ti.Resize,this.handleCancel),this.windowListeners.add(Ti.DragStart,EO),this.windowListeners.add(Ti.VisibilityChange,this.handleCancel),this.windowListeners.add(Ti.ContextMenu,EO),this.documentListeners.add(Ti.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(CO(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(TO(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){const{active:n,onPending:a}=this.props;a(n,t,this.initialCoordinates,r)}handleStart(){const{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ti.Click,Soe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ti.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;const{activated:n,initialCoordinates:a,props:i}=this,{onMove:s,options:{activationConstraint:c}}=i;if(!a)return;const d=(r=px(t))!=null?r:ts,f=mx(a,d);if(!n&&c){if(TO(c)){if(c.tolerance!=null&&$b(f,c.tolerance))return this.handleCancel();if($b(f,c.distance))return this.handleStart()}if(CO(c)&&$b(f,c.tolerance))return this.handleCancel();this.handlePending(c,f);return}t.cancelable&&t.preventDefault(),s(d)}handleEnd(){const{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){const{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Mt.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const koe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class UN extends BN{constructor(t){const{event:r}=t,n=vd(r.target);super(t,koe,n)}}UN.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n?.({event:r}),!0)}}];const _oe={move:{name:"mousemove"},end:{name:"mouseup"}};var ww;(function(e){e[e.RightClick=2]="RightClick"})(ww||(ww={}));class Eg extends BN{constructor(t){super(t,_oe,vd(t.event.target))}}Eg.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===ww.RightClick?!1:(n?.({event:r}),!0)}}];const Hb={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Tg extends BN{constructor(t){super(t,Hb)}static setup(){return window.addEventListener(Hb.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Hb.move.name,t)};function t(){}}}Tg.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;const{touches:a}=r;return a.length>1?!1:(n?.({event:r}),!0)}}];var Uf;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Uf||(Uf={}));var gx;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(gx||(gx={}));function joe(e){let{acceleration:t,activator:r=Uf.Pointer,canScroll:n,draggingRect:a,enabled:i,interval:s=5,order:c=gx.TreeOrder,pointerCoordinates:d,scrollableAncestors:f,scrollableAncestorRects:h,delta:p,threshold:g}=e;const v=Toe({delta:p,disabled:!i}),[b,y]=$le(),w=k.useRef({x:0,y:0}),j=k.useRef({x:0,y:0}),T=k.useMemo(()=>{switch(r){case Uf.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case Uf.DraggableRect:return a}},[r,a,d]),N=k.useRef(null),C=k.useCallback(()=>{const O=N.current;if(!O)return;const A=w.current.x*j.current.x,D=w.current.y*j.current.y;O.scrollBy(A,D)},[]),E=k.useMemo(()=>c===gx.TreeOrder?[...f].reverse():f,[c,f]);k.useEffect(()=>{if(!i||!f.length||!T){y();return}for(const O of E){if(n?.(O)===!1)continue;const A=f.indexOf(O),D=h[A];if(!D)continue;const{direction:M,speed:P}=xoe(O,D,T,t,g);for(const R of["x","y"])v[R][M[R]]||(P[R]=0,M[R]=0);if(P.x>0||P.y>0){y(),N.current=O,b(C,s),w.current=P,j.current=M;return}}w.current={x:0,y:0},j.current={x:0,y:0},y()},[t,C,n,y,i,s,JSON.stringify(T),JSON.stringify(v),b,f,E,h,JSON.stringify(g)])}const Eoe={x:{[Sn.Backward]:!1,[Sn.Forward]:!1},y:{[Sn.Backward]:!1,[Sn.Forward]:!1}};function Toe(e){let{delta:t,disabled:r}=e;const n=hx(t);return oh(a=>{if(r||!n||!a)return Eoe;const i={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[Sn.Backward]:a.x[Sn.Backward]||i.x===-1,[Sn.Forward]:a.x[Sn.Forward]||i.x===1},y:{[Sn.Backward]:a.y[Sn.Backward]||i.y===-1,[Sn.Forward]:a.y[Sn.Forward]||i.y===1}}},[r,t,n])}function Coe(e,t){const r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return oh(a=>{var i;return t==null?null:(i=n??a)!=null?i:null},[n,t])}function Aoe(e,t){return k.useMemo(()=>e.reduce((r,n)=>{const{sensor:a}=n,i=a.activators.map(s=>({eventName:s.eventName,handler:t(s.handler,n)}));return[...r,...i]},[]),[e,t])}var x0;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(x0||(x0={}));var Sw;(function(e){e.Optimized="optimized"})(Sw||(Sw={}));const AO=new Map;function Ooe(e,t){let{dragging:r,dependencies:n,config:a}=t;const[i,s]=k.useState(null),{frequency:c,measure:d,strategy:f}=a,h=k.useRef(e),p=w(),g=p0(p),v=k.useCallback(function(j){j===void 0&&(j=[]),!g.current&&s(T=>T===null?j:T.concat(j.filter(N=>!T.includes(N))))},[g]),b=k.useRef(null),y=oh(j=>{if(p&&!r)return AO;if(!j||j===AO||h.current!==e||i!=null){const T=new Map;for(let N of e){if(!N)continue;if(i&&i.length>0&&!i.includes(N.id)&&N.rect.current){T.set(N.id,N.rect.current);continue}const C=N.node.current,E=C?new LN(d(C),C):null;N.rect.current=E,E&&T.set(N.id,E)}return T}return j},[e,i,r,p,d]);return k.useEffect(()=>{h.current=e},[e]),k.useEffect(()=>{p||v()},[r,p]),k.useEffect(()=>{i&&i.length>0&&s(null)},[JSON.stringify(i)]),k.useEffect(()=>{p||typeof c!="number"||b.current!==null||(b.current=setTimeout(()=>{v(),b.current=null},c))},[c,p,v,...n]),{droppableRects:y,measureDroppableContainers:v,measuringScheduled:i!=null};function w(){switch(f){case x0.Always:return!1;case x0.BeforeDragging:return r;default:return!r}}}function zN(e,t){return oh(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function Doe(e,t){return zN(e,t)}function Ioe(e){let{callback:t,disabled:r}=e;const n=kg(t),a=k.useMemo(()=>{if(r||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(n)},[n,r]);return k.useEffect(()=>()=>a?.disconnect(),[a]),a}function Cg(e){let{callback:t,disabled:r}=e;const n=kg(t),a=k.useMemo(()=>{if(r||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(n)},[r]);return k.useEffect(()=>()=>a?.disconnect(),[a]),a}function Roe(e){return new LN(yd(e),e)}function OO(e,t,r){t===void 0&&(t=Roe);const[n,a]=k.useState(null);function i(){a(d=>{if(!e)return null;if(e.isConnected===!1){var f;return(f=d??r)!=null?f:null}const h=t(e);return JSON.stringify(d)===JSON.stringify(h)?d:h})}const s=Ioe({callback(d){if(e)for(const f of d){const{type:h,target:p}=f;if(h==="childList"&&p instanceof HTMLElement&&p.contains(e)){i();break}}}}),c=Cg({callback:i});return es(()=>{i(),e?(c?.observe(e),s?.observe(document.body,{childList:!0,subtree:!0})):(c?.disconnect(),s?.disconnect())},[e]),n}function Moe(e){const t=zN(e);return e8(e,t)}const DO=[];function Poe(e){const t=k.useRef(e),r=oh(n=>e?n&&n!==DO&&e&&t.current&&e.parentNode===t.current.parentNode?n:FN(e):DO,[e]);return k.useEffect(()=>{t.current=e},[e]),r}function Foe(e){const[t,r]=k.useState(null),n=k.useRef(e),a=k.useCallback(i=>{const s=zb(i.target);s&&r(c=>c?(c.set(s,bw(s)),new Map(c)):null)},[]);return k.useEffect(()=>{const i=n.current;if(e!==i){s(i);const c=e.map(d=>{const f=zb(d);return f?(f.addEventListener("scroll",a,{passive:!0}),[f,bw(f)]):null}).filter(d=>d!=null);r(c.length?new Map(c):null),n.current=e}return()=>{s(e),s(i)};function s(c){c.forEach(d=>{const f=zb(d);f?.removeEventListener("scroll",a)})}},[a,e]),k.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,s)=>Bu(i,s),ts):l8(e):ts,[e,t])}function IO(e,t){t===void 0&&(t=[]);const r=k.useRef(null);return k.useEffect(()=>{r.current=null},t),k.useEffect(()=>{const n=e!==ts;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?mx(e,r.current):ts}function Loe(e){k.useEffect(()=>{if(!Ng)return;const t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(const r of t)r?.()}},e.map(t=>{let{sensor:r}=t;return r}))}function Boe(e,t){return k.useMemo(()=>e.reduce((r,n)=>{let{eventName:a,handler:i}=n;return r[a]=s=>{i(s,t)},r},{}),[e,t])}function d8(e){return k.useMemo(()=>e?foe(e):null,[e])}const RO=[];function Uoe(e,t){t===void 0&&(t=yd);const[r]=e,n=d8(r?pa(r):null),[a,i]=k.useState(RO);function s(){i(()=>e.length?e.map(d=>i8(d)?n:new LN(t(d),d)):RO)}const c=Cg({callback:s});return es(()=>{c?.disconnect(),s(),e.forEach(d=>c?.observe(d))},[e]),a}function f8(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return lh(t)?t:e}function zoe(e){let{measure:t}=e;const[r,n]=k.useState(null),a=k.useCallback(f=>{for(const{target:h}of f)if(lh(h)){n(p=>{const g=t(h);return p?{...p,width:g.width,height:g.height}:g});break}},[t]),i=Cg({callback:a}),s=k.useCallback(f=>{const h=f8(f);i?.disconnect(),h&&i?.observe(h),n(h?t(h):null)},[t,i]),[c,d]=fx(s);return k.useMemo(()=>({nodeRef:c,rect:r,setRef:d}),[r,c,d])}const $oe=[{sensor:UN,options:{}},{sensor:u8,options:{}}],Hoe={current:{}},bp={draggable:{measure:jO},droppable:{measure:jO,strategy:x0.WhileDragging,frequency:Sw.Optimized},dragOverlay:{measure:yd}};class zf extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}}const Voe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new zf,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:xx},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:bp,measureDroppableContainers:xx,windowRect:null,measuringScheduled:!1},h8={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:xx,draggableNodes:new Map,over:null,measureDroppableContainers:xx},uh=k.createContext(h8),m8=k.createContext(Voe);function Goe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new zf}}}function Woe(e,t){switch(t.type){case an.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case an.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case an.DragEnd:case an.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case an.RegisterDroppable:{const{element:r}=t,{id:n}=r,a=new zf(e.droppable.containers);return a.set(n,r),{...e,droppable:{...e.droppable,containers:a}}}case an.SetDroppableDisabled:{const{id:r,key:n,disabled:a}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;const s=new zf(e.droppable.containers);return s.set(r,{...i,disabled:a}),{...e,droppable:{...e.droppable,containers:s}}}case an.UnregisterDroppable:{const{id:r,key:n}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;const i=new zf(e.droppable.containers);return i.delete(r),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function qoe(e){let{disabled:t}=e;const{active:r,activatorEvent:n,draggableNodes:a}=k.useContext(uh),i=hx(n),s=hx(r?.id);return k.useEffect(()=>{if(!t&&!n&&i&&s!=null){if(!_g(i)||document.activeElement===i.target)return;const c=a.get(s);if(!c)return;const{activatorNode:d,node:f}=c;if(!d.current&&!f.current)return;requestAnimationFrame(()=>{for(const h of[d.current,f.current]){if(!h)continue;const p=Gle(h);if(p){p.focus();break}}})}},[n,t,a,s,i]),null}function p8(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((a,i)=>i({transform:a,...n}),r):r}function Koe(e){return k.useMemo(()=>({draggable:{...bp.draggable,...e?.draggable},droppable:{...bp.droppable,...e?.droppable},dragOverlay:{...bp.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Yoe(e){let{activeNode:t,measure:r,initialRect:n,config:a=!0}=e;const i=k.useRef(!1),{x:s,y:c}=typeof a=="boolean"?{x:a,y:a}:a;es(()=>{if(!s&&!c||!t){i.current=!1;return}if(i.current||!n)return;const f=t?.node.current;if(!f||f.isConnected===!1)return;const h=r(f),p=e8(h,n);if(s||(p.x=0),c||(p.y=0),i.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const g=r8(f);g&&g.scrollBy({top:p.y,left:p.x})}},[t,s,c,n,r])}const Ag=k.createContext({...ts,scaleX:1,scaleY:1});var no;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(no||(no={}));const Og=k.memo(function(t){var r,n,a,i;let{id:s,accessibility:c,autoScroll:d=!0,children:f,sensors:h=$oe,collisionDetection:p=soe,measuring:g,modifiers:v,...b}=t;const y=k.useReducer(Woe,void 0,Goe),[w,j]=y,[T,N]=Zle(),[C,E]=k.useState(no.Uninitialized),O=C===no.Initialized,{draggable:{active:A,nodes:D,translate:M},droppable:{containers:P}}=w,R=A!=null?D.get(A):null,L=k.useRef({initial:null,translated:null}),te=k.useMemo(()=>{var wr;return A!=null?{id:A,data:(wr=R?.data)!=null?wr:Hoe,rect:L}:null},[A,R]),ee=k.useRef(null),[ue,V]=k.useState(null),[K,ie]=k.useState(null),re=p0(b,Object.values(b)),me=ch("DndDescribedBy",s),W=k.useMemo(()=>P.getEnabled(),[P]),F=Koe(g),{droppableRects:X,measureDroppableContainers:q,measuringScheduled:U}=Ooe(W,{dragging:O,dependencies:[M.x,M.y],config:F.droppable}),G=Coe(D,A),le=k.useMemo(()=>K?px(K):null,[K]),de=El(),ne=Doe(G,F.draggable.measure);Yoe({activeNode:A!=null?D.get(A):null,config:de.layoutShiftCompensation,initialRect:ne,measure:F.draggable.measure});const oe=OO(G,F.draggable.measure,ne),Ae=OO(G?G.parentElement:null),z=k.useRef({activatorEvent:null,active:null,activeNode:G,collisionRect:null,collisions:null,droppableRects:X,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),et=P.getNodeFor((r=z.current.over)==null?void 0:r.id),Be=zoe({measure:F.dragOverlay.measure}),Je=(n=Be.nodeRef.current)!=null?n:G,He=O?(a=Be.rect)!=null?a:oe:null,Ie=!!(Be.nodeRef.current&&Be.rect),_t=Moe(Ie?null:oe),Er=d8(Je?pa(Je):null),fe=Poe(O?et??G:null),Re=Uoe(fe),bt=p8(v,{transform:{x:M.x-_t.x,y:M.y-_t.y,scaleX:1,scaleY:1},activatorEvent:K,active:te,activeNodeRect:oe,containerNodeRect:Ae,draggingNodeRect:He,over:z.current.over,overlayNodeRect:Be.rect,scrollableAncestors:fe,scrollableAncestorRects:Re,windowRect:Er}),Ft=le?Bu(le,M):null,mt=Foe(fe),sr=IO(mt),It=IO(mt,[oe]),Tn=Bu(bt,sr),Xt=He?coe(He,bt):null,hn=te&&Xt?p({active:te,collisionRect:Xt,droppableRects:X,droppableContainers:W,pointerCoordinates:Ft}):null,lt=noe(hn,"id"),[Tt,Cn]=k.useState(null),Zt=Ie?bt:Bu(bt,It),br=loe(Zt,(i=Tt?.rect)!=null?i:null,oe),aa=k.useRef(null),mn=k.useCallback((wr,rr)=>{let{sensor:Vr,options:Vn}=rr;if(ee.current==null)return;const Gn=D.get(ee.current);if(!Gn)return;const pn=wr.nativeEvent,Wn=new Vr({active:ee.current,activeNode:Gn,event:pn,options:Vn,context:z,onAbort(Pr){if(!D.get(Pr))return;const{onDragAbort:An}=re.current,ga={id:Pr};An?.(ga),T({type:"onDragAbort",event:ga})},onPending(Pr,Fa,An,ga){if(!D.get(Pr))return;const{onDragPending:Li}=re.current,B={id:Pr,constraint:Fa,initialCoordinates:An,offset:ga};Li?.(B),T({type:"onDragPending",event:B})},onStart(Pr){const Fa=ee.current;if(Fa==null)return;const An=D.get(Fa);if(!An)return;const{onDragStart:ga}=re.current,Fi={activatorEvent:pn,active:{id:Fa,data:An.data,rect:L}};Jo.unstable_batchedUpdates(()=>{ga?.(Fi),E(no.Initializing),j({type:an.DragStart,initialCoordinates:Pr,active:Fa}),T({type:"onDragStart",event:Fi}),V(aa.current),ie(pn)})},onMove(Pr){j({type:an.DragMove,coordinates:Pr})},onEnd:xa(an.DragEnd),onCancel:xa(an.DragCancel)});aa.current=Wn;function xa(Pr){return async function(){const{active:An,collisions:ga,over:Fi,scrollAdjustedTranslate:Li}=z.current;let B=null;if(An&&Li){const{cancelDrop:J}=re.current;B={activatorEvent:pn,active:An,collisions:ga,delta:Li,over:Fi},Pr===an.DragEnd&&typeof J=="function"&&await Promise.resolve(J(B))&&(Pr=an.DragCancel)}ee.current=null,Jo.unstable_batchedUpdates(()=>{j({type:Pr}),E(no.Uninitialized),Cn(null),V(null),ie(null),aa.current=null;const J=Pr===an.DragEnd?"onDragEnd":"onDragCancel";if(B){const Y=re.current[J];Y?.(B),T({type:J,event:B})}})}}},[D]),_d=k.useCallback((wr,rr)=>(Vr,Vn)=>{const Gn=Vr.nativeEvent,pn=D.get(Vn);if(ee.current!==null||!pn||Gn.dndKit||Gn.defaultPrevented)return;const Wn={active:pn};wr(Vr,rr.options,Wn)===!0&&(Gn.dndKit={capturedBy:rr.sensor},ee.current=Vn,mn(Vr,rr))},[D,mn]),Ao=Aoe(h,_d);Loe(h),es(()=>{oe&&C===no.Initializing&&E(no.Initialized)},[oe,C]),k.useEffect(()=>{const{onDragMove:wr}=re.current,{active:rr,activatorEvent:Vr,collisions:Vn,over:Gn}=z.current;if(!rr||!Vr)return;const pn={active:rr,activatorEvent:Vr,collisions:Vn,delta:{x:Tn.x,y:Tn.y},over:Gn};Jo.unstable_batchedUpdates(()=>{wr?.(pn),T({type:"onDragMove",event:pn})})},[Tn.x,Tn.y]),k.useEffect(()=>{const{active:wr,activatorEvent:rr,collisions:Vr,droppableContainers:Vn,scrollAdjustedTranslate:Gn}=z.current;if(!wr||ee.current==null||!rr||!Gn)return;const{onDragOver:pn}=re.current,Wn=Vn.get(lt),xa=Wn&&Wn.rect.current?{id:Wn.id,rect:Wn.rect.current,data:Wn.data,disabled:Wn.disabled}:null,Pr={active:wr,activatorEvent:rr,collisions:Vr,delta:{x:Gn.x,y:Gn.y},over:xa};Jo.unstable_batchedUpdates(()=>{Cn(xa),pn?.(Pr),T({type:"onDragOver",event:Pr})})},[lt]),es(()=>{z.current={activatorEvent:K,active:te,activeNode:G,collisionRect:Xt,collisions:hn,droppableRects:X,draggableNodes:D,draggingNode:Je,draggingNodeRect:He,droppableContainers:P,over:Tt,scrollableAncestors:fe,scrollAdjustedTranslate:Tn},L.current={initial:He,translated:Xt}},[te,G,hn,Xt,D,Je,He,X,P,Tt,fe,Tn]),joe({...de,delta:M,draggingRect:Xt,pointerCoordinates:Ft,scrollableAncestors:fe,scrollableAncestorRects:Re});const $c=k.useMemo(()=>({active:te,activeNode:G,activeNodeRect:oe,activatorEvent:K,collisions:hn,containerNodeRect:Ae,dragOverlay:Be,draggableNodes:D,droppableContainers:P,droppableRects:X,over:Tt,measureDroppableContainers:q,scrollableAncestors:fe,scrollableAncestorRects:Re,measuringConfiguration:F,measuringScheduled:U,windowRect:Er}),[te,G,oe,K,hn,Ae,Be,D,P,X,Tt,q,fe,Re,F,U,Er]),js=k.useMemo(()=>({activatorEvent:K,activators:Ao,active:te,activeNodeRect:oe,ariaDescribedById:{draggable:me},dispatch:j,draggableNodes:D,over:Tt,measureDroppableContainers:q}),[K,Ao,te,oe,j,me,D,Tt,q]);return Nt.createElement(Z6.Provider,{value:N},Nt.createElement(uh.Provider,{value:js},Nt.createElement(m8.Provider,{value:$c},Nt.createElement(Ag.Provider,{value:br},f)),Nt.createElement(qoe,{disabled:c?.restoreFocus===!1})),Nt.createElement(eoe,{...c,hiddenTextDescribedById:me}));function El(){const wr=ue?.autoScrollEnabled===!1,rr=typeof d=="object"?d.enabled===!1:d===!1,Vr=O&&!wr&&!rr;return typeof d=="object"?{...d,enabled:Vr}:{enabled:Vr}}}),Xoe=k.createContext(null),MO="button",Zoe="Draggable";function Dg(e){let{id:t,data:r,disabled:n=!1,attributes:a}=e;const i=ch(Zoe),{activators:s,activatorEvent:c,active:d,activeNodeRect:f,ariaDescribedById:h,draggableNodes:p,over:g}=k.useContext(uh),{role:v=MO,roleDescription:b="draggable",tabIndex:y=0}=a??{},w=d?.id===t,j=k.useContext(w?Ag:Xoe),[T,N]=fx(),[C,E]=fx(),O=Boe(s,t),A=p0(r);es(()=>(p.set(t,{id:t,key:i,node:T,activatorNode:C,data:A}),()=>{const M=p.get(t);M&&M.key===i&&p.delete(t)}),[p,t]);const D=k.useMemo(()=>({role:v,tabIndex:y,"aria-disabled":n,"aria-pressed":w&&v===MO?!0:void 0,"aria-roledescription":b,"aria-describedby":h.draggable}),[n,v,y,w,b,h.draggable]);return{active:d,activatorEvent:c,activeNodeRect:f,attributes:D,isDragging:w,listeners:n?void 0:O,node:T,over:g,setNodeRef:N,setActivatorNodeRef:E,transform:j}}function x8(){return k.useContext(m8)}const Qoe="Droppable",Joe={timeout:25};function dh(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:a}=e;const i=ch(Qoe),{active:s,dispatch:c,over:d,measureDroppableContainers:f}=k.useContext(uh),h=k.useRef({disabled:r}),p=k.useRef(!1),g=k.useRef(null),v=k.useRef(null),{disabled:b,updateMeasurementsFor:y,timeout:w}={...Joe,...a},j=p0(y??n),T=k.useCallback(()=>{if(!p.current){p.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{f(Array.isArray(j.current)?j.current:[j.current]),v.current=null},w)},[w]),N=Cg({callback:T,disabled:b||!s}),C=k.useCallback((D,M)=>{N&&(M&&(N.unobserve(M),p.current=!1),D&&N.observe(D))},[N]),[E,O]=fx(C),A=p0(t);return k.useEffect(()=>{!N||!E.current||(N.disconnect(),p.current=!1,N.observe(E.current))},[E,N]),k.useEffect(()=>(c({type:an.RegisterDroppable,element:{id:n,key:i,disabled:r,node:E,rect:g,data:A}}),()=>c({type:an.UnregisterDroppable,key:i,id:n})),[n]),k.useEffect(()=>{r!==h.current.disabled&&(c({type:an.SetDroppableDisabled,id:n,key:i,disabled:r}),h.current.disabled=r)},[n,i,r,c]),{active:s,rect:g,isOver:d?.id===n,node:E,over:d,setNodeRef:O}}function ece(e){let{animation:t,children:r}=e;const[n,a]=k.useState(null),[i,s]=k.useState(null),c=hx(r);return!r&&!n&&c&&a(c),es(()=>{if(!i)return;const d=n?.key,f=n?.props.id;if(d==null||f==null){a(null);return}Promise.resolve(t(f,i)).then(()=>{a(null)})},[t,n,i]),Nt.createElement(Nt.Fragment,null,r,n?k.cloneElement(n,{ref:s}):null)}const tce={x:0,y:0,scaleX:1,scaleY:1};function rce(e){let{children:t}=e;return Nt.createElement(uh.Provider,{value:h8},Nt.createElement(Ag.Provider,{value:tce},t))}const nce={position:"fixed",touchAction:"none"},ace=e=>_g(e)?"transform 250ms ease":void 0,ice=k.forwardRef((e,t)=>{let{as:r,activatorEvent:n,adjustScale:a,children:i,className:s,rect:c,style:d,transform:f,transition:h=ace}=e;if(!c)return null;const p=a?f:{...f,scaleX:1,scaleY:1},g={...nce,width:c.width,height:c.height,top:c.top,left:c.left,transform:vo.Transform.toString(p),transformOrigin:a&&n?toe(n,c):void 0,transition:typeof h=="function"?h(n):h,...d};return Nt.createElement(r,{className:s,style:g,ref:t},i)}),sce=e=>t=>{let{active:r,dragOverlay:n}=t;const a={},{styles:i,className:s}=e;if(i!=null&&i.active)for(const[c,d]of Object.entries(i.active))d!==void 0&&(a[c]=r.node.style.getPropertyValue(c),r.node.style.setProperty(c,d));if(i!=null&&i.dragOverlay)for(const[c,d]of Object.entries(i.dragOverlay))d!==void 0&&n.node.style.setProperty(c,d);return s!=null&&s.active&&r.node.classList.add(s.active),s!=null&&s.dragOverlay&&n.node.classList.add(s.dragOverlay),function(){for(const[d,f]of Object.entries(a))r.node.style.setProperty(d,f);s!=null&&s.active&&r.node.classList.remove(s.active)}},lce=e=>{let{transform:{initial:t,final:r}}=e;return[{transform:vo.Transform.toString(t)},{transform:vo.Transform.toString(r)}]},oce={duration:250,easing:"ease",keyframes:lce,sideEffects:sce({styles:{active:{opacity:"0"}}})};function cce(e){let{config:t,draggableNodes:r,droppableContainers:n,measuringConfiguration:a}=e;return kg((i,s)=>{if(t===null)return;const c=r.get(i);if(!c)return;const d=c.node.current;if(!d)return;const f=f8(s);if(!f)return;const{transform:h}=pa(s).getComputedStyle(s),p=t8(h);if(!p)return;const g=typeof t=="function"?t:uce(t);return o8(d,a.draggable.measure),g({active:{id:i,data:c.data,node:d,rect:a.draggable.measure(d)},draggableNodes:r,dragOverlay:{node:s,rect:a.dragOverlay.measure(f)},droppableContainers:n,measuringConfiguration:a,transform:p})})}function uce(e){const{duration:t,easing:r,sideEffects:n,keyframes:a}={...oce,...e};return i=>{let{active:s,dragOverlay:c,transform:d,...f}=i;if(!t)return;const h={x:c.rect.left-s.rect.left,y:c.rect.top-s.rect.top},p={scaleX:d.scaleX!==1?s.rect.width*d.scaleX/c.rect.width:1,scaleY:d.scaleY!==1?s.rect.height*d.scaleY/c.rect.height:1},g={x:d.x-h.x,y:d.y-h.y,...p},v=a({...f,active:s,dragOverlay:c,transform:{initial:d,final:g}}),[b]=v,y=v[v.length-1];if(JSON.stringify(b)===JSON.stringify(y))return;const w=n?.({active:s,dragOverlay:c,...f}),j=c.node.animate(v,{duration:t,easing:r,fill:"forwards"});return new Promise(T=>{j.onfinish=()=>{w?.(),T()}})}}let PO=0;function dce(e){return k.useMemo(()=>{if(e!=null)return PO++,PO},[e])}const Ig=Nt.memo(e=>{let{adjustScale:t=!1,children:r,dropAnimation:n,style:a,transition:i,modifiers:s,wrapperElement:c="div",className:d,zIndex:f=999}=e;const{activatorEvent:h,active:p,activeNodeRect:g,containerNodeRect:v,draggableNodes:b,droppableContainers:y,dragOverlay:w,over:j,measuringConfiguration:T,scrollableAncestors:N,scrollableAncestorRects:C,windowRect:E}=x8(),O=k.useContext(Ag),A=dce(p?.id),D=p8(s,{activatorEvent:h,active:p,activeNodeRect:g,containerNodeRect:v,draggingNodeRect:w.rect,over:j,overlayNodeRect:w.rect,scrollableAncestors:N,scrollableAncestorRects:C,transform:O,windowRect:E}),M=zN(g),P=cce({config:n,draggableNodes:b,droppableContainers:y,measuringConfiguration:T}),R=M?w.setRef:void 0;return Nt.createElement(rce,null,Nt.createElement(ece,{animation:P},p&&A?Nt.createElement(ice,{key:A,id:p.id,ref:R,as:c,activatorEvent:h,adjustScale:t,className:d,transition:i,rect:M,style:{zIndex:f,...a},transform:D},r):null))});function g8(e,t,r){const n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function fce(e,t){return e.reduce((r,n,a)=>{const i=t.get(n);return i&&(r[a]=i),r},Array(e.length))}function Ym(e){return e!==null&&e>=0}function hce(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function mce(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const v8=e=>{let{rects:t,activeIndex:r,overIndex:n,index:a}=e;const i=g8(t,n,r),s=t[a],c=i[a];return!c||!s?null:{x:c.left-s.left,y:c.top-s.top,scaleX:c.width/s.width,scaleY:c.height/s.height}},Xm={scaleX:1,scaleY:1},pce=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:a,rects:i,overIndex:s}=e;const c=(t=i[r])!=null?t:n;if(!c)return null;if(a===r){const f=i[s];return f?{x:0,y:r<s?f.top+f.height-(c.top+c.height):f.top-c.top,...Xm}:null}const d=xce(i,a,r);return a>r&&a<=s?{x:0,y:-c.height-d,...Xm}:a<r&&a>=s?{x:0,y:c.height+d,...Xm}:{x:0,y:0,...Xm}};function xce(e,t,r){const n=e[t],a=e[t-1],i=e[t+1];return n?r<t?a?n.top-(a.top+a.height):i?i.top-(n.top+n.height):0:i?i.top-(n.top+n.height):a?n.top-(a.top+a.height):0:0}const y8="Sortable",b8=Nt.createContext({activeIndex:-1,containerId:y8,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:v8,disabled:{draggable:!1,droppable:!1}});function gce(e){let{children:t,id:r,items:n,strategy:a=v8,disabled:i=!1}=e;const{active:s,dragOverlay:c,droppableRects:d,over:f,measureDroppableContainers:h}=x8(),p=ch(y8,r),g=c.rect!==null,v=k.useMemo(()=>n.map(O=>typeof O=="object"&&"id"in O?O.id:O),[n]),b=s!=null,y=s?v.indexOf(s.id):-1,w=f?v.indexOf(f.id):-1,j=k.useRef(v),T=!hce(v,j.current),N=w!==-1&&y===-1||T,C=mce(i);es(()=>{T&&b&&h(v)},[T,v,b,h]),k.useEffect(()=>{j.current=v},[v]);const E=k.useMemo(()=>({activeIndex:y,containerId:p,disabled:C,disableTransforms:N,items:v,overIndex:w,useDragOverlay:g,sortedRects:fce(v,d),strategy:a}),[y,p,C.draggable,C.droppable,N,v,w,d,g,a]);return Nt.createElement(b8.Provider,{value:E},t)}const vce=e=>{let{id:t,items:r,activeIndex:n,overIndex:a}=e;return g8(r,n,a).indexOf(t)},yce=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:a,items:i,newIndex:s,previousItems:c,previousContainerId:d,transition:f}=e;return!f||!n||c!==i&&a===s?!1:r?!0:s!==a&&t===d},bce={duration:200,easing:"ease"},w8="transform",wce=vo.Transition.toString({property:w8,duration:0,easing:"linear"}),Sce={roleDescription:"sortable"};function Nce(e){let{disabled:t,index:r,node:n,rect:a}=e;const[i,s]=k.useState(null),c=k.useRef(r);return es(()=>{if(!t&&r!==c.current&&n.current){const d=a.current;if(d){const f=yd(n.current,{ignoreTransform:!0}),h={x:d.left-f.left,y:d.top-f.top,scaleX:d.width/f.width,scaleY:d.height/f.height};(h.x||h.y)&&s(h)}}r!==c.current&&(c.current=r)},[t,r,n,a]),k.useEffect(()=>{i&&s(null)},[i]),i}function kce(e){let{animateLayoutChanges:t=yce,attributes:r,disabled:n,data:a,getNewIndex:i=vce,id:s,strategy:c,resizeObserverConfig:d,transition:f=bce}=e;const{items:h,containerId:p,activeIndex:g,disabled:v,disableTransforms:b,sortedRects:y,overIndex:w,useDragOverlay:j,strategy:T}=k.useContext(b8),N=_ce(n,v),C=h.indexOf(s),E=k.useMemo(()=>({sortable:{containerId:p,index:C,items:h},...a}),[p,a,C,h]),O=k.useMemo(()=>h.slice(h.indexOf(s)),[h,s]),{rect:A,node:D,isOver:M,setNodeRef:P}=dh({id:s,data:E,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:O,...d}}),{active:R,activatorEvent:L,activeNodeRect:te,attributes:ee,setNodeRef:ue,listeners:V,isDragging:K,over:ie,setActivatorNodeRef:re,transform:me}=Dg({id:s,data:E,attributes:{...Sce,...r},disabled:N.draggable}),W=zle(P,ue),F=!!R,X=F&&!b&&Ym(g)&&Ym(w),q=!j&&K,U=q&&X?me:null,le=X?U??(c??T)({rects:y,activeNodeRect:te,activeIndex:g,overIndex:w,index:C}):null,de=Ym(g)&&Ym(w)?i({id:s,items:h,activeIndex:g,overIndex:w}):C,ne=R?.id,oe=k.useRef({activeId:ne,items:h,newIndex:de,containerId:p}),Ae=h!==oe.current.items,z=t({active:R,containerId:p,isDragging:K,isSorting:F,id:s,index:C,items:h,newIndex:oe.current.newIndex,previousItems:oe.current.items,previousContainerId:oe.current.containerId,transition:f,wasDragging:oe.current.activeId!=null}),et=Nce({disabled:!z,index:C,node:D,rect:A});return k.useEffect(()=>{F&&oe.current.newIndex!==de&&(oe.current.newIndex=de),p!==oe.current.containerId&&(oe.current.containerId=p),h!==oe.current.items&&(oe.current.items=h)},[F,de,p,h]),k.useEffect(()=>{if(ne===oe.current.activeId)return;if(ne!=null&&oe.current.activeId==null){oe.current.activeId=ne;return}const Je=setTimeout(()=>{oe.current.activeId=ne},50);return()=>clearTimeout(Je)},[ne]),{active:R,activeIndex:g,attributes:ee,data:E,rect:A,index:C,newIndex:de,items:h,isOver:M,isSorting:F,isDragging:K,listeners:V,node:D,overIndex:w,over:ie,setNodeRef:W,setActivatorNodeRef:re,setDroppableNodeRef:P,setDraggableNodeRef:ue,transform:et??le,transition:Be()};function Be(){if(et||Ae&&oe.current.newIndex===C)return wce;if(!(q&&!_g(L)||!f)&&(F||z))return vo.Transition.toString({...f,property:w8})}}function _ce(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e?.draggable)!=null?r:t.draggable,droppable:(n=e?.droppable)!=null?n:t.droppable}}Mt.Down,Mt.Right,Mt.Up,Mt.Left;const S8=({task:e,resource:t,onClick:r})=>{const{attributes:n,listeners:a,setNodeRef:i,transform:s,transition:c,isDragging:d}=kce({id:e.id}),f={transform:vo.Transform.toString(s),transition:c},h=new Date(e.dueDate)<new Date&&e.kanbanStatus!=="done",p=e.kanbanStatus==="blocked"||h,g=v=>new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric"});return o.jsxs("div",{ref:i,style:f,...n,...a,onClick:r,className:`
        bg-bg-card border border-border rounded-lg p-3 cursor-grab active:cursor-grabbing
        hover:border-border-light transition-colors
        ${d?"opacity-50 shadow-lg":""}
        ${p?"border-l-2 border-l-rag-red":""}
      `,children:[o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary line-clamp-2",children:e.title}),p&&o.jsxs("div",{className:"relative group",children:[o.jsx(_n,{className:"w-4 h-4 text-rag-red flex-shrink-0"}),o.jsx("div",{className:"absolute right-0 top-full mt-1 w-48 p-2 bg-bg-card border border-border rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10",children:o.jsxs("p",{className:"text-xs text-text-secondary",children:[o.jsx("span",{className:"font-medium text-rag-red",children:"AI Risk:"})," AI predicts this task will miss deadline based on assignee's current workload."]})})]})]}),o.jsx("div",{className:"mb-3",children:o.jsx("span",{className:"inline-block px-2 py-0.5 bg-bg-hover text-xs text-text-secondary rounded",children:t?.role||"Unassigned"})}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3 text-xs text-text-muted",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Zw,{className:"w-3 h-3"}),o.jsx("span",{className:h?"text-rag-red":"",children:g(e.dueDate)})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(fo,{className:"w-3 h-3"}),o.jsxs("span",{children:[e.estimatedHours,"h"]})]})]}),t&&o.jsx("div",{className:"w-7 h-7 rounded-full flex items-center justify-center text-xs font-medium text-white",style:{backgroundColor:t.avatarColor},title:t.name,children:t.name.split(" ").map(v=>v[0]).join("")})]})]})},N8=[{status:"todo",title:"To Do",color:"bg-text-muted"},{status:"in_progress",title:"In Progress",color:"bg-accent-blue"},{status:"blocked",title:"Blocked",color:"bg-rag-red"},{status:"done",title:"Done",color:"bg-rag-green"}],jce=({title:e,status:t,tasks:r,resources:n,isOver:a,onAddTask:i,onEditTask:s})=>{const{setNodeRef:c}=dh({id:`column-${t}`,data:{type:"column",status:t}}),d=r.filter(p=>p.kanbanStatus===t),f=N8.find(p=>p.status===t),h=p=>n.find(g=>g.id===p);return o.jsxs("div",{className:"flex-1 min-w-[280px] max-w-[320px]",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:`w-2 h-2 rounded-full ${f.color}`}),o.jsx("h3",{className:"text-sm font-semibold text-text-primary",children:e}),o.jsx("span",{className:"text-xs text-text-muted bg-bg-hover px-2 py-0.5 rounded-full",children:d.length})]}),o.jsx("button",{className:"p-1 text-text-muted hover:text-text-primary transition-colors",children:o.jsx(R$,{className:"w-4 h-4"})})]}),o.jsxs("div",{ref:c,className:`bg-bg-secondary rounded-lg p-2 min-h-[400px] transition-all duration-200 ${a?"ring-2 ring-accent-blue ring-offset-2 ring-offset-bg-primary bg-accent-blue/5":""}`,children:[o.jsx(gce,{items:d.map(p=>p.id),strategy:pce,children:o.jsx("div",{className:"space-y-2",children:d.map(p=>o.jsx(S8,{task:p,resource:h(p.assigneeId),onClick:()=>s?.(p)},p.id))})}),a&&d.length===0&&o.jsx("div",{className:"flex items-center justify-center h-20 border-2 border-dashed border-accent-blue/50 rounded-lg text-accent-blue text-sm",children:"Drop here"}),t==="todo"&&i&&o.jsxs("button",{onClick:i,className:"w-full mt-2 p-2 flex items-center justify-center gap-2 text-sm text-text-muted hover:text-text-primary hover:bg-bg-hover rounded-lg transition-colors border border-dashed border-border",children:[o.jsx(Ir,{className:"w-4 h-4"}),o.jsx("span",{children:"Add Task"})]})]})]})},Ece=({tasks:e,resources:t,onAddTask:r,onEditTask:n})=>{const{dispatch:a}=Pt(),[i,s]=Nt.useState(null),[c,d]=Nt.useState(null),f=jg(Sc(UN,{activationConstraint:{distance:5}})),h=b=>{const y=e.find(w=>w.id===b.active.id);y&&s(y)},p=b=>{const{over:y}=b;if(!y){d(null);return}if(y.id.toString().startsWith("column-"))d(y.id.toString());else{const w=e.find(j=>j.id===y.id);w&&d(`column-${w.kanbanStatus}`)}},g=b=>{const{active:y,over:w}=b;if(s(null),d(null),!w)return;const j=e.find(N=>N.id===y.id);if(!j)return;let T=null;if(w.id.toString().startsWith("column-"))T=w.id.toString().replace("column-","");else{const N=e.find(C=>C.id===w.id);N&&(T=N.kanbanStatus)}T&&j.kanbanStatus!==T&&a({type:"UPDATE_TASK",payload:{...j,kanbanStatus:T}})},v=b=>t.find(y=>y.id===b);return o.jsxs(Og,{sensors:f,collisionDetection:aoe,onDragStart:h,onDragOver:p,onDragEnd:g,children:[o.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4",children:N8.map(b=>o.jsx(jce,{title:b.title,status:b.status,tasks:e,resources:t,isOver:c===`column-${b.status}`,onAddTask:b.status==="todo"?r:void 0,onEditTask:n},b.status))}),o.jsx(Ig,{dropAnimation:{duration:200,easing:"cubic-bezier(0.18, 0.67, 0.6, 1.22)"},children:i&&o.jsx("div",{className:"rotate-3 scale-105",children:o.jsx(S8,{task:i,resource:v(i.assigneeId)})})})]})};function Nw(e,t,r){const i=e.filter(d=>d.parentTaskId===r).sort((d,f)=>d.wbsCode&&f.wbsCode?d.wbsCode.localeCompare(f.wbsCode):0).findIndex(d=>d.id===t)+1;if(!r)return String(i);const s=e.find(d=>d.id===r);return`${s?.wbsCode||Nw(e,r,s?.parentTaskId)}.${i}`}function Tce(e,t){const r=e.filter(i=>i.projectId===t),n=new Map;function a(i,s){r.filter(d=>d.parentTaskId===i).sort((d,f)=>(d.sortOrder??999)-(f.sortOrder??999)).forEach((d,f)=>{const h=s?`${s}.${f+1}`:String(f+1);n.set(d.id,h),a(d.id,h)})}return a(void 0,""),n}function Cce(e,t){const r=e.filter(c=>c.projectId===t),n=new Map;r.forEach(c=>{n.set(c.id,{...c,level:0,children:[],hasChildren:!1,path:[]})});const a=[];n.forEach(c=>{if(c.parentTaskId&&n.has(c.parentTaskId)){const d=n.get(c.parentTaskId);d.children.push(c),d.hasChildren=!0}else a.push(c)});function i(c,d,f){c.forEach(h=>{h.level=d,h.path=f,i(h.children,d+1,[...f,h.id])})}i(a,0,[]);function s(c){c.sort((d,f)=>(d.sortOrder??999)-(f.sortOrder??999)),c.forEach(d=>s(d.children))}return s(a),a}function FO(e,t=new Set){const r=[];function n(a){a.forEach(i=>{const s=k8(i);r.push({...i,hasChildren:i.children.length>0,isExpanded:t.has(i.id),childCount:s}),(t.has(i.id)||t.size===0)&&n(i.children)})}return n(e),r}function k8(e){let t=e.children.length;return e.children.forEach(r=>{t+=k8(r)}),t}function _8(e,t,r){if(t===r)return!0;let n=r;const a=new Set;for(;n;){if(a.has(n)||n===t)return!0;a.add(n),n=e.find(s=>s.id===n)?.parentTaskId}return!1}function j8(e,t){const r=[];return e.filter(a=>a.parentTaskId===t).forEach(a=>{r.push(a.id),r.push(...j8(e,a.id))}),r}function Ace(e,t,r){const n=e.filter(i=>i.projectId===t);if(!r)return n;const a=new Set([r,...j8(e,r)]);return n.filter(i=>!a.has(i.id))}function Oce(e,t,r){if(t===r)return!0;const n=new Set,a=[r];for(;a.length>0;){const i=a.shift();if(n.has(i))continue;n.add(i);const s=e.find(c=>c.id===i);if(s?.dependsOn){if(s.dependsOn.includes(t))return!0;a.push(...s.dependsOn)}}return!1}function Dce(e,t,r){const n=e.filter(a=>a.projectId===t);return r?n.filter(a=>a.id===r?!1:!Oce(e,r,a.id)):n}function E8(e,t){const r=e.find(a=>a.id===t);if(!r)return 0;const n=e.filter(a=>a.parentTaskId===t);return n.length===0?r.estimatedHours||0:n.reduce((a,i)=>a+E8(e,i.id),0)}function T8(e,t){const r=e.find(a=>a.id===t);if(!r)return 0;const n=e.filter(a=>a.parentTaskId===t);return n.length===0?r.actualHours||0:n.reduce((a,i)=>a+T8(e,i.id),0)}function Ice(e,t){const r=e.find(n=>n.id===t);return!r?.dependsOn||r.dependsOn.length===0?!0:r.dependsOn.every(n=>e.find(i=>i.id===n)?.kanbanStatus==="done")}const C8={todo:o.jsx(N$,{className:"w-4 h-4 text-gray-400"}),in_progress:o.jsx(il,{className:"w-4 h-4 text-blue-400 animate-spin"}),blocked:o.jsx(r$,{className:"w-4 h-4 text-red-400"}),done:o.jsx(y$,{className:"w-4 h-4 text-green-400"})},Rce={low:"bg-gray-500/20 text-gray-400",medium:"bg-blue-500/20 text-blue-400",high:"bg-amber-500/20 text-amber-400",critical:"bg-red-500/20 text-red-400"},Mce=({projectId:e,onTaskClick:t,onAddTask:r,selectedTaskId:n})=>{const{state:a,dispatch:i,getResource:s}=Pt(),{tasks:c}=a,[d,f]=k.useState(new Set),[h,p]=k.useState(!0),[g,v]=k.useState(null),[b,y]=k.useState(null),w=jg(Sc(Eg,{activationConstraint:{distance:10}}),Sc(Tg,{activationConstraint:{delay:250,tolerance:5}})),j=k.useMemo(()=>Cce(c,e),[c,e]),T=k.useMemo(()=>{if(h){const ee=new Set(c.filter(ue=>ue.projectId===e).map(ue=>ue.id));return FO(j,ee)}return FO(j,d)},[j,d,h,c,e]),N=g?T.find(ee=>ee.id===g):null,C=ee=>{p(!1),f(ue=>{const V=new Set(ue);return V.has(ee)?V.delete(ee):V.add(ee),V})},E=()=>{p(!0);const ee=new Set(c.filter(ue=>ue.projectId===e).map(ue=>ue.id));f(ee)},O=()=>{p(!1),f(new Set)},A=ee=>{const ue=ee.active.id;v(ue)},D=ee=>{const{over:ue}=ee;if(!ue){y(null);return}const V=ue.id;if(V.includes(":")){const[K,ie]=V.split(":");y({taskId:K,position:ie})}else y({taskId:V,position:"child"})},M=ee=>{const{active:ue,over:V}=ee,K=b;if(v(null),y(null),!V||!K)return;const ie=ue.id,re=c.find(de=>de.id===ie),me=c.find(de=>de.id===K.taskId);if(!re||!me||ie===K.taskId)return;const{position:W}=K;let F;if(W==="child"?F=me.id:F=me.parentTaskId,F&&_8(c,ie,F)){console.warn("Cannot move task: would create cycle");return}const q=c.filter(de=>de.projectId===e&&de.parentTaskId===F).sort((de,ne)=>(de.sortOrder??999)-(ne.sortOrder??999)).filter(de=>de.id!==ie);let U;if(W==="child")U=q.length;else if(W==="before"){const de=q.findIndex(ne=>ne.id===me.id);U=de>=0?de:0}else{const de=q.findIndex(ne=>ne.id===me.id);U=de>=0?de+1:q.length}const G=[...q];G.splice(U,0,re);const le=[];G.forEach((de,ne)=>{(de.sortOrder!==ne||de.id===ie&&de.parentTaskId!==F)&&le.push({...de,sortOrder:ne,parentTaskId:de.id===ie?F:de.parentTaskId})}),re.parentTaskId!==F&&c.filter(ne=>ne.projectId===e&&ne.parentTaskId===re.parentTaskId&&ne.id!==ie).sort((ne,oe)=>(ne.sortOrder??999)-(oe.sortOrder??999)).forEach((ne,oe)=>{ne.sortOrder!==oe&&le.push({...ne,sortOrder:oe})}),le.forEach(de=>{i({type:"UPDATE_TASK",payload:de})}),setTimeout(()=>{const de=c.map(oe=>le.find(z=>z.id===oe.id)||oe),ne=Tce(de,e);de.filter(oe=>oe.projectId===e).forEach(oe=>{const Ae=ne.get(oe.id);Ae&&Ae!==oe.wbsCode&&i({type:"UPDATE_TASK",payload:{...oe,wbsCode:Ae}})})},50),F&&f(de=>new Set([...de,F]))},P=c.filter(ee=>ee.projectId===e),R=P.length,L=P.filter(ee=>ee.kanbanStatus==="done").length,te=P.filter(ee=>ee.isMilestone).length;return R===0?o.jsxs("div",{className:"bg-bg-secondary rounded-lg border border-border p-8 text-center",children:[o.jsx("div",{className:"text-text-secondary mb-4",children:"No tasks in this project yet"}),r&&o.jsxs("button",{onClick:()=>r(),className:"inline-flex items-center gap-2 px-4 py-2 bg-accent-blue text-white rounded-lg hover:bg-accent-blue/80 transition-colors",children:[o.jsx(Ir,{className:"w-4 h-4"}),"Add First Task"]})]}):o.jsxs(Og,{sensors:w,collisionDetection:PN,onDragStart:A,onDragOver:D,onDragEnd:M,children:[o.jsxs("div",{className:"bg-bg-secondary rounded-lg border border-border",children:[o.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("h3",{className:"font-medium text-text-primary",children:"Work Breakdown Structure"}),o.jsxs("div",{className:"flex items-center gap-3 text-sm text-text-secondary",children:[o.jsxs("span",{children:[R," tasks"]}),o.jsxs("span",{className:"text-green-400",children:[L," done"]}),te>0&&o.jsxs("span",{className:"flex items-center gap-1",children:[o.jsx(ys,{className:"w-3 h-3 text-amber-400"}),te," milestones"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Drag tasks to reorder"}),o.jsx("button",{onClick:E,className:"px-2 py-1 text-xs text-text-secondary hover:text-text-primary transition-colors",children:"Expand All"}),o.jsx("button",{onClick:O,className:"px-2 py-1 text-xs text-text-secondary hover:text-text-primary transition-colors",children:"Collapse All"}),r&&o.jsxs("button",{onClick:()=>r(),className:"flex items-center gap-1 px-2 py-1 text-xs bg-accent-blue/20 text-accent-blue rounded hover:bg-accent-blue/30 transition-colors",children:[o.jsx(Ir,{className:"w-3 h-3"}),"Add Task"]})]})]}),o.jsx("div",{className:"divide-y divide-border/50",children:T.map(ee=>o.jsx(Pce,{task:ee,allTasks:c,isSelected:ee.id===n,isExpanded:h||d.has(ee.id),dropTarget:b,activeId:g,onToggleExpand:()=>C(ee.id),onClick:()=>t?.(ee),onAddSubtask:r?()=>r(ee.id):void 0,getResource:s},ee.id))})]}),o.jsx(Ig,{children:N&&o.jsx("div",{className:"bg-bg-card border border-accent-blue rounded-lg shadow-xl px-4 py-2 opacity-90",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ld,{className:"w-4 h-4 text-accent-blue"}),C8[N.kanbanStatus],N.wbsCode&&o.jsx("span",{className:"text-xs font-mono text-text-secondary",children:N.wbsCode}),o.jsx("span",{className:"text-text-primary font-medium",children:N.title})]})})})]})},Vb=({id:e,isActive:t,position:r,level:n})=>{const{setNodeRef:a,isOver:i}=dh({id:e}),s=i||t;return r==="child"?o.jsx("div",{ref:a,className:`
          mx-4 my-1 rounded-lg border-2 border-dashed transition-all
          ${s?"h-10 border-accent-blue bg-accent-blue/10":"h-0 border-transparent"}
        `,style:{marginLeft:`${(n+1)*24+16}px`},children:s&&o.jsxs("div",{className:"flex items-center gap-2 h-full px-3 text-xs text-accent-blue",children:[o.jsx(Jw,{className:"w-3 h-3"}),o.jsx("span",{children:"Drop as child"})]})}):o.jsx("div",{ref:a,className:`
        relative transition-all
        ${s?"h-1":"h-0"}
      `,children:s&&o.jsx("div",{className:"absolute left-0 right-0 h-1 bg-accent-blue",style:{marginLeft:`${n*24+16}px`},children:o.jsx("div",{className:"absolute -left-1 -top-1 w-3 h-3 bg-accent-blue rounded-full"})})})},Pce=({task:e,allTasks:t,isSelected:r,isExpanded:n,dropTarget:a,activeId:i,onToggleExpand:s,onClick:c,onAddSubtask:d,getResource:f})=>{const{attributes:h,listeners:p,setNodeRef:g,transform:v}=Dg({id:e.id}),b=e.assigneeId?f(e.assigneeId):null,y=E8(t,e.id),w=T8(t,e.id),j=Ice(t,e.id),T=e.dependsOn&&e.dependsOn.length>0,N=v?{transform:`translate3d(${v.x}px, ${v.y}px, 0)`,zIndex:1e3}:void 0,C=i===e.id,E=i!==null&&i!==e.id&&!_8(t,i,e.id);return o.jsxs("div",{className:"relative",children:[E&&o.jsx(Vb,{id:`${e.id}:before`,isActive:a?.taskId===e.id&&a?.position==="before",position:"before",level:e.level}),o.jsxs("div",{ref:g,style:N,className:`
          group flex items-center gap-2 px-4 py-2 transition-colors
          ${C?"opacity-50 bg-accent-blue/20":"hover:bg-bg-tertiary"}
          ${r?"bg-accent-blue/10 border-l-2 border-accent-blue":""}
        `,children:[o.jsx("div",{...h,...p,className:"cursor-grab active:cursor-grabbing p-1 -ml-1 text-text-muted hover:text-text-secondary transition-colors touch-none",children:o.jsx(ld,{className:"w-4 h-4"})}),o.jsx("div",{style:{width:`${e.level*24}px`},className:"flex-shrink-0"}),o.jsx("button",{onClick:O=>{O.stopPropagation(),s()},className:`
            w-5 h-5 flex items-center justify-center rounded hover:bg-bg-primary transition-colors
            ${e.hasChildren?"text-text-secondary":"text-transparent"}
          `,disabled:!e.hasChildren,children:e.hasChildren&&(n?o.jsx(Ra,{className:"w-4 h-4"}):o.jsx(ha,{className:"w-4 h-4"}))}),o.jsx("span",{className:"flex-shrink-0",children:C8[e.kanbanStatus]}),e.wbsCode&&o.jsx("span",{className:"text-xs font-mono text-text-secondary bg-bg-primary px-1.5 py-0.5 rounded",children:e.wbsCode}),e.isMilestone&&o.jsx(ys,{className:"w-4 h-4 text-amber-400 flex-shrink-0"}),o.jsx("span",{onClick:c,className:`flex-grow truncate cursor-pointer hover:text-accent-blue ${e.kanbanStatus==="done"?"text-text-secondary line-through":"text-text-primary"}`,children:e.title}),e.priority&&e.priority!=="medium"&&o.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${Rce[e.priority]}`,children:e.priority}),T&&!j&&o.jsxs("span",{className:"flex items-center gap-1 text-xs text-amber-400",title:"Has incomplete dependencies",children:[o.jsx(r5,{className:"w-3 h-3"}),o.jsx(_n,{className:"w-3 h-3"})]}),e.hasChildren&&e.childCount>0&&o.jsxs("span",{className:"text-xs text-text-secondary bg-bg-primary px-1.5 py-0.5 rounded",children:[e.childCount," subtask",e.childCount!==1?"s":""]}),o.jsxs("span",{className:"flex items-center gap-1 text-xs text-text-secondary",title:`${w}h actual / ${y}h estimated`,children:[o.jsx(fo,{className:"w-3 h-3"}),w,"/",y,"h"]}),b&&o.jsxs("span",{className:"flex items-center gap-1 text-xs",style:{color:b.avatarColor},title:b.name,children:[o.jsx(l5,{className:"w-3 h-3"}),o.jsx("span",{className:"max-w-[60px] truncate",children:b.name.split(" ")[0]})]}),e.dueDate&&o.jsx("span",{className:`text-xs ${new Date(e.dueDate)<new Date&&e.kanbanStatus!=="done"?"text-red-400":"text-text-secondary"}`,children:new Date(e.dueDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),d&&o.jsx("button",{onClick:O=>{O.stopPropagation(),d()},className:"opacity-0 group-hover:opacity-100 p-1 text-text-secondary hover:text-accent-blue transition-all",title:"Add subtask",children:o.jsx(Ir,{className:"w-4 h-4"})})]}),E&&o.jsx(Vb,{id:`${e.id}:child`,isActive:a?.taskId===e.id&&a?.position==="child",position:"child",level:e.level}),E&&o.jsx(Vb,{id:`${e.id}:after`,isActive:a?.taskId===e.id&&a?.position==="after",position:"after",level:e.level})]})},Fce={pending:{icon:o.jsx(fo,{className:"w-4 h-4"}),color:"text-gray-400",bgColor:"bg-gray-500/20"},completed:{icon:o.jsx(yr,{className:"w-4 h-4"}),color:"text-green-400",bgColor:"bg-green-500/20"},missed:{icon:o.jsx(_n,{className:"w-4 h-4"}),color:"text-red-400",bgColor:"bg-red-500/20"}},Lce=({projectId:e,onMilestoneClick:t,onAddMilestone:r})=>{const{state:n,getTasksByProject:a}=Pt(),i=a(e),s=k.useMemo(()=>(n.milestones||[]).filter(f=>f.projectId===e).sort((f,h)=>new Date(f.targetDate).getTime()-new Date(h.targetDate).getTime()),[n.milestones,e]),c=k.useMemo(()=>s.map(f=>{const h=i.filter(b=>f.linkedTaskIds.includes(b.id)),p=h.filter(b=>b.kanbanStatus==="done"),g=h.length>0?Math.round(p.length/h.length*100):0,v=f.status==="pending"&&new Date(f.targetDate)<new Date;return{...f,linkedTaskCount:h.length,completedTaskCount:p.length,progress:g,isOverdue:v}}),[s,i]),d=k.useMemo(()=>({total:s.length,completed:s.filter(f=>f.status==="completed").length,pending:s.filter(f=>f.status==="pending").length,missed:s.filter(f=>f.status==="missed").length,overdue:c.filter(f=>f.isOverdue).length}),[s,c]);return s.length===0?o.jsxs("div",{className:"bg-bg-secondary rounded-lg border border-border p-8 text-center",children:[o.jsx(ys,{className:"w-12 h-12 text-text-muted mx-auto mb-3"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"No Milestones Yet"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"Milestones mark key deliverables and progress points in your project."}),r&&o.jsxs("button",{onClick:r,className:"inline-flex items-center gap-2 px-4 py-2 bg-accent-blue text-white rounded-lg hover:bg-accent-blue/80 transition-colors",children:[o.jsx(Ir,{className:"w-4 h-4"}),"Add First Milestone"]})]}):o.jsxs("div",{className:"bg-bg-secondary rounded-lg border border-border",children:[o.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("h3",{className:"font-medium text-text-primary flex items-center gap-2",children:[o.jsx(ys,{className:"w-4 h-4 text-amber-400"}),"Project Milestones"]}),o.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[o.jsxs("span",{className:"text-text-secondary",children:[d.total," total"]}),d.completed>0&&o.jsxs("span",{className:"text-green-400",children:[d.completed," done"]}),d.overdue>0&&o.jsxs("span",{className:"text-red-400",children:[d.overdue," overdue"]})]})]}),r&&o.jsxs("button",{onClick:r,className:"flex items-center gap-1 px-2 py-1 text-xs bg-accent-blue/20 text-accent-blue rounded hover:bg-accent-blue/30 transition-colors",children:[o.jsx(Ir,{className:"w-3 h-3"}),"Add Milestone"]})]}),o.jsx("div",{className:"p-4",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-4 top-6 bottom-6 w-0.5 bg-border"}),o.jsx("div",{className:"space-y-4",children:c.map((f,h)=>{const p=Fce[f.status];return c.length-1,o.jsxs("div",{onClick:()=>t?.(f),className:"relative flex items-start gap-4 cursor-pointer group",children:[o.jsx("div",{className:`
                      relative z-10 w-8 h-8 rounded-full flex items-center justify-center
                      ${p.bgColor} ${p.color}
                      ${f.isOverdue&&f.status==="pending"?"ring-2 ring-red-400 ring-offset-2 ring-offset-bg-secondary":""}
                      group-hover:scale-110 transition-transform
                    `,children:p.icon}),o.jsx("div",{className:"flex-1 pb-4",children:o.jsxs("div",{className:"bg-bg-card rounded-lg border border-border p-3 group-hover:border-accent-blue/50 transition-colors",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-text-primary group-hover:text-accent-blue transition-colors",children:f.name}),f.description&&o.jsx("p",{className:"text-sm text-text-secondary mt-0.5",children:f.description})]}),o.jsx(ha,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsxs("div",{className:"flex items-center gap-4 text-xs",children:[o.jsxs("span",{className:`flex items-center gap-1 ${f.isOverdue?"text-red-400":"text-text-secondary"}`,children:[o.jsx(Zw,{className:"w-3 h-3"}),new Date(f.targetDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),f.isOverdue&&" (Overdue)"]}),f.completedDate&&o.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[o.jsx(yr,{className:"w-3 h-3"}),"Completed ",new Date(f.completedDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})]}),f.linkedTaskCount>0&&o.jsxs("span",{className:"text-text-secondary",children:[f.completedTaskCount,"/",f.linkedTaskCount," tasks"]})]}),f.status==="pending"&&f.linkedTaskCount>0&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",children:[o.jsx("span",{className:"text-text-secondary",children:"Progress"}),o.jsxs("span",{className:f.progress===100?"text-green-400":"text-text-secondary",children:[f.progress,"%"]})]}),o.jsx("div",{className:"h-1.5 bg-bg-hover rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all ${f.progress===100?"bg-green-400":"bg-accent-blue"}`,style:{width:`${f.progress}%`}})})]})]})})]},f.id)})})]})})]})},Bce=({projectId:e,task:t,parentTaskId:r,onClose:n})=>{const{state:a,dispatch:i}=Pt(),{resources:s,tasks:c}=a,[d,f]=k.useState(!!(t?.parentTaskId||t?.dependsOn?.length||t?.isMilestone||t?.priority)),[h,p]=k.useState({title:t?.title||"",description:t?.description||"",assigneeId:t?.assigneeId||"",kanbanStatus:t?.kanbanStatus||"todo",dueDate:t?.dueDate||new Date().toISOString().split("T")[0],estimatedHours:t?.estimatedHours||8,actualHours:t?.actualHours||0,parentTaskId:t?.parentTaskId||r||"",dependsOn:t?.dependsOn||[],isMilestone:t?.isMilestone||!1,priority:t?.priority||"medium",deliverable:t?.deliverable||"",startDate:t?.startDate||""}),g=k.useMemo(()=>Ace(c,e,t?.id),[c,e,t?.id]),v=k.useMemo(()=>Dce(c,e,t?.id),[c,e,t?.id]),b=j=>{j.preventDefault();const T=t?.id||No(),N=h.parentTaskId?Nw(c,T,h.parentTaskId):Nw(c,T,void 0),C={id:T,projectId:e,title:h.title,description:h.description,assigneeId:h.assigneeId,kanbanStatus:h.kanbanStatus,dueDate:h.dueDate,estimatedHours:h.estimatedHours,actualHours:h.actualHours,parentTaskId:h.parentTaskId||void 0,dependsOn:h.dependsOn.length>0?h.dependsOn:void 0,wbsCode:N,isMilestone:h.isMilestone||void 0,priority:h.priority!=="medium"?h.priority:void 0,deliverable:h.deliverable||void 0,startDate:h.startDate||void 0};i(t?{type:"UPDATE_TASK",payload:C}:{type:"ADD_TASK",payload:C}),n()},y=j=>{p(T=>({...T,dependsOn:T.dependsOn.includes(j)?T.dependsOn.filter(N=>N!==j):[...T.dependsOn,j]}))},w=()=>{t&&confirm("Are you sure you want to delete this task?")&&(i({type:"DELETE_TASK",payload:t.id}),n())};return o.jsxs("form",{onSubmit:b,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Task Title *"}),o.jsx("input",{type:"text",value:h.title,onChange:j=>p({...h,title:j.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Description"}),o.jsx("textarea",{value:h.description,onChange:j=>p({...h,description:j.target.value}),rows:3,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue resize-none"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Assignee"}),o.jsxs("select",{value:h.assigneeId,onChange:j=>p({...h,assigneeId:j.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"",children:"Unassigned"}),s.map(j=>o.jsxs("option",{value:j.id,children:[j.name," (",j.role,")"]},j.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Status"}),o.jsxs("select",{value:h.kanbanStatus,onChange:j=>p({...h,kanbanStatus:j.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"todo",children:"To Do"}),o.jsx("option",{value:"in_progress",children:"In Progress"}),o.jsx("option",{value:"blocked",children:"Blocked"}),o.jsx("option",{value:"done",children:"Done"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Due Date"}),o.jsx("input",{type:"date",value:h.dueDate,onChange:j=>p({...h,dueDate:j.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Estimated Hours"}),o.jsx("input",{type:"number",value:h.estimatedHours,onChange:j=>p({...h,estimatedHours:Number(j.target.value)}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Actual Hours"}),o.jsx("input",{type:"number",value:h.actualHours,onChange:j=>p({...h,actualHours:Number(j.target.value)}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("button",{type:"button",onClick:()=>f(!d),className:"flex items-center gap-2 text-sm text-text-secondary hover:text-text-primary transition-colors",children:[d?o.jsx(ZI,{className:"w-4 h-4"}):o.jsx(Ra,{className:"w-4 h-4"}),o.jsx("span",{children:"WBS & Advanced Options"}),(h.parentTaskId||h.dependsOn.length>0||h.isMilestone)&&o.jsx("span",{className:"text-xs bg-accent-blue/20 text-accent-blue px-1.5 py-0.5 rounded",children:"configured"})]}),d&&o.jsxs("div",{className:"space-y-4 p-4 bg-bg-tertiary rounded-lg border border-border",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Parent Task (WBS Hierarchy)"}),o.jsxs("select",{value:h.parentTaskId,onChange:j=>p({...h,parentTaskId:j.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"",children:"No parent (root level)"}),g.map(j=>o.jsxs("option",{value:j.id,children:[j.wbsCode?`${j.wbsCode} - `:"",j.title]},j.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Priority"}),o.jsxs("select",{value:h.priority,onChange:j=>p({...h,priority:j.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"low",children:"Low"}),o.jsx("option",{value:"medium",children:"Medium"}),o.jsx("option",{value:"high",children:"High"}),o.jsx("option",{value:"critical",children:"Critical"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Start Date"}),o.jsx("input",{type:"date",value:h.startDate,onChange:j=>p({...h,startDate:j.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsx("div",{className:"flex items-center gap-3 pt-6",children:o.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:h.isMilestone,onChange:j=>p({...h,isMilestone:j.target.checked}),className:"w-4 h-4 rounded border-border bg-bg-primary text-accent-blue focus:ring-accent-blue"}),o.jsx(ys,{className:`w-4 h-4 ${h.isMilestone?"text-amber-400":"text-text-secondary"}`}),o.jsx("span",{className:"text-sm text-text-primary",children:"Mark as Milestone"})]})})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-text-secondary mb-2",children:[o.jsx(r5,{className:"w-4 h-4"}),"Dependencies (tasks that must complete first)"]}),v.length>0?o.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1 p-2 bg-bg-primary rounded-lg border border-border",children:v.map(j=>o.jsxs("label",{className:"flex items-center gap-2 p-1.5 rounded hover:bg-bg-tertiary cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:h.dependsOn.includes(j.id),onChange:()=>y(j.id),className:"w-4 h-4 rounded border-border bg-bg-primary text-accent-blue focus:ring-accent-blue"}),o.jsxs("span",{className:`text-sm ${j.kanbanStatus==="done"?"text-green-400":"text-text-primary"}`,children:[j.wbsCode?`${j.wbsCode} - `:"",j.title]}),j.kanbanStatus==="done"&&o.jsx("span",{className:"text-xs text-green-400",children:"(done)"})]},j.id))}):o.jsx("p",{className:"text-sm text-text-secondary italic",children:"No other tasks available for dependencies"}),h.dependsOn.length>0&&o.jsxs("p",{className:"mt-1 text-xs text-text-secondary",children:[h.dependsOn.length," dependency(ies) selected"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Deliverable / Output"}),o.jsx("input",{type:"text",value:h.deliverable,onChange:j=>p({...h,deliverable:j.target.value}),placeholder:"What is the output of this task?",className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{className:"flex justify-between pt-4 border-t border-border",children:[o.jsx("div",{children:t&&o.jsx(Xe,{type:"button",variant:"danger",onClick:w,children:"Delete Task"})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:n,children:"Cancel"}),o.jsx(Xe,{type:"submit",children:t?"Update Task":"Create Task"})]})]})]})};function kw(e,t,r,n){const a=t.toString().slice(-2),i=n.toString().padStart(3,"0");return`${e}-${a}-${r}-${i}`}function _w(e,t,r,n){const a=e.filter(s=>s.departmentCode===t&&s.fiscalYear===r&&s.category===n);return a.length===0?1:Math.max(...a.map(s=>s.sequenceNumber))+1}function Uce(e=new Date){return e.getFullYear()}const A8=({initiativeId:e,project:t,onClose:r,onNavigate:n})=>{const{state:a,dispatch:i}=Pt(),{initiatives:s,resources:c,projects:d}=a,[f,h]=k.useState({initiativeId:t?.initiativeId||e||"",name:t?.name||"",description:t?.description||"",managerId:t?.managerId||"",status:t?.status||"not_started",ragStatus:t?.ragStatus||"green",startDate:t?.startDate||new Date().toISOString().split("T")[0],endDate:t?.endDate||new Date(Date.now()+1440*60*60*1e3).toISOString().split("T")[0],completionPercentage:t?.completionPercentage||0,budget:t?.budget||5e4,spentBudget:t?.spentBudget||0,departmentCode:t?.departmentCode||"IT",category:t?.category||"GROW",fiscalYear:t?.fiscalYear||Uce()}),p=w=>{w.preventDefault();const j=t?.sequenceNumber||_w(d,f.departmentCode,f.fiscalYear,f.category),T=t?.workId||kw(f.departmentCode,f.fiscalYear,f.category,j),N={id:t?.id||No(),initiativeId:f.initiativeId,name:f.name,description:f.description,managerId:f.managerId,status:f.status,ragStatus:f.ragStatus,startDate:f.startDate,endDate:f.endDate,completionPercentage:f.completionPercentage,budget:f.budget,spentBudget:f.spentBudget,departmentCode:f.departmentCode,category:f.category,fiscalYear:f.fiscalYear,sequenceNumber:j,workId:T};i(t?{type:"UPDATE_PROJECT",payload:N}:{type:"ADD_PROJECT",payload:N}),r()},g=()=>{t&&confirm("Are you sure you want to delete this project? This will also delete all associated tasks.")&&(i({type:"DELETE_PROJECT",payload:t.id}),r())},v=t?.workId||kw(f.departmentCode,f.fiscalYear,f.category,_w(d,f.departmentCode,f.fiscalYear,f.category)),b=f.spentBudget-f.budget,y=f.budget>0?Math.round(f.spentBudget/f.budget*100):0;return o.jsxs("form",{onSubmit:p,className:"space-y-4",children:[o.jsx("div",{className:"p-3 bg-accent-blue/10 border border-accent-blue/30 rounded-lg",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:"Work ID:"}),o.jsx("span",{className:"font-mono font-semibold text-accent-blue",children:v})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Project Name *"}),o.jsx("input",{type:"text",value:f.name,onChange:w=>h({...f,name:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Description"}),o.jsx("textarea",{value:f.description,onChange:w=>h({...f,description:w.target.value}),rows:2,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue resize-none"})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Department *"}),o.jsx("select",{value:f.departmentCode,onChange:w=>h({...f,departmentCode:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",disabled:!!t,children:Object.values(Un).map(w=>o.jsxs("option",{value:w.code,children:[w.code," - ",w.name]},w.code))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Category *"}),o.jsx("select",{value:f.category,onChange:w=>h({...f,category:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",disabled:!!t,children:Object.values(Hi).map(w=>o.jsx("option",{value:w.code,children:w.name},w.code))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Fiscal Year"}),o.jsx("input",{type:"number",value:f.fiscalYear,onChange:w=>h({...f,fiscalYear:Number(w.target.value)}),min:2020,max:2030,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",disabled:!!t})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Initiative *"}),o.jsxs("select",{value:f.initiativeId,onChange:w=>h({...f,initiativeId:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0,children:[o.jsx("option",{value:"",children:"Select Initiative"}),s.map(w=>o.jsx("option",{value:w.id,children:w.name},w.id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Project Manager"}),o.jsxs("select",{value:f.managerId,onChange:w=>h({...f,managerId:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"",children:"Unassigned"}),c.map(w=>o.jsxs("option",{value:w.id,children:[w.name," (",w.role,")"]},w.id))]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Start Date"}),o.jsx("input",{type:"date",value:f.startDate,onChange:w=>h({...f,startDate:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"End Date"}),o.jsx("input",{type:"date",value:f.endDate,onChange:w=>h({...f,endDate:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Status"}),o.jsxs("select",{value:f.status,onChange:w=>h({...f,status:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"not_started",children:"Not Started"}),o.jsx("option",{value:"in_progress",children:"In Progress"}),o.jsx("option",{value:"on_hold",children:"On Hold"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"RAG Status"}),o.jsxs("select",{value:f.ragStatus,onChange:w=>h({...f,ragStatus:w.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"green",children:"Green - On Track"}),o.jsx("option",{value:"amber",children:"Amber - At Risk"}),o.jsx("option",{value:"red",children:"Red - Critical"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Completion %"}),o.jsx("input",{type:"number",value:f.completionPercentage,onChange:w=>h({...f,completionPercentage:Number(w.target.value)}),min:0,max:100,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Budget ($)"}),o.jsx("input",{type:"number",value:f.budget,onChange:w=>h({...f,budget:Number(w.target.value)}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Spent Budget ($)"}),o.jsx("input",{type:"number",value:f.spentBudget,onChange:w=>h({...f,spentBudget:Number(w.target.value)}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Budget Usage:"}),o.jsxs("span",{className:b>0?"text-rag-red":"text-rag-green",children:[y,"% (",b>0?"+":"","$",b.toLocaleString(),")"]})]}),o.jsx("div",{className:"h-2 bg-bg-primary rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all ${y>100?"bg-rag-red":y>80?"bg-rag-amber":"bg-rag-green"}`,style:{width:`${Math.min(y,100)}%`}})}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Completion:"}),o.jsxs("span",{className:"text-accent-blue",children:[f.completionPercentage,"%"]})]}),o.jsx("div",{className:"h-2 bg-bg-primary rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-accent-blue rounded-full transition-all",style:{width:`${f.completionPercentage}%`}})})]}),o.jsxs("div",{className:"flex justify-between pt-4 border-t border-border",children:[o.jsxs("div",{className:"flex gap-2",children:[t&&o.jsx(Xe,{type:"button",variant:"danger",onClick:g,children:"Delete"}),t&&n&&o.jsxs(Xe,{type:"button",variant:"secondary",onClick:n,children:[o.jsx(JI,{className:"w-4 h-4 mr-1"}),"View Execution"]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),o.jsx(Xe,{type:"submit",children:t?"Update":"Create"})]})]})]})},zce=({projectId:e,milestone:t,onClose:r})=>{const{state:n,dispatch:a,getTasksByProject:i}=Pt(),s=i(e),[c,d]=k.useState({name:t?.name||"",description:t?.description||"",targetDate:t?.targetDate||new Date().toISOString().split("T")[0],completedDate:t?.completedDate||"",status:t?.status||"pending",linkedTaskIds:t?.linkedTaskIds||[]}),f=k.useMemo(()=>{const y=(n.milestones||[]).filter(w=>w.projectId===e);return Math.max(0,...y.map(w=>w.displayOrder))},[n.milestones,e]),h=y=>{y.preventDefault();const w={id:t?.id||No(),projectId:e,name:c.name,description:c.description||void 0,targetDate:c.targetDate,completedDate:c.completedDate||void 0,status:c.status,linkedTaskIds:c.linkedTaskIds,displayOrder:t?.displayOrder??f+1};a(t?{type:"UPDATE_MILESTONE",payload:w}:{type:"ADD_MILESTONE",payload:w}),r()},p=()=>{t&&confirm("Are you sure you want to delete this milestone?")&&(a({type:"DELETE_MILESTONE",payload:t.id}),r())},g=y=>{d(w=>({...w,linkedTaskIds:w.linkedTaskIds.includes(y)?w.linkedTaskIds.filter(j=>j!==y):[...w.linkedTaskIds,y]}))},v=k.useMemo(()=>c.linkedTaskIds.length===0?!1:c.linkedTaskIds.every(y=>s.find(j=>j.id===y)?.kanbanStatus==="done"),[c.linkedTaskIds,s]),b={pending:o.jsx(fo,{className:"w-4 h-4 text-gray-400"}),completed:o.jsx(yr,{className:"w-4 h-4 text-green-400"}),missed:o.jsx(_n,{className:"w-4 h-4 text-red-400"})};return o.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Milestone Name *"}),o.jsxs("div",{className:"relative",children:[o.jsx(ys,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-400"}),o.jsx("input",{type:"text",value:c.name,onChange:y=>d({...c,name:y.target.value}),placeholder:"e.g., Phase 1 Complete, MVP Launch",className:"w-full pl-10 pr-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Description"}),o.jsx("textarea",{value:c.description,onChange:y=>d({...c,description:y.target.value}),rows:2,placeholder:"What does this milestone represent?",className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue resize-none"})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Target Date *"}),o.jsx("input",{type:"date",value:c.targetDate,onChange:y=>d({...c,targetDate:y.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Completed Date"}),o.jsx("input",{type:"date",value:c.completedDate,onChange:y=>d({...c,completedDate:y.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Status"}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:c.status,onChange:y=>d({...c,status:y.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue appearance-none",children:[o.jsx("option",{value:"pending",children:"Pending"}),o.jsx("option",{value:"completed",children:"Completed"}),o.jsx("option",{value:"missed",children:"Missed"})]}),o.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:b[c.status]})]})]})]}),v&&c.status==="pending"&&o.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-500/10 rounded-lg border border-green-500/30",children:[o.jsx(yr,{className:"w-4 h-4 text-green-400"}),o.jsx("span",{className:"text-sm text-green-400",children:"All linked tasks are complete!"}),o.jsx("button",{type:"button",onClick:()=>d({...c,status:"completed",completedDate:new Date().toISOString().split("T")[0]}),className:"ml-auto text-xs bg-green-500/20 text-green-400 px-2 py-1 rounded hover:bg-green-500/30",children:"Mark Complete"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Linked Tasks (tasks that must complete for this milestone)"}),s.length>0?o.jsx("div",{className:"max-h-48 overflow-y-auto space-y-1 p-2 bg-bg-tertiary rounded-lg border border-border",children:s.map(y=>o.jsxs("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-bg-hover cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:c.linkedTaskIds.includes(y.id),onChange:()=>g(y.id),className:"w-4 h-4 rounded border-border bg-bg-primary text-accent-blue focus:ring-accent-blue"}),o.jsxs("span",{className:`flex-1 text-sm ${y.kanbanStatus==="done"?"text-green-400 line-through":"text-text-primary"}`,children:[y.wbsCode?`${y.wbsCode} - `:"",y.title]}),y.kanbanStatus==="done"&&o.jsx(yr,{className:"w-3 h-3 text-green-400"}),y.isMilestone&&o.jsx(ys,{className:"w-3 h-3 text-amber-400"})]},y.id))}):o.jsx("p",{className:"text-sm text-text-muted italic p-4 bg-bg-tertiary rounded-lg border border-border",children:"No tasks in this project yet. Create tasks first, then link them to milestones."}),c.linkedTaskIds.length>0&&o.jsxs("p",{className:"mt-1 text-xs text-text-secondary",children:[c.linkedTaskIds.length," task(s) linked ",c.linkedTaskIds.filter(y=>s.find(w=>w.id===y)?.kanbanStatus==="done").length," completed"]})]}),o.jsxs("div",{className:"flex justify-between pt-4 border-t border-border",children:[o.jsx("div",{children:t&&o.jsx(Xe,{type:"button",variant:"danger",onClick:p,children:"Delete Milestone"})}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),o.jsx(Xe,{type:"submit",children:t?"Update Milestone":"Create Milestone"})]})]})]})},$ce=()=>{const e=fa(),[t]=Hw(),{state:r,getInitiative:n,getPillar:a,getTasksByProject:i}=Pt(),{projects:s,initiatives:c,pillars:d,tasks:f}=r,[h,p]=k.useState(""),[g,v]=k.useState("all"),[b,y]=k.useState(t.get("pillar")||"all"),[w,j]=k.useState(t.get("initiative")||"all"),[T,N]=k.useState(!1),C=k.useMemo(()=>s.filter(D=>{const M=D.name.toLowerCase().includes(h.toLowerCase())||D.description?.toLowerCase().includes(h.toLowerCase()),P=g==="all"||D.ragStatus===g,R=n(D.initiativeId),L=b==="all"||R?.pillarId===b,te=w==="all"||D.initiativeId===w;return M&&P&&L&&te}),[s,h,g,b,w,n]),E=k.useMemo(()=>{const D={};return C.forEach(M=>{const P=n(M.initiativeId);P&&(D[P.id]||(D[P.id]={initiative:P,projects:[]}),D[P.id].projects.push(M))}),Object.values(D).sort((M,P)=>M.initiative.name.localeCompare(P.initiative.name))},[C,n]),O=k.useMemo(()=>({total:s.length,green:s.filter(D=>D.ragStatus==="green").length,amber:s.filter(D=>D.ragStatus==="amber").length,red:s.filter(D=>D.ragStatus==="red").length}),[s]),A=b==="all"?c:c.filter(D=>D.pillarId===b);return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Project Execution"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Select a project to manage tasks and track progress"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(Ai,{className:"w-5 h-5 text-accent-cyan"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Execution Board"})]}),c.length>0&&o.jsx(Xe,{onClick:()=>N(!0),icon:o.jsx(Ir,{className:"w-4 h-4"}),children:"Add Project"})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{onClick:()=>v("all"),className:`bg-bg-card rounded-xl border p-4 cursor-pointer transition-colors ${g==="all"?"border-accent-blue bg-accent-blue/5":"border-border hover:bg-bg-hover"}`,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Ai,{className:"w-5 h-5 text-accent-blue"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:O.total}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Total Projects"})]})]})}),o.jsx("div",{onClick:()=>v("green"),className:`bg-bg-card rounded-xl border p-4 cursor-pointer transition-colors ${g==="green"?"border-rag-green bg-rag-green/5":"border-border hover:bg-bg-hover"}`,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(yr,{className:"w-5 h-5 text-rag-green"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-rag-green",children:O.green}),o.jsx("p",{className:"text-sm text-text-secondary",children:"On Track"})]})]})}),o.jsx("div",{onClick:()=>v("amber"),className:`bg-bg-card rounded-xl border p-4 cursor-pointer transition-colors ${g==="amber"?"border-rag-amber bg-rag-amber/5":"border-border hover:bg-bg-hover"}`,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(jn,{className:"w-5 h-5 text-rag-amber"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-rag-amber",children:O.amber}),o.jsx("p",{className:"text-sm text-text-secondary",children:"At Risk"})]})]})}),o.jsx("div",{onClick:()=>v("red"),className:`bg-bg-card rounded-xl border p-4 cursor-pointer transition-colors ${g==="red"?"border-rag-red bg-rag-red/5":"border-border hover:bg-bg-hover"}`,children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(jn,{className:"w-5 h-5 text-rag-red"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-rag-red",children:O.red}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Critical"})]})]})})]}),o.jsx("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:o.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[o.jsx("div",{className:"flex-1 min-w-[200px]",children:o.jsxs("div",{className:"relative",children:[o.jsx(s5,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted"}),o.jsx("input",{type:"text",placeholder:"Search projects...",value:h,onChange:D=>p(D.target.value),className:"w-full pl-10 pr-4 py-2 bg-bg-primary border border-border rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-blue"})]})}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(X$,{className:"w-4 h-4 text-text-muted"}),o.jsxs("select",{value:b,onChange:D=>{y(D.target.value),j("all")},className:"px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"all",children:"All Pillars"}),d.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]})]}),o.jsxs("select",{value:w,onChange:D=>j(D.target.value),className:"px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"all",children:"All Initiatives"}),A.map(D=>o.jsx("option",{value:D.id,children:D.name},D.id))]}),(h||g!=="all"||b!=="all"||w!=="all")&&o.jsx("button",{onClick:()=>{p(""),v("all"),y("all"),j("all")},className:"text-sm text-accent-blue hover:text-accent-blue/80",children:"Clear filters"})]})}),o.jsx("div",{className:"space-y-4",children:E.length===0?o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-8 text-center",children:[o.jsx(Ai,{className:"w-12 h-12 text-text-muted mx-auto mb-3"}),o.jsx("p",{className:"text-text-secondary mb-4",children:h||g!=="all"||b!=="all"||w!=="all"?"No projects found matching your filters":c.length===0?"No initiatives exist yet. Create an initiative first in Portfolio.":"No projects exist yet. Create your first project!"}),c.length>0&&!h&&g==="all"&&b==="all"&&w==="all"&&o.jsx(Xe,{onClick:()=>N(!0),icon:o.jsx(Ir,{className:"w-4 h-4"}),children:"Add Project"}),c.length===0&&o.jsx(Xe,{onClick:()=>e("/portfolio"),variant:"secondary",children:"Go to Portfolio"})]}):E.map(({initiative:D,projects:M})=>{const P=a(D.pillarId);return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border overflow-hidden",children:[o.jsx("div",{className:"px-4 py-3 bg-bg-hover border-b border-border",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ic,{status:D.ragStatus,size:"sm"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-text-primary",children:D.name}),o.jsx("p",{className:"text-xs text-text-muted",children:P?.name})]})]}),o.jsxs("span",{className:"text-sm text-text-secondary",children:[M.length," project(s)"]})]})}),o.jsx("div",{className:"divide-y divide-border",children:M.map(R=>{const L=i(R.id),te=L.filter(K=>K.kanbanStatus==="done").length,ee=L.length>0?Math.round(te/L.length*100):0,ue=Un[R.departmentCode],V=Hi[R.category];return o.jsx("div",{onClick:()=>e(`/execution/${R.id}`),className:"px-4 py-3 hover:bg-bg-hover cursor-pointer transition-colors group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[o.jsx(_p,{status:R.ragStatus}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h4",{className:"font-medium text-text-primary group-hover:text-accent-blue transition-colors",children:R.name}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-mono font-medium",style:{backgroundColor:`${ue?.color}20`,color:ue?.color},children:R.workId}),o.jsx("button",{onClick:K=>{K.stopPropagation(),e(`/project/${R.id}`)},className:"p-1 text-text-muted hover:text-accent-blue opacity-0 group-hover:opacity-100 transition-opacity",title:"View Project Charter",children:o.jsx(eS,{className:"w-3.5 h-3.5"})})]}),o.jsx("p",{className:"text-sm text-text-muted line-clamp-1",children:R.description})]})]}),o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsx("div",{className:"text-center",children:o.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:`${V?.color}20`,color:V?.color},children:V?.name})}),o.jsxs("div",{className:"text-right",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-24 h-2 bg-bg-hover rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-accent-blue rounded-full",style:{width:`${ee}%`}})}),o.jsxs("span",{className:"text-sm text-text-secondary w-10",children:[ee,"%"]})]}),o.jsxs("p",{className:"text-xs text-text-muted",children:[te,"/",L.length," tasks"]})]}),o.jsxs("div",{className:"text-right w-24",children:[o.jsxs("p",{className:"text-sm font-medium text-text-primary",children:["$",(R.spentBudget/1e3).toFixed(0),"K"]}),o.jsxs("p",{className:"text-xs text-text-muted",children:["of $",(R.budget/1e3).toFixed(0),"K"]})]}),o.jsx(ha,{className:"w-5 h-5 text-text-muted group-hover:text-accent-blue transition-colors"})]})]})},R.id)})})]},D.id)})}),o.jsx(Ta,{isOpen:T,onClose:()=>N(!1),title:"Add New Project",size:"lg",children:o.jsx(A8,{onClose:()=>N(!1)})})]})},LO=()=>{const{projectId:e}=NI(),t=fa(),{state:r,getProject:n,getInitiative:a,getTasksByProject:i,getPillar:s}=Pt(),{resources:c}=r,[d,f]=k.useState("execution"),[h,p]=k.useState(!1),[g,v]=k.useState(),[b,y]=k.useState(),[w,j]=k.useState(!1),[T,N]=k.useState(null),[C,E]=k.useState(!1),[O,A]=k.useState(!1),[D,M]=k.useState(),P=e?n(e):null,R=P?a(P.initiativeId):null,L=R?s(R.pillarId):null,te=P?i(P.id):[];if(!P)return o.jsx($ce,{});const{isLoading:ee,getProjectAISuggestion:ue}=Yw(),V=P?ue(P.id):null,K=G=>{v(void 0),y(G),p(!0)},ie=G=>{v(G),y(void 0),p(!0)},re=G=>{N(G),E(!0)},me=()=>{j(!0)},W=()=>{M(void 0),A(!0)},F=G=>{M(G),A(!0)},X=[{id:"overview",label:"Overview",icon:Vu},{id:"execution",label:"Kanban Board",icon:Ai},{id:"wbs",label:"WBS Tree",icon:Lx},{id:"team",label:"Team & Resourcing",icon:ri},{id:"kpis",label:"KPIs & Metrics",icon:gr}],q=te.filter(G=>G.kanbanStatus==="done").length,U=te.length>0?Math.round(q/te.length*100):0;return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("button",{onClick:()=>t("/execution"),className:"flex items-center gap-2 text-text-secondary hover:text-text-primary transition-colors",children:[o.jsx(Fx,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:"Back to Project List"})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[o.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-mono font-semibold",style:{backgroundColor:`${Un[P.departmentCode]?.color}20`,color:Un[P.departmentCode]?.color},children:P.workId}),o.jsx("h1",{className:"text-xl font-bold text-text-primary",children:P.name}),o.jsx(_p,{status:P.ragStatus})]}),o.jsxs("div",{className:"flex items-center gap-3 text-sm text-text-secondary",children:[o.jsxs("span",{children:["Initiative: ",R?.name]}),o.jsx("span",{className:"text-text-muted",children:"|"}),o.jsxs("span",{children:["Pillar: ",L?.name]}),o.jsx("span",{className:"text-text-muted",children:"|"}),o.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs font-medium",style:{backgroundColor:`${Hi[P.category]?.color}20`,color:Hi[P.category]?.color},children:Hi[P.category]?.name})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>t(`/project/${P.id}`),className:"flex items-center gap-2 px-3 py-2 bg-bg-hover rounded-lg hover:bg-bg-secondary transition-colors text-text-secondary hover:text-text-primary",title:"View Project Charter",children:[o.jsx(eS,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:"Charter"})]}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-hover rounded-lg",children:[o.jsx(Ai,{className:"w-5 h-5 text-accent-cyan"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Manager Persona"})]})]})]}),V&&o.jsxs("div",{onClick:()=>t("/insights"),className:"flex items-start gap-3 p-3 bg-rag-amber/10 rounded-lg border border-rag-amber/30 cursor-pointer hover:bg-rag-amber/20 transition-colors group",children:[ee?o.jsx(il,{className:"w-5 h-5 text-rag-amber flex-shrink-0 mt-0.5 animate-spin"}):o.jsx(jn,{className:"w-5 h-5 text-rag-amber flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:"text-sm font-semibold text-rag-amber",children:"Warning: "}),o.jsx("span",{className:"text-sm text-text-primary",children:V})]}),o.jsx(Kt,{className:"w-4 h-4 text-rag-amber opacity-0 group-hover:opacity-100 transition-opacity mt-0.5"})]})]}),o.jsx("div",{className:"border-b border-border",children:o.jsx("div",{className:"flex gap-1",children:X.map(G=>o.jsxs("button",{onClick:()=>f(G.id),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${d===G.id?"border-accent-blue text-accent-blue":"border-transparent text-text-secondary hover:text-text-primary"}`,children:[o.jsx(G.icon,{className:"w-4 h-4"}),G.label]},G.id))})}),d==="overview"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{onClick:()=>f("execution"),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Completion"}),o.jsx(Kt,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsxs("p",{className:"text-3xl font-bold text-text-primary",children:[U,"%"]}),o.jsx("div",{className:"mt-2 h-2 bg-bg-hover rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-accent-blue rounded-full transition-all",style:{width:`${U}%`}})})]}),o.jsxs("div",{onClick:()=>f("execution"),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Total Tasks"}),o.jsx(Kt,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsx("p",{className:"text-3xl font-bold text-text-primary",children:te.length}),o.jsxs("p",{className:"text-sm text-text-muted mt-1",children:[q," completed"]})]}),o.jsxs("div",{onClick:me,className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Budget Spent"}),o.jsx(sl,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsxs("p",{className:"text-3xl font-bold text-text-primary",children:["$",(P.spentBudget/1e3).toFixed(0),"K"]}),o.jsxs("p",{className:"text-sm text-text-muted mt-1",children:["of $",(P.budget/1e3).toFixed(0),"K allocated"]})]})]}),o.jsx(Lce,{projectId:P.id,onMilestoneClick:F,onAddMilestone:W})]}),d==="execution"&&o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Kanban Board"}),o.jsx(qu,{content:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"To Do:"})," Tasks waiting to be started"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"In Progress:"})," Tasks currently being worked on"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Blocked:"})," Tasks that cannot proceed due to dependencies or issues"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Done:"})," Completed tasks"]}),o.jsx("p",{className:"pt-2 border-t border-border",children:"Drag and drop tasks between columns to update their status."})]}),position:"right",size:"lg"})]}),o.jsx(Xe,{onClick:()=>K(),icon:o.jsx(Ai,{className:"w-4 h-4"}),children:"Add Task"})]}),o.jsx(Ece,{tasks:te,resources:c,onAddTask:()=>K(),onEditTask:ie})]}),d==="wbs"&&o.jsxs("div",{children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Work Breakdown Structure"}),o.jsx(qu,{content:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"WBS Tree View:"})," Hierarchical task breakdown showing parent-child relationships"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Subtasks:"})," Click + on any task to add a subtask beneath it"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Dependencies:"})," Tasks can depend on other tasks (shown with link icon)"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Milestones:"})," Key deliverables marked with a flag icon"]}),o.jsx("p",{className:"pt-2 border-t border-border",children:"Click any task to edit its details and WBS configuration."})]}),position:"right",size:"lg"})]})}),o.jsx(Mce,{projectId:P.id,onTaskClick:ie,onAddTask:K})]}),d==="team"&&o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Team Members"}),o.jsx("button",{onClick:()=>t("/resources"),className:"text-sm text-accent-blue hover:text-accent-blue/80",children:"Manage All Resources"})]}),o.jsxs("div",{className:"space-y-3",children:[c.filter(G=>te.some(le=>le.assigneeId===G.id)).map(G=>{const le=te.filter(oe=>oe.assigneeId===G.id),de=le.reduce((oe,Ae)=>oe+Ae.estimatedHours,0),ne=Math.round(de/(G.weeklyCapacity*4)*100);return o.jsxs("div",{onClick:()=>re(G),className:"flex items-center justify-between p-3 bg-bg-hover rounded-lg cursor-pointer hover:bg-bg-secondary transition-colors group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium text-white",style:{backgroundColor:G.avatarColor},children:G.name.split(" ").map(oe=>oe[0]).join("")}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary",children:G.name}),o.jsx("p",{className:"text-xs text-text-muted",children:G.role})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"text-right",children:[o.jsxs("p",{className:"text-sm font-medium text-text-primary",children:[le.length," tasks"]}),o.jsxs("p",{className:`text-xs ${ne>100?"text-rag-red":ne>80?"text-rag-amber":"text-text-muted"}`,children:[ne,"% utilization"]})]}),o.jsx(ha,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})]},G.id)}),c.filter(G=>te.some(le=>le.assigneeId===G.id)).length===0&&o.jsx("p",{className:"text-center text-text-muted py-4",children:"No team members assigned to this project"})]})]}),d==="kpis"&&o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"Project KPIs"}),o.jsx("p",{className:"text-text-secondary",children:"KPI tracking will be linked to the strategic metrics this project impacts."})]}),o.jsx(Ta,{isOpen:h,onClose:()=>{p(!1),y(void 0)},title:g?"Edit Task":b?"Add Subtask":"Add New Task",size:"lg",children:o.jsx(Bce,{projectId:P.id,task:g,parentTaskId:b,onClose:()=>{p(!1),y(void 0)}})}),o.jsx(Ta,{isOpen:w,onClose:()=>j(!1),title:"Edit Project",size:"lg",children:o.jsx(A8,{project:P,onClose:()=>j(!1)})}),o.jsx(Ta,{isOpen:C,onClose:()=>E(!1),title:"Team Member Details",children:T&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-16 h-16 rounded-full flex items-center justify-center text-xl font-medium text-white",style:{backgroundColor:T.avatarColor},children:T.name.split(" ").map(G=>G[0]).join("")}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:T.name}),o.jsx("p",{className:"text-text-secondary",children:T.role}),o.jsx("p",{className:"text-sm text-text-muted",children:T.team})]})]}),o.jsxs("div",{className:"border-t border-border pt-4 space-y-3",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Email"}),o.jsx("span",{className:"text-text-primary",children:T.email||"Not provided"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Weekly Capacity"}),o.jsxs("span",{className:"text-text-primary",children:[T.weeklyCapacity," hours"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-secondary",children:"Tasks on this project"}),o.jsx("span",{className:"text-text-primary",children:te.filter(G=>G.assigneeId===T.id).length})]})]}),o.jsxs("div",{className:"border-t border-border pt-4",children:[o.jsx("h4",{className:"text-sm font-medium text-text-secondary mb-2",children:"Assigned Tasks"}),o.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:te.filter(G=>G.assigneeId===T.id).map(G=>o.jsxs("div",{onClick:()=>{E(!1),ie(G)},className:"p-2 bg-bg-secondary rounded-lg cursor-pointer hover:bg-bg-hover transition-colors",children:[o.jsx("p",{className:"text-sm text-text-primary",children:G.title}),o.jsx("p",{className:"text-xs text-text-muted capitalize",children:G.kanbanStatus.replace("_"," ")})]},G.id))})]}),o.jsx("div",{className:"flex justify-end pt-2",children:o.jsx(Xe,{onClick:()=>t("/resources"),variant:"secondary",children:"View All Resources"})})]})}),o.jsx(Ta,{isOpen:O,onClose:()=>{A(!1),M(void 0)},title:D?"Edit Milestone":"Add New Milestone",size:"lg",children:o.jsx(zce,{projectId:P.id,milestone:D,onClose:()=>{A(!1),M(void 0)}})})]})},Hce=({pillar:e,onClose:t})=>{const{state:r,dispatch:n}=Pt(),a=!!e,[i,s]=k.useState({name:e?.name||"",description:e?.description||"",ragStatus:e?.ragStatus||"green",displayOrder:e?.displayOrder??r.pillars.length}),c=d=>{d.preventDefault();const f={id:e?.id||No(),name:i.name,description:i.description,displayOrder:i.displayOrder,ragStatus:i.ragStatus};n(a?{type:"UPDATE_PILLAR",payload:f}:{type:"ADD_PILLAR",payload:f}),t()};return o.jsxs("form",{onSubmit:c,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Pillar Name *"}),o.jsx("input",{type:"text",value:i.name,onChange:d=>s({...i,name:d.target.value}),placeholder:"e.g., Financial Performance",className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Description"}),o.jsx("textarea",{value:i.description,onChange:d=>s({...i,description:d.target.value}),placeholder:"Describe this strategic pillar...",rows:3,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue resize-none"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Status"}),o.jsxs("select",{value:i.ragStatus,onChange:d=>s({...i,ragStatus:d.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"green",children:"On Track (Green)"}),o.jsx("option",{value:"amber",children:"At Risk (Amber)"}),o.jsx("option",{value:"red",children:"Critical (Red)"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Display Order"}),o.jsx("input",{type:"number",value:i.displayOrder,onChange:d=>s({...i,displayOrder:parseInt(d.target.value)||0}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:t,children:"Cancel"}),o.jsx(Xe,{type:"submit",children:a?"Update Pillar":"Create Pillar"})]})]})},Vce={"pillar-1":o.jsx(sd,{className:"w-5 h-5"}),"pillar-2":o.jsx(ri,{className:"w-5 h-5"}),"pillar-3":o.jsx(mo,{className:"w-5 h-5"}),"pillar-4":o.jsx(J$,{className:"w-5 h-5"})},Gce={"pillar-1":"bg-emerald-500","pillar-2":"bg-blue-500","pillar-3":"bg-orange-500","pillar-4":"bg-purple-500"},Wce=({kpi:e,onSave:t,onClose:r})=>{const[n,a]=k.useState(e),i=s=>{s.preventDefault(),t(n)};return o.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:o.jsxs("div",{className:"bg-bg-card border border-border rounded-xl p-6 w-full max-w-md",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Edit KPI"}),o.jsxs("form",{onSubmit:i,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-text-secondary mb-1",children:"KPI Name"}),o.jsx("input",{type:"text",value:n.name,onChange:s=>a({...n,name:s.target.value}),className:"w-full px-3 py-2 bg-bg-secondary border border-border rounded-lg text-text-primary"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-text-secondary mb-1",children:"Current Value"}),o.jsx("input",{type:"number",value:n.currentValue,onChange:s=>a({...n,currentValue:Number(s.target.value)}),className:"w-full px-3 py-2 bg-bg-secondary border border-border rounded-lg text-text-primary"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-text-secondary mb-1",children:"Target Value"}),o.jsx("input",{type:"number",value:n.targetValue,onChange:s=>a({...n,targetValue:Number(s.target.value)}),className:"w-full px-3 py-2 bg-bg-secondary border border-border rounded-lg text-text-primary"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm text-text-secondary mb-1",children:"Unit"}),o.jsxs("select",{value:n.unit,onChange:s=>a({...n,unit:s.target.value}),className:"w-full px-3 py-2 bg-bg-secondary border border-border rounded-lg text-text-primary",children:[o.jsx("option",{value:"%",children:"Percentage (%)"}),o.jsx("option",{value:"$",children:"Currency ($)"}),o.jsx("option",{value:"score",children:"Score"}),o.jsx("option",{value:"number",children:"Number"})]})]}),o.jsxs("div",{className:"flex gap-3 pt-2",children:[o.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 border border-border rounded-lg text-text-secondary hover:bg-bg-hover",children:"Cancel"}),o.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-accent-blue text-white rounded-lg hover:bg-accent-blue/90",children:"Save"})]})]})]})})},qce=({pillar:e,kpis:t,initiativeCount:r,onEditKPI:n,onViewInitiatives:a})=>{const[i,s]=k.useState(!0),c=(h,p)=>h>p?"up":h<p?"down":"neutral",d=h=>{switch(h.unit){case"%":return`${h.currentValue}%`;case"$":return`$${h.currentValue.toLocaleString()}`;default:return h.currentValue.toString()}},f=h=>Math.min(100,Math.round(h.currentValue/h.targetValue*100));return o.jsxs("div",{className:"w-full bg-bg-card border border-border rounded-xl overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer hover:bg-bg-hover transition-colors",onClick:()=>s(!i),children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${Gce[e.id]} text-white`,children:Vce[e.id]||o.jsx(gr,{className:"w-5 h-5"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:e.name}),o.jsx("p",{className:"text-sm text-text-secondary",children:e.description})]})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx(ic,{status:e.ragStatus,showLabel:!0}),o.jsxs("span",{onClick:h=>{h.stopPropagation(),a?.()},className:"text-sm text-accent-blue hover:text-accent-blue/80 cursor-pointer hover:underline",children:[r," initiatives"]}),i?o.jsx(Ra,{className:"w-5 h-5 text-text-muted"}):o.jsx(ha,{className:"w-5 h-5 text-text-muted"})]})]}),i&&o.jsx("div",{className:"border-t border-border",children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h4",{className:"text-sm font-medium text-text-secondary uppercase tracking-wider",children:"Key Performance Indicators"}),o.jsxs("button",{className:"flex items-center gap-1 text-sm text-accent-blue hover:text-accent-blue/80",children:[o.jsx(Ir,{className:"w-4 h-4"}),"Add KPI"]})]}),o.jsxs("div",{className:"space-y-3",children:[t.map(h=>{const p=c(h.currentValue,h.previousValue),g=f(h);return o.jsxs("div",{className:"flex items-center gap-4 p-3 bg-bg-secondary rounded-lg",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("span",{className:"text-sm font-medium text-text-primary",children:h.name}),p==="up"&&o.jsx(Ac,{className:"w-4 h-4 text-rag-green"}),p==="down"&&o.jsx(tS,{className:"w-4 h-4 text-rag-red"}),p==="neutral"&&o.jsx(a5,{className:"w-4 h-4 text-text-muted"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"flex-1 h-2 bg-bg-hover rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full ${g>=100?"bg-rag-green":g>=70?"bg-rag-amber":"bg-rag-red"}`,style:{width:`${g}%`}})}),o.jsxs("span",{className:"text-xs text-text-muted w-10",children:[g,"%"]})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-lg font-bold text-text-primary",children:d(h)}),o.jsxs("p",{className:"text-xs text-text-muted",children:["Target: ",h.unit==="%"?`${h.targetValue}%`:h.unit==="$"?`$${h.targetValue.toLocaleString()}`:h.targetValue]})]}),o.jsx("button",{onClick:v=>{v.stopPropagation(),n(h)},className:"p-2 text-text-muted hover:text-text-primary hover:bg-bg-hover rounded-lg transition-colors",children:o.jsx(sl,{className:"w-4 h-4"})})]},h.id)}),t.length===0&&o.jsx("p",{className:"text-center text-text-muted py-4",children:"No KPIs defined for this pillar"})]})]})})]})},Kce=()=>{const e=fa(),{state:t,getKPIsByPillar:r,getInitiativesByPillar:n,dispatch:a}=Pt(),{pillars:i}=t,[s,c]=k.useState(null),[d,f]=k.useState(!1),[h,p]=k.useState(null),g=k.useRef({}),v=y=>{a({type:"UPDATE_KPI",payload:y}),c(null)},b={green:i.filter(y=>y.ragStatus==="green").length,amber:i.filter(y=>y.ragStatus==="amber").length,red:i.filter(y=>y.ragStatus==="red").length};return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Strategy Hub"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Manage your Balanced Scorecard and Strategic KPIs"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(gr,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"BSC Framework"})]}),o.jsx(Xe,{onClick:()=>f(!0),icon:o.jsx(Ir,{className:"w-4 h-4"}),children:"Add Pillar"})]})]}),o.jsxs("div",{className:"w-full grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{onClick:()=>e("/portfolio"),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-text-secondary mb-1",children:"Total Pillars"}),o.jsx("p",{className:"text-3xl font-bold text-text-primary",children:i.length})]}),o.jsx(Kt,{className:"w-5 h-5 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>{const y=i.find(w=>w.ragStatus==="green");y&&g.current[y.id]&&g.current[y.id]?.scrollIntoView({behavior:"smooth",block:"center"})},className:`bg-bg-card rounded-xl border border-border p-5 ${b.green>0?"cursor-pointer hover:bg-bg-hover":""} transition-colors group`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-green"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"On Track"})]}),o.jsx("p",{className:"text-3xl font-bold text-rag-green mt-1",children:b.green})]}),b.green>0&&o.jsx(Kt,{className:"w-5 h-5 text-rag-green opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>{const y=i.find(w=>w.ragStatus==="amber");y&&g.current[y.id]&&g.current[y.id]?.scrollIntoView({behavior:"smooth",block:"center"})},className:`bg-bg-card rounded-xl border border-border p-5 ${b.amber>0?"cursor-pointer hover:bg-bg-hover":""} transition-colors group`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-amber"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"At Risk"})]}),o.jsx("p",{className:"text-3xl font-bold text-rag-amber mt-1",children:b.amber})]}),b.amber>0&&o.jsx(Kt,{className:"w-5 h-5 text-rag-amber opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>{const y=i.find(w=>w.ragStatus==="red");y&&g.current[y.id]&&g.current[y.id]?.scrollIntoView({behavior:"smooth",block:"center"})},className:`bg-bg-card rounded-xl border border-border p-5 ${b.red>0?"cursor-pointer hover:bg-bg-hover":""} transition-colors group`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-red"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Critical"})]}),o.jsx("p",{className:"text-3xl font-bold text-rag-red mt-1",children:b.red})]}),b.red>0&&o.jsx(Kt,{className:"w-5 h-5 text-rag-red opacity-0 group-hover:opacity-100 transition-opacity"})]})})]}),o.jsxs("div",{className:"w-full space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Strategy Pillars"}),o.jsx(qu,{content:"Each pillar contains Key Performance Indicators (KPIs) that measure progress toward strategic goals. Click on a pillar to expand and view/edit its KPIs. KPIs are color-coded: Green (meeting target), Amber (within 10%), Red (below 10%).",position:"right",size:"lg"})]}),i.length===0?o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-8 text-center",children:[o.jsx(gr,{className:"w-12 h-12 text-accent-blue mx-auto mb-3"}),o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-2",children:"No Strategy Pillars"}),o.jsx("p",{className:"text-text-secondary mb-4",children:"Create your first strategy pillar to start building your Balanced Scorecard."}),o.jsxs("div",{className:"flex items-center justify-center gap-3",children:[o.jsx(Xe,{onClick:()=>f(!0),icon:o.jsx(Ir,{className:"w-4 h-4"}),children:"Create Pillar"}),o.jsx(Xe,{variant:"secondary",onClick:()=>e("/import"),icon:o.jsx(od,{className:"w-4 h-4"}),children:"Import Data"})]})]}):i.sort((y,w)=>y.displayOrder-w.displayOrder).map(y=>o.jsx("div",{ref:w=>{g.current[y.id]=w},children:o.jsx(qce,{pillar:y,kpis:r(y.id),initiativeCount:n(y.id).length,onEditKPI:c,onViewInitiatives:()=>e(`/portfolio?pillar=${y.id}`)})},y.id))]}),s&&o.jsx(Wce,{kpi:s,onSave:v,onClose:()=>c(null)}),o.jsx(Ta,{isOpen:d,onClose:()=>f(!1),title:"Add New Strategy Pillar",children:o.jsx(Hce,{onClose:()=>f(!1)})})]})},Yce=({type:e,title:t,description:r,action:n,link:a})=>{const s={warning:{bg:"bg-rag-amber/10",border:"border-rag-amber/30",icon:o.jsx(jn,{className:"w-5 h-5 text-rag-amber"}),badge:"bg-rag-amber/20 text-rag-amber"},success:{bg:"bg-rag-green/10",border:"border-rag-green/30",icon:o.jsx(yr,{className:"w-5 h-5 text-rag-green"}),badge:"bg-rag-green/20 text-rag-green"},info:{bg:"bg-accent-blue/10",border:"border-accent-blue/30",icon:o.jsx(L0,{className:"w-5 h-5 text-accent-blue"}),badge:"bg-accent-blue/20 text-accent-blue"},critical:{bg:"bg-rag-red/10",border:"border-rag-red/30",icon:o.jsx(Qw,{className:"w-5 h-5 text-rag-red"}),badge:"bg-rag-red/20 text-rag-red"}}[e];return o.jsx("div",{className:`${s.bg} border ${s.border} rounded-xl p-4`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${s.badge}`,children:s.icon}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-medium text-text-primary mb-1",children:t}),o.jsx("p",{className:"text-sm text-text-secondary",children:r}),n&&a&&o.jsxs(Xn,{to:a,className:"inline-flex items-center gap-1 mt-2 text-sm text-accent-blue hover:text-accent-blue/80",children:[n,o.jsx(Kt,{className:"w-4 h-4"})]})]})]})})},Xce=e=>{switch(e){case"critical":return"critical";case"warning":return"warning";case"success":return"success";default:return"info"}},Zce=e=>{switch(e){case"schedule":case"scope":return"/execution";case"cost":return"/portfolio";case"resource":return"/resources";case"strategic":case"quality":return"/strategy";default:return"/insights"}},Qce=e=>{switch(e){case"schedule":case"scope":return"View Execution";case"cost":return"View Portfolio";case"resource":return"View Resources";case"strategic":case"quality":return"View Strategy";default:return"View Details"}},Jce=()=>{const e=fa(),{state:t}=Pt(),{pillars:r,initiatives:n,projects:a,tasks:i}=t,{isConfigured:s,isLoading:c,analysis:d,refreshAnalysis:f,lastUpdated:h,error:p,ruleBasedInsights:g,ruleBasedSummary:v}=Yw(),b=k.useRef(null),y=g.map(E=>({type:Xce(E.severity),title:E.title,description:E.description,action:E.suggestedAction?Qce(E.category):void 0,link:E.suggestedAction?Zce(E.category):void 0})),w=y.filter(E=>E.type==="critical").length,j=y.filter(E=>E.type==="warning").length,T=y.filter(E=>E.type==="success").length,N=r.length>0||n.length>0||a.length>0||i.length>0,C=[{metric:"Overall Health",trend:r.filter(E=>E.ragStatus==="green").length>=r.length/2?"up":"down",value:`${Math.round(r.filter(E=>E.ragStatus==="green").length/r.length*100)}%`,description:"Pillars on track"},{metric:"Initiative Progress",trend:n.filter(E=>E.ragStatus==="green").length>=n.length/2?"up":"down",value:`${n.filter(E=>E.ragStatus==="green").length}/${n.length}`,description:"Initiatives healthy"},{metric:"Task Completion",trend:i.filter(E=>E.kanbanStatus==="done").length>i.length/3?"up":"neutral",value:`${Math.round(i.filter(E=>E.kanbanStatus==="done").length/i.length*100)}%`,description:"Tasks completed"},{metric:"Budget Utilization",trend:"neutral",value:`${Math.round(n.reduce((E,O)=>E+O.spentBudget,0)/n.reduce((E,O)=>E+O.budget,0)*100)}%`,description:"Budget consumed"}];return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Insights Center"}),o.jsx("p",{className:"text-text-secondary mt-1",children:s?`Rule-based analysis + AI enhancement ${h?`- AI updated: ${new Date(h).toLocaleString()}`:""}`:"Rule-based analysis active. Configure Claude API for AI-enhanced insights."})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[s?o.jsx(Xe,{onClick:()=>f(!0),variant:"secondary",size:"sm",disabled:c,icon:c?o.jsx(il,{className:"w-4 h-4 animate-spin"}):o.jsx(co,{className:"w-4 h-4"}),children:c?"Analyzing...":"Refresh AI"}):o.jsx(Xe,{onClick:()=>e("/settings"),variant:"secondary",size:"sm",icon:o.jsx(mo,{className:"w-4 h-4"}),children:"Enable AI"}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(Vu,{className:"w-5 h-5 text-accent-cyan"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Rules"}),s&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-text-muted",children:"+"}),c?o.jsx(il,{className:"w-5 h-5 text-accent-purple animate-spin"}):o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"AI"})]})]})]})]}),p&&o.jsx("div",{className:"bg-rag-red/10 border border-rag-red/30 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(jn,{className:"w-5 h-5 text-rag-red"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-rag-red",children:"AI Analysis Error"}),o.jsx("p",{className:"text-sm text-text-secondary",children:p})]})]})}),!N&&o.jsx("div",{className:"bg-bg-card rounded-xl border border-border p-8 text-center",children:o.jsxs("div",{className:"max-w-md mx-auto",children:[o.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-accent-blue/10 rounded-full flex items-center justify-center",children:o.jsx(Ea,{className:"w-8 h-8 text-accent-blue"})}),o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Data to Analyze"}),o.jsx("p",{className:"text-text-secondary mb-6",children:"AI Insights will appear here once you have data in your system. Start by importing data or creating your first Strategy Pillar."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[o.jsx(Xe,{onClick:()=>e("/import"),icon:o.jsx(zT,{className:"w-4 h-4"}),children:"Import Data"}),o.jsx(Xe,{onClick:()=>e("/settings"),variant:"secondary",icon:o.jsx(co,{className:"w-4 h-4"}),children:"Load Demo Data"})]})]})}),N&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:`p-2 rounded-lg ${d?"bg-accent-purple/20":"bg-accent-cyan/20"}`,children:d?o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"}):o.jsx(RH,{className:"w-5 h-5 text-accent-cyan"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:`text-sm font-semibold mb-2 ${d?"text-accent-purple":"text-accent-cyan"}`,children:d?"AI Executive Summary":"Executive Summary"}),o.jsx("p",{className:"text-text-primary mb-4",children:d?.executiveSummary.summary||v.summary}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-rag-red mb-2",children:"Key Risks"}),o.jsxs("ul",{className:"space-y-1",children:[(d?.executiveSummary.keyRisks||v.keyRisks).slice(0,3).map((E,O)=>o.jsxs("li",{className:"text-sm text-text-secondary flex items-start gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-rag-red mt-1.5 flex-shrink-0"}),E]},O)),(d?.executiveSummary.keyRisks||v.keyRisks).length===0&&o.jsx("li",{className:"text-sm text-text-muted",children:"No critical risks identified"})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-rag-green mb-2",children:"Opportunities"}),o.jsxs("ul",{className:"space-y-1",children:[(d?.executiveSummary.opportunities||v.opportunities).slice(0,3).map((E,O)=>o.jsxs("li",{className:"text-sm text-text-secondary flex items-start gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-rag-green mt-1.5 flex-shrink-0"}),E]},O)),(d?.executiveSummary.opportunities||v.opportunities).length===0&&o.jsx("li",{className:"text-sm text-text-muted",children:"Continue monitoring performance"})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-semibold text-accent-blue mb-2",children:"Recommendations"}),o.jsxs("ul",{className:"space-y-1",children:[(d?.executiveSummary.recommendations||v.recommendations).slice(0,3).map((E,O)=>o.jsxs("li",{className:"text-sm text-text-secondary flex items-start gap-2",children:[o.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-accent-blue mt-1.5 flex-shrink-0"}),E]},O)),(d?.executiveSummary.recommendations||v.recommendations).length===0&&o.jsx("li",{className:"text-sm text-text-muted",children:"No immediate actions required"})]})]})]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsx("div",{onClick:()=>b.current?.scrollIntoView({behavior:"smooth",block:"start"}),className:"bg-bg-card rounded-xl border border-border p-5 cursor-pointer hover:bg-bg-hover transition-colors group",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-accent-purple/20 rounded-lg",children:o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:y.length}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Total Insights"})]})]}),o.jsx(Kt,{className:"w-4 h-4 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>e("/strategy"),className:`bg-bg-card rounded-xl border border-border p-5 ${w>0?"cursor-pointer hover:bg-bg-hover":""} transition-colors group`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-rag-red/20 rounded-lg",children:o.jsx(Qw,{className:"w-5 h-5 text-rag-red"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-rag-red",children:w}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Critical Issues"})]})]}),w>0&&o.jsx(Kt,{className:"w-4 h-4 text-rag-red opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>e("/portfolio?filter=at-risk"),className:`bg-bg-card rounded-xl border border-border p-5 ${j>0?"cursor-pointer hover:bg-bg-hover":""} transition-colors group`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-rag-amber/20 rounded-lg",children:o.jsx(jn,{className:"w-5 h-5 text-rag-amber"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-rag-amber",children:j}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Warnings"})]})]}),j>0&&o.jsx(Kt,{className:"w-4 h-4 text-rag-amber opacity-0 group-hover:opacity-100 transition-opacity"})]})}),o.jsx("div",{onClick:()=>e("/strategy"),className:`bg-bg-card rounded-xl border border-border p-5 ${T>0?"cursor-pointer hover:bg-bg-hover":""} transition-colors group`,children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-rag-green/20 rounded-lg",children:o.jsx(yr,{className:"w-5 h-5 text-rag-green"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl font-bold text-rag-green",children:T}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Positive Trends"})]})]}),T>0&&o.jsx(Kt,{className:"w-4 h-4 text-rag-green opacity-0 group-hover:opacity-100 transition-opacity"})]})})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("h2",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(zT,{className:"w-5 h-5 text-accent-cyan"}),"Trend Analysis"]}),o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:C.map((E,O)=>{const A=()=>{switch(E.metric){case"Overall Health":return"/strategy";case"Initiative Progress":return"/portfolio";case"Task Completion":return"/execution";case"Budget Utilization":return"/portfolio";default:return"/"}};return o.jsxs("div",{onClick:()=>e(A()),className:"bg-bg-secondary rounded-lg p-4 cursor-pointer hover:bg-bg-hover transition-colors group",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[E.trend==="up"&&o.jsx(Ac,{className:"w-4 h-4 text-rag-green"}),E.trend==="down"&&o.jsx(tS,{className:"w-4 h-4 text-rag-red"}),E.trend==="neutral"&&o.jsx(gr,{className:"w-4 h-4 text-text-muted"}),o.jsx("span",{className:"text-sm text-text-secondary",children:E.metric})]}),o.jsx(Kt,{className:"w-3 h-3 text-text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:E.value}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:E.description})]},O)})})]}),o.jsxs("div",{ref:b,children:[o.jsxs("h2",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(L0,{className:"w-5 h-5 text-rag-amber"}),"Rule-Based Insights",o.jsxs("span",{className:"text-xs text-text-muted font-normal ml-2",children:[g.length," insights from ",new Set(g.map(E=>E.category)).size," categories"]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.length>0?y.map((E,O)=>o.jsx(Yce,{...E},O)):o.jsxs("div",{className:"col-span-2 bg-bg-secondary rounded-xl p-6 text-center",children:[o.jsx(yr,{className:"w-8 h-8 text-rag-green mx-auto mb-2"}),o.jsx("p",{className:"text-text-secondary",children:"All metrics within healthy thresholds"})]})})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"Recommended Actions"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs(Xn,{to:"/strategy",className:"flex items-center gap-3 p-4 bg-bg-secondary rounded-lg hover:bg-bg-hover transition-colors",children:[o.jsx(gr,{className:"w-8 h-8 text-accent-blue"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Review Strategy"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Update KPI targets"})]})]}),o.jsxs(Xn,{to:"/portfolio",className:"flex items-center gap-3 p-4 bg-bg-secondary rounded-lg hover:bg-bg-hover transition-colors",children:[o.jsx(sd,{className:"w-8 h-8 text-rag-green"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Check Budgets"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Review allocations"})]})]}),o.jsxs(Xn,{to:"/resources",className:"flex items-center gap-3 p-4 bg-bg-secondary rounded-lg hover:bg-bg-hover transition-colors",children:[o.jsx(ri,{className:"w-8 h-8 text-accent-purple"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Manage Resources"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Optimize assignments"})]})]})]})]})]})]})};var vx={};vx.version="0.18.5";var O8=1252,eue=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$N={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},HN=function(e){eue.indexOf(e)!=-1&&(O8=$N[0]=e)};function tue(){HN(1252)}var Ki=function(e){HN(e)};function VN(){Ki(1200),tue()}function BO(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function rue(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function D8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Of=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?rue(e.slice(2)):t==254&&r==255?D8(e.slice(2)):t==65279?e.slice(1):e},Zm=function(t){return String.fromCharCode(t)},UO=function(t){return String.fromCharCode(t)},g0,so="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function v0(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0,d=0,f=0;f<e.length;)r=e.charCodeAt(f++),i=r>>2,n=e.charCodeAt(f++),s=(r&3)<<4|n>>4,a=e.charCodeAt(f++),c=(n&15)<<2|a>>6,d=a&63,isNaN(n)?c=d=64:isNaN(a)&&(d=64),t+=so.charAt(i)+so.charAt(s)+so.charAt(c)+so.charAt(d);return t}function ai(e){var t="",r=0,n=0,a=0,i=0,s=0,c=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)i=so.indexOf(e.charAt(f++)),s=so.indexOf(e.charAt(f++)),r=i<<2|s>>4,t+=String.fromCharCode(r),c=so.indexOf(e.charAt(f++)),n=(s&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),d=so.indexOf(e.charAt(f++)),a=(c&3)<<6|d,d!==64&&(t+=String.fromCharCode(a));return t}var xt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),kl=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function yo(e){return xt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function zO(e){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Xa=function(t){return xt?kl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Rg(e){if(typeof ArrayBuffer>"u")return Xa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Eo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function nue(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function GN(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return GN(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Nn=xt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:kl(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function aue(e){for(var t=[],r=0,n=e.length+250,a=yo(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var c=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|c>>6&15|(s&3)<<4,a[r++]=128|c&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=yo(65535),n=65530)}return t.push(a.slice(0,r)),Nn(t)}var ua=/\u0000/g,Df=/[\u0001-\u0006]/g;function Uu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yi(e,t){var r=""+e;return r.length>=t?r:Or("0",t-r.length)+r}function WN(e,t){var r=""+e;return r.length>=t?r:Or(" ",t-r.length)+r}function yx(e,t){var r=""+e;return r.length>=t?r:r+Or(" ",t-r.length)}function iue(e,t){var r=""+Math.round(e);return r.length>=t?r:Or("0",t-r.length)+r}function sue(e,t){var r=""+e;return r.length>=t?r:Or("0",t-r.length)+r}var $O=Math.pow(2,32);function _u(e,t){if(e>$O||e<-$O)return iue(e,t);var r=Math.round(e);return sue(r,t)}function bx(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var HO=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Gb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function lue(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var tt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},VO={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},oue={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wx(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,c=0,d=1,f=0,h=0,p=Math.floor(a);f<t&&(p=Math.floor(a),c=p*s+i,h=p*f+d,!(a-p<5e-8));)a=1/(a-p),i=s,s=c,d=f,f=h;if(h>t&&(f>t?(h=d,c=i):(h=f,c=s)),!r)return[0,n*c,h];var g=Math.floor(n*c/h);return[g,n*c-g*h,h]}function lo(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),s=[d.getFullYear(),d.getMonth()+1,d.getDate()],i=d.getDay(),n<60&&(i=(i+6)%7),r&&(i=mue(d,s))}return c.y=s[0],c.m=s[1],c.d=s[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var I8=new Date(1899,11,31,0,0,0),cue=I8.getTime(),uue=new Date(1900,2,1,0,0,0);function R8(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=uue&&(r+=1440*60*1e3),(r-(cue+(e.getTimezoneOffset()-I8.getTimezoneOffset())*6e4))/(1440*60*1e3)}function qN(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function due(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fue(e){var t=e<0?12:11,r=qN(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function hue(e){var t=qN(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function y0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=fue(e):t===10?r=e.toFixed(10).substr(0,12):r=hue(e),qN(due(r.toUpperCase()))}function Nc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):y0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ii(14,R8(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function mue(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function pue(e,t,r,n){var a="",i=0,s=0,c=r.y,d,f=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:d=c%100,f=2;break;default:d=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:d=r.m,f=t.length;break;case 3:return Gb[r.m-1][1];case 5:return Gb[r.m-1][0];default:return Gb[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=r.d,f=t.length;break;case 3:return HO[r.q][0];default:return HO[r.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Yi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Yi(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=r.D*24+r.H;break;case"[m]":case"[mm]":d=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":d=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:d=c,f=1;break}var h=f>0?Yi(d,f):"";return h}function oo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var M8=/%/g;function xue(e,t,r){var n=t.replace(M8,""),a=t.length-n.length;return rl(e,n,r*Math.pow(10,2*a))+Or("%",a)}function gue(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function P8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+P8(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,h){return d+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var F8=/# (\?+)( ?)\/( ?)(\d+)/;function vue(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,c=n;return r+(i===0?"":""+i)+" "+(s===0?Or(" ",e[1].length+1+e[4].length):WN(s,e[1].length)+e[2]+"/"+e[3]+Yi(c,e[4].length))}function yue(e,t,r){return r+(t===0?"":""+t)+Or(" ",e[1].length+2+e[4].length)}var L8=/^#*0*\.([0#]+)/,B8=/\).*[0#]/,U8=/\(###\) ###\\?-####/;function la(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function GO(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function WO(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function bue(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function wue(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ni(e,t,r){if(e.charCodeAt(0)===40&&!t.match(B8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ni("n",n,r):"("+Ni("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return gue(e,t,r);if(t.indexOf("%")!==-1)return xue(e,t,r);if(t.indexOf("E")!==-1)return P8(t,r);if(t.charCodeAt(0)===36)return"$"+Ni(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,d=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+_u(d,t.length);if(t.match(/^[#?]+$/))return a=_u(r,0),a==="0"&&(a=""),a.length>t.length?a:la(t.substr(0,t.length-a.length))+a;if(i=t.match(F8))return vue(i,d,f);if(t.match(/^#+0+$/))return f+_u(d,t.length-t.indexOf("0"));if(i=t.match(L8))return a=GO(r,i[1].length).replace(/^([^\.]+)$/,"$1."+la(i[1])).replace(/\.$/,"."+la(i[1])).replace(/\.(\d*)$/,function(b,y){return"."+y+Or("0",la(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+GO(d,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+oo(_u(d,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ni(e,t,-r):oo(""+(Math.floor(r)+bue(r,i[1].length)))+"."+Yi(WO(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ni(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Uu(Ni(e,t.replace(/[\\-]/g,""),r)),s=0,Uu(Uu(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<a.length?a.charAt(s++):b==="0"?"0":""}));if(t.match(U8))return a=Ni(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=wx(d,Math.pow(10,s)-1,!1),a=""+f,h=rl("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=yx(c[2],s),h.length<i[4].length&&(h=la(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=wx(d,Math.pow(10,s)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?WN(c[1],s)+i[2]+"/"+i[3]+yx(c[2],s):Or(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=_u(r,0),t.length<=a.length?a:la(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=t.indexOf(".")-s,g=t.length-a.length-p;return la(t.substr(0,p)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=WO(r,i[1].length),r<0?"-"+Ni(e,t,-r):oo(wue(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Yi(0,3-b.length):"")+b})+"."+Yi(s,i[1].length);switch(t){case"###,##0.00":return Ni(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var v=oo(_u(d,0));return v!=="0"?f+v:"";case"###,###.00":return Ni(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ni(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Sue(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Nue(e,t,r){var n=t.replace(M8,""),a=t.length-n.length;return rl(e,n,r*Math.pow(10,2*a))+Or("%",a)}function z8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+z8(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,d,f,h){return d+f+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function hs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(B8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hs("n",n,r):"("+hs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Sue(e,t,r);if(t.indexOf("%")!==-1)return Nue(e,t,r);if(t.indexOf("E")!==-1)return z8(t,r);if(t.charCodeAt(0)===36)return"$"+hs(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,c,d=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Yi(d,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:la(t.substr(0,t.length-a.length))+a;if(i=t.match(F8))return yue(i,d,f);if(t.match(/^#+0+$/))return f+Yi(d,t.length-t.indexOf("0"));if(i=t.match(L8))return a=(""+r).replace(/^([^\.]+)$/,"$1."+la(i[1])).replace(/\.$/,"."+la(i[1])),a=a.replace(/\.(\d*)$/,function(b,y){return"."+y+Or("0",la(i[1]).length-y.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return f+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return f+oo(""+d);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hs(e,t,-r):oo(""+r)+"."+Or("0",i[1].length);if(i=t.match(/^#,#*,#0/))return hs(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Uu(hs(e,t.replace(/[\\-]/g,""),r)),s=0,Uu(Uu(t.replace(/\\/g,"")).replace(/[0#]/g,function(b){return s<a.length?a.charAt(s++):b==="0"?"0":""}));if(t.match(U8))return a=hs(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=wx(d,Math.pow(10,s)-1,!1),a=""+f,h=rl("n",i[1],c[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=yx(c[2],s),h.length<i[4].length&&(h=la(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=wx(d,Math.pow(10,s)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?WN(c[1],s)+i[2]+"/"+i[3]+yx(c[2],s):Or(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:la(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var p=t.indexOf(".")-s,g=t.length-a.length-p;return la(t.substr(0,p)+a+t.substr(t.length-g))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+hs(e,t,-r):oo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?Yi(0,3-b.length):"")+b})+"."+Yi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var v=oo(""+d);return v!=="0"?f+v:"";default:if(t.match(/\.[0#?]*$/))return hs(e,t.slice(0,t.lastIndexOf(".")),r)+la(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rl(e,t,r){return(r|0)===r?hs(e,t,r):Ni(e,t,r)}function kue(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var $8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mc(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":bx(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match($8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function _ue(e,t,r,n){for(var a=[],i="",s=0,c="",d="t",f,h,p,g="H";s<e.length;)switch(c=e.charAt(s)){case"G":if(!bx(e,s))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(p=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(p);a[a.length]={t:"t",v:i},++s;break;case"\\":var v=e.charAt(++s),b=v==="("||v===")"?v:"t";a[a.length]={t:b,v},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=lo(t,r,e.charAt(s+1)==="2"),f==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},d=c,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=lo(t,r),f==null))return"";for(i=c;++s<e.length&&e.charAt(s).toLowerCase()===c;)i+=c;c==="m"&&d.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=g),a[a.length]={t:c,v:i},d=c;break;case"A":case"a":case"":var y={t:c,v:c};if(f==null&&(f=lo(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(y.v=f.H>=12?"P":"A"),y.t="T",g="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(y.v=f.H>=12?"PM":"AM"),y.t="T",s+=5,g="h"):e.substr(s,5).toUpperCase()==="/"?(f!=null&&(y.v=f.H>=12?"":""),y.t="T",s+=5,g="h"):(y.t="t",++s),f==null&&y.t==="T")return"";a[a.length]=y,d=c;break;case"[":for(i=c;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match($8)){if(f==null&&(f=lo(t,r),f==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},d=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mc(e)||(a[a.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=c;++s<e.length&&(c=e.charAt(s))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++s<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(s))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++s)===c;)i+=c;a[a.length]={t:c,v:i},d=c;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++s;break}var w=0,j=0,T;for(s=a.length-1,d="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=g,d="h",w<1&&(w=1);break;case"s":(T=a[s].v.match(/\.0+$/))&&(j=Math.max(j,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":d=a[s].t;break;case"m":d==="s"&&(a[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&a[s].v.match(/[Hh]/)&&(w=1),w<2&&a[s].v.match(/[Mm]/)&&(w=2),w<3&&a[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var N="",C;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=pue(a[s].t.charCodeAt(0),a[s].v,f,j),a[s].t="t";break;case"n":case"?":for(C=s+1;a[C]!=null&&((c=a[C].t)==="?"||c==="D"||(c===" "||c==="t")&&a[C+1]!=null&&(a[C+1].t==="?"||a[C+1].t==="t"&&a[C+1].v==="/")||a[s].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[C].v==="/"||a[C].v===" "&&a[C+1]!=null&&a[C+1].t=="?"));)a[s].v+=a[C].v,a[C]={v:"",t:";"},++C;N+=a[s].v,s=C-1;break;case"G":a[s].t="t",a[s].v=Nc(t,r);break}var E="",O,A;if(N.length>0){N.charCodeAt(0)==40?(O=t<0&&N.charCodeAt(0)===45?-t:t,A=rl("n",N,O)):(O=t<0&&n>1?-t:t,A=rl("n",N,O),O<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),C=A.length-1;var D=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){D=s;break}var M=a.length;if(D===a.length&&A.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(C>=a[s].v.length-1?(C-=a[s].v.length,a[s].v=A.substr(C+1,a[s].v.length)):C<0?a[s].v="":(a[s].v=A.substr(0,C+1),C=-1),a[s].t="t",M=s);C>=0&&M<a.length&&(a[M].v=A.substr(0,C+1)+a[M].v)}else if(D!==a.length&&A.indexOf("E")===-1){for(C=A.indexOf(".")-1,s=D;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(h=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")-1:a[s].v.length-1,E=a[s].v.substr(h+1);h>=0;--h)C>=0&&(a[s].v.charAt(h)==="0"||a[s].v.charAt(h)==="#")&&(E=A.charAt(C--)+E);a[s].v=E,a[s].t="t",M=s}for(C>=0&&M<a.length&&(a[M].v=A.substr(0,C+1)+a[M].v),C=A.indexOf(".")+1,s=D;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==D)){for(h=a[s].v.indexOf(".")>-1&&s===D?a[s].v.indexOf(".")+1:0,E=a[s].v.substr(0,h);h<a[s].v.length;++h)C<A.length&&(E+=A.charAt(C++));a[s].v=E,a[s].t="t",M=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(O=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=rl(a[s].t,a[s].v,O),a[s].t="t");var P="";for(s=0;s!==a.length;++s)a[s]!=null&&(P+=a[s].v);return P}var qO=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function KO(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function jue(e,t){var r=kue(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(qO),c=r[1].match(qO);return KO(t,s)?[n,r[0]]:KO(t,c)?[n,r[1]]:[n,r[s!=null&&c!=null?2:1]]}return[n,i]}function ii(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:tt)[e],n==null&&(n=r.table&&r.table[VO[e]]||tt[VO[e]]),n==null&&(n=oue[e]||"General");break}if(bx(n,0))return Nc(t,r);t instanceof Date&&(t=R8(t,r.date1904));var a=jue(n,t);if(bx(a[1]))return Nc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return _ue(a[1],t,r,a[0])}function vs(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(tt[r]==null){t<0&&(t=r);continue}if(tt[r]==e){t=r;break}}t<0&&(t=391)}return tt[t]=e,t}function fh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&vs(e[t],t)}function bd(){tt=lue()}var H8={format:ii,load:vs,_table:tt,load_table:fh,parse_date_code:lo,is_date:Mc,get_table:function(){return H8._table=tt}},Eue={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},V8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Tue(e){var t=typeof e=="number"?tt[e]:e;return t=t.replace(V8,"(\\d+)"),new RegExp("^"+t+"$")}function Cue(e,t,r){var n=-1,a=-1,i=-1,s=-1,c=-1,d=-1;(t.match(V8)||[]).forEach(function(p,g){var v=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=v;break;case"d":i=v;break;case"h":s=v;break;case"s":d=v;break;case"m":s>=0?c=v:a=v;break}}),d>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return s==-1&&c==-1&&d==-1?f:n==-1&&a==-1&&i==-1?h:f+"T"+h}var Aue=(function(){var e={};e.version="1.2.0";function t(){for(var A=0,D=new Array(256),M=0;M!=256;++M)A=M,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,D[M]=A;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(A){var D=0,M=0,P=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)R[P]=A[P];for(P=0;P!=256;++P)for(M=A[P],D=256+P;D<4096;D+=256)M=R[D]=M>>>8^A[M&255];var L=[];for(P=1;P!=16;++P)L[P-1]=typeof Int32Array<"u"?R.subarray(P*256,P*256+256):R.slice(P*256,P*256+256);return L}var a=n(r),i=a[0],s=a[1],c=a[2],d=a[3],f=a[4],h=a[5],p=a[6],g=a[7],v=a[8],b=a[9],y=a[10],w=a[11],j=a[12],T=a[13],N=a[14];function C(A,D){for(var M=D^-1,P=0,R=A.length;P<R;)M=M>>>8^r[(M^A.charCodeAt(P++))&255];return~M}function E(A,D){for(var M=D^-1,P=A.length-15,R=0;R<P;)M=N[A[R++]^M&255]^T[A[R++]^M>>8&255]^j[A[R++]^M>>16&255]^w[A[R++]^M>>>24]^y[A[R++]]^b[A[R++]]^v[A[R++]]^g[A[R++]]^p[A[R++]]^h[A[R++]]^f[A[R++]]^d[A[R++]]^c[A[R++]]^s[A[R++]]^i[A[R++]]^r[A[R++]];for(P+=15;R<P;)M=M>>>8^r[(M^A[R++])&255];return~M}function O(A,D){for(var M=D^-1,P=0,R=A.length,L=0,te=0;P<R;)L=A.charCodeAt(P++),L<128?M=M>>>8^r[(M^L)&255]:L<2048?(M=M>>>8^r[(M^(192|L>>6&31))&255],M=M>>>8^r[(M^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,te=A.charCodeAt(P++)&1023,M=M>>>8^r[(M^(240|L>>8&7))&255],M=M>>>8^r[(M^(128|L>>2&63))&255],M=M>>>8^r[(M^(128|te>>6&15|(L&3)<<4))&255],M=M>>>8^r[(M^(128|te&63))&255]):(M=M>>>8^r[(M^(224|L>>12&15))&255],M=M>>>8^r[(M^(128|L>>6&63))&255],M=M>>>8^r[(M^(128|L&63))&255]);return~M}return e.table=r,e.bstr=C,e.buf=E,e.str=O,e})(),Qe=(function(){var t={};t.version="1.2.1";function r(B,J){for(var Y=B.split("/"),Z=J.split("/"),Q=0,ae=0,ge=Math.min(Y.length,Z.length);Q<ge;++Q){if(ae=Y[Q].length-Z[Q].length)return ae;if(Y[Q]!=Z[Q])return Y[Q]<Z[Q]?-1:1}return Y.length-Z.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var J=B.lastIndexOf("/");return J===-1?B:B.slice(0,J+1)}function a(B){if(B.charAt(B.length-1)=="/")return a(B.slice(0,-1));var J=B.lastIndexOf("/");return J===-1?B:B.slice(J+1)}function i(B,J){typeof J=="string"&&(J=new Date(J));var Y=J.getHours();Y=Y<<6|J.getMinutes(),Y=Y<<5|J.getSeconds()>>>1,B.write_shift(2,Y);var Z=J.getFullYear()-1980;Z=Z<<4|J.getMonth()+1,Z=Z<<5|J.getDate(),B.write_shift(2,Z)}function s(B){var J=B.read_shift(2)&65535,Y=B.read_shift(2)&65535,Z=new Date,Q=Y&31;Y>>>=5;var ae=Y&15;Y>>>=4,Z.setMilliseconds(0),Z.setFullYear(Y+1980),Z.setMonth(ae-1),Z.setDate(Q);var ge=J&31;J>>>=5;var je=J&63;return J>>>=6,Z.setHours(J),Z.setMinutes(je),Z.setSeconds(ge<<1),Z}function c(B){Bn(B,0);for(var J={},Y=0;B.l<=B.length-4;){var Z=B.read_shift(2),Q=B.read_shift(2),ae=B.l+Q,ge={};Z===21589&&(Y=B.read_shift(1),Y&1&&(ge.mtime=B.read_shift(4)),Q>5&&(Y&2&&(ge.atime=B.read_shift(4)),Y&4&&(ge.ctime=B.read_shift(4))),ge.mtime&&(ge.mt=new Date(ge.mtime*1e3))),B.l=ae,J[Z]=ge}return J}var d;function f(){return d||(d={})}function h(B,J){if(B[0]==80&&B[1]==75)return js(B,J);if((B[0]|32)==109&&(B[1]|32)==105)return xa(B,J);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var Y=3,Z=512,Q=0,ae=0,ge=0,je=0,ve=0,ye=[],we=B.slice(0,512);Bn(we,0);var Oe=p(we);switch(Y=Oe[0],Y){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(Oe[1]==0)return js(B,J);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}Z!==512&&(we=B.slice(0,Z),Bn(we,28));var Pe=B.slice(0,Z);g(we,Y);var ze=we.read_shift(4,"i");if(Y===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);we.l+=4,ge=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),je=we.read_shift(4,"i"),Q=we.read_shift(4,"i"),ve=we.read_shift(4,"i"),ae=we.read_shift(4,"i");for(var De=-1,Ue=0;Ue<109&&(De=we.read_shift(4,"i"),!(De<0));++Ue)ye[Ue]=De;var qe=v(B,Z);w(ve,ae,qe,Z,ye);var nr=T(qe,ge,ye,Z);nr[ge].name="!Directory",Q>0&&je!==te&&(nr[je].name="!MiniFAT"),nr[ye[0]].name="!FAT",nr.fat_addrs=ye,nr.ssz=Z;var ar={},mr=[],li=[],Oo=[];N(ge,nr,qe,mr,Q,ar,li,je),b(li,Oo,mr),mr.shift();var Tl={FileIndex:li,FullPaths:Oo};return J&&J.raw&&(Tl.raw={header:Pe,sectors:qe}),Tl}function p(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(ee,"Header Signature: "),B.l+=16;var J=B.read_shift(2,"u");return[B.read_shift(2,"u"),J]}function g(B,J){var Y=9;switch(B.l+=2,Y=B.read_shift(2)){case 9:if(J!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(J!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function v(B,J){for(var Y=Math.ceil(B.length/J)-1,Z=[],Q=1;Q<Y;++Q)Z[Q-1]=B.slice(Q*J,(Q+1)*J);return Z[Y-1]=B.slice(Y*J),Z}function b(B,J,Y){for(var Z=0,Q=0,ae=0,ge=0,je=0,ve=Y.length,ye=[],we=[];Z<ve;++Z)ye[Z]=we[Z]=Z,J[Z]=Y[Z];for(;je<we.length;++je)Z=we[je],Q=B[Z].L,ae=B[Z].R,ge=B[Z].C,ye[Z]===Z&&(Q!==-1&&ye[Q]!==Q&&(ye[Z]=ye[Q]),ae!==-1&&ye[ae]!==ae&&(ye[Z]=ye[ae])),ge!==-1&&(ye[ge]=Z),Q!==-1&&Z!=ye[Z]&&(ye[Q]=ye[Z],we.lastIndexOf(Q)<je&&we.push(Q)),ae!==-1&&Z!=ye[Z]&&(ye[ae]=ye[Z],we.lastIndexOf(ae)<je&&we.push(ae));for(Z=1;Z<ve;++Z)ye[Z]===Z&&(ae!==-1&&ye[ae]!==ae?ye[Z]=ye[ae]:Q!==-1&&ye[Q]!==Q&&(ye[Z]=ye[Q]));for(Z=1;Z<ve;++Z)if(B[Z].type!==0){if(je=Z,je!=ye[je])do je=ye[je],J[Z]=J[je]+"/"+J[Z];while(je!==0&&ye[je]!==-1&&je!=ye[je]);ye[Z]=-1}for(J[0]+="/",Z=1;Z<ve;++Z)B[Z].type!==2&&(J[Z]+="/")}function y(B,J,Y){for(var Z=B.start,Q=B.size,ae=[],ge=Z;Y&&Q>0&&ge>=0;)ae.push(J.slice(ge*L,ge*L+L)),Q-=L,ge=Qo(Y,ge*4);return ae.length===0?ke(0):Nn(ae).slice(0,B.size)}function w(B,J,Y,Z,Q){var ae=te;if(B===te){if(J!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var ge=Y[B],je=(Z>>>2)-1;if(!ge)return;for(var ve=0;ve<je&&(ae=Qo(ge,ve*4))!==te;++ve)Q.push(ae);w(Qo(ge,Z-4),J-1,Y,Z,Q)}}function j(B,J,Y,Z,Q){var ae=[],ge=[];Q||(Q=[]);var je=Z-1,ve=0,ye=0;for(ve=J;ve>=0;){Q[ve]=!0,ae[ae.length]=ve,ge.push(B[ve]);var we=Y[Math.floor(ve*4/Z)];if(ye=ve*4&je,Z<4+ye)throw new Error("FAT boundary crossed: "+ve+" 4 "+Z);if(!B[we])break;ve=Qo(B[we],ye)}return{nodes:ae,data:sD([ge])}}function T(B,J,Y,Z){var Q=B.length,ae=[],ge=[],je=[],ve=[],ye=Z-1,we=0,Oe=0,Pe=0,ze=0;for(we=0;we<Q;++we)if(je=[],Pe=we+J,Pe>=Q&&(Pe-=Q),!ge[Pe]){ve=[];var De=[];for(Oe=Pe;Oe>=0;){De[Oe]=!0,ge[Oe]=!0,je[je.length]=Oe,ve.push(B[Oe]);var Ue=Y[Math.floor(Oe*4/Z)];if(ze=Oe*4&ye,Z<4+ze)throw new Error("FAT boundary crossed: "+Oe+" 4 "+Z);if(!B[Ue]||(Oe=Qo(B[Ue],ze),De[Oe]))break}ae[Pe]={nodes:je,data:sD([ve])}}return ae}function N(B,J,Y,Z,Q,ae,ge,je){for(var ve=0,ye=Z.length?2:0,we=J[B].data,Oe=0,Pe=0,ze;Oe<we.length;Oe+=128){var De=we.slice(Oe,Oe+128);Bn(De,64),Pe=De.read_shift(2),ze=ek(De,0,Pe-ye),Z.push(ze);var Ue={name:ze,type:De.read_shift(1),color:De.read_shift(1),L:De.read_shift(4,"i"),R:De.read_shift(4,"i"),C:De.read_shift(4,"i"),clsid:De.read_shift(16),state:De.read_shift(4,"i"),start:0,size:0},qe=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);qe!==0&&(Ue.ct=C(De,De.l-8));var nr=De.read_shift(2)+De.read_shift(2)+De.read_shift(2)+De.read_shift(2);nr!==0&&(Ue.mt=C(De,De.l-8)),Ue.start=De.read_shift(4,"i"),Ue.size=De.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=te,Ue.name=""),Ue.type===5?(ve=Ue.start,Q>0&&ve!==te&&(J[ve].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",J[Ue.start]===void 0&&(J[Ue.start]=j(Y,Ue.start,J.fat_addrs,J.ssz)),J[Ue.start].name=Ue.name,Ue.content=J[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:ve!==te&&Ue.start!==te&&J[ve]&&(Ue.content=y(Ue,J[ve].data,(J[je]||{}).data))),Ue.content&&Bn(Ue.content,0),ae[ze]=Ue,ge.push(Ue)}}function C(B,J){return new Date((qa(B,J+4)/1e7*Math.pow(2,32)+qa(B,J)/1e7-11644473600)*1e3)}function E(B,J){return f(),h(d.readFileSync(B),J)}function O(B,J){var Y=J&&J.type;switch(Y||xt&&Buffer.isBuffer(B)&&(Y="buffer"),Y||"base64"){case"file":return E(B,J);case"base64":return h(Xa(ai(B)),J);case"binary":return h(Xa(B),J)}return h(B,J)}function A(B,J){var Y=J||{},Z=Y.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=Z+"/",B.FileIndex[0]={name:Z,type:5}),Y.CLSID&&(B.FileIndex[0].clsid=Y.CLSID),D(B)}function D(B){var J="Sh33tJ5";if(!Qe.find(B,"/"+J)){var Y=ke(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,B.FileIndex.push({name:J,type:2,content:Y,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+J),M(B)}}function M(B,J){A(B);for(var Y=!1,Z=!1,Q=B.FullPaths.length-1;Q>=0;--Q){var ae=B.FileIndex[Q];switch(ae.type){case 0:Z?Y=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(ae.R*ae.L*ae.C)&&(Y=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!J)){var ge=new Date(1987,1,19),je=0,ve=Object.create?Object.create(null):{},ye=[];for(Q=0;Q<B.FullPaths.length;++Q)ve[B.FullPaths[Q]]=!0,B.FileIndex[Q].type!==0&&ye.push([B.FullPaths[Q],B.FileIndex[Q]]);for(Q=0;Q<ye.length;++Q){var we=n(ye[Q][0]);Z=ve[we],Z||(ye.push([we,{name:a(we).replace("/",""),type:1,clsid:V,ct:ge,mt:ge,content:null}]),ve[we]=!0)}for(ye.sort(function(ze,De){return r(ze[0],De[0])}),B.FullPaths=[],B.FileIndex=[],Q=0;Q<ye.length;++Q)B.FullPaths[Q]=ye[Q][0],B.FileIndex[Q]=ye[Q][1];for(Q=0;Q<ye.length;++Q){var Oe=B.FileIndex[Q],Pe=B.FullPaths[Q];if(Oe.name=a(Pe).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||V,Q===0)Oe.C=ye.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Pe.slice(-1)=="/"){for(je=Q+1;je<ye.length&&n(B.FullPaths[je])!=Pe;++je);for(Oe.C=je>=ye.length?-1:je,je=Q+1;je<ye.length&&n(B.FullPaths[je])!=n(Pe);++je);Oe.R=je>=ye.length?-1:je,Oe.type=1}else n(B.FullPaths[Q+1]||"")==n(Pe)&&(Oe.R=Q+1),Oe.type=2}}}function P(B,J){var Y=J||{};if(Y.fileType=="mad")return Pr(B,Y);if(M(B),Y.fileType==="zip")return wr(B,Y);var Z=(function(ze){for(var De=0,Ue=0,qe=0;qe<ze.FileIndex.length;++qe){var nr=ze.FileIndex[qe];if(nr.content){var ar=nr.content.length;ar>0&&(ar<4096?De+=ar+63>>6:Ue+=ar+511>>9)}}for(var mr=ze.FullPaths.length+3>>2,li=De+7>>3,Oo=De+127>>7,Tl=li+Ue+mr+Oo,is=Tl+127>>7,jd=is<=109?0:Math.ceil((is-109)/127);Tl+is+jd+127>>7>is;)jd=++is<=109?0:Math.ceil((is-109)/127);var va=[1,jd,is,Oo,mr,Ue,De,0];return ze.FileIndex[0].size=De<<6,va[7]=(ze.FileIndex[0].start=va[0]+va[1]+va[2]+va[3]+va[4]+va[5])+(va[6]+7>>3),va})(B),Q=ke(Z[7]<<9),ae=0,ge=0;{for(ae=0;ae<8;++ae)Q.write_shift(1,ue[ae]);for(ae=0;ae<8;++ae)Q.write_shift(2,0);for(Q.write_shift(2,62),Q.write_shift(2,3),Q.write_shift(2,65534),Q.write_shift(2,9),Q.write_shift(2,6),ae=0;ae<3;++ae)Q.write_shift(2,0);for(Q.write_shift(4,0),Q.write_shift(4,Z[2]),Q.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),Q.write_shift(4,0),Q.write_shift(4,4096),Q.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:te),Q.write_shift(4,Z[3]),Q.write_shift(-4,Z[1]?Z[0]-1:te),Q.write_shift(4,Z[1]),ae=0;ae<109;++ae)Q.write_shift(-4,ae<Z[2]?Z[1]+ae:-1)}if(Z[1])for(ge=0;ge<Z[1];++ge){for(;ae<236+ge*127;++ae)Q.write_shift(-4,ae<Z[2]?Z[1]+ae:-1);Q.write_shift(-4,ge===Z[1]-1?te:ge+1)}var je=function(ze){for(ge+=ze;ae<ge-1;++ae)Q.write_shift(-4,ae+1);ze&&(++ae,Q.write_shift(-4,te))};for(ge=ae=0,ge+=Z[1];ae<ge;++ae)Q.write_shift(-4,K.DIFSECT);for(ge+=Z[2];ae<ge;++ae)Q.write_shift(-4,K.FATSECT);je(Z[3]),je(Z[4]);for(var ve=0,ye=0,we=B.FileIndex[0];ve<B.FileIndex.length;++ve)we=B.FileIndex[ve],we.content&&(ye=we.content.length,!(ye<4096)&&(we.start=ge,je(ye+511>>9)));for(je(Z[6]+7>>3);Q.l&511;)Q.write_shift(-4,K.ENDOFCHAIN);for(ge=ae=0,ve=0;ve<B.FileIndex.length;++ve)we=B.FileIndex[ve],we.content&&(ye=we.content.length,!(!ye||ye>=4096)&&(we.start=ge,je(ye+63>>6)));for(;Q.l&511;)Q.write_shift(-4,K.ENDOFCHAIN);for(ae=0;ae<Z[4]<<2;++ae){var Oe=B.FullPaths[ae];if(!Oe||Oe.length===0){for(ve=0;ve<17;++ve)Q.write_shift(4,0);for(ve=0;ve<3;++ve)Q.write_shift(4,-1);for(ve=0;ve<12;++ve)Q.write_shift(4,0);continue}we=B.FileIndex[ae],ae===0&&(we.start=we.size?we.start-1:te);var Pe=ae===0&&Y.root||we.name;if(ye=2*(Pe.length+1),Q.write_shift(64,Pe,"utf16le"),Q.write_shift(2,ye),Q.write_shift(1,we.type),Q.write_shift(1,we.color),Q.write_shift(-4,we.L),Q.write_shift(-4,we.R),Q.write_shift(-4,we.C),we.clsid)Q.write_shift(16,we.clsid,"hex");else for(ve=0;ve<4;++ve)Q.write_shift(4,0);Q.write_shift(4,we.state||0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(4,we.start),Q.write_shift(4,we.size),Q.write_shift(4,0)}for(ae=1;ae<B.FileIndex.length;++ae)if(we=B.FileIndex[ae],we.size>=4096)if(Q.l=we.start+1<<9,xt&&Buffer.isBuffer(we.content))we.content.copy(Q,Q.l,0,we.size),Q.l+=we.size+511&-512;else{for(ve=0;ve<we.size;++ve)Q.write_shift(1,we.content[ve]);for(;ve&511;++ve)Q.write_shift(1,0)}for(ae=1;ae<B.FileIndex.length;++ae)if(we=B.FileIndex[ae],we.size>0&&we.size<4096)if(xt&&Buffer.isBuffer(we.content))we.content.copy(Q,Q.l,0,we.size),Q.l+=we.size+63&-64;else{for(ve=0;ve<we.size;++ve)Q.write_shift(1,we.content[ve]);for(;ve&63;++ve)Q.write_shift(1,0)}if(xt)Q.l=Q.length;else for(;Q.l<Q.length;)Q.write_shift(1,0);return Q}function R(B,J){var Y=B.FullPaths.map(function(ve){return ve.toUpperCase()}),Z=Y.map(function(ve){var ye=ve.split("/");return ye[ye.length-(ve.slice(-1)=="/"?2:1)]}),Q=!1;J.charCodeAt(0)===47?(Q=!0,J=Y[0].slice(0,-1)+J):Q=J.indexOf("/")!==-1;var ae=J.toUpperCase(),ge=Q===!0?Y.indexOf(ae):Z.indexOf(ae);if(ge!==-1)return B.FileIndex[ge];var je=!ae.match(Df);for(ae=ae.replace(ua,""),je&&(ae=ae.replace(Df,"!")),ge=0;ge<Y.length;++ge)if((je?Y[ge].replace(Df,"!"):Y[ge]).replace(ua,"")==ae||(je?Z[ge].replace(Df,"!"):Z[ge]).replace(ua,"")==ae)return B.FileIndex[ge];return null}var L=64,te=-2,ee="d0cf11e0a1b11ae1",ue=[208,207,17,224,161,177,26,225],V="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:ee,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:V,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(B,J,Y){f();var Z=P(B,Y);d.writeFileSync(J,Z)}function re(B){for(var J=new Array(B.length),Y=0;Y<B.length;++Y)J[Y]=String.fromCharCode(B[Y]);return J.join("")}function me(B,J){var Y=P(B,J);switch(J&&J.type||"buffer"){case"file":return f(),d.writeFileSync(J.filename,Y),Y;case"binary":return typeof Y=="string"?Y:re(Y);case"base64":return v0(typeof Y=="string"?Y:re(Y));case"buffer":if(xt)return Buffer.isBuffer(Y)?Y:kl(Y);case"array":return typeof Y=="string"?Xa(Y):Y}return Y}var W;function F(B){try{var J=B.InflateRaw,Y=new J;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)W=B;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function X(B,J){if(!W)return Ao(B,J);var Y=W.InflateRaw,Z=new Y,Q=Z._processChunk(B.slice(B.l),Z._finishFlushFlag);return B.l+=Z.bytesRead,Q}function q(B){return W?W.deflateRawSync(B):lt(B)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function de(B){var J=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(J>>16|J>>8|J)&255}for(var ne=typeof Uint8Array<"u",oe=ne?new Uint8Array(256):[],Ae=0;Ae<256;++Ae)oe[Ae]=de(Ae);function z(B,J){var Y=oe[B&255];return J<=8?Y>>>8-J:(Y=Y<<8|oe[B>>8&255],J<=16?Y>>>16-J:(Y=Y<<8|oe[B>>16&255],Y>>>24-J))}function et(B,J){var Y=J&7,Z=J>>>3;return(B[Z]|(Y<=6?0:B[Z+1]<<8))>>>Y&3}function Be(B,J){var Y=J&7,Z=J>>>3;return(B[Z]|(Y<=5?0:B[Z+1]<<8))>>>Y&7}function Je(B,J){var Y=J&7,Z=J>>>3;return(B[Z]|(Y<=4?0:B[Z+1]<<8))>>>Y&15}function He(B,J){var Y=J&7,Z=J>>>3;return(B[Z]|(Y<=3?0:B[Z+1]<<8))>>>Y&31}function Ie(B,J){var Y=J&7,Z=J>>>3;return(B[Z]|(Y<=1?0:B[Z+1]<<8))>>>Y&127}function _t(B,J,Y){var Z=J&7,Q=J>>>3,ae=(1<<Y)-1,ge=B[Q]>>>Z;return Y<8-Z||(ge|=B[Q+1]<<8-Z,Y<16-Z)||(ge|=B[Q+2]<<16-Z,Y<24-Z)||(ge|=B[Q+3]<<24-Z),ge&ae}function Er(B,J,Y){var Z=J&7,Q=J>>>3;return Z<=5?B[Q]|=(Y&7)<<Z:(B[Q]|=Y<<Z&255,B[Q+1]=(Y&7)>>8-Z),J+3}function fe(B,J,Y){var Z=J&7,Q=J>>>3;return Y=(Y&1)<<Z,B[Q]|=Y,J+1}function Re(B,J,Y){var Z=J&7,Q=J>>>3;return Y<<=Z,B[Q]|=Y&255,Y>>>=8,B[Q+1]=Y,J+8}function bt(B,J,Y){var Z=J&7,Q=J>>>3;return Y<<=Z,B[Q]|=Y&255,Y>>>=8,B[Q+1]=Y&255,B[Q+2]=Y>>>8,J+16}function Ft(B,J){var Y=B.length,Z=2*Y>J?2*Y:J+5,Q=0;if(Y>=J)return B;if(xt){var ae=zO(Z);if(B.copy)B.copy(ae);else for(;Q<B.length;++Q)ae[Q]=B[Q];return ae}else if(ne){var ge=new Uint8Array(Z);if(ge.set)ge.set(B);else for(;Q<Y;++Q)ge[Q]=B[Q];return ge}return B.length=Z,B}function mt(B){for(var J=new Array(B),Y=0;Y<B;++Y)J[Y]=0;return J}function sr(B,J,Y){var Z=1,Q=0,ae=0,ge=0,je=0,ve=B.length,ye=ne?new Uint16Array(32):mt(32);for(ae=0;ae<32;++ae)ye[ae]=0;for(ae=ve;ae<Y;++ae)B[ae]=0;ve=B.length;var we=ne?new Uint16Array(ve):mt(ve);for(ae=0;ae<ve;++ae)ye[Q=B[ae]]++,Z<Q&&(Z=Q),we[ae]=0;for(ye[0]=0,ae=1;ae<=Z;++ae)ye[ae+16]=je=je+ye[ae-1]<<1;for(ae=0;ae<ve;++ae)je=B[ae],je!=0&&(we[ae]=ye[je+16]++);var Oe=0;for(ae=0;ae<ve;++ae)if(Oe=B[ae],Oe!=0)for(je=z(we[ae],Z)>>Z-Oe,ge=(1<<Z+4-Oe)-1;ge>=0;--ge)J[je|ge<<Oe]=Oe&15|ae<<4;return Z}var It=ne?new Uint16Array(512):mt(512),Tn=ne?new Uint16Array(32):mt(32);if(!ne){for(var Xt=0;Xt<512;++Xt)It[Xt]=0;for(Xt=0;Xt<32;++Xt)Tn[Xt]=0}(function(){for(var B=[],J=0;J<32;J++)B.push(5);sr(B,Tn,32);var Y=[];for(J=0;J<=143;J++)Y.push(8);for(;J<=255;J++)Y.push(9);for(;J<=279;J++)Y.push(7);for(;J<=287;J++)Y.push(8);sr(Y,It,288)})();var hn=(function(){for(var J=ne?new Uint8Array(32768):[],Y=0,Z=0;Y<le.length-1;++Y)for(;Z<le[Y+1];++Z)J[Z]=Y;for(;Z<32768;++Z)J[Z]=29;var Q=ne?new Uint8Array(259):[];for(Y=0,Z=0;Y<G.length-1;++Y)for(;Z<G[Y+1];++Z)Q[Z]=Y;function ae(je,ve){for(var ye=0;ye<je.length;){var we=Math.min(65535,je.length-ye),Oe=ye+we==je.length;for(ve.write_shift(1,+Oe),ve.write_shift(2,we),ve.write_shift(2,~we&65535);we-- >0;)ve[ve.l++]=je[ye++]}return ve.l}function ge(je,ve){for(var ye=0,we=0,Oe=ne?new Uint16Array(32768):[];we<je.length;){var Pe=Math.min(65535,je.length-we);if(Pe<10){for(ye=Er(ve,ye,+(we+Pe==je.length)),ye&7&&(ye+=8-(ye&7)),ve.l=ye/8|0,ve.write_shift(2,Pe),ve.write_shift(2,~Pe&65535);Pe-- >0;)ve[ve.l++]=je[we++];ye=ve.l*8;continue}ye=Er(ve,ye,+(we+Pe==je.length)+2);for(var ze=0;Pe-- >0;){var De=je[we];ze=(ze<<5^De)&32767;var Ue=-1,qe=0;if((Ue=Oe[ze])&&(Ue|=we&-32768,Ue>we&&(Ue-=32768),Ue<we))for(;je[Ue+qe]==je[we+qe]&&qe<250;)++qe;if(qe>2){De=Q[qe],De<=22?ye=Re(ve,ye,oe[De+1]>>1)-1:(Re(ve,ye,3),ye+=5,Re(ve,ye,oe[De-23]>>5),ye+=3);var nr=De<8?0:De-4>>2;nr>0&&(bt(ve,ye,qe-G[De]),ye+=nr),De=J[we-Ue],ye=Re(ve,ye,oe[De]>>3),ye-=3;var ar=De<4?0:De-2>>1;ar>0&&(bt(ve,ye,we-Ue-le[De]),ye+=ar);for(var mr=0;mr<qe;++mr)Oe[ze]=we&32767,ze=(ze<<5^je[we])&32767,++we;Pe-=qe-1}else De<=143?De=De+48:ye=fe(ve,ye,1),ye=Re(ve,ye,oe[De]),Oe[ze]=we&32767,++we}ye=Re(ve,ye,0)-1}return ve.l=(ye+7)/8|0,ve.l}return function(ve,ye){return ve.length<8?ae(ve,ye):ge(ve,ye)}})();function lt(B){var J=ke(50+Math.floor(B.length*1.1)),Y=hn(B,J);return J.slice(0,Y)}var Tt=ne?new Uint16Array(32768):mt(32768),Cn=ne?new Uint16Array(32768):mt(32768),Zt=ne?new Uint16Array(128):mt(128),br=1,aa=1;function mn(B,J){var Y=He(B,J)+257;J+=5;var Z=He(B,J)+1;J+=5;var Q=Je(B,J)+4;J+=4;for(var ae=0,ge=ne?new Uint8Array(19):mt(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ve=1,ye=ne?new Uint8Array(8):mt(8),we=ne?new Uint8Array(8):mt(8),Oe=ge.length,Pe=0;Pe<Q;++Pe)ge[U[Pe]]=ae=Be(B,J),ve<ae&&(ve=ae),ye[ae]++,J+=3;var ze=0;for(ye[0]=0,Pe=1;Pe<=ve;++Pe)we[Pe]=ze=ze+ye[Pe-1]<<1;for(Pe=0;Pe<Oe;++Pe)(ze=ge[Pe])!=0&&(je[Pe]=we[ze]++);var De=0;for(Pe=0;Pe<Oe;++Pe)if(De=ge[Pe],De!=0){ze=oe[je[Pe]]>>8-De;for(var Ue=(1<<7-De)-1;Ue>=0;--Ue)Zt[ze|Ue<<De]=De&7|Pe<<3}var qe=[];for(ve=1;qe.length<Y+Z;)switch(ze=Zt[Ie(B,J)],J+=ze&7,ze>>>=3){case 16:for(ae=3+et(B,J),J+=2,ze=qe[qe.length-1];ae-- >0;)qe.push(ze);break;case 17:for(ae=3+Be(B,J),J+=3;ae-- >0;)qe.push(0);break;case 18:for(ae=11+Ie(B,J),J+=7;ae-- >0;)qe.push(0);break;default:qe.push(ze),ve<ze&&(ve=ze);break}var nr=qe.slice(0,Y),ar=qe.slice(Y);for(Pe=Y;Pe<286;++Pe)nr[Pe]=0;for(Pe=Z;Pe<30;++Pe)ar[Pe]=0;return br=sr(nr,Tt,286),aa=sr(ar,Cn,30),J}function _d(B,J){if(B[0]==3&&!(B[1]&3))return[yo(J),2];for(var Y=0,Z=0,Q=zO(J||1<<18),ae=0,ge=Q.length>>>0,je=0,ve=0;(Z&1)==0;){if(Z=Be(B,Y),Y+=3,Z>>>1)Z>>1==1?(je=9,ve=5):(Y=mn(B,Y),je=br,ve=aa);else{Y&7&&(Y+=8-(Y&7));var ye=B[Y>>>3]|B[(Y>>>3)+1]<<8;if(Y+=32,ye>0)for(!J&&ge<ae+ye&&(Q=Ft(Q,ae+ye),ge=Q.length);ye-- >0;)Q[ae++]=B[Y>>>3],Y+=8;continue}for(;;){!J&&ge<ae+32767&&(Q=Ft(Q,ae+32767),ge=Q.length);var we=_t(B,Y,je),Oe=Z>>>1==1?It[we]:Tt[we];if(Y+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)Q[ae++]=Oe;else{if(Oe==256)break;Oe-=257;var Pe=Oe<8?0:Oe-4>>2;Pe>5&&(Pe=0);var ze=ae+G[Oe];Pe>0&&(ze+=_t(B,Y,Pe),Y+=Pe),we=_t(B,Y,ve),Oe=Z>>>1==1?Tn[we]:Cn[we],Y+=Oe&15,Oe>>>=4;var De=Oe<4?0:Oe-2>>1,Ue=le[Oe];for(De>0&&(Ue+=_t(B,Y,De),Y+=De),!J&&ge<ze&&(Q=Ft(Q,ze+100),ge=Q.length);ae<ze;)Q[ae]=Q[ae-Ue],++ae}}}return J?[Q,Y+7>>>3]:[Q.slice(0,ae),Y+7>>>3]}function Ao(B,J){var Y=B.slice(B.l||0),Z=_d(Y,J);return B.l+=Z[1],Z[0]}function $c(B,J){if(B)typeof console<"u"&&console.error(J);else throw new Error(J)}function js(B,J){var Y=B;Bn(Y,0);var Z=[],Q=[],ae={FileIndex:Z,FullPaths:Q};A(ae,{root:J.root});for(var ge=Y.length-4;(Y[ge]!=80||Y[ge+1]!=75||Y[ge+2]!=5||Y[ge+3]!=6)&&ge>=0;)--ge;Y.l=ge+4,Y.l+=4;var je=Y.read_shift(2);Y.l+=6;var ve=Y.read_shift(4);for(Y.l=ve,ge=0;ge<je;++ge){Y.l+=20;var ye=Y.read_shift(4),we=Y.read_shift(4),Oe=Y.read_shift(2),Pe=Y.read_shift(2),ze=Y.read_shift(2);Y.l+=8;var De=Y.read_shift(4),Ue=c(Y.slice(Y.l+Oe,Y.l+Oe+Pe));Y.l+=Oe+Pe+ze;var qe=Y.l;Y.l=De+4,El(Y,ye,we,ae,Ue),Y.l=qe}return ae}function El(B,J,Y,Z,Q){B.l+=2;var ae=B.read_shift(2),ge=B.read_shift(2),je=s(B);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var ve=B.read_shift(4),ye=B.read_shift(4),we=B.read_shift(4),Oe=B.read_shift(2),Pe=B.read_shift(2),ze="",De=0;De<Oe;++De)ze+=String.fromCharCode(B[B.l++]);if(Pe){var Ue=c(B.slice(B.l,B.l+Pe));(Ue[21589]||{}).mt&&(je=Ue[21589].mt),((Q||{})[21589]||{}).mt&&(je=Q[21589].mt)}B.l+=Pe;var qe=B.slice(B.l,B.l+ye);switch(ge){case 8:qe=X(B,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ge)}var nr=!1;ae&8&&(ve=B.read_shift(4),ve==134695760&&(ve=B.read_shift(4),nr=!0),ye=B.read_shift(4),we=B.read_shift(4)),ye!=J&&$c(nr,"Bad compressed size: "+J+" != "+ye),we!=Y&&$c(nr,"Bad uncompressed size: "+Y+" != "+we),An(Z,ze,qe,{unsafe:!0,mt:je})}function wr(B,J){var Y=J||{},Z=[],Q=[],ae=ke(1),ge=Y.compression?8:0,je=0,ve=0,ye=0,we=0,Oe=0,Pe=B.FullPaths[0],ze=Pe,De=B.FileIndex[0],Ue=[],qe=0;for(ve=1;ve<B.FullPaths.length;++ve)if(ze=B.FullPaths[ve].slice(Pe.length),De=B.FileIndex[ve],!(!De.size||!De.content||ze=="Sh33tJ5")){var nr=we,ar=ke(ze.length);for(ye=0;ye<ze.length;++ye)ar.write_shift(1,ze.charCodeAt(ye)&127);ar=ar.slice(0,ar.l),Ue[Oe]=Aue.buf(De.content,0);var mr=De.content;ge==8&&(mr=q(mr)),ae=ke(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,je),ae.write_shift(2,ge),De.mt?i(ae,De.mt):ae.write_shift(4,0),ae.write_shift(-4,Ue[Oe]),ae.write_shift(4,mr.length),ae.write_shift(4,De.content.length),ae.write_shift(2,ar.length),ae.write_shift(2,0),we+=ae.length,Z.push(ae),we+=ar.length,Z.push(ar),we+=mr.length,Z.push(mr),ae=ke(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,je),ae.write_shift(2,ge),ae.write_shift(4,0),ae.write_shift(-4,Ue[Oe]),ae.write_shift(4,mr.length),ae.write_shift(4,De.content.length),ae.write_shift(2,ar.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,nr),qe+=ae.l,Q.push(ae),qe+=ar.length,Q.push(ar),++Oe}return ae=ke(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,Oe),ae.write_shift(2,Oe),ae.write_shift(4,qe),ae.write_shift(4,we),ae.write_shift(2,0),Nn([Nn(Z),Nn(Q),ae])}var rr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vr(B,J){if(B.ctype)return B.ctype;var Y=B.name||"",Z=Y.match(/\.([^\.]+)$/);return Z&&rr[Z[1]]||J&&(Z=(Y=J).match(/[\.\\]([^\.\\])+$/),Z&&rr[Z[1]])?rr[Z[1]]:"application/octet-stream"}function Vn(B){for(var J=v0(B),Y=[],Z=0;Z<J.length;Z+=76)Y.push(J.slice(Z,Z+76));return Y.join(`\r
`)+`\r
`}function Gn(B){var J=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ye){var we=ye.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});J=J.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),J.charAt(0)==`
`&&(J="=0D"+J.slice(1)),J=J.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],Z=J.split(`\r
`),Q=0;Q<Z.length;++Q){var ae=Z[Q];if(ae.length==0){Y.push("");continue}for(var ge=0;ge<ae.length;){var je=76,ve=ae.slice(ge,ge+je);ve.charAt(je-1)=="="?je--:ve.charAt(je-2)=="="?je-=2:ve.charAt(je-3)=="="&&(je-=3),ve=ae.slice(ge,ge+je),ge+=je,ge<ae.length&&(ve+="="),Y.push(ve)}}return Y.join(`\r
`)}function pn(B){for(var J=[],Y=0;Y<B.length;++Y){for(var Z=B[Y];Y<=B.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+B[++Y];J.push(Z)}for(var Q=0;Q<J.length;++Q)J[Q]=J[Q].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return Xa(J.join(`\r
`))}function Wn(B,J,Y){for(var Z="",Q="",ae="",ge,je=0;je<10;++je){var ve=J[je];if(!ve||ve.match(/^\s*$/))break;var ye=ve.match(/^(.*?):\s*([^\s].*)$/);if(ye)switch(ye[1].toLowerCase()){case"content-location":Z=ye[2].trim();break;case"content-type":ae=ye[2].trim();break;case"content-transfer-encoding":Q=ye[2].trim();break}}switch(++je,Q.toLowerCase()){case"base64":ge=Xa(ai(J.slice(je).join("")));break;case"quoted-printable":ge=pn(J.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Q)}var we=An(B,Z.slice(Y.length),ge,{unsafe:!0});ae&&(we.ctype=ae)}function xa(B,J){if(re(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=J&&J.root||"",Z=(xt&&Buffer.isBuffer(B)?B.toString("binary"):re(B)).split(`\r
`),Q=0,ae="";for(Q=0;Q<Z.length;++Q)if(ae=Z[Q],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),Y||(Y=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),ae.slice(0,Y.length)!=Y););var ge=(Z[1]||"").match(/boundary="(.*?)"/);if(!ge)throw new Error("MAD cannot find boundary");var je="--"+(ge[1]||""),ve=[],ye=[],we={FileIndex:ve,FullPaths:ye};A(we);var Oe,Pe=0;for(Q=0;Q<Z.length;++Q){var ze=Z[Q];ze!==je&&ze!==je+"--"||(Pe++&&Wn(we,Z.slice(Oe,Q),Y),Oe=Q)}return we}function Pr(B,J){var Y=J||{},Z=Y.boundary||"SheetJS";Z="------="+Z;for(var Q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],ae=B.FullPaths[0],ge=ae,je=B.FileIndex[0],ve=1;ve<B.FullPaths.length;++ve)if(ge=B.FullPaths[ve].slice(ae.length),je=B.FileIndex[ve],!(!je.size||!je.content||ge=="Sh33tJ5")){ge=ge.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var ye=je.content,we=xt&&Buffer.isBuffer(ye)?ye.toString("binary"):re(ye),Oe=0,Pe=Math.min(1024,we.length),ze=0,De=0;De<=Pe;++De)(ze=we.charCodeAt(De))>=32&&ze<128&&++Oe;var Ue=Oe>=Pe*4/5;Q.push(Z),Q.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+ge),Q.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),Q.push("Content-Type: "+Vr(je,ge)),Q.push(""),Q.push(Ue?Gn(we):Vn(we))}return Q.push(Z+`--\r
`),Q.join(`\r
`)}function Fa(B){var J={};return A(J,B),J}function An(B,J,Y,Z){var Q=Z&&Z.unsafe;Q||A(B);var ae=!Q&&Qe.find(B,J);if(!ae){var ge=B.FullPaths[0];J.slice(0,ge.length)==ge?ge=J:(ge.slice(-1)!="/"&&(ge+="/"),ge=(ge+J).replace("//","/")),ae={name:a(J),type:2},B.FileIndex.push(ae),B.FullPaths.push(ge),Q||Qe.utils.cfb_gc(B)}return ae.content=Y,ae.size=Y?Y.length:0,Z&&(Z.CLSID&&(ae.clsid=Z.CLSID),Z.mt&&(ae.mt=Z.mt),Z.ct&&(ae.ct=Z.ct)),ae}function ga(B,J){A(B);var Y=Qe.find(B,J);if(Y){for(var Z=0;Z<B.FileIndex.length;++Z)if(B.FileIndex[Z]==Y)return B.FileIndex.splice(Z,1),B.FullPaths.splice(Z,1),!0}return!1}function Fi(B,J,Y){A(B);var Z=Qe.find(B,J);if(Z){for(var Q=0;Q<B.FileIndex.length;++Q)if(B.FileIndex[Q]==Z)return B.FileIndex[Q].name=a(Y),B.FullPaths[Q]=Y,!0}return!1}function Li(B){M(B,!0)}return t.find=R,t.read=O,t.parse=h,t.write=me,t.writeFile=ie,t.utils={cfb_new:Fa,cfb_add:An,cfb_del:ga,cfb_mov:Fi,cfb_gc:Li,ReadShift:$f,CheckField:fF,prep_blob:Bn,bconcat:Nn,use_zlib:F,_deflateRaw:lt,_inflateRaw:Ao,consts:K},t})();function Oue(e){return typeof e=="string"?Rg(e):Array.isArray(e)?nue(e):e}function hh(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Rg(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?xs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([Oue(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Eo(t)),c.write(t),c.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function Due(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Rr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function YO(e,t){for(var r=[],n=Rr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Mg(e){for(var t=[],r=Rr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Pg(e){for(var t=[],r=Rr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Iue(e){for(var t=[],r=Rr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Sx=new Date(1899,11,30,0,0,0);function on(e,t){var r=e.getTime(),n=Sx.getTime()+(e.getTimezoneOffset()-Sx.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var G8=new Date,Rue=Sx.getTime()+(G8.getTimezoneOffset()-Sx.getTimezoneOffset())*6e4,XO=G8.getTimezoneOffset();function Fg(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Rue),t.getTimezoneOffset()!==XO&&t.setTime(t.getTime()+(t.getTimezoneOffset()-XO)*6e4),t}function Mue(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var ZO=new Date("2017-02-19T19:06:09.000Z"),W8=isNaN(ZO.getFullYear())?new Date("2/19/17"):ZO,Pue=W8.getFullYear()==2017;function fr(e,t){var r=new Date(e);if(Pue)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(W8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function kc(e,t){if(xt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return xs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return xs(D8(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return xs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return xs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function hr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=hr(e[r]));return t}function Or(e,t){for(var r="";r.length<t;)r+=e;return r}function Zi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var Fue=["january","february","march","april","may","june","july","august","september","october","november","december"];function td(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&Fue.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Lue=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],c=1;c<i.length;++c)s.push(a),s.push(i[c]);return s}})();function q8(e){return e?e.content&&e.type?kc(e.content,!0):e.data?Of(e.data):e.asNodeBuffer&&xt?Of(e.asNodeBuffer().toString("binary")):e.asBinary?Of(e.asBinary()):e._data&&e._data.getContent?Of(kc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function K8(e){if(!e)return null;if(e.data)return BO(e.data);if(e.asNodeBuffer&&xt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?BO(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Bue(e){return e&&e.name.slice(-4)===".bin"?K8(e):q8(e)}function ji(e,t){for(var r=e.FullPaths||Rr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function KN(e,t){var r=ji(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Xr(e,t,r){if(!r)return Bue(KN(e,t));if(!t)return null;try{return Xr(e,t)}catch{return null}}function Za(e,t,r){if(!r)return q8(KN(e,t));if(!t)return null;try{return Za(e,t)}catch{return null}}function Uue(e,t,r){return K8(KN(e,t))}function QO(e){for(var t=e.FullPaths||Rr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ht(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return xt?n=kl(r):n=aue(r),Qe.utils.cfb_add(e,t,n)}Qe.utils.cfb_add(e,t,r)}else e.file(t,r)}function YN(){return Qe.utils.cfb_new()}function Y8(e,t){switch(t.type){case"base64":return Qe.read(e,{type:"base64"});case"binary":return Qe.read(e,{type:"binary"});case"buffer":case"array":return Qe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function If(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Hr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,zue=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,JO=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$ue=/<[^>]*>/g,na=Hr.match(JO)?JO:$ue,Hue=/<\w*:/,Vue=/<(\/?)\w+:/;function it(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(zue),c=0,d="",f=0,h="",p="",g=1;if(s)for(f=0;f!=s.length;++f){for(p=s[f],i=0;i!=p.length&&p.charCodeAt(i)!==61;++i);for(h=p.slice(0,i).trim();p.charCodeAt(i+1)==32;)++i;for(g=(a=p.charCodeAt(i+1))==34||a==39?1:0,d=p.slice(i+1+g,p.length-g),c=0;c!=h.length&&h.charCodeAt(c)!==58;++c);if(c===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=d,n[h.toLowerCase()]=d;else{var v=(c===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(c+1);if(n[v]&&h.slice(c-3,c)=="ext")continue;n[v]=d,n[v.toLowerCase()]=d}}return n}function ks(e){return e.replace(Vue,"<$1")}var X8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},XN=Mg(X8),jt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(c,d){return X8[c]||String.fromCharCode(parseInt(d,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,d){return String.fromCharCode(parseInt(d,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}})(),ZN=/[&<>'"]/g,Gue=/[\u0000-\u0008\u000b-\u001f]/g;function Ht(e){var t=e+"";return t.replace(ZN,function(r){return XN[r]}).replace(Gue,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function eD(e){return Ht(e).replace(/ /g,"_x0020_")}var Z8=/[\u0000-\u001f]/g;function QN(e){var t=e+"";return t.replace(ZN,function(r){return XN[r]}).replace(/\n/g,"<br/>").replace(Z8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Wue(e){var t=e+"";return t.replace(ZN,function(r){return XN[r]}).replace(Z8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var tD=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function que(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function dr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wb(e){for(var t="",r=0,n=0,a=0,i=0,s=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),c=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function rD(e){var t=yo(2*e.length),r,n,a=1,i=0,s=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function nD(e){return kl(e,"binary").toString("utf8")}var Qm="foo bar baz",Yt=xt&&(nD(Qm)==Wb(Qm)&&nD||rD(Qm)==Wb(Qm)&&rD)||Wb,xs=xt?function(e){return kl(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},b0=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),Q8=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),Kue=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),Yue=/<\/?(?:vt:)?variant>/g,Xue=/<(?:vt:)([^>]*)>([\s\S]*)</;function aD(e,t){var r=it(e),n=e.match(Kue(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(Yue,"").match(Xue);s&&a.push({v:Yt(s[2]),t:s[1]})}),a}var J8=/(^\s|\s$|\n)/;function zn(e,t){return"<"+e+(t.match(J8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function w0(e){return Rr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Fe(e,t,r){return"<"+e+(r!=null?w0(r):"")+(t!=null?(t.match(J8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function jw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Zue(e,t){switch(typeof e){case"string":var r=Fe("vt:lpwstr",Ht(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Fe((e|0)==e?"vt:i4":"vt:r8",Ht(String(e)));case"boolean":return Fe("vt:bool",e?"true":"false")}if(e instanceof Date)return Fe("vt:filetime",jw(e));throw new Error("Unable to serialize "+e)}function JN(e){if(xt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Yt(Eo(GN(e)));throw new Error("Bad input format: expected Buffer or string")}var S0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Wa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Que(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Jue(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var iD=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},sD=xt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:kl(t)})):iD(e)}:iD,lD=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Js(e,a)));return n.join("").replace(ua,"")},ek=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ua,""):lD(e,t,r)}:lD,oD=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},eF=xt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):oD(e,t,r)}:oD,cD=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Du(e,a)));return n.join("")},mh=xt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):cD(t,r,n)}:cD,tF=function(e,t){var r=qa(e,t);return r>0?mh(e,t+4,t+4+r-1):""},rF=tF,nF=function(e,t){var r=qa(e,t);return r>0?mh(e,t+4,t+4+r-1):""},aF=nF,iF=function(e,t){var r=2*qa(e,t);return r>0?mh(e,t+4,t+4+r-1):""},sF=iF,lF=function(t,r){var n=qa(t,r);return n>0?ek(t,r+4,r+4+n):""},oF=lF,cF=function(e,t){var r=qa(e,t);return r>0?mh(e,t+4,t+4+r):""},uF=cF,dF=function(e,t){return Que(e,t)},Nx=dF,tk=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(rF=function(t,r){if(!Buffer.isBuffer(t))return tF(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},aF=function(t,r){if(!Buffer.isBuffer(t))return nF(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},sF=function(t,r){if(!Buffer.isBuffer(t))return iF(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},oF=function(t,r){if(!Buffer.isBuffer(t))return lF(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},uF=function(t,r){if(!Buffer.isBuffer(t))return cF(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Nx=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):dF(t,r)},tk=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Du=function(e,t){return e[t]},Js=function(e,t){return e[t+1]*256+e[t]},ede=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},qa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Qo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},tde=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $f(e,t){var r="",n,a,i=[],s,c,d,f;switch(t){case"dbcs":if(f=this.l,xt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)r+=String.fromCharCode(Js(this,f)),f+=2;e*=2;break;case"utf8":r=mh(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ek(this,this.l,this.l+e);break;case"wstr":return $f.call(this,e,"dbcs");case"lpstr-ansi":r=rF(this,this.l),e=4+qa(this,this.l);break;case"lpstr-cp":r=aF(this,this.l),e=4+qa(this,this.l);break;case"lpwstr":r=sF(this,this.l),e=4+2*qa(this,this.l);break;case"lpp4":e=4+qa(this,this.l),r=oF(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qa(this,this.l),r=uF(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Du(this,this.l+e++))!==0;)i.push(Zm(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Js(this,this.l+e))!==0;)i.push(Zm(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",f=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return s=Du(this,f),this.l=f+1,c=$f.call(this,e-d,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Zm(Js(this,f))),f+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(f)!==-1)return s=Du(this,f),this.l=f+1,c=$f.call(this,e-d,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Zm(Du(this,f))),f+=1}r=i.join("");break;default:switch(e){case 1:return n=Du(this,this.l),this.l++,n;case 2:return n=(t==="i"?ede:Js)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Qo:tde)(this,this.l),this.l+=4,n):(a=qa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Nx(this,this.l):a=Nx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=eF(this,this.l,e);break}}return this.l+=e,r}var rde=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},nde=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ade=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function ide(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)ade(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,rde(this,t,this.l);break;case 8:if(n=8,r==="f"){Jue(this,t,this.l);break}case 16:break;case-4:n=4,nde(this,t,this.l);break}return this.l+=n,this}function fF(e,t){var r=eF(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Bn(e,t){e.l=t,e.read_shift=$f,e.chk=fF,e.write_shift=ide}function ra(e,t){e.l+=t}function ke(e){var t=yo(e);return Bn(t,0),t}function _l(e,t,r){if(e){var n,a,i;Bn(e,e.l||0);for(var s=e.length,c=0,d=0;e.l<s;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var f=T0[c]||T0[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;d=e.l+i;var h=f.f&&f.f(e,i,r);if(e.l=d,t(h,f,c))return}}}function Da(){var e=[],t=xt?256:2048,r=function(f){var h=ke(f);return Bn(h,0),h},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(f){return n&&f<n.length-n.l?n:(a(),n=r(Math.max(f+1,t)))},s=function(){return a(),Nn(e)},c=function(f){a(),n=f,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:s,_bufs:e}}function Ce(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=T0[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&tk(r)&&e.push(r)}}function Hf(e,t,r){var n=hr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function uD(e,t,r){var n=hr(e);return n.s=Hf(n.s,t.s,r),n.e=Hf(n.e,t.s,r),n}function Vf(e,t){if(e.cRel&&e.c<0)for(e=hr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=hr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=nt(e);return!e.cRel&&e.cRel!=null&&(r=ode(r)),!e.rRel&&e.rRel!=null&&(r=sde(r)),r}function qb(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Nr(e.s.c)+":"+(e.e.cRel?"":"$")+Nr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+$r(e.s.r)+":"+(e.e.rRel?"":"$")+$r(e.e.r):Vf(e.s,t.biff)+":"+Vf(e.e,t.biff)}function rk(e){return parseInt(lde(e),10)-1}function $r(e){return""+(e+1)}function sde(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function lde(e){return e.replace(/\$(\d+)$/,"$1")}function nk(e){for(var t=cde(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Nr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function ode(e){return e.replace(/^([A-Z])/,"$$$1")}function cde(e){return e.replace(/^\$([A-Z])/,"$1")}function ude(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function nt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ia(e){var t=e.indexOf(":");return t==-1?{s:kr(e),e:kr(e)}:{s:kr(e.slice(0,t)),e:kr(e.slice(t+1))}}function dt(e,t){return typeof t>"u"||typeof t=="number"?dt(e.s,e.e):(typeof e!="string"&&(e=nt(e)),typeof t!="string"&&(t=nt(t)),e==t?e:e+":"+t)}function Et(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function dD(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ii(e.z,r?on(t):t)}catch{}try{return e.w=ii((e.XF||{}).numFmtId||(r?14:0),r?on(t):t)}catch{return""+t}}function pl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?jl[e.v]||e.v:t==null?dD(e,e.v):dD(e,t))}function To(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function hF(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var d=typeof n.origin=="string"?kr(n.origin):n.origin;s=d.r,c=d.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=Et(i["!ref"]);f.s.c=h.s.c,f.s.r=h.s.r,f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),s==-1&&(f.e.r=s=h.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[p].length;++g)if(!(typeof t[p][g]>"u")){var v={v:t[p][g]},b=s+p,y=c+g;if(f.s.r>b&&(f.s.r=b),f.s.c>y&&(f.s.c=y),f.e.r<b&&(f.e.r=b),f.e.c<y&&(f.e.c=y),t[p][g]&&typeof t[p][g]=="object"&&!Array.isArray(t[p][g])&&!(t[p][g]instanceof Date))v=t[p][g];else if(Array.isArray(v.v)&&(v.f=t[p][g][1],v.v=v.v[0]),v.v===null)if(v.f)v.t="n";else if(n.nullError)v.t="e",v.v=0;else if(n.sheetStubs)v.t="z";else continue;else typeof v.v=="number"?v.t="n":typeof v.v=="boolean"?v.t="b":v.v instanceof Date?(v.z=n.dateNF||tt[14],n.cellDates?(v.t="d",v.w=ii(v.z,on(v.v))):(v.t="n",v.v=on(v.v),v.w=ii(v.z,v.v))):v.t="s";if(a)i[b]||(i[b]=[]),i[b][y]&&i[b][y].z&&(v.z=i[b][y].z),i[b][y]=v;else{var w=nt({c:y,r:b});i[w]&&i[w].z&&(v.z=i[w].z),i[w]=v}}}return f.s.c<1e7&&(i["!ref"]=dt(f)),i}function wd(e,t){return hF(null,e,t)}function dde(e){return e.read_shift(4,"i")}function Qi(e,t){return t||(t=ke(4)),t.write_shift(4,e),t}function ta(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function kn(e,t){var r=!1;return t==null&&(r=!0,t=ke(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function fde(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function hde(e,t){return t||(t=ke(4)),t.write_shift(2,0),t.write_shift(2,0),t}function ak(e,t){var r=e.l,n=e.read_shift(1),a=ta(e),i=[],s={t:a,h:a};if((n&1)!==0){for(var c=e.read_shift(4),d=0;d!=c;++d)i.push(fde(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function mde(e,t){var r=!1;return t==null&&(r=!0,t=ke(15+4*e.t.length)),t.write_shift(1,0),kn(e.t,t),r?t.slice(0,t.l):t}var pde=ak;function xde(e,t){var r=!1;return t==null&&(r=!0,t=ke(23+4*e.t.length)),t.write_shift(1,1),kn(e.t,t),t.write_shift(4,1),hde({},t),r?t.slice(0,t.l):t}function Pi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Fc(e,t){return t==null&&(t=ke(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Lc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Bc(e,t){return t==null&&(t=ke(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var gde=ta,mF=kn;function ik(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function kx(e,t){var r=!1;return t==null&&(r=!0,t=ke(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var vde=ta,Ew=ik,sk=kx;function lk(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Nx([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Qo(t,0)>>2;return r?a/100:a}function pF(e,t){t==null&&(t=ke(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function xF(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function yde(e,t){return t||(t=ke(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Uc=xF,Sd=yde;function ea(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _c(e,t){return(t||ke(8)).write_shift(8,e,"f")}function bde(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),c=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var f=uc[a];f&&(t.rgb=k0(f));break;case 2:t.rgb=k0([s,c,d]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function _x(e,t){if(t||(t=ke(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function wde(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Sde(e,t){t||(t=ke(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function gF(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Nde(e){return gF(e,1)}function kde(e){return gF(e,2)}var ok=2,_a=3,Jm=11,fD=12,jx=19,ep=64,_de=65,jde=71,Ede=4108,Tde=4126,wn=80,vF=81,Cde=[wn,vF],Tw={1:{n:"CodePage",t:ok},2:{n:"Category",t:wn},3:{n:"PresentationFormat",t:wn},4:{n:"ByteCount",t:_a},5:{n:"LineCount",t:_a},6:{n:"ParagraphCount",t:_a},7:{n:"SlideCount",t:_a},8:{n:"NoteCount",t:_a},9:{n:"HiddenCount",t:_a},10:{n:"MultimediaClipCount",t:_a},11:{n:"ScaleCrop",t:Jm},12:{n:"HeadingPairs",t:Ede},13:{n:"TitlesOfParts",t:Tde},14:{n:"Manager",t:wn},15:{n:"Company",t:wn},16:{n:"LinksUpToDate",t:Jm},17:{n:"CharacterCount",t:_a},19:{n:"SharedDoc",t:Jm},22:{n:"HyperlinksChanged",t:Jm},23:{n:"AppVersion",t:_a,p:"version"},24:{n:"DigSig",t:_de},26:{n:"ContentType",t:wn},27:{n:"ContentStatus",t:wn},28:{n:"Language",t:wn},29:{n:"Version",t:wn},255:{},2147483648:{n:"Locale",t:jx},2147483651:{n:"Behavior",t:jx},1919054434:{}},Cw={1:{n:"CodePage",t:ok},2:{n:"Title",t:wn},3:{n:"Subject",t:wn},4:{n:"Author",t:wn},5:{n:"Keywords",t:wn},6:{n:"Comments",t:wn},7:{n:"Template",t:wn},8:{n:"LastAuthor",t:wn},9:{n:"RevNumber",t:wn},10:{n:"EditTime",t:ep},11:{n:"LastPrinted",t:ep},12:{n:"CreatedDate",t:ep},13:{n:"ModifiedDate",t:ep},14:{n:"PageCount",t:_a},15:{n:"WordCount",t:_a},16:{n:"CharCount",t:_a},17:{n:"Thumbnail",t:jde},18:{n:"Application",t:wn},19:{n:"DocSecurity",t:_a},255:{},2147483648:{n:"Locale",t:jx},2147483651:{n:"Behavior",t:jx},1919054434:{}},hD={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Ade=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ode(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Dde=Ode([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),uc=hr(Dde),jl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},yF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Aw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},tp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ck(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Ide(e){var t=ck();if(!e||!e.match)return t;var r={};if((e.match(na)||[]).forEach(function(n){var a=it(n);switch(a[0].replace(Hue,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Aw[a.ContentType]]!==void 0&&t[Aw[a.ContentType]].push(a.PartName);break}}),t.xmlns!==sn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function bF(e,t){var r=Iue(Aw),n=[],a;n[n.length]=Hr,n[n.length]=Fe("Types",null,{xmlns:sn.CT,"xmlns:xsd":sn.xsd,"xmlns:xsi":sn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Fe("Default",null,{Extension:d[0],ContentType:d[1]})}));var i=function(d){e[d]&&e[d].length>0&&(a=e[d][0],n[n.length]=Fe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:tp[d][t.bookType]||tp[d].xlsx}))},s=function(d){(e[d]||[]).forEach(function(f){n[n.length]=Fe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:tp[d][t.bookType]||tp[d].xlsx})})},c=function(d){(e[d]||[]).forEach(function(f){n[n.length]=Fe("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:r[d][0]})})};return i("workbooks"),s("sheets"),s("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),s("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function N0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Gf(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(na)||[]).forEach(function(a){var i=it(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:If(i.Target,t);r[c]=s,n[i.Id]=s}}),r["!id"]=n,r}function zu(e){var t=[Hr,Fe("Relationships",null,{xmlns:sn.RELS})];return Rr(e["!id"]).forEach(function(r){t[t.length]=Fe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function zt(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[gt.HLINK,gt.XPATH,gt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var Rde="application/vnd.oasis.opendocument.spreadsheet";function Mde(e,t){for(var r=JN(e),n,a;n=S0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=it(n[0],!1),a.path=="/"&&a.type!==Rde)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Pde(e){var t=[Hr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function mD(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Fde(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Lde(e){var t=[Hr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(mD(e[r][0],e[r][1])),t.push(Fde("",e[r][0]));return t.push(mD("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function wF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vx.version+"</meta:generator></office:meta></office:document-meta>"}var Oi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Bde=(function(){for(var e=new Array(Oi.length),t=0;t<Oi.length;++t){var r=Oi[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function SF(e){var t={};e=Yt(e);for(var r=0;r<Oi.length;++r){var n=Oi[r],a=e.match(Bde[r]);a!=null&&a.length>0&&(t[n[1]]=jt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=fr(t[n[1]]))}return t}function Kb(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Ht(t),n[n.length]=r?Fe(e,t,r):zn(e,t))}function NF(e,t){var r=t||{},n=[Hr,Fe("cp:coreProperties",null,{"xmlns:cp":sn.CORE_PROPS,"xmlns:dc":sn.dc,"xmlns:dcterms":sn.dcterms,"xmlns:dcmitype":sn.dcmitype,"xmlns:xsi":sn.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Kb("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:jw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Kb("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:jw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Oi.length;++i){var s=Oi[i],c=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Kb(s[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var dc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],kF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _F(e,t,r,n){var a=[];if(typeof e=="string")a=aD(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(h){return{v:h}}));var s=typeof t=="string"?aD(t,n).map(function(h){return h.v}):t,c=0,d=0;if(s.length>0)for(var f=0;f!==a.length;f+=2){switch(d=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=d,r.SheetNames=s.slice(c,c+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=d,r.DefinedNames=s.slice(c,c+d);break;case"Charts":case"Diagramme":r.Chartsheets=d,r.ChartNames=s.slice(c,c+d);break}c+=d}}function Ude(e,t,r){var n={};return t||(t={}),e=Yt(e),dc.forEach(function(a){var i=(e.match(b0(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=jt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&_F(n.HeadingPairs,n.TitlesOfParts,t,r),t}function jF(e){var t=[],r=Fe;return e||(e={}),e.Application="SheetJS",t[t.length]=Hr,t[t.length]=Fe("Properties",null,{xmlns:sn.EXT_PROPS,"xmlns:vt":sn.vt}),dc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Ht(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Ht(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var zde=/<[^>]+>[^<]*/g;function $de(e,t){var r={},n="",a=e.match(zde);if(a)for(var i=0;i!=a.length;++i){var s=a[i],c=it(s);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(c.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var d=s.split(">"),f=d[0].slice(4),h=d[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=jt(h);break;case"bool":r[n]=dr(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=fr(h);break;case"cy":case"error":r[n]=jt(h);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,f,d)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function EF(e){var t=[Hr,Fe("Properties",null,{xmlns:sn.CUST_PROPS,"xmlns:vt":sn.vt})];if(!e)return t.join("");var r=1;return Rr(e).forEach(function(a){++r,t[t.length]=Fe("property",Zue(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ht(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Ow={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Yb;function Hde(e,t,r){Yb||(Yb=Mg(Ow)),t=Yb[t]||t,e[t]=r}function Vde(e,t){var r=[];return Rr(Ow).map(function(n){for(var a=0;a<Oi.length;++a)if(Oi[a][1]==n)return Oi[a];for(a=0;a<dc.length;++a)if(dc[a][1]==n)return dc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"Z")),typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(zn(Ow[n[1]]||n[1],a))}}),Fe("DocumentProperties",r.join(""),{xmlns:Wa.o})}function Gde(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Rr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Oi.length;++s)if(i==Oi[s][1])return;for(s=0;s<dc.length;++s)if(i==dc[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var c=e[i],d="string";typeof c=="number"?(d="float",c=String(c)):c===!0||c===!1?(d="boolean",c=c?"1":"0"):c=String(c),a.push(Fe(eD(i),c,{"dt:dt":d}))}}),t&&Rr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],c="string";typeof s=="number"?(c="float",s=String(s)):s===!0||s===!1?(c="boolean",s=s?"1":"0"):s instanceof Date?(c="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Fe(eD(i),s,{"dt:dt":c}))}}),"<"+n+' xmlns="'+Wa.o+'">'+a.join("")+"</"+n+">"}function uk(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Wde(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=ke(8);return s.write_shift(4,n),s.write_shift(4,a),s}function TF(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function CF(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function AF(e,t,r){return t===31?CF(e):TF(e,t,r)}function Dw(e,t,r){return AF(e,t,r===!1?0:4)}function qde(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return AF(e,t,0)}function Kde(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ua,""),e.l-a&2&&(e.l+=2)}return r}function Yde(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ua,"");return r}function Xde(e){var t=e.l,r=Ex(e,vF);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Ex(e,_a);return[r,n]}function Zde(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Xde(e));return r}function pD(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(ua,"").replace(Df,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function OF(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Qde(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Ex(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==fD&&n!==t&&Cde.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===fD?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return TF(e,n,4).replace(ua,"");case 31:return CF(e);case 64:return uk(e);case 65:return OF(e);case 71:return Qde(e);case 80:return Dw(e,n,!i.raw).replace(ua,"");case 81:return qde(e,n).replace(ua,"");case 4108:return Zde(e);case 4126:case 4127:return n==4127?Kde(e):Yde(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function xD(e,t){var r=ke(4),n=ke(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ke(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Wde(t);break;case 31:case 80:for(n=ke(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Nn([r,n])}function gD(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,c=0,d=-1,f={};for(s=0;s!=a;++s){var h=e.read_shift(4),p=e.read_shift(4);i[s]=[h,p+r]}i.sort(function(T,N){return T[1]-N[1]});var g={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var v=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,v=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],v=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],v=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(v=!1,e.l=i[s][1]),v)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var b=t[i[s][0]];if(g[b.n]=Ex(e,b.t,{raw:!0}),b.p==="version"&&(g[b.n]=String(g[b.n]>>16)+"."+("0000"+String(g[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(g[b.n]){case 0:g[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ki(c=g[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[b.n])}}else if(i[s][0]===1){if(c=g.CodePage=Ex(e,ok),Ki(c),d!==-1){var y=e.l;e.l=i[d][1],f=pD(e,c),e.l=y}}else if(i[s][0]===0){if(c===0){d=s,e.l=i[s+1][1];continue}f=pD(e,c)}else{var w=f[i[s][0]],j;switch(e[e.l]){case 65:e.l+=4,j=OF(e);break;case 30:e.l+=4,j=Dw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,j=Dw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,j=e.read_shift(4,"i");break;case 19:e.l+=4,j=e.read_shift(4);break;case 5:e.l+=4,j=e.read_shift(8,"f");break;case 11:e.l+=4,j=Br(e,4);break;case 64:e.l+=4,j=fr(uk(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[w]=j}}return e.l=r+n,g}var DF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Jde(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function vD(e,t,r){var n=ke(8),a=[],i=[],s=8,c=0,d=ke(8),f=ke(8);if(d.write_shift(4,2),d.write_shift(4,1200),f.write_shift(4,1),i.push(d),a.push(f),s+=8+d.length,!t){f=ke(8),f.write_shift(4,0),a.unshift(f);var h=[ke(4)];for(h[0].write_shift(4,e.length),c=0;c<e.length;++c){var p=e[c][0];for(d=ke(8+2*(p.length+1)+(p.length%2?0:2)),d.write_shift(4,c+2),d.write_shift(4,p.length+1),d.write_shift(0,p,"dbcs");d.l!=d.length;)d.write_shift(1,0);h.push(d)}d=Nn(h),i.unshift(d),s+=8+d.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(DF.indexOf(e[c][0])>-1||kF.indexOf(e[c][0])>-1)&&e[c][1]!=null){var g=e[c][1],v=0;if(t){v=+t[e[c][0]];var b=r[v];if(b.p=="version"&&typeof g=="string"){var y=g.split(".");g=(+y[0]<<16)+(+y[1]||0)}d=xD(b.t,g)}else{var w=Jde(g);w==-1&&(w=31,g=String(g)),d=xD(w,g)}i.push(d),f=ke(8),f.write_shift(4,t?v:2+c),a.push(f),s+=8+d.length}var j=8*(i.length+1);for(c=0;c<i.length;++c)a[c].write_shift(4,j),j+=i[c].length;return n.write_shift(4,s),n.write_shift(4,i.length),Nn([n].concat(a).concat(i))}function yD(e,t,r){var n=e.content;if(!n)return{};Bn(n,0);var a,i,s,c,d=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),h=n.read_shift(16);if(h!==Qe.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(s=n.read_shift(16),d=n.read_shift(4));var p=gD(n,t),g={SystemIdentifier:f};for(var v in p)g[v]=p[v];if(g.FMTID=i,a===1)return g;if(d-n.l==2&&(n.l+=2),n.l!==d)throw new Error("Length mismatch 2: "+n.l+" !== "+d);var b;try{b=gD(n,null)}catch{}for(v in b)g[v]=b[v];return g.FMTID=[i,s],g}function bD(e,t,r,n,a,i){var s=ke(a?68:48),c=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Qe.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var d=vD(e,r,n);if(c.push(d),a){var f=vD(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+d.length),c.push(f)}return Nn(c)}function Ql(e,t){return e.read_shift(t),null}function efe(e,t){t||(t=ke(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function tfe(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Br(e,t){return e.read_shift(t)===1}function oa(e,t){return t||(t=ke(2)),t.write_shift(2,+!!e),t}function Zr(e){return e.read_shift(2,"u")}function Ei(e,t){return t||(t=ke(2)),t.write_shift(2,e),t}function IF(e,t){return tfe(e,t,Zr)}function rfe(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function RF(e,t,r){return r||(r=ke(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ph(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function nfe(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,c,d={};a&&(s=e.read_shift(2)),n&&(c=e.read_shift(4));var f=i==2?"dbcs-cont":"sbcs-cont",h=t===0?"":e.read_shift(t,f);return a&&(e.l+=4*s),n&&(e.l+=c),d.t=h,a||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function afe(e){var t=e.t||"",r=ke(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ke(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Nn(a)}function jc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function xh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):jc(e,n,r)}function zc(e,t,r){if(r.biff>5)return xh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function MF(e,t,r){return r||(r=ke(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function ife(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function sfe(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ua,"");return n&&(e.l+=24),a}function lfe(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(ua,"");return r+s}function ofe(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return sfe(e);case"0303000000000000c000000000000046":return lfe(e);default:throw new Error("Unsupported Moniker "+r)}}function rp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ua,""):"";return r}function wD(e,t){t||(t=ke(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function cfe(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,c,d,f="",h,p;a&16&&(i=rp(e,r-e.l)),a&128&&(s=rp(e,r-e.l)),(a&257)===257&&(c=rp(e,r-e.l)),(a&257)===1&&(d=ofe(e,r-e.l)),a&8&&(f=rp(e,r-e.l)),a&32&&(h=e.read_shift(16)),a&64&&(p=uk(e)),e.l=r;var g=s||c||d||"";g&&f&&(g+="#"+f),g||(g="#"+f),a&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var v={Target:g};return h&&(v.guid=h),p&&(v.time=p),i&&(v.Tooltip=i),v}function ufe(e){var t=ke(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),wD(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var c=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&wD(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var d=0;n.slice(d*3,d*3+3)=="../"||n.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,n.length-3*d+1),r=0;r<n.length-3*d;++r)t.write_shift(1,n.charCodeAt(r+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function PF(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function FF(e,t){var r=PF(e);return r[3]=0,r}function _s(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ec(e,t,r,n){return n||(n=ke(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function dfe(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ffe(e,t,r){return t===0?"":zc(e,t,r)}function hfe(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function LF(e){var t=e.read_shift(2),r=lk(e);return[t,r]}function mfe(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=ph(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Lg(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function BF(e,t){return t||(t=ke(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function UF(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var pfe=UF;function zF(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function xfe(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function gfe(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Kn(e){e.l+=2,e.l+=e.read_shift(2)}var vfe={0:Kn,4:Kn,5:Kn,6:Kn,7:gfe,8:Kn,9:Kn,10:Kn,11:Kn,12:Kn,13:xfe,14:Kn,15:Kn,16:Kn,17:Kn,18:Kn,19:Kn,20:Kn,21:zF};function yfe(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(vfe[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function np(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function dk(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=ke(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function bfe(e,t){return t===0||e.read_shift(2),1200}function wfe(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=zc(e,0,r);return e.read_shift(t+n-e.l),a}function Sfe(e,t){var r=!t||t.biff==8,n=ke(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Nfe(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function kfe(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=ph(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function _fe(e,t){var r=!t||t.biff>=8?2:1,n=ke(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function jfe(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(nfe(e));return i.Count=n,i.Unique=a,i}function Efe(e,t){var r=ke(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=afe(e[a]);var i=Nn([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function Tfe(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Cfe(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Afe(e){var t=dfe(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Ofe(e){return e.read_shift(2),e.read_shift(4)}function SD(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function Dfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:c,Selected:d,TabRatio:f}}function Ife(){var e=ke(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Rfe(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Mfe(e){var t=ke(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Pfe(){}function Ffe(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ph(e,0,r),n}function Lfe(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=ke(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Bfe(e){var t=_s(e);return t.isst=e.read_shift(4),t}function Ufe(e,t,r,n){var a=ke(10);return Ec(e,t,n,a),a.write_shift(4,r),a}function zfe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=_s(e);r.biff==2&&e.l++;var i=xh(e,n-e.l,r);return a.val=i,a}function $fe(e,t,r,n,a){var i=!a||a.biff==8,s=ke(8+ +i+(1+i)*r.length);return Ec(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function Hfe(e,t,r){var n=e.read_shift(2),a=zc(e,0,r);return[n,a]}function Vfe(e,t,r,n){var a=r&&r.biff==5;n||(n=ke(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var Gfe=zc;function ND(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),c=e.read_shift(2),d=e.read_shift(2);return e.l=n,{s:{r:i,c},e:{r:s,c:d}}}function Wfe(e,t){var r=t.biff==8||!t.biff?4:2,n=ke(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function qfe(e){var t=e.read_shift(2),r=e.read_shift(2),n=LF(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Kfe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(LF(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function Yfe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function Xfe(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),c=e.read_shift(4),d=e.read_shift(2);return a.patternType=Ade[c>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=d&127,a.icvBack=d>>7&127,a.fsxButton=d>>14&1),a}function Zfe(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Xfe(e,t,n.fStyle,r),n}function kD(e,t,r,n){var a=r&&r.biff==5;n||(n=ke(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Qfe(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Jfe(e){var t=ke(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function _D(e,t,r){var n=_s(e);(r.biff==2||t==9)&&++e.l;var a=rfe(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function e0e(e,t,r,n,a,i){var s=ke(8);return Ec(e,t,n,s),RF(r,i,s),s}function t0e(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_s(e),a=ea(e);return n.val=a,n}function r0e(e,t,r,n){var a=ke(14);return Ec(e,t,n,a),_c(r,a),a}var jD=ffe;function n0e(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=jc(e,i),c=[];n>e.l;)c.push(xh(e));return[i,a,s,c]}function ED(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=mfe(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var a0e=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function TD(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),d=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),d=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=jc(e,s,r);a&32&&(f=a0e[f.charCodeAt(0)]);var h=n-e.l;r&&r.biff==2&&--h;var p=n==e.l||c===0||!(h>0)?[]:yxe(e,h,r,c);return{chKey:i,Name:f,itab:d,rgce:p}}function $F(e,t,r){if(r.biff<8)return i0e(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(hfe(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function i0e(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ph(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function s0e(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=jc(e,n,r),s=jc(e,a,r);return[i,s]}function l0e(e,t,r){var n=UF(e);e.l++;var a=e.read_shift(1);return t-=8,[bxe(e,t,r),a,n]}function CD(e,t,r){var n=pfe(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,gxe(e,t,r)]}function o0e(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function c0e(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=zc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},c,s,i]}}function u0e(e,t,r){return c0e(e,t,r)}function d0e(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Lg(e));return r}function f0e(e){var t=ke(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)BF(e[r],t);return t}function h0e(e,t,r){if(r&&r.biff<8)return p0e(e,t,r);var n=zF(e),a=yfe(e,t-22,n[1]);return{cmo:n,ft:a}}var m0e={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function p0e(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((m0e[n]||ra)(e,t,r)),{cmo:[a,n,i],ft:s}}function x0e(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=ife(e,6,r);var c=e.read_shift(2);e.read_shift(2),Zr(e,2);var d=e.read_shift(2);e.l+=d;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var h=e[e.l],p=jc(e,e.lens[f+1]-e.lens[f]-1);if(a+=p,a.length>=(h?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function g0e(e,t){var r=Lg(e);e.l+=16;var n=cfe(e,t-24);return[r,n]}function v0e(e){var t=ke(24),r=kr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Nn([t,ufe(e[1])])}function y0e(e,t){e.read_shift(2);var r=Lg(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ua,""),[r,n]}function b0e(e){var t=e[1].Tooltip,r=ke(10+2*(t.length+1));r.write_shift(2,2048);var n=kr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function w0e(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=hD[r]||r,r=e.read_shift(2),t[1]=hD[r]||r,t}function S0e(e){return e||(e=ke(4)),e.write_shift(2,1),e.write_shift(2,1),e}function N0e(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(FF(e));return r}function k0e(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(FF(e));return r}function _0e(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function HF(e,t,r){if(!r.cellStyles)return ra(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),c=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var f={s:a,e:i,w:s,ixfe:c,flags:d};return(r.biff>=5||!r.biff)&&(f.level=d>>8&7),f}function j0e(e,t){var r=ke(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function E0e(e,t){var r={};return t<32||(e.l+=16,r.header=ea(e),r.footer=ea(e),e.l+=2),r}function T0e(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function C0e(e){for(var t=ke(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var A0e=_s,O0e=IF,D0e=xh;function I0e(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function R0e(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_s(e);++e.l;var a=zc(e,t-7,r);return n.t="str",n.val=a,n}function M0e(e){var t=_s(e);++e.l;var r=ea(e);return t.t="n",t.val=r,t}function P0e(e,t,r){var n=ke(15);return bh(n,e,t),n.write_shift(8,r,"f"),n}function F0e(e){var t=_s(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function L0e(e,t,r){var n=ke(9);return bh(n,e,t),n.write_shift(2,r),n}function B0e(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function U0e(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function z0e(e,t,r){var n=e.l+t,a=_s(e),i=e.read_shift(2),s=jc(e,i,r);return e.l=n,a.t="str",a.val=s,a}var $0e=[2,3,48,49,131,139,140,245],Iw=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Mg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,d){var f=[],h=yo(1);switch(d.type){case"base64":h=Xa(ai(c));break;case"binary":h=Xa(c);break;case"buffer":case"array":h=c;break}Bn(h,0);var p=h.read_shift(1),g=!!(p&136),v=!1,b=!1;switch(p){case 2:break;case 3:break;case 48:v=!0,g=!0;break;case 49:v=!0,g=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var y=0,w=521;p==2&&(y=h.read_shift(2)),h.l+=3,p!=2&&(y=h.read_shift(4)),y>1048576&&(y=1e6),p!=2&&(w=h.read_shift(2));var j=h.read_shift(2),T=d.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(T=e[h[h.l]]),h.l+=1,h.l+=2),b&&(h.l+=36);for(var N=[],C={},E=Math.min(h.length,p==2?521:w-10-(v?264:0)),O=b?32:11;h.l<E&&h[h.l]!=13;)switch(C={},C.name=g0.utils.decode(T,h.slice(h.l,h.l+O)).replace(/[\u0000\r\n].*$/g,""),h.l+=O,C.type=String.fromCharCode(h.read_shift(1)),p!=2&&!b&&(C.offset=h.read_shift(4)),C.len=h.read_shift(1),p==2&&(C.offset=h.read_shift(2)),C.dec=h.read_shift(1),C.name.length&&N.push(C),p!=2&&(h.l+=b?13:14),C.type){case"B":(!v||C.len!=8)&&d.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(h[h.l]!==13&&(h.l=w-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=w;var A=0,D=0;for(f[0]=[],D=0;D!=N.length;++D)f[0][D]=N[D].name;for(;y-- >0;){if(h[h.l]===42){h.l+=j;continue}for(++h.l,f[++A]=[],D=0,D=0;D!=N.length;++D){var M=h.slice(h.l,h.l+N[D].len);h.l+=N[D].len,Bn(M,0);var P=g0.utils.decode(T,M);switch(N[D].type){case"C":P.trim().length&&(f[A][D]=P.replace(/\s+$/,""));break;case"D":P.length===8?f[A][D]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):f[A][D]=P;break;case"F":f[A][D]=parseFloat(P.trim());break;case"+":case"I":f[A][D]=b?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":f[A][D]=!0;break;case"N":case"F":f[A][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[A][D]="##MEMO##"+(b?parseInt(P.trim(),10):M.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(f[A][D]=+P||0);break;case"@":f[A][D]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":f[A][D]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":f[A][D]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[A][D]=-M.read_shift(-8,"f");break;case"B":if(v&&N[D].len==8){f[A][D]=M.read_shift(8,"f");break}case"G":case"P":M.l+=N[D].len;break;case"0":if(N[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[D].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return d&&d.sheetRows&&(f=f.slice(0,d.sheetRows)),d.DBF=N,f}function n(c,d){var f=d||{};f.dateNF||(f.dateNF="yyyymmdd");var h=wd(r(c,f),f);return h["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,h}function a(c,d){try{return To(n(c,d),d)}catch(f){if(d&&d.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(c,d){var f=d||{};if(+f.codepage>=0&&Ki(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var h=Da(),p=Ox(c,{header:1,raw:!0,cellDates:!0}),g=p[0],v=p.slice(1),b=c["!cols"]||[],y=0,w=0,j=0,T=1;for(y=0;y<g.length;++y){if(((b[y]||{}).DBF||{}).name){g[y]=b[y].DBF.name,++j;continue}if(g[y]!=null){if(++j,typeof g[y]=="number"&&(g[y]=g[y].toString(10)),typeof g[y]!="string")throw new Error("DBF Invalid column name "+g[y]+" |"+typeof g[y]+"|");if(g.indexOf(g[y])!==y){for(w=0;w<1024;++w)if(g.indexOf(g[y]+"_"+w)==-1){g[y]+="_"+w;break}}}}var N=Et(c["!ref"]),C=[],E=[],O=[];for(y=0;y<=N.e.c-N.s.c;++y){var A="",D="",M=0,P=[];for(w=0;w<v.length;++w)v[w][y]!=null&&P.push(v[w][y]);if(P.length==0||g[y]==null){C[y]="?";continue}for(w=0;w<P.length;++w){switch(typeof P[w]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=P[w]instanceof Date?"D":"C";break;default:D="C"}M=Math.max(M,String(P[w]).length),A=A&&A!=D?"C":D}M>250&&(M=250),D=((b[y]||{}).DBF||{}).type,D=="C"&&b[y].DBF.len>M&&(M=b[y].DBF.len),A=="B"&&D=="N"&&(A="N",O[y]=b[y].DBF.dec,M=b[y].DBF.len),E[y]=A=="C"||D=="N"?M:i[A]||0,T+=E[y],C[y]=A}var R=h.next(32);for(R.write_shift(4,318902576),R.write_shift(4,v.length),R.write_shift(2,296+32*j),R.write_shift(2,T),y=0;y<4;++y)R.write_shift(4,0);for(R.write_shift(4,0|(+t[O8]||3)<<8),y=0,w=0;y<g.length;++y)if(g[y]!=null){var L=h.next(32),te=(g[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,te,"sbcs"),L.write_shift(1,C[y]=="?"?"C":C[y],"sbcs"),L.write_shift(4,w),L.write_shift(1,E[y]||i[C[y]]||0),L.write_shift(1,O[y]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),w+=E[y]||i[C[y]]||0}var ee=h.next(264);for(ee.write_shift(4,13),y=0;y<65;++y)ee.write_shift(4,0);for(y=0;y<v.length;++y){var ue=h.next(T);for(ue.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(C[w]){case"L":ue.write_shift(1,v[y][w]==null?63:v[y][w]?84:70);break;case"B":ue.write_shift(8,v[y][w]||0,"f");break;case"N":var V="0";for(typeof v[y][w]=="number"&&(V=v[y][w].toFixed(O[w]||0)),j=0;j<E[w]-V.length;++j)ue.write_shift(1,32);ue.write_shift(1,V,"sbcs");break;case"D":v[y][w]?(ue.write_shift(4,("0000"+v[y][w].getFullYear()).slice(-4),"sbcs"),ue.write_shift(2,("00"+(v[y][w].getMonth()+1)).slice(-2),"sbcs"),ue.write_shift(2,("00"+v[y][w].getDate()).slice(-2),"sbcs")):ue.write_shift(8,"00000000","sbcs");break;case"C":var K=String(v[y][w]!=null?v[y][w]:"").slice(0,E[w]);for(ue.write_shift(1,K,"sbcs"),j=0;j<E[w]-K.length;++j)ue.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}})(),VF=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Rr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,v){var b=e[v];return typeof b=="number"?UO(b):b},n=function(g,v,b){var y=v.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return y==59?g:UO(y)};e["|"]=254;function a(g,v){switch(v.type){case"base64":return i(ai(g),v);case"binary":return i(g,v);case"buffer":return i(xt&&Buffer.isBuffer(g)?g.toString("binary"):Eo(g),v);case"array":return i(kc(g),v)}throw new Error("Unrecognized type "+v.type)}function i(g,v){var b=g.split(/[\n\r]+/),y=-1,w=-1,j=0,T=0,N=[],C=[],E=null,O={},A=[],D=[],M=[],P=0,R;for(+v.codepage>=0&&Ki(+v.codepage);j!==b.length;++j){P=0;var L=b[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),te=L.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),ee=te[0],ue;if(L.length>0)switch(ee){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&C.push(L.slice(3).replace(/;;/g,";"));break;case"C":var V=!1,K=!1,ie=!1,re=!1,me=-1,W=-1;for(T=1;T<te.length;++T)switch(te[T].charAt(0)){case"A":break;case"X":w=parseInt(te[T].slice(1))-1,K=!0;break;case"Y":for(y=parseInt(te[T].slice(1))-1,K||(w=0),R=N.length;R<=y;++R)N[R]=[];break;case"K":ue=te[T].slice(1),ue.charAt(0)==='"'?ue=ue.slice(1,ue.length-1):ue==="TRUE"?ue=!0:ue==="FALSE"?ue=!1:isNaN(Zi(ue))?isNaN(td(ue).getDate())||(ue=fr(ue)):(ue=Zi(ue),E!==null&&Mc(E)&&(ue=Fg(ue))),V=!0;break;case"E":re=!0;var F=$u(te[T].slice(1),{r:y,c:w});N[y][w]=[N[y][w],F];break;case"S":ie=!0,N[y][w]=[N[y][w],"S5S"];break;case"G":break;case"R":me=parseInt(te[T].slice(1))-1;break;case"C":W=parseInt(te[T].slice(1))-1;break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+L)}if(V&&(N[y][w]&&N[y][w].length==2?N[y][w][0]=ue:N[y][w]=ue,E=null),ie){if(re)throw new Error("SYLK shared formula cannot have own formula");var X=me>-1&&N[me][W];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");N[y][w][1]=oL(X[1],{r:y-me,c:w-W})}break;case"F":var q=0;for(T=1;T<te.length;++T)switch(te[T].charAt(0)){case"X":w=parseInt(te[T].slice(1))-1,++q;break;case"Y":for(y=parseInt(te[T].slice(1))-1,R=N.length;R<=y;++R)N[R]=[];break;case"M":P=parseInt(te[T].slice(1))/20;break;case"F":break;case"G":break;case"P":E=C[parseInt(te[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=te[T].slice(1).split(" "),R=parseInt(M[0],10);R<=parseInt(M[1],10);++R)P=parseInt(M[2],10),D[R-1]=P===0?{hidden:!0}:{wch:P},bo(D[R-1]);break;case"C":w=parseInt(te[T].slice(1))-1,D[w]||(D[w]={});break;case"R":y=parseInt(te[T].slice(1))-1,A[y]||(A[y]={}),P>0?(A[y].hpt=P,A[y].hpx=nd(P)):P===0&&(A[y].hidden=!0);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+L)}q<1&&(E=null);break;default:if(v&&v.WTF)throw new Error("SYLK bad record "+L)}}return A.length>0&&(O["!rows"]=A),D.length>0&&(O["!cols"]=D),v&&v.sheetRows&&(N=N.slice(0,v.sheetRows)),[N,O]}function s(g,v){var b=a(g,v),y=b[0],w=b[1],j=wd(y,v);return Rr(w).forEach(function(T){j[T]=w[T]}),j}function c(g,v){return To(s(g,v),v)}function d(g,v,b,y){var w="C;Y"+(b+1)+";X"+(y+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+gk(g.f,{r:b,c:y}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function f(g,v){v.forEach(function(b,y){var w="F;W"+(y+1)+" "+(y+1)+" ";b.hidden?w+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=_0(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=j0(b.wpx)),typeof b.wch=="number"&&(w+=Math.round(b.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function h(g,v){v.forEach(function(b,y){var w="F;";b.hidden?w+="M0;":b.hpt?w+="M"+20*b.hpt+";":b.hpx&&(w+="M"+20*E0(b.hpx)+";"),w.length>2&&g.push(w+"R"+(y+1))})}function p(g,v){var b=["ID;PWXL;N;E"],y=[],w=Et(g["!ref"]),j,T=Array.isArray(g),N=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),g["!cols"]&&f(b,g["!cols"]),g["!rows"]&&h(b,g["!rows"]),b.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var C=w.s.r;C<=w.e.r;++C)for(var E=w.s.c;E<=w.e.c;++E){var O=nt({r:C,c:E});j=T?(g[C]||[])[E]:g[O],!(!j||j.v==null&&(!j.f||j.F))&&y.push(d(j,g,C,E))}return b.join(N)+N+y.join(N)+N+"E"+N}return{to_workbook:c,to_sheet:s,from_sheet:p}})(),GF=(function(){function e(i,s){switch(s.type){case"base64":return t(ai(i),s);case"binary":return t(i,s);case"buffer":return t(xt&&Buffer.isBuffer(i)?i.toString("binary"):Eo(i),s);case"array":return t(kc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var c=i.split(`
`),d=-1,f=-1,h=0,p=[];h!==c.length;++h){if(c[h].trim()==="BOT"){p[++d]=[],f=0;continue}if(!(d<0)){var g=c[h].trim().split(","),v=g[0],b=g[1];++h;for(var y=c[h]||"";(y.match(/["]/g)||[]).length&1&&h<c.length-1;)y+=`
`+c[++h];switch(y=y.trim(),+v){case-1:if(y==="BOT"){p[++d]=[],f=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?p[d][f]=!0:y==="FALSE"?p[d][f]=!1:isNaN(Zi(b))?isNaN(td(b).getDate())?p[d][f]=b:p[d][f]=fr(b):p[d][f]=Zi(b),++f;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),p[d][f++]=y!==""?y:null;break}if(y==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function r(i,s){return wd(e(i,s),s)}function n(i,s){return To(r(i,s),s)}var a=(function(){var i=function(d,f,h,p,g){d.push(f),d.push(h+","+p),d.push('"'+g.replace(/"/g,'""')+'"')},s=function(d,f,h,p){d.push(f+","+h),d.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(d){var f=[],h=Et(d["!ref"]),p,g=Array.isArray(d);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,h.e.r-h.s.r+1,""),i(f,"TUPLES",0,h.e.c-h.s.c+1,""),i(f,"DATA",0,0,"");for(var v=h.s.r;v<=h.e.r;++v){s(f,-1,0,"BOT");for(var b=h.s.c;b<=h.e.c;++b){var y=nt({r:v,c:b});if(p=g?(d[v]||[])[b]:d[y],!p){s(f,1,0,"");continue}switch(p.t){case"n":var w=p.w;!w&&p.v!=null&&(w=p.v),w==null?p.f&&!p.F?s(f,1,0,"="+p.f):s(f,1,0,""):s(f,0,w,"V");break;case"b":s(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=ii(p.z||tt[14],on(fr(p.v)))),s(f,0,p.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var j=`\r
`,T=f.join(j);return T}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),WF=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var v=p.split(`
`),b=-1,y=-1,w=0,j=[];w!==v.length;++w){var T=v[w].trim().split(":");if(T[0]==="cell"){var N=kr(T[1]);if(j.length<=N.r)for(b=j.length;b<=N.r;++b)j[b]||(j[b]=[]);switch(b=N.r,y=N.c,T[2]){case"t":j[b][y]=e(T[3]);break;case"v":j[b][y]=+T[3];break;case"vtf":var C=T[T.length-1];case"vtc":T[3]==="nl"?j[b][y]=!!+T[4]:j[b][y]=+T[4],T[2]=="vtf"&&(j[b][y]=[j[b][y],C])}}}return g&&g.sheetRows&&(j=j.slice(0,g.sheetRows)),j}function n(p,g){return wd(r(p,g),g)}function a(p,g){return To(n(p,g),g)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var g=[],v=[],b,y="",w=Ia(p["!ref"]),j=Array.isArray(p),T=w.s.r;T<=w.e.r;++T)for(var N=w.s.c;N<=w.e.c;++N)if(y=nt({r:T,c:N}),b=j?(p[T]||[])[N]:p[y],!(!b||b.v==null||b.t==="z")){switch(v=["cell",y,"t"],b.t){case"s":case"str":v.push(t(b.v));break;case"n":b.f?(v[2]="vtf",v[3]="n",v[4]=b.v,v[5]=t(b.f)):(v[2]="v",v[3]=b.v);break;case"b":v[2]="vt"+(b.f?"f":"c"),v[3]="nl",v[4]=b.v?"1":"0",v[5]=t(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var C=on(fr(b.v));v[2]="vtc",v[3]="nd",v[4]=""+C,v[5]=b.w||ii(b.z||tt[14],C);break;case"e":continue}g.push(v.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(p){return[i,s,c,s,f(p),d].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:h}})(),rd=(function(){function e(h,p,g,v,b){b.raw?p[g][v]=h:h===""||(h==="TRUE"?p[g][v]=!0:h==="FALSE"?p[g][v]=!1:isNaN(Zi(h))?isNaN(td(h).getDate())?p[g][v]=h:p[g][v]=fr(h):p[g][v]=Zi(h))}function t(h,p){var g=p||{},v=[];if(!h||h.length===0)return v;for(var b=h.split(/[\r\n]/),y=b.length-1;y>=0&&b[y].length===0;)--y;for(var w=10,j=0,T=0;T<=y;++T)j=b[T].indexOf(" "),j==-1?j=b[T].length:j++,w=Math.max(w,j);for(T=0;T<=y;++T){v[T]=[];var N=0;for(e(b[T].slice(0,w).trim(),v,T,N,g),N=1;N<=(b[T].length-w)/10+1;++N)e(b[T].slice(w+(N-1)*10,w+N*10).trim(),v,T,N,g)}return g.sheetRows&&(v=v.slice(0,g.sheetRows)),v}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(h){for(var p={},g=!1,v=0,b=0;v<h.length;++v)(b=h.charCodeAt(v))==34?g=!g:!g&&b in r&&(p[b]=(p[b]||0)+1);b=[];for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&b.push([p[v],v]);if(!b.length){p=n;for(v in p)Object.prototype.hasOwnProperty.call(p,v)&&b.push([p[v],v])}return b.sort(function(y,w){return y[0]-w[0]||n[y[1]]-n[w[1]]}),r[b.pop()[1]]||44}function i(h,p){var g=p||{},v="",b=g.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(v=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(v=h.charAt(4),h=h.slice(6)):v=a(h.slice(0,1024)):g&&g.FS?v=g.FS:v=a(h.slice(0,1024));var w=0,j=0,T=0,N=0,C=0,E=v.charCodeAt(0),O=!1,A=0,D=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var M=g.dateNF!=null?Tue(g.dateNF):null;function P(){var R=h.slice(N,C),L={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)L.t="z";else if(g.raw)L.t="s",L.v=R;else if(R.trim().length===0)L.t="s",L.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(L.t="s",L.v=R.slice(2,-1).replace(/""/g,'"')):npe(R)?(L.t="n",L.f=R.slice(1)):(L.t="s",L.v=R);else if(R=="TRUE")L.t="b",L.v=!0;else if(R=="FALSE")L.t="b",L.v=!1;else if(!isNaN(T=Zi(R)))L.t="n",g.cellText!==!1&&(L.w=R),L.v=T;else if(!isNaN(td(R).getDate())||M&&R.match(M)){L.z=g.dateNF||tt[14];var te=0;M&&R.match(M)&&(R=Cue(R,g.dateNF,R.match(M)||[]),te=1),g.cellDates?(L.t="d",L.v=fr(R,te)):(L.t="n",L.v=on(fr(R,te))),g.cellText!==!1&&(L.w=ii(L.z,L.v instanceof Date?on(L.v):L.v)),g.cellNF||delete L.z}else L.t="s",L.v=R;if(L.t=="z"||(g.dense?(b[w]||(b[w]=[]),b[w][j]=L):b[nt({c:j,r:w})]=L),N=C+1,D=h.charCodeAt(N),y.e.c<j&&(y.e.c=j),y.e.r<w&&(y.e.r=w),A==E)++j;else if(j=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;C<h.length;++C)switch(A=h.charCodeAt(C)){case 34:D===34&&(O=!O);break;case E:case 10:case 13:if(!O&&P())break e;break}return C-N>0&&P(),b["!ref"]=dt(y),b}function s(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,p):wd(t(h,p),p)}function c(h,p){var g="",v=p.type=="string"?[0,0,0,0]:_k(h,p);switch(p.type){case"base64":g=ai(h);break;case"binary":g=h;break;case"buffer":p.codepage==65001?g=h.toString("utf8"):p.codepage&&typeof g0<"u"||(g=xt&&Buffer.isBuffer(h)?h.toString("binary"):Eo(h));break;case"array":g=kc(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+p.type)}return v[0]==239&&v[1]==187&&v[2]==191?g=Yt(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=Yt(g):p.type=="binary"&&typeof g0<"u",g.slice(0,19)=="socialcalc:version:"?WF.to_sheet(p.type=="string"?g:Yt(g),p):s(g,p)}function d(h,p){return To(c(h,p),p)}function f(h){for(var p=[],g=Et(h["!ref"]),v,b=Array.isArray(h),y=g.s.r;y<=g.e.r;++y){for(var w=[],j=g.s.c;j<=g.e.c;++j){var T=nt({r:y,c:j});if(v=b?(h[y]||[])[j]:h[T],!v||v.v==null){w.push("          ");continue}for(var N=(v.w||(pl(v),v.w)||"").slice(0,10);N.length<10;)N+=" ";w.push(N+(j===0?" ":""))}p.push(w.join(""))}return p.join(`
`)}return{to_workbook:d,to_sheet:c,from_sheet:f}})();function H0e(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=VF.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return rd.to_workbook(e,t)}}var fc=(function(){function e(F,X,q){if(F){Bn(F,F.l||0);for(var U=q.Enum||me;F.l<F.length;){var G=F.read_shift(2),le=U[G]||U[65535],de=F.read_shift(2),ne=F.l+de,oe=le.f&&le.f(F,de,q);if(F.l=ne,X(oe,le,G))return}}}function t(F,X){switch(X.type){case"base64":return r(Xa(ai(F)),X);case"binary":return r(Xa(F),X);case"buffer":case"array":return r(F,X)}throw"Unsupported type "+X.type}function r(F,X){if(!F)return F;var q=X||{},U=q.dense?[]:{},G="Sheet1",le="",de=0,ne={},oe=[],Ae=[],z={s:{r:0,c:0},e:{r:0,c:0}},et=q.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)q.Enum=me,e(F,function(Ie,_t,Er){switch(Er){case 0:q.vers=Ie,Ie>=4096&&(q.qpro=!0);break;case 6:z=Ie;break;case 204:Ie&&(le=Ie);break;case 222:le=Ie;break;case 15:case 51:q.qpro||(Ie[1].v=Ie[1].v.slice(1));case 13:case 14:case 16:Er==14&&(Ie[2]&112)==112&&(Ie[2]&15)>1&&(Ie[2]&15)<15&&(Ie[1].z=q.dateNF||tt[14],q.cellDates&&(Ie[1].t="d",Ie[1].v=Fg(Ie[1].v))),q.qpro&&Ie[3]>de&&(U["!ref"]=dt(z),ne[G]=U,oe.push(G),U=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},de=Ie[3],G=le||"Sheet"+(de+1),le="");var fe=q.dense?(U[Ie[0].r]||[])[Ie[0].c]:U[nt(Ie[0])];if(fe){fe.t=Ie[1].t,fe.v=Ie[1].v,Ie[1].z!=null&&(fe.z=Ie[1].z),Ie[1].f!=null&&(fe.f=Ie[1].f);break}q.dense?(U[Ie[0].r]||(U[Ie[0].r]=[]),U[Ie[0].r][Ie[0].c]=Ie[1]):U[nt(Ie[0])]=Ie[1];break}},q);else if(F[2]==26||F[2]==14)q.Enum=W,F[2]==14&&(q.qpro=!0,F.l=0),e(F,function(Ie,_t,Er){switch(Er){case 204:G=Ie;break;case 22:Ie[1].v=Ie[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ie[3]>de&&(U["!ref"]=dt(z),ne[G]=U,oe.push(G),U=q.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},de=Ie[3],G="Sheet"+(de+1)),et>0&&Ie[0].r>=et)break;q.dense?(U[Ie[0].r]||(U[Ie[0].r]=[]),U[Ie[0].r][Ie[0].c]=Ie[1]):U[nt(Ie[0])]=Ie[1],z.e.c<Ie[0].c&&(z.e.c=Ie[0].c),z.e.r<Ie[0].r&&(z.e.r=Ie[0].r);break;case 27:Ie[14e3]&&(Ae[Ie[14e3][0]]=Ie[14e3][1]);break;case 1537:Ae[Ie[0]]=Ie[1],Ie[0]==de&&(G=Ie[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(U["!ref"]=dt(z),ne[le||G]=U,oe.push(le||G),!Ae.length)return{SheetNames:oe,Sheets:ne};for(var Be={},Je=[],He=0;He<Ae.length;++He)ne[oe[He]]?(Je.push(Ae[He]||oe[He]),Be[Ae[He]]=ne[Ae[He]]||ne[oe[He]]):(Je.push(Ae[He]),Be[Ae[He]]={"!ref":"A1"});return{SheetNames:Je,Sheets:Be}}function n(F,X){var q=X||{};if(+q.codepage>=0&&Ki(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var U=Da(),G=Et(F["!ref"]),le=Array.isArray(F),de=[];Le(U,0,i(1030)),Le(U,6,d(G));for(var ne=Math.min(G.e.r,8191),oe=G.s.r;oe<=ne;++oe)for(var Ae=$r(oe),z=G.s.c;z<=G.e.c;++z){oe===G.s.r&&(de[z]=Nr(z));var et=de[z]+Ae,Be=le?(F[oe]||[])[z]:F[et];if(!(!Be||Be.t=="z"))if(Be.t=="n")(Be.v|0)==Be.v&&Be.v>=-32768&&Be.v<=32767?Le(U,13,v(oe,z,Be.v)):Le(U,14,y(oe,z,Be.v));else{var Je=pl(Be);Le(U,15,p(oe,z,Je.slice(0,239)))}}return Le(U,1),U.end()}function a(F,X){var q=X||{};if(+q.codepage>=0&&Ki(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var U=Da();Le(U,0,s(F));for(var G=0,le=0;G<F.SheetNames.length;++G)(F.Sheets[F.SheetNames[G]]||{})["!ref"]&&Le(U,27,re(F.SheetNames[G],le++));var de=0;for(G=0;G<F.SheetNames.length;++G){var ne=F.Sheets[F.SheetNames[G]];if(!(!ne||!ne["!ref"])){for(var oe=Et(ne["!ref"]),Ae=Array.isArray(ne),z=[],et=Math.min(oe.e.r,8191),Be=oe.s.r;Be<=et;++Be)for(var Je=$r(Be),He=oe.s.c;He<=oe.e.c;++He){Be===oe.s.r&&(z[He]=Nr(He));var Ie=z[He]+Je,_t=Ae?(ne[Be]||[])[He]:ne[Ie];if(!(!_t||_t.t=="z"))if(_t.t=="n")Le(U,23,P(Be,He,de,_t.v));else{var Er=pl(_t);Le(U,22,A(Be,He,de,Er.slice(0,239)))}}++de}}return Le(U,1),U.end()}function i(F){var X=ke(2);return X.write_shift(2,F),X}function s(F){var X=ke(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var q=0,U=0,G=0,le=0;le<F.SheetNames.length;++le){var de=F.SheetNames[le],ne=F.Sheets[de];if(!(!ne||!ne["!ref"])){++G;var oe=Ia(ne["!ref"]);q<oe.e.r&&(q=oe.e.r),U<oe.e.c&&(U=oe.e.c)}}return q>8191&&(q=8191),X.write_shift(2,q),X.write_shift(1,G),X.write_shift(1,U),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function c(F,X,q){var U={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&q.qpro?(U.s.c=F.read_shift(1),F.l++,U.s.r=F.read_shift(2),U.e.c=F.read_shift(1),F.l++,U.e.r=F.read_shift(2),U):(U.s.c=F.read_shift(2),U.s.r=F.read_shift(2),X==12&&q.qpro&&(F.l+=2),U.e.c=F.read_shift(2),U.e.r=F.read_shift(2),X==12&&q.qpro&&(F.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function d(F){var X=ke(8);return X.write_shift(2,F.s.c),X.write_shift(2,F.s.r),X.write_shift(2,F.e.c),X.write_shift(2,F.e.r),X}function f(F,X,q){var U=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(U[0].c=F.read_shift(1),U[3]=F.read_shift(1),U[0].r=F.read_shift(2),F.l+=2):(U[2]=F.read_shift(1),U[0].c=F.read_shift(2),U[0].r=F.read_shift(2)),U}function h(F,X,q){var U=F.l+X,G=f(F,X,q);if(G[1].t="s",q.vers==20768){F.l++;var le=F.read_shift(1);return G[1].v=F.read_shift(le,"utf8"),G}return q.qpro&&F.l++,G[1].v=F.read_shift(U-F.l,"cstr"),G}function p(F,X,q){var U=ke(7+q.length);U.write_shift(1,255),U.write_shift(2,X),U.write_shift(2,F),U.write_shift(1,39);for(var G=0;G<U.length;++G){var le=q.charCodeAt(G);U.write_shift(1,le>=128?95:le)}return U.write_shift(1,0),U}function g(F,X,q){var U=f(F,X,q);return U[1].v=F.read_shift(2,"i"),U}function v(F,X,q){var U=ke(7);return U.write_shift(1,255),U.write_shift(2,X),U.write_shift(2,F),U.write_shift(2,q,"i"),U}function b(F,X,q){var U=f(F,X,q);return U[1].v=F.read_shift(8,"f"),U}function y(F,X,q){var U=ke(13);return U.write_shift(1,255),U.write_shift(2,X),U.write_shift(2,F),U.write_shift(8,q,"f"),U}function w(F,X,q){var U=F.l+X,G=f(F,X,q);if(G[1].v=F.read_shift(8,"f"),q.qpro)F.l=U;else{var le=F.read_shift(2);C(F.slice(F.l,F.l+le),G),F.l+=le}return G}function j(F,X,q){var U=X&32768;return X&=-32769,X=(U?F:0)+(X>=8192?X-16384:X),(U?"":"$")+(q?Nr(X):$r(X))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(F,X){Bn(F,0);for(var q=[],U=0,G="",le="",de="",ne="";F.l<F.length;){var oe=F[F.l++];switch(oe){case 0:q.push(F.read_shift(8,"f"));break;case 1:le=j(X[0].c,F.read_shift(2),!0),G=j(X[0].r,F.read_shift(2),!1),q.push(le+G);break;case 2:{var Ae=j(X[0].c,F.read_shift(2),!0),z=j(X[0].r,F.read_shift(2),!1);le=j(X[0].c,F.read_shift(2),!0),G=j(X[0].r,F.read_shift(2),!1),q.push(Ae+z+":"+le+G)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(F.read_shift(2));break;case 6:{for(var et="";oe=F[F.l++];)et+=String.fromCharCode(oe);q.push('"'+et.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:ne=q.pop(),de=q.pop(),q.push(["AND","OR"][oe-20]+"("+de+","+ne+")");break;default:if(oe<32&&N[oe])ne=q.pop(),de=q.pop(),q.push(de+N[oe]+ne);else if(T[oe]){if(U=T[oe][1],U==69&&(U=F[F.l++]),U>q.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+q.join("|")+"|");return}var Be=q.slice(-U);q.length-=U,q.push(T[oe][0]+"("+Be.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}q.length==1?X[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function E(F){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=F.read_shift(2),X[3]=F[F.l++],X[0].c=F[F.l++],X}function O(F,X){var q=E(F);return q[1].t="s",q[1].v=F.read_shift(X-4,"cstr"),q}function A(F,X,q,U){var G=ke(6+U.length);G.write_shift(2,F),G.write_shift(1,q),G.write_shift(1,X),G.write_shift(1,39);for(var le=0;le<U.length;++le){var de=U.charCodeAt(le);G.write_shift(1,de>=128?95:de)}return G.write_shift(1,0),G}function D(F,X){var q=E(F);q[1].v=F.read_shift(2);var U=q[1].v>>1;if(q[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return q[1].v=U,q}function M(F,X){var q=E(F),U=F.read_shift(4),G=F.read_shift(4),le=F.read_shift(2);if(le==65535)return U===0&&G===3221225472?(q[1].t="e",q[1].v=15):U===0&&G===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var de=le&32768;return le=(le&32767)-16446,q[1].v=(1-de*2)*(G*Math.pow(2,le+32)+U*Math.pow(2,le)),q}function P(F,X,q,U){var G=ke(14);if(G.write_shift(2,F),G.write_shift(1,q),G.write_shift(1,X),U==0)return G.write_shift(4,0),G.write_shift(4,0),G.write_shift(2,65535),G;var le=0,de=0,ne=0,oe=0;return U<0&&(le=1,U=-U),de=Math.log2(U)|0,U/=Math.pow(2,de-31),oe=U>>>0,(oe&2147483648)==0&&(U/=2,++de,oe=U>>>0),U-=oe,oe|=2147483648,oe>>>=0,U*=Math.pow(2,32),ne=U>>>0,G.write_shift(4,ne),G.write_shift(4,oe),de+=16383+(le?32768:0),G.write_shift(2,de),G}function R(F,X){var q=M(F);return F.l+=X-14,q}function L(F,X){var q=E(F),U=F.read_shift(4);return q[1].v=U>>6,q}function te(F,X){var q=E(F),U=F.read_shift(8,"f");return q[1].v=U,q}function ee(F,X){var q=te(F);return F.l+=X-10,q}function ue(F,X){return F[F.l+X-1]==0?F.read_shift(X,"cstr"):""}function V(F,X){var q=F[F.l++];q>X-1&&(q=X-1);for(var U="";U.length<q;)U+=String.fromCharCode(F[F.l++]);return U}function K(F,X,q){if(!(!q.qpro||X<21)){var U=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var G=F.read_shift(X-21,"cstr");return[U,G]}}function ie(F,X){for(var q={},U=F.l+X;F.l<U;){var G=F.read_shift(2);if(G==14e3){for(q[G]=[0,""],q[G][0]=F.read_shift(2);F[F.l];)q[G][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return q}function re(F,X){var q=ke(5+F.length);q.write_shift(2,14e3),q.write_shift(2,X);for(var U=0;U<F.length;++U){var G=F.charCodeAt(U);q[q.l++]=G>127?95:G}return q[q.l++]=0,q}var me={0:{n:"BOF",f:Zr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ue},222:{n:"SHEETNAMELP",f:V},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:ee},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ue},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function V0e(e){var t={},r=e.match(na),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=it(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=$N[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var G0e=(function(){var e=b0("t"),t=b0("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var c={t:"s",v:jt(s[1])},d=i.match(t);return d&&(c.s=V0e(d[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(c){return c.v})}})(),W0e=(function(){var t=/(\r\n|\n)/g;function r(a,i,s){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var d=a.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(i.push("<"+d+">"),s.push("</"+d+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),q0e=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,K0e=/<(?:\w+:)?r>/,Y0e=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function fk(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(Yt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Yt(e),r&&(n.h=QN(n.t))):e.match(K0e)&&(n.r=Yt(e),n.t=jt(Yt((e.replace(Y0e,"").match(q0e)||[]).join("").replace(na,""))),r&&(n.h=W0e(G0e(n.r)))),n):{t:""}}var X0e=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Z0e=/<(?:\w+:)?(?:si|sstItem)>/g,Q0e=/<\/(?:\w+:)?(?:si|sstItem)>/;function J0e(e,t){var r=[],n="";if(!e)return r;var a=e.match(X0e);if(a){n=a[2].replace(Z0e,"").split(Q0e);for(var i=0;i!=n.length;++i){var s=fk(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=it(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var ehe=/^\s|\s$|[\t\n\r]/;function qF(e,t){if(!t.bookSST)return"";var r=[Hr];r[r.length]=Fe("sst",null,{xmlns:Pc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(ehe)&&(i+=' xml:space="preserve"'),i+=">"+Ht(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function the(e){return[e.read_shift(4),e.read_shift(4)]}function rhe(e,t){var r=[],n=!1;return _l(e,function(i,s,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function nhe(e,t){return t||(t=ke(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var ahe=mde;function ihe(e){var t=Da();Ce(t,159,nhe(e));for(var r=0;r<e.length;++r)Ce(t,19,ahe(e[r]));return Ce(t,160),t.end()}function KF(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function nl(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function she(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=nl(e,4),t.U=nl(e,4),t.W=nl(e,4),t}function lhe(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function ohe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(lhe(e));return t}function che(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function uhe(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=nl(e,4),t.U=nl(e,4),t.W=nl(e,4),t}function dhe(e){var t=uhe(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function YF(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function XF(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function fhe(e){var t=nl(e);switch(t.Minor){case 2:return[t.Minor,hhe(e)];case 3:return[t.Minor,mhe()];case 4:return[t.Minor,phe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function hhe(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=YF(e,r),a=XF(e,e.length-e.l);return{t:"Std",h:n,v:a}}function mhe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function phe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(na,function(i){var s=it(i);switch(ks(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=s[c]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function xhe(e,t){var r={},n=r.EncryptionVersionInfo=nl(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=YF(e,a),t-=a,r.EncryptionVerifier=XF(e,t),r}function ghe(e){var t={},r=t.EncryptionVersionInfo=nl(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function hk(e){var t=0,r,n=KF(e),a=n.length+1,i,s,c,d,f;for(r=yo(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],c=(t&16384)===0?0:1,d=t<<1&32767,f=c|d,t=f^s;return t^52811}var ZF=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,c){return n(s^c)},i=function(s){for(var c=t[s.length-1],d=104,f=s.length-1;f>=0;--f)for(var h=s[f],p=0;p!=7;++p)h&64&&(c^=r[d]),h*=2,--d;return c};return function(s){for(var c=KF(s),d=i(c),f=c.length,h=yo(16),p=0;p!=16;++p)h[p]=0;var g,v,b;for((f&1)===1&&(g=d>>8,h[f]=a(e[0],g),--f,g=d&255,v=c[c.length-1],h[f]=a(v,g));f>0;)--f,g=d>>8,h[f]=a(c[f],g),--f,g=d&255,h[f]=a(c[f],g);for(f=15,b=15-c.length;b>0;)g=d>>8,h[f]=a(e[b],g),--f,--b,g=d&255,h[f]=a(c[f],g),--f,--b;return h}})(),vhe=function(e,t,r,n,a){a||(a=t),n||(n=ZF(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},yhe=function(e){var t=0,r=ZF(e);return function(n){var a=vhe("",n,t,r);return t=a[1],a[0]}};function bhe(e,t,r,n){var a={key:Zr(e),verificationBytes:Zr(e)};return r.password&&(a.verifier=hk(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=yhe(r.password)),a}function whe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=ghe(e):n.Data=xhe(e,t),n}function She(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?whe(e,t-2,n):bhe(e,r.biff>=8?t:t-2,r,n),n}var QF=(function(){function e(a,i){switch(i.type){case"base64":return t(ai(a),i);case"binary":return t(a,i);case"buffer":return t(xt&&Buffer.isBuffer(a)?a.toString("binary"):Eo(a),i);case"array":return t(kc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},c=s.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(h,p){Array.isArray(c)&&(c[p]=[]);for(var g=/\\\w+\b/g,v=0,b,y=-1;b=g.exec(h);){switch(b[0]){case"\\cell":var w=h.slice(v,g.lastIndex-b[0].length);if(w[0]==" "&&(w=w.slice(1)),++y,w.length){var j={v:w,t:"s"};Array.isArray(c)?c[p][y]=j:c[nt({r:p,c:y})]=j}break}v=g.lastIndex}y>f.e.c&&(f.e.c=y)}),c["!ref"]=dt(f),c}function r(a,i){return To(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Et(a["!ref"]),c,d=Array.isArray(a),f=s.s.r;f<=s.e.r;++f){i.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var p=nt({r:f,c:h});c=d?(a[f]||[])[h]:a[p],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(pl(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Nhe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function k0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function khe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var c=0,d=0,f=a+i;switch(d=s/(f>1?2-f:f),a){case t:c=((r-n)/s+6)%6;break;case r:c=(n-t)/s+2;break;case n:c=(t-r)/s+4;break}return[c/6,d,f/2]}function _he(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],c=6*t,d;if(r!==0)switch(c|0){case 0:case 6:d=a*c,s[0]+=a,s[1]+=d;break;case 1:d=a*(2-c),s[0]+=d,s[1]+=a;break;case 2:d=a*(c-2),s[1]+=a,s[2]+=d;break;case 3:d=a*(4-c),s[1]+=d,s[2]+=a;break;case 4:d=a*(c-4),s[2]+=a,s[0]+=d;break;case 5:d=a*(6-c),s[2]+=d,s[0]+=a;break}for(var f=0;f!=3;++f)s[f]=Math.round(s[f]*255);return s}function Tx(e,t){if(t===0)return e;var r=khe(Nhe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),k0(_he(r))}var JF=6,jhe=15,Ehe=1,Jn=JF;function _0(e){return Math.floor((e+Math.round(128/Jn)/256)*Jn)}function j0(e){return Math.floor((e-5)/Jn*100+.5)/100}function Cx(e){return Math.round((e*Jn+5)/Jn*256)/256}function Xb(e){return Cx(j0(_0(e)))}function mk(e){var t=Math.abs(e-Xb(e)),r=Jn;if(t>.005)for(Jn=Ehe;Jn<jhe;++Jn)Math.abs(e-Xb(e))<=t&&(t=Math.abs(e-Xb(e)),r=Jn);Jn=r}function bo(e){e.width?(e.wpx=_0(e.width),e.wch=j0(e.wpx),e.MDW=Jn):e.wpx?(e.wch=j0(e.wpx),e.width=Cx(e.wch),e.MDW=Jn):typeof e.wch=="number"&&(e.width=Cx(e.wch),e.wpx=_0(e.width),e.MDW=Jn),e.customWidth&&delete e.customWidth}var The=96,eL=The;function E0(e){return e*96/eL}function nd(e){return e*eL/96}var Che={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Ahe(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(na)||[]).forEach(function(s){var c=it(s);switch(ks(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=dr(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=dr(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function Ohe(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(na)||[]).forEach(function(s){var c=it(s);switch(ks(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function Dhe(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(na)||[]).forEach(function(s){var c=it(s);switch(ks(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Yt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?dr(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?dr(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?dr(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?dr(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?dr(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?dr(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?dr(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=$N[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=dr(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var d=uc[a.color.index];a.color.index==81&&(d=uc[1]),d||(d=uc[1]),a.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Tx(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function Ihe(e,t,r){t.NumberFmt=[];for(var n=Rr(tt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=tt[n[a]];var i=e[0].match(na);if(i)for(a=0;a<i.length;++a){var s=it(i[a]);switch(ks(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=jt(Yt(s.formatCode)),d=parseInt(s.numFmtId,10);if(t.NumberFmt[d]=c,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=c}vs(c,d)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function Rhe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Fe("numFmt",null,{numFmtId:n,formatCode:Ht(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Fe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var ap=["numFmtId","fillId","fontId","borderId","xfId"],ip=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Mhe(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(na)||[]).forEach(function(i){var s=it(i),c=0;switch(ks(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],c=0;c<ap.length;++c)n[ap[c]]&&(n[ap[c]]=parseInt(n[ap[c]],10));for(c=0;c<ip.length;++c)n[ip[c]]&&(n[ip[c]]=dr(n[ip[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};s.vertical&&(d.vertical=s.vertical),s.horizontal&&(d.horizontal=s.horizontal),s.textRotation!=null&&(d.textRotation=s.textRotation),s.indent&&(d.indent=s.indent),s.wrapText&&(d.wrapText=dr(s.wrapText)),n.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function Phe(e){var t=[];return t[t.length]=Fe("cellXfs",null),e.forEach(function(r){t[t.length]=Fe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Fe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Fhe=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,d,f){var h={};if(!c)return h;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=c.match(t))&&Ihe(p,h,f),(p=c.match(a))&&Dhe(p,h,d,f),(p=c.match(n))&&Ohe(p,h,d,f),(p=c.match(i))&&Ahe(p,h,d,f),(p=c.match(r))&&Mhe(p,h,f),h}})();function tL(e,t){var r=[Hr,Fe("styleSheet",null,{xmlns:Pc[0],"xmlns:vt":sn.vt})],n;return e.SSF&&(n=Rhe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Phe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Lhe(e,t){var r=e.read_shift(2),n=ta(e);return[r,n]}function Bhe(e,t,r){r||(r=ke(6+4*t.length)),r.write_shift(2,e),kn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Uhe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=wde(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var c=e.read_shift(1);c>0&&(n.family=c);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=bde(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ta(e),n}function zhe(e,t){t||(t=ke(153)),t.write_shift(2,e.sz*20),Sde(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),_x(e.color,t);var n=0;return n=2,t.write_shift(1,n),kn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var $he=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zb,Hhe=ra;function AD(e,t){t||(t=ke(84)),Zb||(Zb=Mg($he));var r=Zb[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(_x({auto:1},t),_x({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Vhe(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function rL(e,t,r){r||(r=ke(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function jf(e,t){return t||(t=ke(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ghe=ra;function Whe(e,t){return t||(t=ke(51)),t.write_shift(1,0),jf(null,t),jf(null,t),jf(null,t),jf(null,t),jf(null,t),t.length>t.l?t.slice(0,t.l):t}function qhe(e,t){return t||(t=ke(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),kx(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Khe(e,t,r){var n=ke(2052);return n.write_shift(4,e),kx(t,n),kx(r,n),n.length>n.l?n.slice(0,n.l):n}function Yhe(e,t,r){var n={};n.NumberFmt=[];for(var a in tt)n.NumberFmt[a]=tt[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return _l(e,function(d,f,h){switch(h){case 44:n.NumberFmt[d[0]]=d[1],vs(d[1],d[0]);break;case 43:n.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=Tx(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(h),s=!0;break;case 38:i.pop(),s=!1;break;default:if(f.T>0)i.push(h);else if(f.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function Xhe(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Ce(e,615,Qi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ce(e,44,Bhe(a,t[a]))}),Ce(e,616))}}function Zhe(e){var t=1;Ce(e,611,Qi(t)),Ce(e,43,zhe({sz:12,color:{theme:1},name:"Calibri",family:2})),Ce(e,612)}function Qhe(e){var t=2;Ce(e,603,Qi(t)),Ce(e,45,AD({patternType:"none"})),Ce(e,45,AD({patternType:"gray125"})),Ce(e,604)}function Jhe(e){var t=1;Ce(e,613,Qi(t)),Ce(e,46,Whe()),Ce(e,614)}function eme(e){var t=1;Ce(e,626,Qi(t)),Ce(e,47,rL({numFmtId:0},65535)),Ce(e,627)}function tme(e,t){Ce(e,617,Qi(t.length)),t.forEach(function(r){Ce(e,47,rL(r,0))}),Ce(e,618)}function rme(e){var t=1;Ce(e,619,Qi(t)),Ce(e,48,qhe({xfId:0,name:"Normal"})),Ce(e,620)}function nme(e){var t=0;Ce(e,505,Qi(t)),Ce(e,506)}function ame(e){var t=0;Ce(e,508,Khe(t,"TableStyleMedium9","PivotStyleMedium4")),Ce(e,509)}function ime(e,t){var r=Da();return Ce(r,278),Xhe(r,e.SSF),Zhe(r),Qhe(r),Jhe(r),eme(r),tme(r,t.cellXfs),rme(r),nme(r),ame(r),Ce(r,279),r.end()}var sme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function lme(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(na)||[]).forEach(function(a){var i=it(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[sme.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function ome(){}function cme(){}var ume=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,dme=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fme=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function hme(e,t,r){t.themeElements={};var n;[["clrScheme",ume,lme],["fontScheme",dme,ome],["fmtScheme",fme,cme]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var mme=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function nL(e,t){(!e||e.length===0)&&(e=pk());var r,n={};if(!(r=e.match(mme)))throw new Error("themeElements not found in theme");return hme(r[0],n,t),n.raw=e,n}function pk(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Hr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function pme(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=Y8(i,{type:"array"})}catch{return}var c=Za(s,"theme/theme/theme1.xml",!0);if(c)return nL(c,r)}}function xme(e){return e.read_shift(4)}function gme(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=vme(e,4);break;case 2:t.xclrValue=PF(e);break;case 3:t.xclrValue=xme(e);break;case 4:e.l+=4;break}return e.l+=8,t}function vme(e,t){return ra(e,t)}function yme(e,t){return ra(e,t)}function bme(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=gme(e);break;case 6:n[1]=yme(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function wme(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(bme(e,r-e.l));return{ixfe:n,ext:i}}function Sme(e,t){t.forEach(function(r){r[0]})}function Nme(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ta(e)}}function kme(e){var t=ke(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),kn(e.name,t),t.slice(0,t.l)}function _me(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function jme(e){var t=ke(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Eme(e,t){var r=ke(8+2*t.length);return r.write_shift(4,e),kn(t,r),r.slice(0,r.l)}function Tme(e){return e.l+=4,e.read_shift(4)!=0}function Cme(e,t){var r=ke(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Ame(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,c=2;return _l(e,function(d,f,h){switch(h){case 335:n.Types.push({name:d.name});break;case 51:d.forEach(function(p){c==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):c==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:c=d?1:0;break;case 338:c=2;break;case 35:i.push(h),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!f.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function Ome(){var e=Da();return Ce(e,332),Ce(e,334,Qi(1)),Ce(e,335,kme({name:"XLDAPR",version:12e4,flags:3496657072})),Ce(e,336),Ce(e,339,Eme(1,"XLDAPR")),Ce(e,52),Ce(e,35,Qi(514)),Ce(e,4096,Qi(0)),Ce(e,4097,Ei(1)),Ce(e,36),Ce(e,53),Ce(e,340),Ce(e,337,Cme(1)),Ce(e,51,jme([[1,0]])),Ce(e,338),Ce(e,333),e.end()}function Dme(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(na,function(c){var d=it(c);switch(ks(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==d.name&&(s=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[d.t-1].name,index:+d.v}):i==0&&n.Value.push({type:n.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+d.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return c}),n}function aL(){var e=[Hr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Ime(e){var t=[];if(!e)return t;var r=1;return(e.match(na)||[]).forEach(function(n){var a=it(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Rme(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=nt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Mme(e,t,r){var n=[];return _l(e,function(i,s,c){switch(c){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function Pme(e,t,r,n){if(!e)return e;var a=n||{},i=!1;_l(e,function(c,d,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!d.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function Fme(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Pu=1024;function iL(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Fe("xml",null,{"xmlns:v":Wa.v,"xmlns:o":Wa.o,"xmlns:x":Wa.x,"xmlns:mv":Wa.mv}).replace(/\/>/,">"),Fe("o:shapelayout",Fe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Fe("v:shapetype",[Fe("v:stroke",null,{joinstyle:"miter"}),Fe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Pu<e*1e3;)Pu+=1e3;return t.forEach(function(i){var s=kr(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var d=c.type=="gradient"?Fe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Fe("v:fill",d,c),h={on:"t",obscured:"t"};++Pu,a=a.concat(["<v:shape"+w0({id:"_x0000_s"+Pu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Fe("v:shadow",null,h),Fe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),zn("x:AutoFill","False"),zn("x:Row",String(s.r)),zn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function OD(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var c=kr(s.ref);if(a?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[s.ref],!i){i={t:"z"},a?e[c.r][c.c]=i:e[s.ref]=i;var d=Et(e["!ref"]||"BDWGO1000001:A1");d.s.r>c.r&&(d.s.r=c.r),d.e.r<c.r&&(d.e.r=c.r),d.s.c>c.c&&(d.s.c=c.c),d.e.c<c.c&&(d.e.c=c.c);var f=dt(d);f!==e["!ref"]&&(e["!ref"]=f)}i.c||(i.c=[]);var h={a:s.author,t:s.t,r:s.r,T:r};s.h&&(h.h=s.h);for(var p=i.c.length-1;p>=0;--p){if(!r&&i.c[p].T)return;r&&!i.c[p].T&&i.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(h.a==n[p].id){h.a=n[p].name||h.a;break}}i.c.push(h)})}function Lme(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?comment[^>]*>/);if(c){var d=it(c[0]),f={author:d.authorId&&r[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},h=kr(d.ref);if(!(t.sheetRows&&t.sheetRows<=h.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&fk(p[1])||{r:"",t:"",h:""};f.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),f.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=g.h),n.push(f)}}}}),n}function sL(e){var t=[Hr,Fe("comments",null,{xmlns:Pc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Ht(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(d){d.a&&(a=r.indexOf(Ht(d.a))),i.push(d.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(zn("t",Ht(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)s+=`Reply:
    `+i[c]+`
`;t.push(zn("t",Ht(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Bme(e,t){var r=[],n=!1,a={},i=0;return e.replace(na,function(c,d){var f=it(c);switch(ks(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=d+c.length;break;case"</text>":a.t=e.slice(i,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),r}function Ume(e,t,r){var n=[Hr,Fe("ThreadedComments",null,{xmlns:sn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,c){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var d={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=d.id:d.parentId=i,s.ID=d.id,s.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Fe("threadedComment",zn("text",s.t||""),d))})}),n.push("</ThreadedComments>"),n.join("")}function zme(e,t){var r=[],n=!1;return e.replace(na,function(i){var s=it(i);switch(ks(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function $me(e){var t=[Hr,Fe("personList",null,{xmlns:sn.TCMNT,"xmlns:x":Pc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Fe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Hme(e){var t={};t.iauthor=e.read_shift(4);var r=Uc(e);return t.rfx=r.s,t.ref=nt(r.s),e.l+=16,t}function Vme(e,t){return t==null&&(t=ke(36)),t.write_shift(4,e[1].iauthor),Sd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Gme=ta;function Wme(e){return kn(e.slice(0,54))}function qme(e,t){var r=[],n=[],a={},i=!1;return _l(e,function(c,d,f){switch(f){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}function Kme(e){var t=Da(),r=[];return Ce(t,628),Ce(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ce(t,632,Wme(a.a)))})}),Ce(t,631),Ce(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:kr(n[0]),e:kr(n[0])};Ce(t,635,Vme([i,a])),a.t&&a.t.length>0&&Ce(t,637,xde(a)),Ce(t,636),delete a.iauthor})}),Ce(t,634),Ce(t,629),t.end()}var Yme="application/vnd.ms-office.vbaProject";function Xme(e){var t=Qe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qe.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Qe.write(t)}function Zme(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Qe.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var lL=["xlsb","xlsm","xlam","biff8","xla"];function Qme(){return{"!type":"dialog"}}function Jme(){return{"!type":"dialog"}}function epe(){return{"!type":"macro"}}function tpe(){return{"!type":"macro"}}var $u=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var c=!1,d=!1;i.length==0?d=!0:i.charAt(0)=="["&&(d=!0,i=i.slice(1,-1)),s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return c?h+=t.c:--h,d?f+=t.r:--f,a+(c?"":"$")+Nr(h)+(d?"":"$")+$r(f)}return function(a,i){return t=i,a.replace(e,r)}})(),xk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gk=(function(){return function(t,r){return t.replace(xk,function(n,a,i,s,c,d){var f=nk(s)-(i?0:r.c),h=rk(d)-(c?0:r.r),p=h==0?"":c?h+1:"["+h+"]",g=f==0?"":i?f+1:"["+f+"]";return a+"R"+p+"C"+g})}})();function oL(e,t){return e.replace(xk,function(r,n,a,i,s,c){return n+(a=="$"?a+i:Nr(nk(i)+t.c))+(s=="$"?s+c:$r(rk(c)+t.r))})}function rpe(e,t,r){var n=Ia(t),a=n.s,i=kr(r),s={r:i.r-a.r,c:i.c-a.c};return oL(e,s)}function npe(e){return e.length!=1}function DD(e){return e.replace(/_xlfn\./g,"")}function Yr(e){e.l+=1}function wo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function cL(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return uL(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=wo(e),c=wo(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function uL(e){var t=wo(e),r=wo(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function ape(e,t,r){if(r.biff<8)return uL(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=wo(e),s=wo(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function dL(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return ipe(e);var n=e.read_shift(r&&r.biff==12?4:2),a=wo(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function ipe(e){var t=wo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function spe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function lpe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return ope(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:c}}function ope(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function cpe(e,t,r){var n=(e[e.l++]&96)>>5,a=cL(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function upe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=cL(e,i,r);return[n,a,s]}function dpe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function fpe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function hpe(e,t,r){var n=(e[e.l++]&96)>>5,a=ape(e,t-1,r);return[n,a]}function mpe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ID(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function ppe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function xpe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function gpe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function vpe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function ype(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function fL(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function bpe(e){return e.read_shift(2),fL(e)}function wpe(e){return e.read_shift(2),fL(e)}function Spe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=dL(e,0,r);return[n,a]}function Npe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=lpe(e,0,r);return[n,a]}function kpe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=dL(e,0,r);return[n,a,i]}function _pe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[Txe[a],pL[a],n]}function jpe(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Epe(e);return[a,(i[0]===0?pL:Exe)[i[1]]]}function Epe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Tpe(e,t,r){e.l+=r&&r.biff==2?3:4}function Cpe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Ape(e){return e.l++,jl[e.read_shift(1)]}function Ope(e){return e.l++,e.read_shift(2)}function Dpe(e){return e.l++,e.read_shift(1)!==0}function Ipe(e){return e.l++,ea(e)}function Rpe(e,t,r){return e.l++,ph(e,t-1,r)}function Mpe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Br(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=jl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ea(e);break;case 2:r[1]=zc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Ppe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Uc:Lg)(e));return a}function Fpe(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var c=0;c!=a;++c)s[i][c]=Mpe(e,r.biff);return s}function Lpe(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Bpe(e,t,r){if(r.biff==5)return Upe(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function Upe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function zpe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function $pe(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Hpe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Vpe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Gpe=ra,Wpe=ra,qpe=ra;function gh(e,t,r){return e.l+=2,[spe(e)]}function vk(e){return e.l+=6,[]}var Kpe=gh,Ype=vk,Xpe=vk,Zpe=gh;function hL(e){return e.l+=2,[Zr(e),e.read_shift(2)&1]}var Qpe=gh,Jpe=hL,exe=vk,txe=gh,rxe=gh,nxe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function axe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=nxe[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function ixe(e){return e.l+=2,[e.read_shift(4)]}function sxe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function lxe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function oxe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cxe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function uxe(e){return e.l+=4,[0,0]}var RD={1:{n:"PtgExp",f:Cpe},2:{n:"PtgTbl",f:qpe},3:{n:"PtgAdd",f:Yr},4:{n:"PtgSub",f:Yr},5:{n:"PtgMul",f:Yr},6:{n:"PtgDiv",f:Yr},7:{n:"PtgPower",f:Yr},8:{n:"PtgConcat",f:Yr},9:{n:"PtgLt",f:Yr},10:{n:"PtgLe",f:Yr},11:{n:"PtgEq",f:Yr},12:{n:"PtgGe",f:Yr},13:{n:"PtgGt",f:Yr},14:{n:"PtgNe",f:Yr},15:{n:"PtgIsect",f:Yr},16:{n:"PtgUnion",f:Yr},17:{n:"PtgRange",f:Yr},18:{n:"PtgUplus",f:Yr},19:{n:"PtgUminus",f:Yr},20:{n:"PtgPercent",f:Yr},21:{n:"PtgParen",f:Yr},22:{n:"PtgMissArg",f:Yr},23:{n:"PtgStr",f:Rpe},26:{n:"PtgSheet",f:sxe},27:{n:"PtgEndSheet",f:lxe},28:{n:"PtgErr",f:Ape},29:{n:"PtgBool",f:Dpe},30:{n:"PtgInt",f:Ope},31:{n:"PtgNum",f:Ipe},32:{n:"PtgArray",f:mpe},33:{n:"PtgFunc",f:_pe},34:{n:"PtgFuncVar",f:jpe},35:{n:"PtgName",f:Lpe},36:{n:"PtgRef",f:Spe},37:{n:"PtgArea",f:cpe},38:{n:"PtgMemArea",f:zpe},39:{n:"PtgMemErr",f:Gpe},40:{n:"PtgMemNoMem",f:Wpe},41:{n:"PtgMemFunc",f:$pe},42:{n:"PtgRefErr",f:Hpe},43:{n:"PtgAreaErr",f:dpe},44:{n:"PtgRefN",f:Npe},45:{n:"PtgAreaN",f:hpe},46:{n:"PtgMemAreaN",f:oxe},47:{n:"PtgMemNoMemN",f:cxe},57:{n:"PtgNameX",f:Bpe},58:{n:"PtgRef3d",f:kpe},59:{n:"PtgArea3d",f:upe},60:{n:"PtgRefErr3d",f:Vpe},61:{n:"PtgAreaErr3d",f:fpe},255:{}},dxe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fxe={1:{n:"PtgElfLel",f:hL},2:{n:"PtgElfRw",f:txe},3:{n:"PtgElfCol",f:Kpe},6:{n:"PtgElfRwV",f:rxe},7:{n:"PtgElfColV",f:Zpe},10:{n:"PtgElfRadical",f:Qpe},11:{n:"PtgElfRadicalS",f:exe},13:{n:"PtgElfColS",f:Ype},15:{n:"PtgElfColSV",f:Xpe},16:{n:"PtgElfRadicalLel",f:Jpe},25:{n:"PtgList",f:axe},29:{n:"PtgSxName",f:ixe},255:{}},hxe={0:{n:"PtgAttrNoop",f:uxe},1:{n:"PtgAttrSemi",f:ype},2:{n:"PtgAttrIf",f:gpe},4:{n:"PtgAttrChoose",f:ppe},8:{n:"PtgAttrGoto",f:xpe},16:{n:"PtgAttrSum",f:Tpe},32:{n:"PtgAttrBaxcel",f:ID},33:{n:"PtgAttrBaxcel",f:ID},64:{n:"PtgAttrSpace",f:bpe},65:{n:"PtgAttrSpaceSemi",f:wpe},128:{n:"PtgAttrIfError",f:vpe},255:{}};function vh(e,t,r,n){if(n.biff<8)return ra(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=Fpe(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=Ppe(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(ra(e,t)),i}function yh(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=RD[i]||RD[dxe[i]],(i===24||i===25)&&(a=(i===24?fxe:hxe)[e[e.l+1]]),!a||!a.f?ra(e,t):s.push([a.n,a.f(e,t,r)]);return s}function mxe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];s?s[0]===2?a.push('"'+s[1].replace(/"/g,'""')+'"'):a.push(s[1]):a.push("")}t.push(a.join(","))}return t.join(";")}var pxe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xxe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function mL(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function MD(e,t,r){var n=mL(e,t,r);return n=="#REF"?n:xxe(n,r)}function Qn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0}},c=[],d,f,h,p=0,g=0,v,b="";if(!e[0]||!e[0][0])return"";for(var y=-1,w="",j=0,T=e[0].length;j<T;++j){var N=e[0][j];switch(N[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=c.pop(),f=c.pop(),y>=0){switch(e[0][y][1][0]){case 0:w=Or(" ",e[0][y][1][1]);break;case 1:w=Or("\r",e[0][y][1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}f=f+w,y=-1}c.push(f+pxe[N[0]]+d);break;case"PtgIsect":d=c.pop(),f=c.pop(),c.push(f+" "+d);break;case"PtgUnion":d=c.pop(),f=c.pop(),c.push(f+","+d);break;case"PtgRange":d=c.pop(),f=c.pop(),c.push(f+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Hf(N[1][1],s,a),c.push(Vf(h,i));break;case"PtgRefN":h=r?Hf(N[1][1],r,a):N[1][1],c.push(Vf(h,i));break;case"PtgRef3d":p=N[1][1],h=Hf(N[1][2],s,a),b=MD(n,p,a),c.push(b+"!"+Vf(h,i));break;case"PtgFunc":case"PtgFuncVar":var C=N[1][0],E=N[1][1];C||(C=0),C&=127;var O=C==0?[]:c.slice(-C);c.length-=C,E==="User"&&(E=O.shift()),c.push(E+"("+O.join(",")+")");break;case"PtgBool":c.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(N[1]);break;case"PtgNum":c.push(String(N[1]));break;case"PtgStr":c.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(N[1]);break;case"PtgAreaN":v=uD(N[1][1],r?{s:r}:s,a),c.push(qb(v,a));break;case"PtgArea":v=uD(N[1][1],s,a),c.push(qb(v,a));break;case"PtgArea3d":p=N[1][1],v=N[1][2],b=MD(n,p,a),c.push(b+"!"+qb(v,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=N[1][2];var A=(n.names||[])[g-1]||(n[0]||[])[g],D=A?A.Name:"SH33TJSNAME"+String(g);D&&D.slice(0,6)=="_xlfn."&&!a.xlfn&&(D=D.slice(6)),c.push(D);break;case"PtgNameX":var M=N[1][1];g=N[1][2];var P;if(a.biff<=5)M<0&&(M=-M),n[M]&&(P=n[M][g]);else{var R="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][g]&&n[M][g].itab>0&&(R=n.SheetNames[n[M][g].itab-1]+"!"):R=n.SheetNames[g-1]+"!"),n[M]&&n[M][g])R+=n[M][g].Name;else if(n[0]&&n[0][g])R+=n[0][g].Name;else{var L=(mL(n,M,a)||"").split(";;");L[g-1]?R=L[g-1]:R+="SH33TJSERRX"}c.push(R);break}P||(P={Name:"SH33TJSERRY"}),c.push(P.Name);break;case"PtgParen":var te="(",ee=")";if(y>=0){switch(w="",e[0][y][1][0]){case 2:te=Or(" ",e[0][y][1][1])+te;break;case 3:te=Or("\r",e[0][y][1][1])+te;break;case 4:ee=Or(" ",e[0][y][1][1])+ee;break;case 5:ee=Or("\r",e[0][y][1][1])+ee;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][y][1][0])}y=-1}c.push(te+c.pop()+ee);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":h={c:N[1][1],r:N[1][0]};var ue={c:r.c,r:r.r};if(n.sharedf[nt(h)]){var V=n.sharedf[nt(h)];c.push(Qn(V,s,ue,n,a))}else{var K=!1;for(d=0;d!=n.arrayf.length;++d)if(f=n.arrayf[d],!(h.c<f[0].s.c||h.c>f[0].e.c)&&!(h.r<f[0].s.r||h.r>f[0].e.r)){c.push(Qn(f[1],s,ue,n,a)),K=!0;break}K||c.push(N[1])}break;case"PtgArray":c.push("{"+mxe(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&y>=0&&ie.indexOf(e[0][j][0])==-1){N=e[0][y];var re=!0;switch(N[1][0]){case 4:re=!1;case 0:w=Or(" ",N[1][1]);break;case 5:re=!1;case 1:w=Or("\r",N[1][1]);break;default:if(w="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}c.push((re?w:"")+c.pop()+(re?"":w)),y=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function gxe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],ra(e,t-2)];var c=yh(e,s,r);return t!==s+a&&(i=vh(e,t-s-a,c,r)),e.l=n,[c,i]}function vxe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],ra(e,t-2)];var c=yh(e,s,r);return t!==s+a&&(i=vh(e,t-s-a,c,r)),e.l=n,[c,i]}function yxe(e,t,r,n){var a=e.l+t,i=yh(e,n,r),s;return a!==e.l&&(s=vh(e,a-e.l,i,r)),[i,s]}function bxe(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=yh(e,i,r);return i==65535?[[],ra(e,t-2)]:(t!==i+2&&(a=vh(e,n-i-2,s,r)),[s,a])}function wxe(e){var t;if(Js(e,e.l+6)!==65535)return[ea(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Sxe(e){if(e==null){var t=ke(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return _c(e);return _c(0)}function Qb(e,t,r){var n=e.l+t,a=_s(e);r.biff==2&&++e.l;var i=wxe(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=vxe(e,n-e.l,r);return{cell:a,val:i[0],formula:c,shared:s>>3&1,tt:i[1]}}function Nxe(e,t,r,n,a){var i=Ec(t,r,a),s=Sxe(e.v),c=ke(6),d=33;c.write_shift(2,d),c.write_shift(4,0);for(var f=ke(e.bf.length),h=0;h<e.bf.length;++h)f[h]=e.bf[h];var p=Nn([i,s,c,f]);return p}function Bg(e,t,r){var n=e.read_shift(4),a=yh(e,n,r),i=e.read_shift(4),s=i>0?vh(e,i,a,r):null;return[a,s]}var kxe=Bg,Ug=Bg,_xe=Bg,jxe=Bg,Exe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},pL={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Txe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function PD(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Cxe(e){var t="of:="+e.replace(xk,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Jb(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Axe(e){return e.replace(/\./,"!")}var Wf={},Hu={},qf=typeof Map<"u";function yk(e,t,r){var n=0,a=e.length;if(r){if(qf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=qf?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(qf?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function zg(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Jn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=j0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Cx(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function hc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Co(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){vs(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function xL(e,t,r,n,a,i){try{n.cellNF&&(e.z=tt[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=fr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(tt[t]==null&&vs(Eue[t]||"General",t),e.t==="e")e.w=e.w||jl[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=y0(e.v);else if(e.t==="d"){var s=on(e.v);(s|0)===s?e.w=s.toString(10):e.w=y0(s)}else{if(e.v===void 0)return"";e.w=Nc(e.v,Hu)}else e.t==="d"?e.w=ii(t,on(e.v),Hu):e.w=ii(t,e.v,Hu)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Tx(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Tx(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function Oxe(e,t,r){if(e&&e["!ref"]){var n=Et(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Dxe(e,t){var r=Et(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=dt(r))}var Ixe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Rxe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Mxe=/<(?:\w:)?hyperlink [^>]*>/mg,Pxe=/"(\w*:\w*)"/,Fxe=/<(?:\w:)?col\b[^>]*[\/]?>/g,Lxe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Bxe=/<(?:\w:)?pageMargins[^>]*\/>/g,gL=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Uxe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,zxe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function $xe(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var c=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",h="",p=e.match(Rxe);p?(f=e.slice(0,p.index),h=e.slice(p.index+p[0].length)):f=h=e;var g=f.match(gL);g?bk(g[0],c,a,r):(g=f.match(Uxe))&&Vxe(g[0],g[1]||"",c,a,r);var v=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(v>0){var b=f.slice(v,v+50).match(Pxe);b&&Dxe(c,b[1])}var y=f.match(zxe);y&&y[1]&&nge(y[1],a);var w=[];if(t.cellStyles){var j=f.match(Fxe);j&&Qxe(w,j)}p&&sge(p[1],c,t,d,i,s);var T=h.match(Lxe);T&&(c["!autofilter"]=ege(T[0]));var N=[],C=h.match(Ixe);if(C)for(v=0;v!=C.length;++v)N[v]=Et(C[v].slice(C[v].indexOf('"')+1));var E=h.match(Mxe);E&&Yxe(c,E,n);var O=h.match(Bxe);if(O&&(c["!margins"]=Xxe(it(O[0]))),!c["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(c["!ref"]=dt(d)),t.sheetRows>0&&c["!ref"]){var A=Et(c["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>d.e.r&&(A.e.r=d.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>d.e.c&&(A.e.c=d.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),c["!fullref"]=c["!ref"],c["!ref"]=dt(A))}return w.length>0&&(c["!cols"]=w),N.length>0&&(c["!merges"]=N),c}function Hxe(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+dt(e[r])+'"/>';return t+"</mergeCells>"}function bk(e,t,r,n){var a=it(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=jt(Yt(a.codeName)))}function Vxe(e,t,r,n,a){bk(e.slice(0,e.indexOf(">")),r,n,a)}function Gxe(e,t,r,n,a){var i=!1,s={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[r];try{t.Workbook&&(d=t.Workbook.Sheets[r].CodeName||d)}catch{}i=!0,s.codeName=xs(Ht(d))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),c=(c||"")+Fe("outlinePr",null,f)}!i&&!c||(a[a.length]=Fe("sheetPr",c,s))}var Wxe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],qxe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Kxe(e){var t={sheet:1};return Wxe.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),qxe.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=hk(e.password).toString(16).toUpperCase()),Fe("sheetProtection",null,t)}function Yxe(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=it(Yt(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+jt(i.location))):(i.Target="#"+jt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=Et(i.ref),d=c.s.r;d<=c.e.r;++d)for(var f=c.s.c;f<=c.e.c;++f){var h=nt({c:f,r:d});n?(e[d]||(e[d]=[]),e[d][f]||(e[d][f]={t:"z",v:void 0}),e[d][f].l=i):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=i)}}}function Xxe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Zxe(e){return hc(e),Fe("pageMargins",null,e)}function Qxe(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=it(t[n],!0);a.hidden&&(a.hidden=dr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,mk(a.width)),bo(a);i<=s;)e[i++]=hr(a)}}function Jxe(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Fe("col",null,zg(a,n)));return r[r.length]="</cols>",r.join("")}function ege(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function tge(e,t,r,n){var a=typeof e.ref=="string"?e.ref:dt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Ia(a);s.s.r==s.e.r&&(s.e.r=Ia(t["!ref"]).e.r,a=dt(s));for(var c=0;c<i.length;++c){var d=i[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Fe("autoFilter",null,{ref:a})}var rge=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function nge(e,t){t.Views||(t.Views=[{}]),(e.match(rge)||[]).forEach(function(r,n){var a=it(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),dr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function age(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Fe("sheetViews",Fe("sheetView",null,a),{})}function ige(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=jl[e.v];break;case"d":n&&n.cellDates?a=fr(e.v,-1).toISOString():(e=hr(e),e.t="n",a=""+(e.v=on(fr(e.v)))),typeof e.z>"u"&&(e.z=tt[14]);break;default:a=e.v;break}var c=zn("v",Ht(a)),d={r:t},f=Co(n.cellXfs,e,n);switch(f!==0&&(d.s=f),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=zn("v",""+yk(n.Strings,e.v,n.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var h=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Fe("f",Ht(e.f),h)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(d.cm=1),Fe("c",c,d)}var sge=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=b0("v"),s=b0("f");return function(d,f,h,p,g,v){for(var b=0,y="",w=[],j=[],T=0,N=0,C=0,E="",O,A,D=0,M=0,P,R,L=0,te=0,ee=Array.isArray(v.CellXf),ue,V=[],K=[],ie=Array.isArray(f),re=[],me={},W=!1,F=!!h.sheetStubs,X=d.split(t),q=0,U=X.length;q!=U;++q){y=X[q].trim();var G=y.length;if(G!==0){var le=0;e:for(b=0;b<G;++b)switch(y[b]){case">":if(y[b-1]!="/"){++b;break e}if(h&&h.cellStyles){if(A=it(y.slice(le,b),!0),D=A.r!=null?parseInt(A.r,10):D+1,M=-1,h.sheetRows&&h.sheetRows<D)continue;me={},W=!1,A.ht&&(W=!0,me.hpt=parseFloat(A.ht),me.hpx=nd(me.hpt)),A.hidden=="1"&&(W=!0,me.hidden=!0),A.outlineLevel!=null&&(W=!0,me.level=+A.outlineLevel),W&&(re[D-1]=me)}break;case"<":le=b;break}if(le>=b)break;if(A=it(y.slice(le,b),!0),D=A.r!=null?parseInt(A.r,10):D+1,M=-1,!(h.sheetRows&&h.sheetRows<D)){p.s.r>D-1&&(p.s.r=D-1),p.e.r<D-1&&(p.e.r=D-1),h&&h.cellStyles&&(me={},W=!1,A.ht&&(W=!0,me.hpt=parseFloat(A.ht),me.hpx=nd(me.hpt)),A.hidden=="1"&&(W=!0,me.hidden=!0),A.outlineLevel!=null&&(W=!0,me.level=+A.outlineLevel),W&&(re[D-1]=me)),w=y.slice(b).split(e);for(var de=0;de!=w.length&&w[de].trim().charAt(0)=="<";++de);for(w=w.slice(de),b=0;b!=w.length;++b)if(y=w[b].trim(),y.length!==0){if(j=y.match(r),T=b,N=0,C=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,j!=null&&j.length===2){for(T=0,E=j[1],N=0;N!=E.length&&!((C=E.charCodeAt(N)-64)<1||C>26);++N)T=26*T+C;--T,M=T}else++M;for(N=0;N!=y.length&&y.charCodeAt(N)!==62;++N);if(++N,A=it(y.slice(0,N),!0),A.r||(A.r=nt({r:D-1,c:M})),E=y.slice(N),O={t:""},(j=E.match(i))!=null&&j[1]!==""&&(O.v=jt(j[1])),h.cellFormula){if((j=E.match(s))!=null&&j[1]!==""){if(O.f=jt(Yt(j[1])).replace(/\r\n/g,`
`),h.xlfn||(O.f=DD(O.f)),j[0].indexOf('t="array"')>-1)O.F=(E.match(a)||[])[1],O.F.indexOf(":")>-1&&V.push([Et(O.F),O.F]);else if(j[0].indexOf('t="shared"')>-1){R=it(j[0]);var ne=jt(Yt(j[1]));h.xlfn||(ne=DD(ne)),K[parseInt(R.si,10)]=[R,ne,A.r]}}else(j=E.match(/<f[^>]*\/>/))&&(R=it(j[0]),K[R.si]&&(O.f=rpe(K[R.si][1],K[R.si][2],A.r)));var oe=kr(A.r);for(N=0;N<V.length;++N)oe.r>=V[N][0].s.r&&oe.r<=V[N][0].e.r&&oe.c>=V[N][0].s.c&&oe.c<=V[N][0].e.c&&(O.F=V[N][1])}if(A.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(F)O.t="z";else continue;else O.t=A.t||"n";switch(p.s.c>M&&(p.s.c=M),p.e.c<M&&(p.e.c=M),O.t){case"n":if(O.v==""||O.v==null){if(!F)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!F)continue;O.t="z"}else P=Wf[parseInt(O.v,10)],O.v=P.t,O.r=P.r,h.cellHTML&&(O.h=P.h);break;case"str":O.t="s",O.v=O.v!=null?Yt(O.v):"",h.cellHTML&&(O.h=QN(O.v));break;case"inlineStr":j=E.match(n),O.t="s",j!=null&&(P=fk(j[1]))?(O.v=P.t,h.cellHTML&&(O.h=P.h)):O.v="";break;case"b":O.v=dr(O.v);break;case"d":h.cellDates?O.v=fr(O.v,1):(O.v=on(fr(O.v,1)),O.t="n");break;case"e":(!h||h.cellText!==!1)&&(O.w=O.v),O.v=yF[O.v];break}if(L=te=0,ue=null,ee&&A.s!==void 0&&(ue=v.CellXf[A.s],ue!=null&&(ue.numFmtId!=null&&(L=ue.numFmtId),h.cellStyles&&ue.fillId!=null&&(te=ue.fillId))),xL(O,L,te,h,g,v),h.cellDates&&ee&&O.t=="n"&&Mc(tt[L])&&(O.t="d",O.v=Fg(O.v)),A.cm&&h.xlmeta){var Ae=(h.xlmeta.Cell||[])[+A.cm-1];Ae&&Ae.type=="XLDAPR"&&(O.D=!0)}if(ie){var z=kr(A.r);f[z.r]||(f[z.r]=[]),f[z.r][z.c]=O}else f[A.r]=O}}}}re.length>0&&(f["!rows"]=re)}})();function lge(e,t,r,n){var a=[],i=[],s=Et(e["!ref"]),c="",d,f="",h=[],p=0,g=0,v=e["!rows"],b=Array.isArray(e),y={r:f},w,j=-1;for(g=s.s.c;g<=s.e.c;++g)h[g]=Nr(g);for(p=s.s.r;p<=s.e.r;++p){for(i=[],f=$r(p),g=s.s.c;g<=s.e.c;++g){d=h[g]+f;var T=b?(e[p]||[])[g]:e[d];T!==void 0&&(c=ige(T,d,e,t))!=null&&i.push(c)}(i.length>0||v&&v[p])&&(y={r:f},v&&v[p]&&(w=v[p],w.hidden&&(y.hidden=1),j=-1,w.hpx?j=E0(w.hpx):w.hpt&&(j=w.hpt),j>-1&&(y.ht=j,y.customHeight=1),w.level&&(y.outlineLevel=w.level)),a[a.length]=Fe("row",i.join(""),y))}if(v)for(;p<v.length;++p)v&&v[p]&&(y={r:p+1},w=v[p],w.hidden&&(y.hidden=1),j=-1,w.hpx?j=E0(w.hpx):w.hpt&&(j=w.hpt),j>-1&&(y.ht=j,y.customHeight=1),w.level&&(y.outlineLevel=w.level),a[a.length]=Fe("row","",y));return a.join("")}function vL(e,t,r,n){var a=[Hr,Fe("worksheet",null,{xmlns:Pc[0],"xmlns:r":sn.r})],i=r.SheetNames[e],s=0,c="",d=r.Sheets[i];d==null&&(d={});var f=d["!ref"]||"A1",h=Et(f);if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),f=dt(h)}n||(n={}),d["!comments"]=[];var p=[];Gxe(d,r,e,t,a),a[a.length]=Fe("dimension",null,{ref:f}),a[a.length]=age(d,t,e,r),t.sheetFormat&&(a[a.length]=Fe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(a[a.length]=Jxe(d,d["!cols"])),a[s=a.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(c=lge(d,t),c.length>0&&(a[a.length]=c)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),d["!protect"]&&(a[a.length]=Kxe(d["!protect"])),d["!autofilter"]!=null&&(a[a.length]=tge(d["!autofilter"],d,r,e)),d["!merges"]!=null&&d["!merges"].length>0&&(a[a.length]=Hxe(d["!merges"]));var g=-1,v,b=-1;return d["!links"].length>0&&(a[a.length]="<hyperlinks>",d["!links"].forEach(function(y){y[1].Target&&(v={ref:y[0]},y[1].Target.charAt(0)!="#"&&(b=zt(n,-1,Ht(y[1].Target).replace(/#.*$/,""),gt.HLINK),v["r:id"]="rId"+b),(g=y[1].Target.indexOf("#"))>-1&&(v.location=Ht(y[1].Target.slice(g+1))),y[1].Tooltip&&(v.tooltip=Ht(y[1].Tooltip)),a[a.length]=Fe("hyperlink",null,v))}),a[a.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(a[a.length]=Zxe(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=zn("ignoredErrors",Fe("ignoredError",null,{numberStoredAsText:1,sqref:f}))),p.length>0&&(b=zt(n,-1,"../drawings/drawing"+(e+1)+".xml",gt.DRAW),a[a.length]=Fe("drawing",null,{"r:id":"rId"+b}),d["!drawing"]=p),d["!comments"].length>0&&(b=zt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gt.VML),a[a.length]=Fe("legacyDrawing",null,{"r:id":"rId"+b}),d["!legacy"]=b),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function oge(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function cge(e,t,r){var n=ke(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=E0(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var c=0,d=n.l;n.l+=4;for(var f={r:e,c:0},h=0;h<16;++h)if(!(t.s.c>h+1<<10||t.e.c<h<<10)){for(var p=-1,g=-1,v=h<<10;v<h+1<<10;++v){f.c=v;var b=Array.isArray(r)?(r[f.r]||[])[f.c]:r[nt(f)];b&&(p<0&&(p=v),g=v)}p<0||(++c,n.write_shift(4,p),n.write_shift(4,g))}var y=n.l;return n.l=d,n.write_shift(4,c),n.l=y,n.length>n.l?n.slice(0,n.l):n}function uge(e,t,r,n){var a=cge(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Ce(e,0,a)}var dge=Uc,fge=Sd;function hge(){}function mge(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=gde(e),r}function pge(e,t,r){r==null&&(r=ke(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return _x({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),mF(e,r),r.slice(0,r.l)}function xge(e){var t=Pi(e);return[t]}function gge(e,t,r){return r==null&&(r=ke(8)),Fc(t,r)}function vge(e){var t=Lc(e);return[t]}function yge(e,t,r){return r==null&&(r=ke(4)),Bc(t,r)}function bge(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"b"]}function wge(e,t,r){return r==null&&(r=ke(9)),Fc(t,r),r.write_shift(1,e.v?1:0),r}function Sge(e){var t=Lc(e),r=e.read_shift(1);return[t,r,"b"]}function Nge(e,t,r){return r==null&&(r=ke(5)),Bc(t,r),r.write_shift(1,e.v?1:0),r}function kge(e){var t=Pi(e),r=e.read_shift(1);return[t,r,"e"]}function _ge(e,t,r){return r==null&&(r=ke(9)),Fc(t,r),r.write_shift(1,e.v),r}function jge(e){var t=Lc(e),r=e.read_shift(1);return[t,r,"e"]}function Ege(e,t,r){return r==null&&(r=ke(8)),Bc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Tge(e){var t=Pi(e),r=e.read_shift(4);return[t,r,"s"]}function Cge(e,t,r){return r==null&&(r=ke(12)),Fc(t,r),r.write_shift(4,t.v),r}function Age(e){var t=Lc(e),r=e.read_shift(4);return[t,r,"s"]}function Oge(e,t,r){return r==null&&(r=ke(8)),Bc(t,r),r.write_shift(4,t.v),r}function Dge(e){var t=Pi(e),r=ea(e);return[t,r,"n"]}function Ige(e,t,r){return r==null&&(r=ke(16)),Fc(t,r),_c(e.v,r),r}function yL(e){var t=Lc(e),r=ea(e);return[t,r,"n"]}function Rge(e,t,r){return r==null&&(r=ke(12)),Bc(t,r),_c(e.v,r),r}function Mge(e){var t=Pi(e),r=lk(e);return[t,r,"n"]}function Pge(e,t,r){return r==null&&(r=ke(12)),Fc(t,r),pF(e.v,r),r}function Fge(e){var t=Lc(e),r=lk(e);return[t,r,"n"]}function Lge(e,t,r){return r==null&&(r=ke(8)),Bc(t,r),pF(e.v,r),r}function Bge(e){var t=Pi(e),r=ak(e);return[t,r,"is"]}function Uge(e){var t=Pi(e),r=ta(e);return[t,r,"str"]}function zge(e,t,r){return r==null&&(r=ke(12+4*e.v.length)),Fc(t,r),kn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $ge(e){var t=Lc(e),r=ta(e);return[t,r,"str"]}function Hge(e,t,r){return r==null&&(r=ke(8+4*e.v.length)),Bc(t,r),kn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Vge(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var c=Ug(e,n-e.l,r);s[3]=Qn(c,null,a,r.supbooks,r)}else e.l=n;return s}function Gge(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var c=Ug(e,n-e.l,r);s[3]=Qn(c,null,a,r.supbooks,r)}else e.l=n;return s}function Wge(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var i=ea(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var c=Ug(e,n-e.l,r);s[3]=Qn(c,null,a,r.supbooks,r)}else e.l=n;return s}function qge(e,t,r){var n=e.l+t,a=Pi(e);a.r=r["!row"];var i=ta(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var c=Ug(e,n-e.l,r);s[3]=Qn(c,null,a,r.supbooks,r)}else e.l=n;return s}var Kge=Uc,Yge=Sd;function Xge(e,t){return t==null&&(t=ke(4)),t.write_shift(4,e),t}function Zge(e,t){var r=e.l+t,n=Uc(e),a=ik(e),i=ta(e),s=ta(e),c=ta(e);e.l=r;var d={rfx:n,relId:a,loc:i,display:c};return s&&(d.Tooltip=s),d}function Qge(e,t){var r=ke(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Sd({s:kr(e[0]),e:kr(e[0])},r),sk("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return kn(a||"",r),kn(e[1].Tooltip||"",r),kn("",r),r.slice(0,r.l)}function Jge(){}function eve(e,t,r){var n=e.l+t,a=xF(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var c=kxe(e,n-e.l,r);s[1]=c}else e.l=n;return s}function tve(e,t,r){var n=e.l+t,a=Uc(e),i=[a];if(r.cellFormula){var s=jxe(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function rve(e,t,r){r==null&&(r=ke(18));var n=zg(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var bL=["left","right","top","bottom","header","footer"];function nve(e){var t={};return bL.forEach(function(r){t[r]=ea(e)}),t}function ave(e,t){return t==null&&(t=ke(48)),hc(e),bL.forEach(function(r){_c(e[r],t)}),t}function ive(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function sve(e,t,r){r==null&&(r=ke(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function lve(e){var t=ke(24);return t.write_shift(4,4),t.write_shift(4,1),Sd(e,t),t}function ove(e,t){return t==null&&(t=ke(66)),t.write_shift(2,e.password?hk(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function cve(){}function uve(){}function dve(e,t,r,n,a,i,s){if(!e)return e;var c=t||{};n||(n={"!id":{}});var d=c.dense?[]:{},f,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,v,b,y,w,j,T,N,C,E,O=[];c.biff=12,c["!row"]=0;var A=0,D=!1,M=[],P={},R=c.supbooks||a.supbooks||[[]];if(R.sharedf=P,R.arrayf=M,R.SheetNames=a.SheetNames||a.Sheets.map(function(ie){return ie.name}),!c.supbooks&&(c.supbooks=R,a.Names))for(var L=0;L<a.Names.length;++L)R[0][L+1]=a.Names[L];var te=[],ee=[],ue=!1;T0[16]={n:"BrtShortReal",f:yL};var V;if(_l(e,function(re,me,W){if(!g)switch(W){case 148:f=re;break;case 0:v=re,c.sheetRows&&c.sheetRows<=v.r&&(g=!0),C=$r(w=v.r),c["!row"]=v.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=nd(re.hpt)),ee[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:re[2]},re[2]){case"n":b.v=re[1];break;case"s":N=Wf[re[1]],b.v=N.t,b.r=N.r;break;case"b":b.v=!!re[1];break;case"e":b.v=re[1],c.cellText!==!1&&(b.w=jl[b.v]);break;case"str":b.t="s",b.v=re[1];break;case"is":b.t="s",b.v=re[1].t;break}if((y=s.CellXf[re[0].iStyleRef])&&xL(b,y.numFmtId,null,c,i,s),j=re[0].c==-1?j+1:re[0].c,c.dense?(d[w]||(d[w]=[]),d[w][j]=b):d[Nr(j)+C]=b,c.cellFormula){for(D=!1,A=0;A<M.length;++A){var F=M[A];v.r>=F[0].s.r&&v.r<=F[0].e.r&&j>=F[0].s.c&&j<=F[0].e.c&&(b.F=dt(F[0]),D=!0)}!D&&re.length>3&&(b.f=re[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>j&&(h.s.c=j),h.e.r<v.r&&(h.e.r=v.r),h.e.c<j&&(h.e.c=j),c.cellDates&&y&&b.t=="n"&&Mc(tt[y.numFmtId])){var X=lo(b.v);X&&(b.t="d",b.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}V&&(V.type=="XLDAPR"&&(b.D=!0),V=void 0);break;case 1:case 12:if(!c.sheetStubs||p)break;b={t:"z",v:void 0},j=re[0].c==-1?j+1:re[0].c,c.dense?(d[w]||(d[w]=[]),d[w][j]=b):d[Nr(j)+C]=b,h.s.r>v.r&&(h.s.r=v.r),h.s.c>j&&(h.s.c=j),h.e.r<v.r&&(h.e.r=v.r),h.e.c<j&&(h.e.c=j),V&&(V.type=="XLDAPR"&&(b.D=!0),V=void 0);break;case 176:O.push(re);break;case 49:V=((c.xlmeta||{}).Cell||[])[re-1];break;case 494:var q=n["!id"][re.relId];for(q?(re.Target=q.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=q):re.relId==""&&(re.Target="#"+re.loc),w=re.rfx.s.r;w<=re.rfx.e.r;++w)for(j=re.rfx.s.c;j<=re.rfx.e.c;++j)c.dense?(d[w]||(d[w]=[]),d[w][j]||(d[w][j]={t:"z",v:void 0}),d[w][j].l=re):(T=nt({c:j,r:w}),d[T]||(d[T]={t:"z",v:void 0}),d[T].l=re);break;case 426:if(!c.cellFormula)break;M.push(re),E=c.dense?d[w][j]:d[Nr(j)+C],E.f=Qn(re[1],h,{r:v.r,c:j},R,c),E.F=dt(re[0]);break;case 427:if(!c.cellFormula)break;P[nt(re[0].s)]=re[1],E=c.dense?d[w][j]:d[Nr(j)+C],E.f=Qn(re[1],h,{r:v.r,c:j},R,c);break;case 60:if(!c.cellStyles)break;for(;re.e>=re.s;)te[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},ue||(ue=!0,mk(re.w/256)),bo(te[re.e+1]);break;case 161:d["!autofilter"]={ref:dt(re)};break;case 476:d["!margins"]=re;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),re.name&&(a.Sheets[r].CodeName=re.name),(re.above||re.left)&&(d["!outline"]={above:re.above,left:re.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),re.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!me.T){if(!p||c.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},c),delete c.supbooks,delete c["!row"],!d["!ref"]&&(h.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(d["!ref"]=dt(f||h)),c.sheetRows&&d["!ref"]){var K=Et(d["!ref"]);c.sheetRows<=+K.e.r&&(K.e.r=c.sheetRows-1,K.e.r>h.e.r&&(K.e.r=h.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>h.e.c&&(K.e.c=h.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),d["!fullref"]=d["!ref"],d["!ref"]=dt(K))}return O.length>0&&(d["!merges"]=O),te.length>0&&(d["!cols"]=te),ee.length>0&&(d["!rows"]=ee),d}function fve(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=hr(t),t.z=t.z||tt[14],t.v=on(fr(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var d={r,c:n};switch(d.s=Co(a.cellXfs,t,a),t.l&&i["!links"].push([nt(d),t.l]),t.c&&i["!comments"].push([nt(d),t.c]),t.t){case"s":case"str":return a.bookSST?(c=yk(a.Strings,t.v,a.revStrings),d.t="s",d.v=c,s?Ce(e,18,Oge(t,d)):Ce(e,7,Cge(t,d))):(d.t="str",s?Ce(e,17,Hge(t,d)):Ce(e,6,zge(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Ce(e,13,Lge(t,d)):Ce(e,2,Pge(t,d)):s?Ce(e,16,Rge(t,d)):Ce(e,5,Ige(t,d)),!0;case"b":return d.t="b",s?Ce(e,15,Nge(t,d)):Ce(e,4,wge(t,d)),!0;case"e":return d.t="e",s?Ce(e,14,Ege(t,d)):Ce(e,3,_ge(t,d)),!0}return s?Ce(e,12,yge(t,d)):Ce(e,1,gge(t,d)),!0}function hve(e,t,r,n){var a=Et(t["!ref"]||"A1"),i,s="",c=[];Ce(e,145);var d=Array.isArray(t),f=a.e.r;t["!rows"]&&(f=Math.max(a.e.r,t["!rows"].length-1));for(var h=a.s.r;h<=f;++h){s=$r(h),uge(e,t,a,h);var p=!1;if(h<=a.e.r)for(var g=a.s.c;g<=a.e.c;++g){h===a.s.r&&(c[g]=Nr(g)),i=c[g]+s;var v=d?(t[h]||[])[g]:t[i];if(!v){p=!1;continue}p=fve(e,v,h,g,n,t,p)}}Ce(e,146)}function mve(e,t){!t||!t["!merges"]||(Ce(e,177,Xge(t["!merges"].length)),t["!merges"].forEach(function(r){Ce(e,176,Yge(r))}),Ce(e,178))}function pve(e,t){!t||!t["!cols"]||(Ce(e,390),t["!cols"].forEach(function(r,n){r&&Ce(e,60,rve(n,r))}),Ce(e,391))}function xve(e,t){!t||!t["!ref"]||(Ce(e,648),Ce(e,649,lve(Et(t["!ref"]))),Ce(e,650))}function gve(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=zt(r,-1,n[1].Target.replace(/#.*$/,""),gt.HLINK);Ce(e,494,Qge(n,a))}}),delete t["!links"]}function vve(e,t,r,n){if(t["!comments"].length>0){var a=zt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gt.VML);Ce(e,551,sk("rId"+a)),t["!legacy"]=a}}function yve(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:dt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,c=Ia(i);c.s.r==c.e.r&&(c.e.r=Ia(t["!ref"]).e.r,i=dt(c));for(var d=0;d<s.length;++d){var f=s[d];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+i;break}}d==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ce(e,161,Sd(Et(i))),Ce(e,162)}}function bve(e,t,r){Ce(e,133),Ce(e,137,sve(t,r)),Ce(e,138),Ce(e,134)}function wve(e,t){t["!protect"]&&Ce(e,535,ove(t["!protect"]))}function Sve(e,t,r,n){var a=Da(),i=r.SheetNames[e],s=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var d=Et(s["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Ce(a,129),(r.vbaraw||s["!outline"])&&Ce(a,147,pge(c,s["!outline"])),Ce(a,148,fge(d)),bve(a,s,r.Workbook),pve(a,s),hve(a,s,e,t),wve(a,s),yve(a,s,r,e),mve(a,s),gve(a,s,n),s["!margins"]&&Ce(a,476,ave(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&xve(a,s),vve(a,s,e,n),Ce(a,130),a.end()}function Nve(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=jt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function kve(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var c=0,d=0,f="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=Nve(p);h.s.r=h.s.c=0,h.e.c=c,f=Nr(c),g[0].forEach(function(v,b){s[f+$r(b)]={t:"n",v,z:g[1]},d=b}),h.e.r<d&&(h.e.r=d),++c}),c>0&&(s["!ref"]=dt(h)),s}function _ve(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,c=e.match(gL);return c&&bk(c[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function jve(e,t){e.l+=10;var r=ta(e);return{name:r}}function Eve(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return _l(e,function(d,f,h){switch(h){case 550:i["!rel"]=d;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),d.name&&(a.Sheets[r].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var wk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Tve=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Cve=[],Ave=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function FD(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=dr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function LD(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=dr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function wL(e){LD(e.WBProps,wk),LD(e.CalcPr,Ave),FD(e.WBView,Tve),FD(e.Sheets,Cve),Hu.date1904=dr(e.WBProps.date1904)}function Ove(e){return!e.Workbook||!e.Workbook.WBProps?"false":dr(e.Workbook.WBProps.date1904)?"true":"false"}var Dve="][*?/\\".split("");function SL(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Dve.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Ive(e,t,r){e.forEach(function(n,a){SL(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function Rve(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Ive(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Oxe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Mve=/<\w+:workbook/;function Pve(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(na,function(d,f){var h=it(d);switch(ks(h[0])){case"<?xml":break;case"<workbook":d.match(Mve)&&(a="xmlns"+d.match(/<(\w+):/)[1]),r.xmlns=h[a];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":wk.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=dr(h[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:r.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(r.WBProps.CodeName=Yt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=jt(Yt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Yt(h.name),h.comment&&(i.Comment=h.comment),h.localSheetId&&(i.Sheet=+h.localSheetId),dr(h.hidden||"0")&&(i.Hidden=!0),s=f+d.length;break;case"</definedName>":i.Ref=jt(Yt(e.slice(s,f))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return d}),Pc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return wL(r),r}function NL(e){var t=[Hr];t[t.length]=Fe("workbook",null,{xmlns:Pc[0],"xmlns:r":sn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(wk.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Fe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ht(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Fe("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var d={name:c.Name};c.Comment&&(d.comment=c.Comment),c.Sheet!=null&&(d.localSheetId=""+c.Sheet),c.Hidden&&(d.hidden="1"),c.Ref&&(t[t.length]=Fe("definedName",Ht(c.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Fve(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ew(e),r.name=ta(e),r}function Lve(e,t){return t||(t=ke(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),sk(e.strRelID,t),kn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Bve(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ta(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Uve(e,t){t||(t=ke(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),mF(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function zve(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function $ve(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=vde(e),s=_xe(e,0,r),c=ik(e);e.l=n;var d={Name:i,Ptg:s};return a<268435455&&(d.Sheet=a),c&&(d.Comment=c),d}function Hve(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],T0[16]={n:"BrtFRTArchID$",f:zve},_l(e,function(d,f,h){switch(h){case 156:s.SheetNames.push(d.name),r.Sheets.push(d);break;case 153:r.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=Qn(d.Ptg,null,null,s,t),delete t.SID,delete d.Ptg,i.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,d]):s[0]=[h,d],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(d),s.XTI=s.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(h),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},t),wL(r),r.Names=i,r.supbooks=s,r}function Vve(e,t){Ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ce(e,156,Lve(a))}Ce(e,144)}function Gve(e,t){t||(t=ke(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return kn("SheetJS",t),kn(vx.version,t),kn(vx.version,t),kn("7262",t),t.length>t.l?t.slice(0,t.l):t}function Wve(e,t){t||(t=ke(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function qve(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(Ce(e,135),Ce(e,158,Wve(a)),Ce(e,136))}}function Kve(e,t){var r=Da();return Ce(r,131),Ce(r,128,Gve()),Ce(r,153,Uve(e.Workbook&&e.Workbook.WBProps||null)),qve(r,e),Vve(r,e),Ce(r,132),r.end()}function Yve(e,t,r){return t.slice(-4)===".bin"?Hve(e,r):Pve(e,r)}function Xve(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?dve(e,n,r,a,i,s,c):$xe(e,n,r,a,i,s,c)}function Zve(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?Eve(e,n,r,a,i):_ve(e,n,r,a,i)}function Qve(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?epe():tpe()}function Jve(e,t,r,n,a,i,s,c){return t.slice(-4)===".bin"?Qme():Jme()}function eye(e,t,r,n){return t.slice(-4)===".bin"?Yhe(e,r,n):Fhe(e,r,n)}function tye(e,t,r){return nL(e,r)}function rye(e,t,r){return t.slice(-4)===".bin"?rhe(e,r):J0e(e,r)}function nye(e,t,r){return t.slice(-4)===".bin"?qme(e,r):Lme(e,r)}function aye(e,t,r){return t.slice(-4)===".bin"?Mme(e):Ime(e)}function iye(e,t,r,n){return r.slice(-4)===".bin"?Pme(e,t,r,n):void 0}function sye(e,t,r){return t.slice(-4)===".bin"?Ame(e,t,r):Dme(e,t,r)}function lye(e,t,r){return(t.slice(-4)===".bin"?Kve:NL)(e)}function oye(e,t,r,n,a){return(t.slice(-4)===".bin"?Sve:vL)(e,r,n,a)}function cye(e,t,r){return(t.slice(-4)===".bin"?ime:tL)(e,r)}function uye(e,t,r){return(t.slice(-4)===".bin"?ihe:qF)(e,r)}function dye(e,t,r){return(t.slice(-4)===".bin"?Kme:sL)(e)}function fye(e){return(e.slice(-4)===".bin"?Ome:aL)()}var kL=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,_L=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function $i(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(kL),i,s,c,d;if(a)for(d=0;d!=a.length;++d)i=a[d].match(_L),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(s+1),n[c]=i[2].slice(1,i[2].length-1));return n}function hye(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(kL),a,i,s,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(_L),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Kf;function mye(e,t){var r=Kf[e]||jt(e);return r==="General"?Nc(t):ii(r,t)}function pye(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=dr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=fr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[jt(t)]=a}function xye(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||jl[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=y0(e.v):e.w=Nc(e.v):e.w=mye(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Kf[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Mc(n)){var a=lo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function gye(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Che[n.Pattern]||n.Pattern)}e[t.ID]=t}function vye(e,t,r,n,a,i,s,c,d,f){var h="General",p=n.StyleID,g={};f=f||{};var v=[],b=0;for(p===void 0&&c&&(p=c.StyleID),p===void 0&&s&&(p=s.StyleID);i[p]!==void 0&&(i[p].nf&&(h=i[p].nf),i[p].Interior&&v.push(i[p].Interior),!!i[p].Parent);)p=i[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=dr(e);break;case"String":n.t="s",n.r=tD(jt(e)),n.v=e.indexOf("<")>-1?jt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(fr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=jt(e):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=yF[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=tD(t||e));break}if(xye(n,h,f),f.cellFormula!==!1)if(n.Formula){var y=jt(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=$u(y,a),delete n.Formula,n.ArrayRange=="RC"?n.F=$u("RC:RC",a):n.ArrayRange&&(n.F=$u(n.ArrayRange,a),d.push([Et(n.F),n.F]))}else for(b=0;b<d.length;++b)a.r>=d[b][0].s.r&&a.r<=d[b][0].e.r&&a.c>=d[b][0].s.c&&a.c<=d[b][0].e.c&&(n.F=d[b][1]);f.cellStyles&&(v.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function yye(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function e2(e,t){var r=t||{};bd();var n=Of(JN(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Yt(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=hr(r);return s.type="string",rd.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(_t){a.indexOf("<"+_t)>=0&&(i=!0)}),i)return a1e(n,r);Kf={"General Number":"General","General Date":tt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":tt[15],"Short Date":tt[14],"Long Time":tt[19],"Medium Time":tt[18],"Short Time":tt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:tt[2],Standard:tt[4],Percent:tt[10],Scientific:tt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,d=[],f,h={},p=[],g=r.dense?[]:{},v="",b={},y={},w=$i('<Data ss:Type="String">'),j=0,T=0,N=0,C={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},O={},A="",D=0,M=[],P={},R={},L=0,te=[],ee=[],ue={},V=[],K,ie=!1,re=[],me=[],W={},F=0,X=0,q={Sheets:[],WBProps:{date1904:!1}},U={};S0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var G="";c=S0.exec(n);)switch(c[3]=(G=c[3]).toLowerCase()){case"data":if(G=="data"){if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break}if(d[d.length-1][1])break;c[1]==="/"?vye(n.slice(j,c.index),A,w,d[d.length-1][0]=="comment"?ue:b,{c:T,r:N},E,V[T],y,re,r):(A="",w=$i(c[0]),j=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(ee.length>0&&(b.c=ee),(!r.sheetRows||r.sheetRows>N)&&b.v!==void 0&&(r.dense?(g[N]||(g[N]=[]),g[N][T]=b):g[Nr(T)+$r(N)]=b),b.HRef&&(b.l={Target:jt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(F=T+(parseInt(b.MergeAcross,10)|0),X=N+(parseInt(b.MergeDown,10)|0),M.push({s:{c:T,r:N},e:{c:F,r:X}})),!r.sheetStubs)b.MergeAcross?T=F+1:++T;else if(b.MergeAcross||b.MergeDown){for(var le=T;le<=F;++le)for(var de=N;de<=X;++de)(le>T||de>N)&&(r.dense?(g[de]||(g[de]=[]),g[de][le]={t:"z"}):g[Nr(le)+$r(de)]={t:"z"});T=F+1}else++T;else b=hye(c[0]),b.Index&&(T=+b.Index-1),T<C.s.c&&(C.s.c=T),T>C.e.c&&(C.e.c=T),c[0].slice(-2)==="/>"&&++T,ee=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(N<C.s.r&&(C.s.r=N),N>C.e.r&&(C.e.r=N),c[0].slice(-2)==="/>"&&(y=$i(c[0]),y.Index&&(N=+y.Index-1)),T=0,++N):(y=$i(c[0]),y.Index&&(N=+y.Index-1),W={},(y.AutoFitHeight=="0"||y.Height)&&(W.hpx=parseInt(y.Height,10),W.hpt=E0(W.hpx),me[N]=W),y.Hidden=="1"&&(W.hidden=!0,me[N]=W));break;case"worksheet":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));p.push(v),C.s.r<=C.e.r&&C.s.c<=C.e.c&&(g["!ref"]=dt(C),r.sheetRows&&r.sheetRows<=C.e.r&&(g["!fullref"]=g["!ref"],C.e.r=r.sheetRows-1,g["!ref"]=dt(C))),M.length&&(g["!merges"]=M),V.length>0&&(g["!cols"]=V),me.length>0&&(g["!rows"]=me),h[v]=g}else C={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=T=0,d.push([c[3],!1]),f=$i(c[0]),v=jt(f.Name),g=r.dense?[]:{},M=[],re=[],me=[],U={name:v,Hidden:0},q.Sheets.push(U);break;case"table":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;d.push([c[3],!1]),V=[],ie=!1}break;case"style":c[1]==="/"?gye(E,O,r):O=$i(c[0]);break;case"numberformat":O.nf=jt($i(c[0]).Format||"General"),Kf[O.nf]&&(O.nf=Kf[O.nf]);for(var ne=0;ne!=392&&tt[ne]!=O.nf;++ne);if(ne==392){for(ne=57;ne!=392;++ne)if(tt[ne]==null){vs(O.nf,ne);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(K=$i(c[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!ie&&K.wpx>10){ie=!0,Jn=JF;for(var oe=0;oe<V.length;++oe)V[oe]&&bo(V[oe])}ie&&bo(K),V[K.Index-1||V.length]=K;for(var Ae=0;Ae<+K.Span;++Ae)V[V.length]=hr(K);break;case"namedrange":if(c[1]==="/")break;q.Names||(q.Names=[]);var z=it(c[0]),et={Name:z.Name,Ref:$u(z.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(et.Sheet=q.Sheets.length-1),q.Names.push(et);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?A+=n.slice(D,c.index):D=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=$i(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?Hde(P,G,n.slice(L,c.index)):L=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else d.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));yye(ue),ee.push(ue)}else d.push([c[3],!1]),f=$i(c[0]),ue={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var Be=$i(c[0]);g["!autofilter"]={ref:$u(Be.Range).replace(/\$/g,"")},d.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=d.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&d.push([c[3],!0]);break;case"null":break;default:if(d.length==0&&c[3]=="document"||d.length==0&&c[3]=="uof")return HD(n,r);var Je=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Je=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Je=!1}break;case"excelworkbook":switch(c[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Je=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Je=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(L,c.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else L=c.index+c[0].length;break;case"header":g["!margins"]||hc(g["!margins"]={},"xlml"),isNaN(+it(c[0]).Margin)||(g["!margins"].header=+it(c[0]).Margin);break;case"footer":g["!margins"]||hc(g["!margins"]={},"xlml"),isNaN(+it(c[0]).Margin)||(g["!margins"].footer=+it(c[0]).Margin);break;case"pagemargins":var He=it(c[0]);g["!margins"]||hc(g["!margins"]={},"xlml"),isNaN(+He.Top)||(g["!margins"].top=+He.Top),isNaN(+He.Left)||(g["!margins"].left=+He.Left),isNaN(+He.Right)||(g["!margins"].right=+He.Right),isNaN(+He.Bottom)||(g["!margins"].bottom=+He.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Je=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Je=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Je=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Je=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Je=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Je=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Je=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Je=!1}break;case"smarttags":break;default:Je=!1;break}if(Je||c[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?pye(R,G,te,n.slice(L,c.index)):(te=c,L=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+d.join("|")}var Ie={};return!r.bookSheets&&!r.bookProps&&(Ie.Sheets=h),Ie.SheetNames=p,Ie.Workbook=q,Ie.SSF=hr(tt),Ie.Props=P,Ie.Custprops=R,Ie}function Rw(e,t){switch(Nk(t=t||{}),t.type||"base64"){case"base64":return e2(ai(e),t);case"binary":case"buffer":case"file":return e2(e,t);case"array":return e2(Eo(e),t)}}function bye(e,t){var r=[];return e.Props&&r.push(Vde(e.Props,t)),e.Custprops&&r.push(Gde(e.Props,e.Custprops)),r.join("")}function wye(){return""}function Sye(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Fe("NumberFormat",null,{"ss:Format":Ht(tt[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Fe("Style",i.join(""),s))}),Fe("Styles",r.join(""))}function jL(e){return Fe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+gk(e.Ref,{r:0,c:0})})}function Nye(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(jL(a)))}return Fe("Names",r.join(""))}function kye(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var c=a[s];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(jL(c)))}return i.join("")}function _ye(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Fe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Fe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Fe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Fe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(zn("ProtectContents","True")),e["!protect"].objects&&a.push(zn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(zn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(zn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(zn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Fe("WorksheetOptions",a.join(""),{xmlns:Wa.x})}function jye(e){return e.map(function(t){var r=que(t.t||""),n=Fe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Fe("Comment",n,{"ss:Author":t.a})}).join("")}function Eye(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Ht(gk(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var d=kr(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(d.r==s.r?"":"["+(d.r-s.r)+"]")+"C"+(d.c==s.c?"":"["+(d.c-s.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Ht(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Ht(e.l.Tooltip))),r["!merges"])for(var f=r["!merges"],h=0;h!=f.length;++h)f[h].s.c!=s.c||f[h].s.r!=s.r||(f[h].e.c>f[h].s.c&&(c["ss:MergeAcross"]=f[h].e.c-f[h].s.c),f[h].e.r>f[h].s.r&&(c["ss:MergeDown"]=f[h].e.r-f[h].s.r));var p="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(e.v);break;case"b":p="Boolean",g=e.v?"1":"0";break;case"e":p="Error",g=jl[e.v];break;case"d":p="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||tt[14]);break;case"s":p="String",g=Wue(e.v||"");break}var v=Co(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+v),c["ss:Index"]=s.c+1;var b=e.v!=null?g:"",y=e.t=="z"?"":'<Data ss:Type="'+p+'">'+b+"</Data>";return(e.c||[]).length>0&&(y+=jye(e.c)),Fe("Cell",y,c)}function Tye(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=nd(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Cye(e,t,r,n){if(!e["!ref"])return"";var a=Et(e["!ref"]),i=e["!merges"]||[],s=0,c=[];e["!cols"]&&e["!cols"].forEach(function(w,j){bo(w);var T=!!w.width,N=zg(j,w),C={"ss:Index":j+1};T&&(C["ss:Width"]=_0(N.width)),w.hidden&&(C["ss:Hidden"]="1"),c.push(Fe("Column",null,C))});for(var d=Array.isArray(e),f=a.s.r;f<=a.e.r;++f){for(var h=[Tye(f,(e["!rows"]||[])[f])],p=a.s.c;p<=a.e.c;++p){var g=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>p)&&!(i[s].s.r>f)&&!(i[s].e.c<p)&&!(i[s].e.r<f)){(i[s].s.c!=p||i[s].s.r!=f)&&(g=!0);break}if(!g){var v={r:f,c:p},b=nt(v),y=d?(e[f]||[])[p]:e[b];h.push(Eye(y,b,e,t,r,n,v))}}h.push("</Row>"),h.length>2&&c.push(h.join(""))}return c.join("")}function Aye(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?kye(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?Cye(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(_ye(i,t,e,r)),n.join("")}function Oye(e,t){t||(t={}),e.SSF||(e.SSF=hr(tt)),e.SSF&&(bd(),fh(e.SSF),t.revssf=Pg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Co(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(bye(e,t)),r.push(wye()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Fe("Worksheet",Aye(n,t,e),{"ss:Name":Ht(e.SheetNames[n])}));return r[2]=Sye(e,t),r[3]=Nye(e),Hr+Fe("Workbook",r.join(""),{xmlns:Wa.ss,"xmlns:o":Wa.o,"xmlns:x":Wa.x,"xmlns:ss":Wa.ss,"xmlns:dt":Wa.dt,"xmlns:html":Wa.html})}function Dye(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Nde(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=kde(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Iye=[60,1084,2066,2165,2175];function Rye(e,t,r,n,a){var i=n,s=[],c=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}s.push(c),r.l+=i;for(var d=Js(r,r.l),f=Mw[d],h=0;f!=null&&Iye.indexOf(d)>-1;)i=Js(r,r.l+2),h=r.l+4,d==2066?h+=4:(d==2165||d==2175)&&(h+=12),c=r.slice(h,r.l+4+i),s.push(c),r.l+=4+i,f=Mw[d=Js(r,r.l)];var p=Nn(s);Bn(p,0);var g=0;p.lens=[];for(var v=0;v<s.length;++v)p.lens.push(g),g+=s[v].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,a)}function fs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=tt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||jl[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=y0(e.v):e.w=Nc(e.v):e.w=ii(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Mc(tt[n]||String(n))){var a=lo(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function sp(e,t,r){return{v:e,ixfe:t,t:r}}function Mye(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},c=null,d=[],f="",h={},p,g="",v,b,y,w,j={},T=[],N,C,E=[],O=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},M=function(lt){return lt<8?uc[lt]:lt<64&&O[lt-8]||uc[lt]},P=function(lt,Tt,Cn){var Zt=Tt.XF.data;if(!(!Zt||!Zt.patternType||!Cn||!Cn.cellStyles)){Tt.s={},Tt.s.patternType=Zt.patternType;var br;(br=k0(M(Zt.icvFore)))&&(Tt.s.fgColor={rgb:br}),(br=k0(M(Zt.icvBack)))&&(Tt.s.bgColor={rgb:br})}},R=function(lt,Tt,Cn){if(!(W>1)&&!(Cn.sheetRows&&lt.r>=Cn.sheetRows)){if(Cn.cellStyles&&Tt.XF&&Tt.XF.data&&P(lt,Tt,Cn),delete Tt.ixfe,delete Tt.XF,p=lt,g=nt(lt),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<s.s.r&&(s.s.r=lt.r),lt.c<s.s.c&&(s.s.c=lt.c),lt.r+1>s.e.r&&(s.e.r=lt.r+1),lt.c+1>s.e.c&&(s.e.c=lt.c+1),Cn.cellFormula&&Tt.f){for(var Zt=0;Zt<T.length;++Zt)if(!(T[Zt][0].s.c>lt.c||T[Zt][0].s.r>lt.r)&&!(T[Zt][0].e.c<lt.c||T[Zt][0].e.r<lt.r)){Tt.F=dt(T[Zt][0]),(T[Zt][0].s.c!=lt.c||T[Zt][0].s.r!=lt.r)&&delete Tt.f,Tt.f&&(Tt.f=""+Qn(T[Zt][1],s,lt,re,L));break}}Cn.dense?(a[lt.r]||(a[lt.r]=[]),a[lt.r][lt.c]=Tt):a[g]=Tt}},L={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var te,ee=[],ue=[],V=[],K=[],ie=!1,re=[];re.SheetNames=L.snames,re.sharedf=L.sharedf,re.arrayf=L.arrayf,re.names=[],re.XTI=[];var me=0,W=0,F=0,X=[],q=[],U;L.codepage=1200,Ki(1200);for(var G=!1;e.l<e.length-1;){var le=e.l,de=e.read_shift(2);if(de===0&&me===10)break;var ne=e.l===e.length?0:e.read_shift(2),oe=Mw[de];if(oe&&oe.f){if(t.bookSheets&&me===133&&de!==133)break;if(me=de,oe.r===2||oe.r==12){var Ae=e.read_shift(2);if(ne-=2,!L.enc&&Ae!==de&&((Ae&255)<<8|Ae>>8)!==de)throw new Error("rt mismatch: "+Ae+"!="+de);oe.r==12&&(e.l+=10,ne-=10)}var z={};if(de===10?z=oe.f(e,ne,L):z=Rye(de,oe,e,ne,L),W==0&&[9,521,1033,2057].indexOf(me)===-1)continue;switch(de){case 34:r.opts.Date1904=A.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=z;break;case 66:var et=Number(z);switch(et){case 21010:et=1200;break;case 32768:et=1e4;break;case 32769:et=1252;break}Ki(L.codepage=et),G=!0;break;case 317:L.rrtabid=z;break;case 25:L.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:L.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(a["!type"]="dialog"),z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:E.push(z);break;case 430:re.push([z]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(z);break;case 24:case 536:U={Name:z.Name,Ref:Qn(z.rgce,s,null,re,L)},z.itab>0&&(U.Sheet=z.itab-1),re.names.push(U),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(q[z.itab-1]={ref:dt(z.rgce[0][0][1][2])});break;case 22:L.ExternCount=z;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(z),re.XTI=re.XTI.concat(z);break;case 2196:if(L.biff<8)break;U!=null&&(U.Comment=z[1]);break;case 18:a["!protect"]=z;break;case 19:z!==0&&L.WTF&&console.error("Password verifier: "+z);break;case 133:i[z.pos]=z,L.snames.push(z.name);break;case 10:{if(--W)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=dt(s),t.sheetRows&&t.sheetRows<=s.e.r){var Be=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=dt(s),s.e.r=Be}s.e.r++,s.e.c++}ee.length>0&&(a["!merges"]=ee),ue.length>0&&(a["!objects"]=ue),V.length>0&&(a["!cols"]=V),K.length>0&&(a["!rows"]=K),A.Sheets.push(D)}f===""?h=a:n[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[de]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),L.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(L.biff=5,G=!0,Ki(L.codepage=28591)),L.biff==8&&z.BIFFVer==0&&z.dt==16&&(L.biff=2),W++)break;if(a=t.dense?[]:{},L.biff<8&&!G&&(G=!0,Ki(L.codepage=t.codepage||1252)),L.biff<5||z.BIFFVer==0&&z.dt==4096){f===""&&(f="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Je={pos:e.l-ne,name:f};i[Je.pos]=Je,L.snames.push(f)}else f=(i[le]||{name:""}).name;z.dt==32&&(a["!type"]="chart"),z.dt==64&&(a["!type"]="macro"),ee=[],ue=[],L.arrayf=T=[],V=[],K=[],ie=!1,D={Hidden:(i[le]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[z.r]||[])[z.c]:a[nt({c:z.c,r:z.r})])&&++z.c,N={ixfe:z.ixfe,XF:E[z.ixfe]||{},v:z.val,t:"n"},F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:z.c,r:z.r},N,t);break;case 5:case 517:N={ixfe:z.ixfe,XF:E[z.ixfe],v:z.val,t:z.t},F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:z.c,r:z.r},N,t);break;case 638:N={ixfe:z.ixfe,XF:E[z.ixfe],v:z.rknum,t:"n"},F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:z.c,r:z.r},N,t);break;case 189:for(var He=z.c;He<=z.C;++He){var Ie=z.rkrec[He-z.c][0];N={ixfe:Ie,XF:E[Ie],v:z.rkrec[He-z.c][1],t:"n"},F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:He,r:z.r},N,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){c=z;break}if(N=sp(z.val,z.cell.ixfe,z.tt),N.XF=E[N.ixfe],t.cellFormula){var _t=z.formula;if(_t&&_t[0]&&_t[0][0]&&_t[0][0][0]=="PtgExp"){var Er=_t[0][0][1][0],fe=_t[0][0][1][1],Re=nt({r:Er,c:fe});j[Re]?N.f=""+Qn(z.formula,s,z.cell,re,L):N.F=((t.dense?(a[Er]||[])[fe]:a[Re])||{}).F}else N.f=""+Qn(z.formula,s,z.cell,re,L)}F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R(z.cell,N,t),c=z}break;case 7:case 519:if(c)c.val=z,N=sp(z,c.cell.ixfe,"s"),N.XF=E[N.ixfe],t.cellFormula&&(N.f=""+Qn(c.formula,s,c.cell,re,L)),F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R(c.cell,N,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(z);var bt=nt(z[0].s);if(v=t.dense?(a[z[0].s.r]||[])[z[0].s.c]:a[bt],t.cellFormula&&v){if(!c||!bt||!v)break;v.f=""+Qn(z[1],s,z[0],re,L),v.F=dt(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!c)break;j[nt(c.cell)]=z[0],v=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[nt(c.cell)],(v||{}).f=""+Qn(z[0],s,p,re,L)}}break;case 253:N=sp(d[z.isst].t,z.ixfe,"s"),d[z.isst].h&&(N.h=d[z.isst].h),N.XF=E[N.ixfe],F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:z.c,r:z.r},N,t);break;case 513:t.sheetStubs&&(N={ixfe:z.ixfe,XF:E[z.ixfe],t:"z"},F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:z.c,r:z.r},N,t));break;case 190:if(t.sheetStubs)for(var Ft=z.c;Ft<=z.C;++Ft){var mt=z.ixfe[Ft-z.c];N={ixfe:mt,XF:E[mt],t:"z"},F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:Ft,r:z.r},N,t)}break;case 214:case 516:case 4:N=sp(z.val,z.ixfe,"s"),N.XF=E[N.ixfe],F>0&&(N.z=X[N.ixfe>>8&63]),fs(N,t,r.opts.Date1904),R({c:z.c,r:z.r},N,t);break;case 0:case 512:W===1&&(s=z);break;case 252:d=z;break;case 1054:if(L.biff==4){X[F++]=z[1];for(var sr=0;sr<F+163&&tt[sr]!=z[1];++sr);sr>=163&&vs(z[1],F+163)}else vs(z[1],z[0]);break;case 30:{X[F++]=z;for(var It=0;It<F+163&&tt[It]!=z;++It);It>=163&&vs(z,F+163)}break;case 229:ee=ee.concat(z);break;case 93:ue[z.cmo[0]]=L.lastobj=z;break;case 438:L.lastobj.TxO=z;break;case 127:L.lastobj.ImData=z;break;case 440:for(w=z[0].s.r;w<=z[0].e.r;++w)for(y=z[0].s.c;y<=z[0].e.c;++y)v=t.dense?(a[w]||[])[y]:a[nt({c:y,r:w})],v&&(v.l=z[1]);break;case 2048:for(w=z[0].s.r;w<=z[0].e.r;++w)for(y=z[0].s.c;y<=z[0].e.c;++y)v=t.dense?(a[w]||[])[y]:a[nt({c:y,r:w})],v&&v.l&&(v.l.Tooltip=z[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;v=t.dense?(a[z[0].r]||[])[z[0].c]:a[nt(z[0])];var Tn=ue[z[2]];v||(t.dense?(a[z[0].r]||(a[z[0].r]=[]),v=a[z[0].r][z[0].c]={t:"z"}):v=a[nt(z[0])]={t:"z"},s.e.r=Math.max(s.e.r,z[0].r),s.s.r=Math.min(s.s.r,z[0].r),s.e.c=Math.max(s.e.c,z[0].c),s.s.c=Math.min(s.s.c,z[0].c)),v.c||(v.c=[]),b={a:z[1],t:Tn.TxO.t},v.c.push(b)}break;case 2173:Sme(E[z.ixfe],z.ext);break;case 125:{if(!L.cellStyles)break;for(;z.e>=z.s;)V[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},ie||(ie=!0,mk(z.w/256)),bo(V[z.e+1])}break;case 520:{var Xt={};z.level!=null&&(K[z.r]=Xt,Xt.level=z.level),z.hidden&&(K[z.r]=Xt,Xt.hidden=!0),z.hpt&&(K[z.r]=Xt,Xt.hpt=z.hpt,Xt.hpx=nd(z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||hc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[de]]=z;break;case 161:a["!margins"]||hc(a["!margins"]={}),a["!margins"].header=z.header,a["!margins"].footer=z.footer;break;case 574:z.RTL&&(A.Views[0].RTL=!0);break;case 146:O=z;break;case 2198:te=z;break;case 140:C=z;break;case 442:f?D.CodeName=z||D.name:A.WBProps.CodeName=z||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+de.toString(16)),e.l+=ne}return r.SheetNames=Rr(i).sort(function(hn,lt){return Number(hn)-Number(lt)}).map(function(hn){return i[hn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&q.forEach(function(hn,lt){r.Sheets[r.SheetNames[lt]]["!autofilter"]=hn}),r.Strings=d,r.SSF=hr(tt),L.enc&&(r.Encryption=L.enc),te&&(r.Themes=te),r.Metadata={},C!==void 0&&(r.Metadata.Country=C),re.names.length>0&&(A.Names=re.names),r.Workbook=A,r}var Yf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Pye(e,t,r){var n=Qe.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=yD(n,Tw,Yf.DSI);for(var i in a)t[i]=a[i]}catch(f){if(r.WTF)throw f}var s=Qe.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var c=yD(s,Cw,Yf.SI);for(var d in c)t[d]==null&&(t[d]=c[d])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(_F(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Fye(e,t){var r=[],n=[],a=[],i=0,s,c=YO(Tw,"n"),d=YO(Cw,"n");if(e.Props)for(s=Rr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(d,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Rr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(d,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var f=[];for(i=0;i<a.length;++i)DF.indexOf(a[i][0])>-1||kF.indexOf(a[i][0])>-1||a[i][1]!=null&&f.push(a[i]);n.length&&Qe.utils.cfb_add(t,"/SummaryInformation",bD(n,Yf.SI,d,Cw)),(r.length||f.length)&&Qe.utils.cfb_add(t,"/DocumentSummaryInformation",bD(r,Yf.DSI,c,Tw,f.length?f:null,Yf.UDI))}function EL(e,t){t||(t={}),Nk(t),VN(),t.codepage&&HN(t.codepage);var r,n;if(e.FullPaths){if(Qe.find(e,"/encryption"))throw new Error("File is password-protected");r=Qe.find(e,"!CompObj"),n=Qe.find(e,"/Workbook")||Qe.find(e,"/Book")}else{switch(t.type){case"base64":e=Xa(ai(e));break;case"binary":e=Xa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Bn(e,0),n={content:e}}var a,i;if(r&&Dye(r),t.bookProps&&!t.bookSheets)a={};else{var s=xt?"buffer":"array";if(n&&n.content)a=Mye(n.content,t);else if((i=Qe.find(e,"PerfectOffice_MAIN"))&&i.content)a=fc.to_workbook(i.content,(t.type=s,t));else if((i=Qe.find(e,"NativeContent_MAIN"))&&i.content)a=fc.to_workbook(i.content,(t.type=s,t));else throw(i=Qe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Qe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Xme(e))}var c={};return e.FullPaths&&Pye(e,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=e),a}function Lye(e,t){var r=t||{},n=Qe.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qe.utils.cfb_add(n,a,TL(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Fye(e,n),r.biff==8&&e.vbaraw&&Zme(n,Qe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var T0={0:{f:oge},1:{f:xge},2:{f:Mge},3:{f:kge},4:{f:bge},5:{f:Dge},6:{f:Uge},7:{f:Tge},8:{f:qge},9:{f:Wge},10:{f:Vge},11:{f:Gge},12:{f:vge},13:{f:Fge},14:{f:jge},15:{f:Sge},16:{f:yL},17:{f:$ge},18:{f:Age},19:{f:ak},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:$ve},40:{},42:{},43:{f:Uhe},44:{f:Lhe},45:{f:Hhe},46:{f:Ghe},47:{f:Vhe},48:{},49:{f:dde},50:{},51:{f:_me},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:HF},62:{f:Bge},63:{f:Rme},64:{f:cve},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ra,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ive},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:mge},148:{f:dge,p:16},151:{f:Jge},152:{},153:{f:Bve},154:{},155:{},156:{f:Fve},157:{},158:{},159:{T:1,f:the},160:{T:-1},161:{T:1,f:Uc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Kge},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Nme},336:{T:-1},337:{f:Tme,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ew},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$F},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:eve},427:{f:tve},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:nve},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:hge},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Zge},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ew},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Gme},633:{T:1},634:{T:-1},635:{T:1,f:Hme},636:{T:-1},637:{f:pde},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:jve},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uve},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mw={6:{f:Qb},10:{f:Ql},12:{f:Zr},13:{f:Zr},14:{f:Br},15:{f:Br},16:{f:ea},17:{f:Br},18:{f:Br},19:{f:Zr},20:{f:jD},21:{f:jD},23:{f:$F},24:{f:TD},25:{f:Br},26:{},27:{},28:{f:u0e},29:{},34:{f:Br},35:{f:ED},38:{f:ea},39:{f:ea},40:{f:ea},41:{f:ea},42:{f:Br},43:{f:Br},47:{f:She},49:{f:Ffe},51:{f:Zr},60:{},61:{f:Dfe},64:{f:Br},65:{f:Pfe},66:{f:Zr},77:{},80:{},81:{},82:{},85:{f:Zr},89:{},90:{},91:{},92:{f:wfe},93:{f:h0e},94:{},95:{f:Br},96:{},97:{},99:{f:Br},125:{f:HF},128:{f:Qfe},129:{f:Nfe},130:{f:Zr},131:{f:Br},132:{f:Br},133:{f:kfe},134:{},140:{f:w0e},141:{f:Zr},144:{},146:{f:k0e},151:{},152:{},153:{},154:{},155:{},156:{f:Zr},157:{},158:{},160:{f:O0e},161:{f:E0e},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Kfe},190:{f:Yfe},193:{f:Ql},197:{},198:{},199:{},200:{},201:{},202:{f:Br},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zr},220:{},221:{f:Br},222:{},224:{f:Zfe},225:{f:bfe},226:{f:Ql},227:{},229:{f:d0e},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:jfe},253:{f:Bfe},255:{f:Tfe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:IF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Br},353:{f:Ql},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:n0e},431:{f:Br},432:{},433:{},434:{},437:{},438:{f:x0e},439:{f:Br},440:{f:g0e},441:{},442:{f:xh},443:{},444:{f:Zr},445:{},446:{},448:{f:Ql},449:{f:Ofe,r:2},450:{f:Ql},512:{f:ND},513:{f:A0e},515:{f:t0e},516:{f:zfe},517:{f:_D},519:{f:D0e},520:{f:Cfe},523:{},545:{f:CD},549:{f:SD},566:{},574:{f:Rfe},638:{f:qfe},659:{},1048:{},1054:{f:Hfe},1084:{},1212:{f:l0e},2048:{f:y0e},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:np},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ql},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:_0e,r:12},2173:{f:wme,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Br,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:s0e,r:12},2197:{},2198:{f:pme,r:12},2199:{},2200:{},2201:{},2202:{f:o0e,r:12},2203:{f:Ql},2204:{},2205:{},2206:{},2207:{},2211:{f:Afe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:T0e},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:N0e},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ND},1:{},2:{f:F0e},3:{f:M0e},4:{f:R0e},5:{f:_D},7:{f:B0e},8:{},9:{f:np},11:{},22:{f:Zr},30:{f:Gfe},31:{},32:{},33:{f:CD},36:{},37:{f:SD},50:{f:U0e},62:{},52:{},67:{},68:{f:Zr},69:{},86:{},126:{},127:{f:I0e},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:z0e},223:{},234:{},354:{},421:{},518:{f:Qb},521:{f:np},536:{f:TD},547:{f:ED},561:{},579:{},1030:{f:Qb},1033:{f:np},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Le(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&tk(r)&&e.push(r)}}function Bye(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Le(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],c=0,d=0,f=0;f+(s[c]||8224)<=8224;)f+=s[c]||8224,c++;var h=e.next(4);for(h.write_shift(2,i),h.write_shift(2,f),e.push(r.slice(d,d+f)),d+=f;d<a;){for(h=e.next(4),h.write_shift(2,60),f=0;f+(s[c]||8224)<=8224;)f+=s[c]||8224,c++;h.write_shift(2,f),e.push(r.slice(d,d+f)),d+=f}}}function bh(e,t,r){return e||(e=ke(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Uye(e,t,r,n){var a=ke(9);return bh(a,e,t),RF(r,n||"b",a),a}function zye(e,t,r){var n=ke(8+2*r.length);return bh(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function $ye(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?on(fr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Le(e,2,L0e(r,n,a)):Le(e,3,P0e(r,n,a));return;case"b":case"e":Le(e,5,Uye(r,n,t.v,t.t));return;case"s":case"str":Le(e,4,zye(r,n,(t.v||"").slice(0,255)));return}Le(e,1,bh(null,r,n))}function Hye(e,t,r,n){var a=Array.isArray(t),i=Et(t["!ref"]||"A1"),s,c="",d=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=dt(i)}for(var f=i.s.r;f<=i.e.r;++f){c=$r(f);for(var h=i.s.c;h<=i.e.c;++h){f===i.s.r&&(d[h]=Nr(h)),s=d[h]+c;var p=a?(t[f]||[])[h]:t[s];p&&$ye(e,p,f,h)}}}function Vye(e,t){for(var r=t||{},n=Da(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Le(n,r.biff==4?1033:r.biff==3?521:9,dk(e,16,r)),Hye(n,e.Sheets[e.SheetNames[a]],a,r),Le(n,10),n.end()}function Gye(e,t,r){Le(e,49,Lfe({sz:12,name:"Arial"},r))}function Wye(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Le(e,1054,Vfe(a,t[a],r))})}function qye(e,t){var r=ke(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Le(e,2151,r),r=ke(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),BF(Et(t["!ref"]||"A1"),r),r.write_shift(4,4),Le(e,2152,r)}function Kye(e,t){for(var r=0;r<16;++r)Le(e,224,kD({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Le(e,224,kD(n,0,t))})}function Yye(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Le(e,440,v0e(n)),n[1].Tooltip&&Le(e,2048,b0e(n))}delete t["!links"]}function Xye(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Le(e,125,j0e(zg(a,n),a))})}}function Zye(e,t,r,n,a){var i=16+Co(a.cellXfs,t,a);if(t.v==null&&!t.bf){Le(e,513,Ec(r,n,i));return}if(t.bf)Le(e,6,Nxe(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?on(fr(t.v)):t.v;Le(e,515,r0e(r,n,s,i));break;case"b":case"e":Le(e,517,e0e(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var c=yk(a.Strings,t.v,a.revStrings);Le(e,253,Ufe(r,n,c,i))}else Le(e,516,$fe(r,n,(t.v||"").slice(0,255),i,a));break;default:Le(e,513,Ec(r,n,i))}}function Qye(e,t,r){var n=Da(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},c=(s.Sheets||[])[e]||{},d=Array.isArray(i),f=t.biff==8,h,p="",g=[],v=Et(i["!ref"]||"A1"),b=f?65536:16384;if(v.e.c>255||v.e.r>=b){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");v.e.c=Math.min(v.e.c,255),v.e.r=Math.min(v.e.c,b-1)}Le(n,2057,dk(r,16,t)),Le(n,13,Ei(1)),Le(n,12,Ei(100)),Le(n,15,oa(!0)),Le(n,17,oa(!1)),Le(n,16,_c(.001)),Le(n,95,oa(!0)),Le(n,42,oa(!1)),Le(n,43,oa(!1)),Le(n,130,Ei(1)),Le(n,128,Jfe()),Le(n,131,oa(!1)),Le(n,132,oa(!1)),f&&Xye(n,i["!cols"]),Le(n,512,Wfe(v,t)),f&&(i["!links"]=[]);for(var y=v.s.r;y<=v.e.r;++y){p=$r(y);for(var w=v.s.c;w<=v.e.c;++w){y===v.s.r&&(g[w]=Nr(w)),h=g[w]+p;var j=d?(i[y]||[])[w]:i[h];j&&(Zye(n,j,y,w,t),f&&j.l&&i["!links"].push([h,j.l]))}}var T=c.CodeName||c.name||a;return f&&Le(n,574,Mfe((s.Views||[])[0])),f&&(i["!merges"]||[]).length&&Le(n,229,f0e(i["!merges"])),f&&Yye(n,i),Le(n,442,MF(T)),f&&qye(n,i),Le(n,10),n.end()}function Jye(e,t,r){var n=Da(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},c=r.biff==8,d=r.biff==5;if(Le(n,2057,dk(e,5,r)),r.bookType=="xla"&&Le(n,135),Le(n,225,c?Ei(1200):null),Le(n,193,efe(2)),d&&Le(n,191),d&&Le(n,192),Le(n,226),Le(n,92,Sfe("SheetJS",r)),Le(n,66,Ei(c?1200:1252)),c&&Le(n,353,Ei(0)),c&&Le(n,448),Le(n,317,C0e(e.SheetNames.length)),c&&e.vbaraw&&Le(n,211),c&&e.vbaraw){var f=s.CodeName||"ThisWorkbook";Le(n,442,MF(f))}Le(n,156,Ei(17)),Le(n,25,oa(!1)),Le(n,18,oa(!1)),Le(n,19,Ei(0)),c&&Le(n,431,oa(!1)),c&&Le(n,444,Ei(0)),Le(n,61,Ife()),Le(n,64,oa(!1)),Le(n,141,Ei(0)),Le(n,34,oa(Ove(e)=="true")),Le(n,14,oa(!0)),c&&Le(n,439,oa(!1)),Le(n,218,Ei(0)),Gye(n,e,r),Wye(n,e.SSF,r),Kye(n,r),c&&Le(n,352,oa(!1));var h=n.end(),p=Da();c&&Le(p,140,S0e()),c&&r.Strings&&Bye(p,252,Efe(r.Strings)),Le(p,10);var g=p.end(),v=Da(),b=0,y=0;for(y=0;y<e.SheetNames.length;++y)b+=(c?12:11)+(c?2:1)*e.SheetNames[y].length;var w=h.length+b+g.length;for(y=0;y<e.SheetNames.length;++y){var j=i[y]||{};Le(v,133,_fe({pos:w,hs:j.Hidden||0,dt:0,name:e.SheetNames[y]},r)),w+=t[y].length}var T=v.end();if(b!=T.length)throw new Error("BS8 "+b+" != "+T.length);var N=[];return h.length&&N.push(h),T.length&&N.push(T),g.length&&N.push(g),Nn(N)}function e1e(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=hr(tt)),e&&e.SSF&&(bd(),fh(e.SSF),r.revssf=Pg(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kk(r),r.cellXfs=[],Co(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Qye(a,r,e);return n.unshift(Jye(e,n,r)),Nn(n)}function TL(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ia(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return e1e(e,t);case 4:case 3:case 2:return Vye(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function BD(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,c=i&&i.index||e.length,d=Lue(e.slice(s,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,h=0,p=0,g=0,v={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(s=0;s<d.length;++s){var y=d[s].trim(),w=y.slice(0,3).toLowerCase();if(w=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}h=0;continue}if(!(w!="<td"&&w!="<th")){var j=y.split(/<\/t[dh]>/i);for(c=0;c<j.length;++c){var T=j[c].trim();if(T.match(/<t[dh]/i)){for(var N=T,C=0;N.charAt(0)=="<"&&(C=N.indexOf(">"))>-1;)N=N.slice(C+1);for(var E=0;E<b.length;++E){var O=b[E];O.s.c==h&&O.s.r<f&&f<=O.e.r&&(h=O.e.c+1,E=-1)}var A=it(T.slice(0,T.indexOf(">")));g=A.colspan?+A.colspan:1,((p=+A.rowspan)>1||g>1)&&b.push({s:{r:f,c:h},e:{r:f+(p||1)-1,c:h+g-1}});var D=A.t||A["data-t"]||"";if(!N.length){h+=g;continue}if(N=Q8(N),v.s.r>f&&(v.s.r=f),v.e.r<f&&(v.e.r=f),v.s.c>h&&(v.s.c=h),v.e.c<h&&(v.e.c=h),!N.length){h+=g;continue}var M={t:"s",v:N};r.raw||!N.trim().length||D=="s"||(N==="TRUE"?M={t:"b",v:!0}:N==="FALSE"?M={t:"b",v:!1}:isNaN(Zi(N))?isNaN(td(N).getDate())||(M={t:"d",v:fr(N)},r.cellDates||(M={t:"n",v:on(M.v)}),M.z=r.dateNF||tt[14]):M={t:"n",v:Zi(N)}),r.dense?(n[f]||(n[f]=[]),n[f][h]=M):n[nt({r:f,c:h})]=M,h+=g}}}}return n["!ref"]=dt(v),b.length&&(n["!merges"]=b),n}function t1e(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var c=0,d=0,f=0;f<a.length;++f)if(!(a[f].s.r>r||a[f].s.c>s)&&!(a[f].e.r<r||a[f].e.c<s)){if(a[f].s.r<r||a[f].s.c<s){c=-1;break}c=a[f].e.r-a[f].s.r+1,d=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var h=nt({r,c:s}),p=n.dense?(e[r]||[])[s]:e[h],g=p&&p.v!=null&&(p.h||QN(p.w||(pl(p),p.w)||""))||"",v={};c>1&&(v.rowspan=c),d>1&&(v.colspan=d),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(v["data-t"]=p&&p.t||"z",p.v!=null&&(v["data-v"]=p.v),p.z!=null&&(v["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),v.id=(n.id||"sjs")+"-"+h,i.push(Fe("td",g,v))}}var b="<tr>";return b+i.join("")+"</tr>"}var r1e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',n1e="</body></html>";function a1e(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return To(BD(r[0],t),t);var n=Tk();return r.forEach(function(a,i){Ck(n,BD(a,t),"Sheet"+(i+1))}),n}function i1e(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function CL(e,t){var r=t||{},n=r.header!=null?r.header:r1e,a=r.footer!=null?r.footer:n1e,i=[n],s=Ia(e["!ref"]);r.dense=Array.isArray(e),i.push(i1e(e,s,r));for(var c=s.s.r;c<=s.e.r;++c)i.push(t1e(e,s,c,r));return i.push("</table>"+a),i.join("")}function AL(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?kr(n.origin):n.origin;a=s.r,i=s.c}var c=t.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var h=Ia(e["!ref"]);f.s.r=Math.min(f.s.r,h.s.r),f.s.c=Math.min(f.s.c,h.s.c),f.e.r=Math.max(f.e.r,h.e.r),f.e.c=Math.max(f.e.c,h.e.c),a==-1&&(f.e.r=a=h.e.r+1)}var p=[],g=0,v=e["!rows"]||(e["!rows"]=[]),b=0,y=0,w=0,j=0,T=0,N=0;for(e["!cols"]||(e["!cols"]=[]);b<c.length&&y<d;++b){var C=c[b];if(UD(C)){if(n.display)continue;v[y]={hidden:!0}}var E=C.children;for(w=j=0;w<E.length;++w){var O=E[w];if(!(n.display&&UD(O))){var A=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):Q8(O.innerHTML),D=O.getAttribute("data-z")||O.getAttribute("z");for(g=0;g<p.length;++g){var M=p[g];M.s.c==j+i&&M.s.r<y+a&&y+a<=M.e.r&&(j=M.e.c+1-i,g=-1)}N=+O.getAttribute("colspan")||1,((T=+O.getAttribute("rowspan")||1)>1||N>1)&&p.push({s:{r:y+a,c:j+i},e:{r:y+a+(T||1)-1,c:j+i+(N||1)-1}});var P={t:"s",v:A},R=O.getAttribute("data-t")||O.getAttribute("t")||"";A!=null&&(A.length==0?P.t=R||"z":n.raw||A.trim().length==0||R=="s"||(A==="TRUE"?P={t:"b",v:!0}:A==="FALSE"?P={t:"b",v:!1}:isNaN(Zi(A))?isNaN(td(A).getDate())||(P={t:"d",v:fr(A)},n.cellDates||(P={t:"n",v:on(P.v)}),P.z=n.dateNF||tt[14]):P={t:"n",v:Zi(A)})),P.z===void 0&&D!=null&&(P.z=D);var L="",te=O.getElementsByTagName("A");if(te&&te.length)for(var ee=0;ee<te.length&&!(te[ee].hasAttribute("href")&&(L=te[ee].getAttribute("href"),L.charAt(0)!="#"));++ee);L&&L.charAt(0)!="#"&&(P.l={Target:L}),n.dense?(e[y+a]||(e[y+a]=[]),e[y+a][j+i]=P):e[nt({c:j+i,r:y+a})]=P,f.e.c<j+i&&(f.e.c=j+i),j+=N}}++y}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,y-1+a),e["!ref"]=dt(f),y>=d&&(e["!fullref"]=dt((f.e.r=c.length-b+y-1+a,f))),e}function OL(e,t){var r=t||{},n=r.dense?[]:{};return AL(n,e,t)}function s1e(e,t){return To(OL(e,t),t)}function UD(e){var t="",r=l1e(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function l1e(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function o1e(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=jt(t.replace(/<[^>]*>/g,""));return[r]}var zD={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function DL(e,t){var r=t||{},n=JN(e),a=[],i,s,c={name:""},d="",f=0,h,p,g={},v=[],b=r.dense?[]:{},y,w,j={value:""},T="",N=0,C=[],E=-1,O=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,M={},P=[],R={},L=0,te=0,ee=[],ue=1,V=1,K=[],ie={Names:[]},re={},me=["",""],W=[],F={},X="",q=0,U=!1,G=!1,le=0;for(S0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=S0.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"":y[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?b["!ref"]=dt(A):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(b["!fullref"]=b["!ref"],A.e.r=r.sheetRows-1,b["!ref"]=dt(A)),P.length&&(b["!merges"]=P),ee.length&&(b["!rows"]=ee),h.name=h.||h.name,typeof JSON<"u"&&JSON.stringify(h),v.push(h.name),g[h.name]=b,G=!1):y[0].charAt(y[0].length-2)!=="/"&&(h=it(y[0],!1),E=O=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,b=r.dense?[]:{},P=[],ee=[],G=!0);break;case"table-row-group":y[1]==="/"?--D:++D;break;case"table-row":case"":if(y[1]==="/"){E+=ue,ue=1;break}if(p=it(y[0],!1),p.?E=p.-1:E==-1&&(E=0),ue=+p["number-rows-repeated"]||1,ue<10)for(le=0;le<ue;++le)D>0&&(ee[E+le]={level:D});O=-1;break;case"covered-table-cell":y[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(b[E]||(b[E]=[]),b[E][O]={t:"z"}):b[nt({r:E,c:O})]={t:"z"}),T="",C=[];break;case"table-cell":case"":if(y[0].charAt(y[0].length-2)==="/")++O,j=it(y[0],!1),V=parseInt(j["number-columns-repeated"]||"1",10),w={t:"z",v:null},j.formula&&r.cellFormula!=!1&&(w.f=PD(jt(j.formula))),(j.||j["value-type"])=="string"&&(w.t="s",w.v=jt(j["string-value"]||""),r.dense?(b[E]||(b[E]=[]),b[E][O]=w):b[nt({r:E,c:O})]=w),O+=V-1;else if(y[1]!=="/"){++O,T="",N=0,C=[],V=1;var de=ue?E+ue-1:E;if(O>A.e.c&&(A.e.c=O),O<A.s.c&&(A.s.c=O),E<A.s.r&&(A.s.r=E),de>A.e.r&&(A.e.r=de),j=it(y[0],!1),W=[],F={},w={t:j.||j["value-type"],v:null},r.cellFormula)if(j.formula&&(j.formula=jt(j.formula)),j["number-matrix-columns-spanned"]&&j["number-matrix-rows-spanned"]&&(L=parseInt(j["number-matrix-rows-spanned"],10)||0,te=parseInt(j["number-matrix-columns-spanned"],10)||0,R={s:{r:E,c:O},e:{r:E+L-1,c:O+te-1}},w.F=dt(R),K.push([R,w.F])),j.formula)w.f=PD(j.formula);else for(le=0;le<K.length;++le)E>=K[le][0].s.r&&E<=K[le][0].e.r&&O>=K[le][0].s.c&&O<=K[le][0].e.c&&(w.F=K[le][1]);switch((j["number-columns-spanned"]||j["number-rows-spanned"])&&(L=parseInt(j["number-rows-spanned"],10)||0,te=parseInt(j["number-columns-spanned"],10)||0,R={s:{r:E,c:O},e:{r:E+L-1,c:O+te-1}},P.push(R)),j["number-columns-repeated"]&&(V=parseInt(j["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=dr(j["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(j.value);break;case"percentage":w.t="n",w.v=parseFloat(j.value);break;case"currency":w.t="n",w.v=parseFloat(j.value);break;case"date":w.t="d",w.v=fr(j["date-value"]),r.cellDates||(w.t="n",w.v=on(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Mue(j["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Fg(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(j.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",j["string-value"]!=null&&(T=jt(j["string-value"]),C=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(U=!1,w.t==="s"&&(w.v=T||"",C.length&&(w.R=C),U=N==0),re.Target&&(w.l=re),W.length>0&&(w.c=W,W=[]),T&&r.cellText!==!1&&(w.w=T),U&&(w.t="z",delete w.v),(!U||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var ne=0;ne<ue;++ne){if(V=parseInt(j["number-columns-repeated"]||"1",10),r.dense)for(b[E+ne]||(b[E+ne]=[]),b[E+ne][O]=ne==0?w:hr(w);--V>0;)b[E+ne][O+V]=hr(w);else for(b[nt({r:E+ne,c:O})]=w;--V>0;)b[nt({r:E+ne,c:O+V})]=hr(w);A.e.c<=O&&(A.e.c=O)}V=parseInt(j["number-columns-repeated"]||"1",10),O+=V-1,V=0,w={},T="",C=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i;F.t=T,C.length&&(F.R=C),F.a=X,W.push(F)}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);X="",q=0,T="",N=0,C=[];break;case"creator":y[1]==="/"?X=n.slice(q,y.index):q=y.index+y[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&a.push([y[3],!1]);T="",N=0,C=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(M[c.name]=d,(i=a.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(d="",c=it(y[0],!1),a.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=it(y[0],!1),d+=zD[y[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=it(y[0],!1),d+=zD[y[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":d+=n.slice(f,y.index);break}else f=y.index+y[0].length;break;case"named-range":s=it(y[0],!1),me=Jb(s["cell-range-address"]);var oe={Name:s.name,Ref:me[0]+"!"+me[1]};G&&(oe.Sheet=v.length),ie.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(y[1]==="/"&&(!j||!j["string-value"])){var Ae=o1e(n.slice(N,y.index));T=(T.length>0?T+`
`:"")+Ae[0]}else it(y[0],!1),N=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{me=Jb(it(y[0])["target-range-address"]),g[me[0]]["!autofilter"]={ref:me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(re=it(y[0],!1),!re.href)break;re.Target=jt(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(me=Jb(re.Target.slice(1)),re.Target="#"+me[0]+"!"+me[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(y)}}var z={Sheets:g,SheetNames:v,Workbook:ie};return r.bookSheets&&delete z.Sheets,z}function $D(e,t){t=t||{},ji(e,"META-INF/manifest.xml")&&Mde(Xr(e,"META-INF/manifest.xml"),t);var r=Za(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=DL(Yt(r),t);return ji(e,"meta.xml")&&(n.Props=SF(Xr(e,"meta.xml"))),n}function HD(e,t){return DL(e,t)}var c1e=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+w0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Hr+t}})(),VD=(function(){var e=function(i){return Ht(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,c){var d=[];d.push('      <table:table table:name="'+Ht(s.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,h=0,p=Ia(i["!ref"]||"A1"),g=i["!merges"]||[],v=0,b=Array.isArray(i);if(i["!cols"])for(h=0;h<=p.e.c;++h)d.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var y="",w=i["!rows"]||[];for(f=0;f<p.s.r;++f)y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+y+`></table:table-row>
`);for(;f<=p.e.r;++f){for(y=w[f]?' table:style-name="ro'+w[f].ods+'"':"",d.push("        <table:table-row"+y+`>
`),h=0;h<p.s.c;++h)d.push(t);for(;h<=p.e.c;++h){var j=!1,T={},N="";for(v=0;v!=g.length;++v)if(!(g[v].s.c>h)&&!(g[v].s.r>f)&&!(g[v].e.c<h)&&!(g[v].e.r<f)){(g[v].s.c!=h||g[v].s.r!=f)&&(j=!0),T["table:number-columns-spanned"]=g[v].e.c-g[v].s.c+1,T["table:number-rows-spanned"]=g[v].e.r-g[v].s.r+1;break}if(j){d.push(r);continue}var C=nt({r:f,c:h}),E=b?(i[f]||[])[h]:i[C];if(E&&E.f&&(T["table:formula"]=Ht(Cxe(E.f)),E.F&&E.F.slice(0,C.length)==C)){var O=Ia(E.F);T["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,T["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!E){d.push(t);continue}switch(E.t){case"b":N=E.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=E.v?"true":"false";break;case"n":N=E.w||String(E.v||0),T["office:value-type"]="float",T["office:value"]=E.v||0;break;case"s":case"str":N=E.v==null?"":E.v,T["office:value-type"]="string";break;case"d":N=E.w||fr(E.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=fr(E.v).toISOString(),T["table:style-name"]="ce1";break;default:d.push(t);continue}var A=e(N);if(E.l&&E.l.Target){var D=E.l.Target;D=D.charAt(0)=="#"?"#"+Axe(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),A=Fe("text:a",A,{"xlink:href":D.replace(/&/g,"&amp;")})}d.push("          "+Fe("table:table-cell",Fe("text:p",A,{}),T)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var h=0;h<f["!cols"].length;++h)if(f["!cols"][h]){var p=f["!cols"][h];if(p.width==null&&p.wpx==null&&p.wch==null)continue;bo(p),p.ods=c;var g=f["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),i.push(`  </style:style>
`),++c}}});var d=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var h=0;h<f["!rows"].length;++h)if(f["!rows"][h]){f["!rows"][h].ods=d;var p=f["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),i.push(`  </style:style>
`),++d}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,c){var d=[Hr],f=w0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=w0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(d.push("<office:document"+f+h+`>
`),d.push(wF().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+f+`>
`),a(d,s),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var p=0;p!=s.SheetNames.length;++p)d.push(n(s.Sheets[s.SheetNames[p]],s,p));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),c.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function IL(e,t){if(t.bookType=="fods")return VD(e,t);var r=YN(),n="",a=[],i=[];return n="mimetype",ht(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ht(r,n,VD(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",ht(r,n,c1e(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",ht(r,n,Hr+wF()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",ht(r,n,Lde(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ht(r,n,Pde(a)),r}function Tc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Pw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Yt(Eo(e))}function u1e(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Xa(xs(e))}function d1e(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function So(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function GD(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function f1e(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function h1e(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function C0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ut(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Dr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ot(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=C0(e,r),i=a&7;a=Math.floor(a/8);var s=0,c;if(a==0)break;switch(i){case 0:{for(var d=r[0];e[r[0]++]>=128;);c=e.slice(d,r[0])}break;case 5:s=4,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=C0(e,r),c=e.slice(r[0],r[0]+s),r[0]+=s;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var f={data:c,type:i};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function Pn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Ut(n*8+a.type)),a.type==2&&t.push(Ut(a.data.length)),t.push(a.data))})}),So(t)}function Sk(e,t){return e?.map(function(r){return t(r.data)})||[]}function ki(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=C0(e,n),i=Ot(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Dr(i[1][0].data),messages:[]};i[2].forEach(function(c){var d=Ot(c.data),f=Dr(d[3][0].data);s.messages.push({meta:d,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=i[3])!=null&&t[0]&&(s.merge=Dr(i[3][0].data)>>>0>0),r.push(s)}return r}function ju(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ut(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ut(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:Ut(s.data.length)}],n[2].push({data:Pn(s.meta),type:2})});var i=Pn(n);t.push(Ut(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),So(t)}function m1e(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=C0(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var c=s-59;s=t[r[0]],c>1&&(s|=t[r[0]+1]<<8),c>2&&(s|=t[r[0]+2]<<16),c>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=c}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var d=0,f=0;if(i==1?(f=(t[r[0]]>>2&7)+4,d=(t[r[0]++]&224)<<3,d|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,i==2?(d=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(d=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[So(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(f>=d)for(a.push(a[0].slice(-d)),f-=d;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-d,-d+f))}}var h=So(a);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function _i(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(m1e(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return So(t)}function Eu(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=Ut(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return So(t)}function p1e(e,t,r,n){var a=Tc(e),i=a.getUint32(4,!0),s=(n>1?12:8)+GD(i&(n>1?3470:398))*4,c=-1,d=-1,f=NaN,h=new Date(2001,0,1);i&512&&(c=a.getUint32(s,!0),s+=4),s+=GD(i&(n>1?12288:4096))*4,i&16&&(d=a.getUint32(s,!0),s+=4),i&32&&(f=a.getFloat64(s,!0),s+=8),i&64&&(h.setTime(h.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[d]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(c>-1)p={t:"s",v:r[c]};else if(d>-1)p={t:"s",v:t[d]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function x1e(e,t,r){var n=Tc(e),a=n.getUint32(8,!0),i=12,s=-1,c=-1,d=NaN,f=NaN,h=new Date(2001,0,1);a&1&&(d=f1e(e,i),i+=16),a&2&&(f=n.getFloat64(i,!0),i+=8),a&4&&(h.setTime(h.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return p}function t2(e,t){var r=new Uint8Array(32),n=Tc(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,h1e(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function r2(e,t){var r=new Uint8Array(32),n=Tc(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function g1e(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return p1e(e,t,r,e[0]);case 5:return x1e(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Zn(e){var t=Ot(e);return C0(t[1][0].data)}function WD(e,t){var r=Ot(t.data),n=Dr(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var c=Ot(s.data),d=Dr(c[1][0].data)>>>0;switch(n){case 1:i[d]=Pw(c[3][0].data);break;case 8:{var f=e[Zn(c[9][0].data)][0],h=Ot(f.data),p=e[Zn(h[1][0].data)][0],g=Dr(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var v=Ot(p.data);i[d]=v[3].map(function(b){return Pw(b.data)}).join("")}break}}),i}function v1e(e,t){var r,n,a,i,s,c,d,f,h,p,g,v,b,y,w=Ot(e),j=Dr(w[1][0].data)>>>0,T=Dr(w[2][0].data)>>>0,N=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Dr(w[8][0].data)>0||!1,C,E;if((i=(a=w[7])==null?void 0:a[0])!=null&&i.data&&t!=0)C=(c=(s=w[7])==null?void 0:s[0])==null?void 0:c.data,E=(f=(d=w[6])==null?void 0:d[0])==null?void 0:f.data;else if((p=(h=w[4])==null?void 0:h[0])!=null&&p.data&&t!=1)C=(v=(g=w[4])==null?void 0:g[0])==null?void 0:v.data,E=(y=(b=w[3])==null?void 0:b[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=N?4:1,A=Tc(C),D=[],M=0;M<C.length/2;++M){var P=A.getUint16(M*2,!0);P<65535&&D.push([M,P])}if(D.length!=T)throw"Expected ".concat(T," cells, found ").concat(D.length);var R=[];for(M=0;M<D.length-1;++M)R[D[M][0]]=E.subarray(D[M][1]*O,D[M+1][1]*O);return D.length>=1&&(R[D[D.length-1][0]]=E.subarray(D[D.length-1][1]*O)),{R:j,cells:R}}function y1e(e,t){var r,n=Ot(t.data),a=(r=n?.[7])!=null&&r[0]?Dr(n[7][0].data)>>>0>0?1:0:-1,i=Sk(n[5],function(s){return v1e(s,a)});return{nrows:Dr(n[4][0].data)>>>0,data:i.reduce(function(s,c){return s[c.R]||(s[c.R]=[]),c.cells.forEach(function(d,f){if(s[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));s[c.R][f]=d}),s},[])}}function b1e(e,t,r){var n,a=Ot(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Dr(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(Dr(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=dt(i);var s=Ot(a[4][0].data),c=WD(e,e[Zn(s[4][0].data)][0]),d=(n=s[17])!=null&&n[0]?WD(e,e[Zn(s[17][0].data)][0]):[],f=Ot(s[3][0].data),h=0;f[1].forEach(function(p){var g=Ot(p.data),v=e[Zn(g[2][0].data)][0],b=Dr(v.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var y=y1e(e,v);y.data.forEach(function(w,j){w.forEach(function(T,N){var C=nt({r:h+j,c:N}),E=g1e(T,c,d);E&&(r[C]=E)})}),h+=y.nrows})}function w1e(e,t){var r=Ot(t.data),n={"!ref":"A1"},a=e[Zn(r[2][0].data)],i=Dr(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return b1e(e,a[0],n),n}function S1e(e,t){var r,n=Ot(t.data),a={name:(r=n[1])!=null&&r[0]?Pw(n[1][0].data):"",sheets:[]},i=Sk(n[2],Zn);return i.forEach(function(s){e[s].forEach(function(c){var d=Dr(c.meta[1][0].data);d==6e3&&a.sheets.push(w1e(e,c))})}),a}function N1e(e,t){var r=Tk(),n=Ot(t.data),a=Sk(n[1],Zn);if(a.forEach(function(i){e[i].forEach(function(s){var c=Dr(s.meta[1][0].data);if(c==2){var d=S1e(e,s);d.sheets.forEach(function(f,h){Ck(r,f,h==0?d.name:d.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function n2(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var f;try{f=_i(d.content)}catch(p){return console.log("?? "+d.content.length+" "+(p.message||p))}var h;try{h=ki(f)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){i[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var c=((a=(n=(r=(t=i?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Dr(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||s.forEach(function(d){i[d].forEach(function(f){var h=Dr(f.meta[1][0].data)>>>0;if(h==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return N1e(i,c)}function k1e(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Dr(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var d=0,f=Tc(e[7][0].data),h=0,p=[],g=Tc(e[4][0].data),v=0,b=[],y=0;y<t.length;++y){if(t[y]==null){f.setUint16(y*2,65535,!0),g.setUint16(y*2,65535);continue}f.setUint16(y*2,h,!0),g.setUint16(y*2,v,!0);var w,j;switch(typeof t[y]){case"string":w=t2({t:"s",v:t[y]},r),j=r2({t:"s",v:t[y]},r);break;case"number":w=t2({t:"n",v:t[y]},r),j=r2({t:"n",v:t[y]},r);break;case"boolean":w=t2({t:"b",v:t[y]},r),j=r2({t:"b",v:t[y]},r);break;default:throw new Error("Unsupported value "+t[y])}p.push(w),h+=w.length,b.push(j),v+=j.length,++d}for(e[2][0].data=Ut(d);y<e[7][0].data.length/2;++y)f.setUint16(y*2,65535,!0),g.setUint16(y*2,65535,!0);return e[6][0].data=So(p),e[3][0].data=So(b),d}function _1e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ia(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(dt(n)));var i=Ox(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(X){return X.forEach(function(q){typeof q=="string"&&s.push(q)})});var c={},d=[],f=Qe.read(t.numbers,{type:"base64"});f.FileIndex.map(function(X,q){return[X,f.FullPaths[q]]}).forEach(function(X){var q=X[0],U=X[1];if(q.type==2&&q.name.match(/\.iwa/)){var G=q.content,le=_i(G),de=ki(le);de.forEach(function(ne){d.push(ne.id),c[ne.id]={deps:[],location:U,type:Dr(ne.messages[0].meta[1][0].data)}})}}),d.sort(function(X,q){return X-q});var h=d.filter(function(X){return X>1}).map(function(X){return[X,Ut(X)]});f.FileIndex.map(function(X,q){return[X,f.FullPaths[q]]}).forEach(function(X){var q=X[0];if(X[1],!!q.name.match(/\.iwa/)){var U=ki(_i(q.content));U.forEach(function(G){G.messages.forEach(function(le){h.forEach(function(de){G.messages.some(function(ne){return Dr(ne.meta[1][0].data)!=11006&&d1e(ne.data,de[1])})&&c[de[0]].deps.push(G.id)})})})}});for(var p=Qe.find(f,c[1].location),g=ki(_i(p.content)),v,b=0;b<g.length;++b){var y=g[b];y.id==1&&(v=y)}var w=Zn(Ot(v.messages[0].data)[1][0].data);for(p=Qe.find(f,c[w].location),g=ki(_i(p.content)),b=0;b<g.length;++b)y=g[b],y.id==w&&(v=y);for(w=Zn(Ot(v.messages[0].data)[2][0].data),p=Qe.find(f,c[w].location),g=ki(_i(p.content)),b=0;b<g.length;++b)y=g[b],y.id==w&&(v=y);for(w=Zn(Ot(v.messages[0].data)[2][0].data),p=Qe.find(f,c[w].location),g=ki(_i(p.content)),b=0;b<g.length;++b)y=g[b],y.id==w&&(v=y);var j=Ot(v.messages[0].data);{j[6][0].data=Ut(n.e.r+1),j[7][0].data=Ut(n.e.c+1);var T=Zn(j[46][0].data),N=Qe.find(f,c[T].location),C=ki(_i(N.content));{for(var E=0;E<C.length&&C[E].id!=T;++E);if(C[E].id!=T)throw"Bad ColumnRowUIDMapArchive";var O=Ot(C[E].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var A=0;A<=n.e.c;++A){var D=[];D[1]=D[2]=[{type:0,data:Ut(A+420690)}],O[1].push({type:2,data:Pn(D)}),O[2].push({type:0,data:Ut(A)}),O[3].push({type:0,data:Ut(A)})}O[4]=[],O[5]=[],O[6]=[];for(var M=0;M<=n.e.r;++M)D=[],D[1]=D[2]=[{type:0,data:Ut(M+726270)}],O[4].push({type:2,data:Pn(D)}),O[5].push({type:0,data:Ut(M)}),O[6].push({type:0,data:Ut(M)});C[E].messages[0].data=Pn(O)}N.content=Eu(ju(C)),N.size=N.content.length,delete j[46];var P=Ot(j[4][0].data);{P[7][0].data=Ut(n.e.r+1);var R=Ot(P[1][0].data),L=Zn(R[2][0].data);N=Qe.find(f,c[L].location),C=ki(_i(N.content));{if(C[0].id!=L)throw"Bad HeaderStorageBucket";var te=Ot(C[0].messages[0].data);for(M=0;M<i.length;++M){var ee=Ot(te[2][0].data);ee[1][0].data=Ut(M),ee[4][0].data=Ut(i[M].length),te[2][M]={type:te[2][0].type,data:Pn(ee)}}C[0].messages[0].data=Pn(te)}N.content=Eu(ju(C)),N.size=N.content.length;var ue=Zn(P[2][0].data);N=Qe.find(f,c[ue].location),C=ki(_i(N.content));{if(C[0].id!=ue)throw"Bad HeaderStorageBucket";for(te=Ot(C[0].messages[0].data),A=0;A<=n.e.c;++A)ee=Ot(te[2][0].data),ee[1][0].data=Ut(A),ee[4][0].data=Ut(n.e.r+1),te[2][A]={type:te[2][0].type,data:Pn(ee)};C[0].messages[0].data=Pn(te)}N.content=Eu(ju(C)),N.size=N.content.length;var V=Zn(P[4][0].data);(function(){for(var X=Qe.find(f,c[V].location),q=ki(_i(X.content)),U,G=0;G<q.length;++G){var le=q[G];le.id==V&&(U=le)}var de=Ot(U.messages[0].data);{de[3]=[];var ne=[];s.forEach(function(z,et){ne[1]=[{type:0,data:Ut(et)}],ne[2]=[{type:0,data:Ut(1)}],ne[3]=[{type:2,data:u1e(z)}],de[3].push({type:2,data:Pn(ne)})})}U.messages[0].data=Pn(de);var oe=ju(q),Ae=Eu(oe);X.content=Ae,X.size=X.content.length})();var K=Ot(P[3][0].data);{var ie=K[1][0];delete K[2];var re=Ot(ie.data);{var me=Zn(re[2][0].data);(function(){for(var X=Qe.find(f,c[me].location),q=ki(_i(X.content)),U,G=0;G<q.length;++G){var le=q[G];le.id==me&&(U=le)}var de=Ot(U.messages[0].data);{delete de[6],delete K[7];var ne=new Uint8Array(de[5][0].data);de[5]=[];for(var oe=0,Ae=0;Ae<=n.e.r;++Ae){var z=Ot(ne);oe+=k1e(z,i[Ae],s),z[1][0].data=Ut(Ae),de[5].push({data:Pn(z),type:2})}de[1]=[{type:0,data:Ut(n.e.c+1)}],de[2]=[{type:0,data:Ut(n.e.r+1)}],de[3]=[{type:0,data:Ut(oe)}],de[4]=[{type:0,data:Ut(n.e.r+1)}]}U.messages[0].data=Pn(de);var et=ju(q),Be=Eu(et);X.content=Be,X.size=X.content.length})()}ie.data=Pn(re)}P[3][0].data=Pn(K)}j[4][0].data=Pn(P)}v.messages[0].data=Pn(j);var W=ju(g),F=Eu(W);return p.content=F,p.size=p.content.length,f}function RL(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function Nk(e){RL([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function kk(e){RL([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function j1e(e){return gt.WS.indexOf(e)>-1?"sheet":e==gt.CS?"chart":e==gt.DS?"dialog":e==gt.MS?"macro":e&&e.length?e:"sheet"}function E1e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,j1e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function T1e(e,t,r,n,a,i,s,c,d,f,h,p){try{i[n]=Gf(Za(e,r,!0),t);var g=Xr(e,t),v;switch(c){case"sheet":v=Xve(g,t,a,d,i[n],f,h,p);break;case"chart":if(v=Zve(g,t,a,d,i[n],f,h,p),!v||!v["!drawel"])break;var b=If(v["!drawel"].Target,t),y=N0(b),w=Fme(Za(e,b,!0),Gf(Za(e,y,!0),b)),j=If(w,b),T=N0(j);v=kve(Za(e,j,!0),j,d,Gf(Za(e,T,!0),j),f,v);break;case"macro":v=Qve(g,t,a,d,i[n],f,h,p);break;case"dialog":v=Jve(g,t,a,d,i[n],f,h,p);break;default:throw new Error("Unrecognized sheet type "+c)}s[n]=v;var N=[];i&&i[n]&&Rr(i[n]).forEach(function(C){var E="";if(i[n][C].Type==gt.CMNT){E=If(i[n][C].Target,t);var O=nye(Xr(e,E,!0),E,d);if(!O||!O.length)return;OD(v,O,!1)}i[n][C].Type==gt.TCMNT&&(E=If(i[n][C].Target,t),N=N.concat(Bme(Xr(e,E,!0),d)))}),N&&N.length&&OD(v,N,!0,d.people||[])}catch(C){if(d.WTF)throw C}}function wi(e){return e.charAt(0)=="/"?e.slice(1):e}function C1e(e,t){if(bd(),t=t||{},Nk(t),ji(e,"META-INF/manifest.xml")||ji(e,"objectdata.xml"))return $D(e,t);if(ji(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof n2<"u"){if(e.FileIndex)return n2(e);var r=Qe.utils.cfb_new();return QO(e).forEach(function(ee){ht(r,ee,Uue(e,ee))}),n2(r)}throw new Error("Unsupported NUMBERS file")}if(!ji(e,"[Content_Types].xml"))throw ji(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ji(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=QO(e),a=Ide(Za(e,"[Content_Types].xml")),i=!1,s,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Xr(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Xr(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var d={},f={};if(!t.bookSheets&&!t.bookProps){if(Wf=[],a.sst)try{Wf=rye(Xr(e,wi(a.sst)),a.sst,t)}catch(ee){if(t.WTF)throw ee}t.cellStyles&&a.themes.length&&(d=tye(Za(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=eye(Xr(e,wi(a.style)),a.style,d,t))}a.links.map(function(ee){try{var ue=Gf(Za(e,N0(wi(ee))),ee);return iye(Xr(e,wi(ee)),ue,ee,t)}catch{}});var h=Yve(Xr(e,wi(a.workbooks[0])),a.workbooks[0],t),p={},g="";a.coreprops.length&&(g=Xr(e,wi(a.coreprops[0]),!0),g&&(p=SF(g)),a.extprops.length!==0&&(g=Xr(e,wi(a.extprops[0]),!0),g&&Ude(g,p,t)));var v={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(g=Za(e,wi(a.custprops[0]),!0),g&&(v=$de(g,t)));var b={};if((t.bookSheets||t.bookProps)&&(h.Sheets?s=h.Sheets.map(function(ue){return ue.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),t.bookProps&&(b.Props=p,b.Custprops=v),t.bookSheets&&typeof s<"u"&&(b.SheetNames=s),t.bookSheets?b.SheetNames:t.bookProps))return b;s={};var y={};t.bookDeps&&a.calcchain&&(y=aye(Xr(e,wi(a.calcchain)),a.calcchain));var w=0,j={},T,N;{var C=h.Sheets;p.Worksheets=C.length,p.SheetNames=[];for(var E=0;E!=C.length;++E)p.SheetNames[E]=C[E].name}var O=i?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),D=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");ji(e,D)||(D="xl/_rels/workbook."+O+".rels");var M=Gf(Za(e,D,!0),D.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=sye(Xr(e,wi(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=zme(Xr(e,wi(a.people[0])),t)),M&&(M=E1e(M,h.Sheets));var P=Xr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=p.Worksheets;++w){var R="sheet";if(M&&M[w]?(T="xl/"+M[w][1].replace(/[\/]?xl\//,""),ji(e,T)||(T=M[w][1]),ji(e,T)||(T=D.replace(/_rels\/.*$/,"")+M[w][1]),R=M[w][2]):(T="xl/worksheets/sheet"+(w+1-P)+"."+O,T=T.replace(/sheet0\./,"sheet.")),N=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(p.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,te=0;te!=t.sheets.length;++te)typeof t.sheets[te]=="number"&&t.sheets[te]==w&&(L=1),typeof t.sheets[te]=="string"&&t.sheets[te].toLowerCase()==p.SheetNames[w].toLowerCase()&&(L=1);if(!L)continue e}}T1e(e,T,N,p.SheetNames[w],w,j,s,R,t,h,d,f)}return b={Directory:a,Workbook:h,Props:p,Custprops:v,Deps:y,Sheets:s,SheetNames:p.SheetNames,Strings:Wf,Styles:f,Themes:d,SSF:hr(tt)},t&&t.bookFiles&&(e.files?(b.keys=n,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(ee,ue){ee=ee.replace(/^Root Entry[\/]/,""),b.keys.push(ee),b.files[ee]=e.FileIndex[ue]}))),t&&t.bookVBA&&(a.vba.length>0?b.vbaraw=Xr(e,wi(a.vba[0]),!0):a.defaults&&a.defaults.bin===Yme&&(b.vbaraw=Xr(e,"xl/vbaProject.bin",!0))),b}function A1e(e,t){var r=t||{},n="Workbook",a=Qe.find(e,n);try{if(n="/!DataSpaces/Version",a=Qe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(she(a.content),n="/!DataSpaces/DataSpaceMap",a=Qe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=ohe(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Qe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=che(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Qe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);dhe(a.content)}catch{}if(n="/EncryptionInfo",a=Qe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=fhe(a.content);if(n="/EncryptedPackage",a=Qe.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function O1e(e,t){return t.bookType=="ods"?IL(e,t):t.bookType=="numbers"?_1e(e,t):t.bookType=="xlsb"?D1e(e,t):I1e(e,t)}function D1e(e,t){Pu=1024,e&&!e.SSF&&(e.SSF=hr(tt)),e&&e.SSF&&(bd(),fh(e.SSF),t.revssf=Pg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=lL.indexOf(t.bookType)>-1,a=ck();kk(t=t||{});var i=YN(),s="",c=0;if(t.cellXfs=[],Co(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",ht(i,s,NF(e.Props,t)),a.coreprops.push(s),zt(t.rels,2,s,gt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,ht(i,s,jF(e.Props)),a.extprops.push(s),zt(t.rels,3,s,gt.EXT_PROPS),e.Custprops!==e.Props&&Rr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",ht(i,s,EF(e.Custprops)),a.custprops.push(s),zt(t.rels,4,s,gt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var h={"!id":{}},p=e.Sheets[e.SheetNames[c-1]],g=(p||{})["!type"]||"sheet";if(s="xl/worksheets/sheet"+c+"."+r,ht(i,s,oye(c-1,s,t,e,h)),a.sheets.push(s),zt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,gt.WS[0]),p){var v=p["!comments"],b=!1,y="";v&&v.length>0&&(y="xl/comments"+c+"."+r,ht(i,y,dye(v,y)),a.comments.push(y),zt(h,-1,"../comments"+c+"."+r,gt.CMNT),b=!0),p["!legacy"]&&b&&ht(i,"xl/drawings/vmlDrawing"+c+".vml",iL(c,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&ht(i,N0(s),zu(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,ht(i,s,uye(t.Strings,s,t)),a.strs.push(s),zt(t.wbrels,-1,"sharedStrings."+r,gt.SST)),s="xl/workbook."+r,ht(i,s,lye(e,s)),a.workbooks.push(s),zt(t.rels,1,s,gt.WB),s="xl/theme/theme1.xml",ht(i,s,pk(e.Themes,t)),a.themes.push(s),zt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),s="xl/styles."+r,ht(i,s,cye(e,s,t)),a.styles.push(s),zt(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",ht(i,s,e.vbaraw),a.vba.push(s),zt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),s="xl/metadata."+r,ht(i,s,fye(s)),a.metadata.push(s),zt(t.wbrels,-1,"metadata."+r,gt.XLMETA),ht(i,"[Content_Types].xml",bF(a,t)),ht(i,"_rels/.rels",zu(t.rels)),ht(i,"xl/_rels/workbook."+r+".rels",zu(t.wbrels)),delete t.revssf,delete t.ssf,i}function I1e(e,t){Pu=1024,e&&!e.SSF&&(e.SSF=hr(tt)),e&&e.SSF&&(bd(),fh(e.SSF),t.revssf=Pg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,qf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=lL.indexOf(t.bookType)>-1,a=ck();kk(t=t||{});var i=YN(),s="",c=0;if(t.cellXfs=[],Co(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",ht(i,s,NF(e.Props,t)),a.coreprops.push(s),zt(t.rels,2,s,gt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&d.push(e.SheetNames[f]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,ht(i,s,jF(e.Props)),a.extprops.push(s),zt(t.rels,3,s,gt.EXT_PROPS),e.Custprops!==e.Props&&Rr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",ht(i,s,EF(e.Custprops)),a.custprops.push(s),zt(t.rels,4,s,gt.CUST_PROPS));var h=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var p={"!id":{}},g=e.Sheets[e.SheetNames[c-1]],v=(g||{})["!type"]||"sheet";if(s="xl/worksheets/sheet"+c+"."+r,ht(i,s,vL(c-1,t,e,p)),a.sheets.push(s),zt(t.wbrels,-1,"worksheets/sheet"+c+"."+r,gt.WS[0]),g){var b=g["!comments"],y=!1,w="";if(b&&b.length>0){var j=!1;b.forEach(function(T){T[1].forEach(function(N){N.T==!0&&(j=!0)})}),j&&(w="xl/threadedComments/threadedComment"+c+"."+r,ht(i,w,Ume(b,h,t)),a.threadedcomments.push(w),zt(p,-1,"../threadedComments/threadedComment"+c+"."+r,gt.TCMNT)),w="xl/comments"+c+"."+r,ht(i,w,sL(b)),a.comments.push(w),zt(p,-1,"../comments"+c+"."+r,gt.CMNT),y=!0}g["!legacy"]&&y&&ht(i,"xl/drawings/vmlDrawing"+c+".vml",iL(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&ht(i,N0(s),zu(p))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,ht(i,s,qF(t.Strings,t)),a.strs.push(s),zt(t.wbrels,-1,"sharedStrings."+r,gt.SST)),s="xl/workbook."+r,ht(i,s,NL(e)),a.workbooks.push(s),zt(t.rels,1,s,gt.WB),s="xl/theme/theme1.xml",ht(i,s,pk(e.Themes,t)),a.themes.push(s),zt(t.wbrels,-1,"theme/theme1.xml",gt.THEME),s="xl/styles."+r,ht(i,s,tL(e,t)),a.styles.push(s),zt(t.wbrels,-1,"styles."+r,gt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",ht(i,s,e.vbaraw),a.vba.push(s),zt(t.wbrels,-1,"vbaProject.bin",gt.VBA)),s="xl/metadata."+r,ht(i,s,aL()),a.metadata.push(s),zt(t.wbrels,-1,"metadata."+r,gt.XLMETA),h.length>1&&(s="xl/persons/person.xml",ht(i,s,$me(h)),a.people.push(s),zt(t.wbrels,-1,"persons/person.xml",gt.PEOPLE)),ht(i,"[Content_Types].xml",bF(a,t)),ht(i,"_rels/.rels",zu(t.rels)),ht(i,"xl/_rels/workbook."+r+".rels",zu(t.wbrels)),delete t.revssf,delete t.ssf,i}function _k(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ai(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function R1e(e,t){return Qe.find(e,"EncryptedPackage")?A1e(e,t):EL(e,t)}function M1e(e,t){var r,n=e,a=t||{};return a.type||(a.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Y8(n,a),C1e(r,a)}function ML(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Rw(e.slice(r),t);default:break e}return rd.to_workbook(e,t)}function P1e(e,t){var r="",n=_k(e,t);switch(t.type){case"base64":r=ai(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=kc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Yt(r)),t.type="binary",ML(r,t)}function F1e(e,t){var r=e;return t.type=="base64"&&(r=ai(r)),r=g0.utils.decode(1200,r.slice(2),"str"),t.type="binary",ML(r,t)}function L1e(e){return e.match(/[^\x00-\x7F]/)?xs(e):e}function a2(e,t,r,n){return n?(r.type="string",rd.to_workbook(e,r)):rd.to_workbook(t,r)}function Ax(e,t){VN();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ax(new Uint8Array(e),(r=hr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Hu={},r.dateNF&&(Hu.dateNF=r.dateNF),r.type||(r.type=xt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=xt?"buffer":"binary",n=Due(e),typeof Uint8Array<"u"&&!xt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=L1e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),c=new Uint8Array(s);if(c.foo="bar",!c.foo)return r=hr(r),r.type="array",Ax(GN(n),r)}switch((a=_k(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return R1e(Qe.read(n,r),r);break;case 9:if(a[1]<=8)return EL(n,r);break;case 60:return Rw(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return H0e(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return GF.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?M1e(n,r):a2(e,n,r,i);case 239:return a[3]===60?Rw(n,r):a2(e,n,r,i);case 255:if(a[1]===254)return F1e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return fc.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return fc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Iw.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return QF.to_workbook(n,r);break;case 10:case 13:case 32:return P1e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return $0e.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Iw.to_workbook(n,r):a2(e,n,r,i)}function PL(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return hh(t.file,Qe.write(e,{type:xt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Qe.write(e,t)}function B1e(e,t){var r=hr(t||{}),n=O1e(e,r);return U1e(n,r)}function U1e(e,t){var r={},n=xt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Qe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Rg(a))}return t.password&&typeof encrypt_agile<"u"?PL(encrypt_agile(a,t.password),t):t.type==="file"?hh(t.file,a):t.type=="string"?Yt(a):a}function z1e(e,t){var r=t||{},n=Lye(e,r);return PL(n,r)}function ms(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return v0(xs(n));case"binary":return xs(n);case"string":return e;case"file":return hh(t.file,n,"utf8");case"buffer":return xt?kl(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ms(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $1e(e,t){switch(t.type){case"base64":return v0(e);case"binary":return e;case"string":return e;case"file":return hh(t.file,e,"binary");case"buffer":return xt?kl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function lp(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?v0(r):t.type=="string"?Yt(r):r;case"file":return hh(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function FL(e,t){VN(),Rve(e);var r=hr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=FL(e,r);return r.type="array",Rg(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ms(Oye(e,r),r);case"slk":case"sylk":return ms(VF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ms(CL(e.Sheets[e.SheetNames[a]],r),r);case"txt":return $1e(LL(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ms(Ek(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ms(GF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return lp(Iw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ms(rd.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ms(QF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ms(WF.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ms(IL(e,r),r);case"wk1":return lp(fc.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return lp(fc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),lp(TL(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),z1e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return B1e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function H1e(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function jk(e,t,r){var n={};return n.type="file",n.file=t,H1e(n),FL(e,n)}function V1e(e,t,r,n,a,i,s,c){var d=$r(r),f=c.defval,h=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),p=!0,g=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!s||e[r])for(var v=t.s.c;v<=t.e.c;++v){var b=s?e[r][v]:e[n[v]+d];if(b===void 0||b.t===void 0){if(f===void 0)continue;i[v]!=null&&(g[i[v]]=f);continue}var y=b.v;switch(b.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(i[v]!=null){if(y==null)if(b.t=="e"&&y===null)g[i[v]]=null;else if(f!==void 0)g[i[v]]=f;else if(h&&y===null)g[i[v]]=null;else continue;else g[i[v]]=h&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?y:pl(b,y,c);y!=null&&(p=!1)}}return{row:g,isempty:p}}function Ox(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,c="",d={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},h=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof h){case"string":d=Et(h);break;case"number":d=Et(e["!ref"]),d.s.r=h;break;default:d=h}n>0&&(a=0);var p=$r(d.s.r),g=[],v=[],b=0,y=0,w=Array.isArray(e),j=d.s.r,T=0,N={};w&&!e[j]&&(e[j]=[]);var C=f.skipHidden&&e["!cols"]||[],E=f.skipHidden&&e["!rows"]||[];for(T=d.s.c;T<=d.e.c;++T)if(!(C[T]||{}).hidden)switch(g[T]=Nr(T),r=w?e[j][T]:e[g[T]+p],n){case 1:i[T]=T-d.s.c;break;case 2:i[T]=g[T];break;case 3:i[T]=f.header[T-d.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=s=pl(r,null,f),y=N[s]||0,!y)N[s]=1;else{do c=s+"_"+y++;while(N[c]);N[s]=y,N[c]=1}i[T]=c}for(j=d.s.r+a;j<=d.e.r;++j)if(!(E[j]||{}).hidden){var O=V1e(e,d,j,g,n,i,w,f);(O.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(v[b++]=O.row)}return v.length=b,v}var qD=/"/g;function G1e(e,t,r,n,a,i,s,c){for(var d=!0,f=[],h="",p=$r(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var v=c.dense?(e[r]||[])[g]:e[n[g]+p];if(v==null)h="";else if(v.v!=null){d=!1,h=""+(c.rawNumbers&&v.t=="n"?v.v:pl(v,null,c));for(var b=0,y=0;b!==h.length;++b)if((y=h.charCodeAt(b))===a||y===i||y===34||c.forceQuotes){h='"'+h.replace(qD,'""')+'"';break}h=="ID"&&(h='"ID"')}else v.f!=null&&!v.F?(d=!1,h="="+v.f,h.indexOf(",")>=0&&(h='"'+h.replace(qD,'""')+'"')):h="";f.push(h)}return c.blankrows===!1&&d?null:f.join(s)}function Ek(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Et(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,d=c.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),h="",p=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],v=n.skipHidden&&e["!rows"]||[],b=a.s.c;b<=a.e.c;++b)(g[b]||{}).hidden||(p[b]=Nr(b));for(var y=0,w=a.s.r;w<=a.e.r;++w)(v[w]||{}).hidden||(h=G1e(e,a,w,p,s,d,i,n),h!=null&&(n.strip&&(h=h.replace(f,"")),(h||n.blankrows!==!1)&&r.push((y++?c:"")+h)));return delete n.dense,r.join("")}function LL(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Ek(e,t);return r}function W1e(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Et(e["!ref"]),i="",s=[],c,d=[],f=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)s[c]=Nr(c);for(var h=a.s.r;h<=a.e.r;++h)for(i=$r(h),c=a.s.c;c<=a.e.c;++c)if(t=s[c]+i,r=f?(e[h]||[])[c]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}d[d.length]=t+"="+n}return d}function BL(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var d=typeof n.origin=="string"?kr(n.origin):n.origin;s=d.r,c=d.c}var f,h={s:{c:0,r:0},e:{c,r:s+t.length-1+a}};if(i["!ref"]){var p=Et(i["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),s==-1&&(s=p.e.r+1,h.e.r=s+t.length-1+a)}else s==-1&&(s=0,h.e.r=t.length-1+a);var g=n.header||[],v=0;t.forEach(function(y,w){Rr(y).forEach(function(j){(v=g.indexOf(j))==-1&&(g[v=g.length]=j);var T=y[j],N="z",C="",E=nt({c:c+v,r:s+w+a});f=A0(i,E),T&&typeof T=="object"&&!(T instanceof Date)?i[E]=T:(typeof T=="number"?N="n":typeof T=="boolean"?N="b":typeof T=="string"?N="s":T instanceof Date?(N="d",n.cellDates||(N="n",T=on(T)),C=n.dateNF||tt[14]):T===null&&n.nullError&&(N="e",T=0),f?(f.t=N,f.v=T,delete f.w,delete f.R,C&&(f.z=C)):i[E]=f={t:N,v:T},C&&(f.z=C))})}),h.e.c=Math.max(h.e.c,c+g.length-1);var b=$r(s);if(a)for(v=0;v<g.length;++v)i[Nr(v+c)+b]={t:"s",v:g[v]};return i["!ref"]=dt(h),i}function q1e(e,t){return BL(null,e,t)}function A0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=kr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?A0(e,nt(t)):A0(e,nt({r:t,c:r||0}))}function K1e(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Tk(){return{SheetNames:[],Sheets:{}}}function Ck(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(SL(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Y1e(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=K1e(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function X1e(e,t){return e.z=t,e}function UL(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Z1e(e,t,r){return UL(e,"#"+t,r)}function Q1e(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function J1e(e,t,r,n){for(var a=typeof t!="string"?t:Et(t),i=typeof t=="string"?t:dt(t),s=a.s.r;s<=a.e.r;++s)for(var c=a.s.c;c<=a.e.c;++c){var d=A0(e,s,c);d.t="n",d.F=i,delete d.v,s==a.s.r&&c==a.s.c&&(d.f=r,n&&(d.D=!0))}return e}var Ye={encode_col:Nr,encode_row:$r,encode_cell:nt,encode_range:dt,decode_col:nk,decode_row:rk,split_cell:ude,decode_cell:kr,decode_range:Ia,format_cell:pl,sheet_add_aoa:hF,sheet_add_json:BL,sheet_add_dom:AL,aoa_to_sheet:wd,json_to_sheet:q1e,table_to_sheet:OL,table_to_book:s1e,sheet_to_csv:Ek,sheet_to_txt:LL,sheet_to_json:Ox,sheet_to_html:CL,sheet_to_formulae:W1e,sheet_to_row_object_array:Ox,sheet_get_cell:A0,book_new:Tk,book_append_sheet:Ck,book_set_sheet_visibility:Y1e,cell_set_number_format:X1e,cell_set_hyperlink:UL,cell_set_internal_link:Z1e,cell_add_comment:Q1e,sheet_set_array_formula:J1e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Jt=(e,t)=>{e["!cols"]=t.map(r=>({wch:r}))},ebe=e=>{const t=Ye.book_new(),r=Object.keys(Un),n=Object.keys(Hi),a=["Not Started","In Progress","On Hold","Completed","Cancelled"],i=["GREEN","AMBER","RED"],s=["To Do","In Progress","Blocked","Done"],c=["Low","Medium","High","Critical"],d=["Pending","Completed","Missed"],f=["%","$","score","number"],h=["Yes","No"],p=Math.max(e.pillars.length,e.initiatives.length,e.resources.length,e.projects.length,e.tasks.length,r.length,n.length,a.length,i.length,s.length,c.length,d.length,f.length),g=[["Pillars","Initiatives","Resources","Projects","Tasks","Departments","Categories","ProjectStatus","RAGStatus","TaskStatus","Priority","MilestoneStatus","KPIUnit","YesNo"],...Array.from({length:p}).map((fe,Re)=>[e.pillars[Re]?.name||"",e.initiatives[Re]?.name||"",e.resources[Re]?.name||"",e.projects[Re]?.name||"",e.tasks[Re]?.title||"",r[Re]||"",n[Re]||"",a[Re]||"",i[Re]||"",s[Re]||"",c[Re]||"",d[Re]||"",f[Re]||"",h[Re]||""])],v=Ye.aoa_to_sheet(g);Jt(v,[25,30,25,30,35,15,15,15,10,15,10,15,10,8]),Ye.book_append_sheet(t,v,"_Lookups");const b=[["StratOS AI - Strategic Portfolio Management"],["Comprehensive Data Import/Export Template v3.0"],[""],["=== HOW TO USE THIS TEMPLATE ==="],[""],["This template allows you to import/export ALL data entities in StratOS AI."],["Each entity has a Reference sheet (read-only) and an Input sheet (for new data)."],[""],["=== SHEET OVERVIEW ==="],[""],["REFERENCE SHEETS (Read-only - shows current data):"],["  1. Pillars (Ref)      - BSC Strategy Pillars"],["  2. KPIs (Ref)         - Strategic KPIs for each pillar"],["  3. Initiatives (Ref)  - Programs/portfolios"],["  4. Resources (Ref)    - Team members"],["  5. Projects (Ref)     - Existing projects"],["  6. Tasks (Ref)        - Existing tasks with WBS structure"],["  7. Milestones (Ref)   - Project milestones"],[""],["INPUT SHEETS (Fill these to add new data):"],["  A. Pillars (Input)    - Add new strategy pillars"],["  B. KPIs (Input)       - Add new KPIs"],["  C. Initiatives (Input)- Add new initiatives"],["  D. Resources (Input)  - Add new team members"],["  E. Projects (Input)   - Add new projects"],["  F. Tasks (Input)      - Add new tasks (supports WBS hierarchy)"],["  G. Milestones (Input) - Add project milestones"],[""],["=== WORK ID FORMAT ==="],["Format: [DEPT]-[YY]-[CATEGORY]-[SEQ]"],["Example: IT-25-GROW-001"],[""],["Departments: FIN, MKT, OPS, IT, HR, SAL, PRD, ENG, LEG, ADM"],["Categories: RUN (Operations), GROW (Expansion), TRNS (Transform)"],[""],["=== WBS (WORK BREAKDOWN STRUCTURE) ==="],["Tasks can be organized hierarchically using Parent Task field."],["WBS codes are auto-generated (e.g., 1.2.3) based on hierarchy."],["Tasks can have dependencies on other tasks."],[""],["=== FIELD MARKERS ==="],["* = Required field"],["(dropdown) = Use dropdown list for valid values"],[""],["=== IMPORTANT NOTES ==="],["- Use dropdown lists when available to ensure data integrity"],["- Dates should be in YYYY-MM-DD format (e.g., 2025-06-15)"],["- Delete example rows before importing"],["- Duplicate entries (same name) will be skipped"],[""],["Generated: "+new Date().toLocaleString()],["Version: 3.0 - Full Entity Support with WBS"]],y=Ye.aoa_to_sheet(b);Jt(y,[90]),Ye.book_append_sheet(t,y,"0. Instructions");const w=[["#","ID","Pillar Name","Description","RAG Status","Display Order"],...e.pillars.map((fe,Re)=>[Re+1,fe.id,fe.name,fe.description,fe.ragStatus.toUpperCase(),fe.displayOrder])],j=Ye.aoa_to_sheet(w);Jt(j,[5,40,30,50,12,12]),Ye.book_append_sheet(t,j,"1. Pillars (Ref)");const T=[["#","ID","KPI Name","Linked Pillar","Target Value","Current Value","Previous Value","Unit","Last Updated"],...e.kpis.map((fe,Re)=>{const bt=e.pillars.find(Ft=>Ft.id===fe.pillarId);return[Re+1,fe.id,fe.name,bt?.name||"",fe.targetValue,fe.currentValue,fe.previousValue,fe.unit,fe.lastUpdated]})],N=Ye.aoa_to_sheet(T);Jt(N,[5,40,30,25,12,12,12,10,12]),Ye.book_append_sheet(t,N,"2. KPIs (Ref)");const C=[["#","ID","Initiative Name","Linked Pillar","Description","Owner","Start Date","End Date","Budget ($)","Spent ($)","RAG Status","Linked KPIs"],...e.initiatives.map((fe,Re)=>{const bt=e.pillars.find(sr=>sr.id===fe.pillarId),Ft=e.resources.find(sr=>sr.id===fe.ownerId),mt=fe.linkedKpiIds?.map(sr=>e.kpis.find(It=>It.id===sr)?.name).filter(Boolean).join("; ")||"";return[Re+1,fe.id,fe.name,bt?.name||"",fe.description,Ft?.name||"",fe.startDate,fe.endDate,fe.budget,fe.spentBudget,fe.ragStatus.toUpperCase(),mt]})],E=Ye.aoa_to_sheet(C);Jt(E,[5,40,35,25,40,20,12,12,12,12,12,30]),Ye.book_append_sheet(t,E,"3. Initiatives (Ref)");const O=[["#","ID","Resource Name","Email","Role","Team","Department","Weekly Capacity (hrs)","Hourly Rate ($)","Avatar Color"],...e.resources.map((fe,Re)=>{const bt=Un[fe.departmentCode];return[Re+1,fe.id,fe.name,fe.email,fe.role,fe.team,`${fe.departmentCode} - ${bt?.name||""}`,fe.weeklyCapacity,fe.hourlyRate||75,fe.avatarColor]})],A=Ye.aoa_to_sheet(O);Jt(A,[5,40,25,30,25,20,25,18,15,12]),Ye.book_append_sheet(t,A,"4. Resources (Ref)");const D=[["#","ID","Work ID","Project Name","Initiative","Description","Department","Category","Fiscal Year","Seq #","Manager","Status","RAG","Start Date","End Date","Budget ($)","Spent ($)","Completion %"],...e.projects.map((fe,Re)=>{const bt=e.initiatives.find(It=>It.id===fe.initiativeId),Ft=e.resources.find(It=>It.id===fe.managerId),mt=Un[fe.departmentCode],sr=Hi[fe.category];return[Re+1,fe.id,fe.workId,fe.name,bt?.name||"",fe.description,`${fe.departmentCode} - ${mt?.name||""}`,`${fe.category} - ${sr?.name||""}`,fe.fiscalYear,fe.sequenceNumber,Ft?.name||"",fe.status.replace("_"," ").replace(/\b\w/g,It=>It.toUpperCase()),fe.ragStatus.toUpperCase(),fe.startDate,fe.endDate,fe.budget,fe.spentBudget,fe.completionPercentage]})],M=Ye.aoa_to_sheet(D);Jt(M,[5,40,18,30,25,40,22,20,10,8,20,15,8,12,12,12,12,12]),Ye.book_append_sheet(t,M,"5. Projects (Ref)");const P=[["#","ID","WBS Code","Task Title","Project","Parent Task","Description","Assignee","Department","Status","Priority","Is Milestone","Start Date","Due Date","Est. Hours","Actual Hours","Planned Hours","Deliverable","Dependencies","Sort Order"],...e.tasks.map((fe,Re)=>{const bt=e.projects.find(It=>It.id===fe.projectId),Ft=fe.parentTaskId?e.tasks.find(It=>It.id===fe.parentTaskId):null,mt=e.resources.find(It=>It.id===fe.assigneeId),sr=fe.dependsOn?.map(It=>e.tasks.find(Tn=>Tn.id===It)?.title).filter(Boolean).join("; ")||"";return[Re+1,fe.id,fe.wbsCode||"",fe.title,bt?.name||"",Ft?.title||"",fe.description,mt?.name||"",fe.departmentCode||"",fe.kanbanStatus.replace("_"," ").replace(/\b\w/g,It=>It.toUpperCase()),fe.priority||"Medium",fe.isMilestone?"Yes":"No",fe.startDate||"",fe.dueDate,fe.estimatedHours,fe.actualHours,fe.plannedHours||"",fe.deliverable||"",sr,fe.sortOrder??""]})],R=Ye.aoa_to_sheet(P);Jt(R,[5,40,10,35,25,25,40,20,10,12,10,12,12,12,10,10,10,30,30,8]),Ye.book_append_sheet(t,R,"6. Tasks (Ref)");const L=[["#","ID","Milestone Name","Project","Description","Target Date","Completed Date","Status","Linked Tasks","Display Order"],...(e.milestones||[]).map((fe,Re)=>{const bt=e.projects.find(mt=>mt.id===fe.projectId),Ft=fe.linkedTaskIds?.map(mt=>e.tasks.find(sr=>sr.id===mt)?.title).filter(Boolean).join("; ")||"";return[Re+1,fe.id,fe.name,bt?.name||"",fe.description||"",fe.targetDate,fe.completedDate||"",fe.status.charAt(0).toUpperCase()+fe.status.slice(1),Ft,fe.displayOrder]})],te=Ye.aoa_to_sheet(L);Jt(te,[5,40,30,25,40,12,12,12,40,12]),Ye.book_append_sheet(t,te,"7. Milestones (Ref)");const ue=[["Pillar Name *","Description *","RAG Status (dropdown)","Display Order"],["Example: Innovation & Technology","Drive digital transformation and technological advancement","GREEN","5"],["(Delete this example row)","","",""],...Array(10).fill(["","","",""])],V=Ye.aoa_to_sheet(ue);Jt(V,[35,50,20,15]),Ye.book_append_sheet(t,V,"A. Pillars (Input)");const ie=[["KPI Name *","Linked Pillar * (dropdown)","Target Value *","Current Value","Previous Value","Unit (dropdown)"],["Customer Satisfaction Score","Customer","95","88","85","score"],["(Delete this example row)","","","","",""],...Array(20).fill(["","","","","",""])],re=Ye.aoa_to_sheet(ie);Jt(re,[35,25,15,15,15,12]),Ye.book_append_sheet(t,re,"B. KPIs (Input)");const W=[["Initiative Name *","Linked Pillar * (dropdown)","Description","Owner (dropdown)","Start Date","End Date","Budget ($)","RAG Status (dropdown)","Linked KPIs (semicolon-separated)"],["Digital Transformation Program","Internal Processes","Transform core business processes through technology","John Smith","2025-01-01","2025-12-31","500000","GREEN","Process Efficiency; Customer Satisfaction Score"],["(Delete this example row)","","","","","","","",""],...Array(15).fill(["","","","","","","","",""])],F=Ye.aoa_to_sheet(W);Jt(F,[35,25,40,20,12,12,12,15,35]),Ye.book_append_sheet(t,F,"C. Initiatives (Input)");const q=[["Name *","Email *","Role *","Team","Department * (dropdown)","Weekly Capacity (hrs)","Hourly Rate ($)"],["Jane Doe","jane.doe@company.com","Senior Developer","Engineering","ENG","40","85"],["(Delete this example row)","","","","","",""],...Array(20).fill(["","","","","","",""])],U=Ye.aoa_to_sheet(q);Jt(U,[25,30,25,20,15,18,15]),Ye.book_append_sheet(t,U,"D. Resources (Input)");const le=[["Project Name *","Initiative * (dropdown)","Description","Project Manager (dropdown)","Department * (dropdown)","Category * (dropdown)","Fiscal Year","Start Date","End Date","Budget ($)","Status (dropdown)","RAG Status (dropdown)"],["Data Migration Project","Digital Transformation Program","Migrate legacy data to new platform","John Smith","IT","TRNS","2025","2025-01-15","2025-06-30","50000","Not Started","GREEN"],["(Delete this example row)","","","","","","","","","","",""],...Array(25).fill(["","","","","","","","","","","",""])],de=Ye.aoa_to_sheet(le);Jt(de,[35,30,40,20,12,12,10,12,12,12,15,12]),Ye.book_append_sheet(t,de,"E. Projects (Input)");const oe=[["Task Title *","Project * (dropdown)","Parent Task (dropdown)","Description","Assignee (dropdown)","Department (dropdown)","Status (dropdown)","Priority (dropdown)","Is Milestone (dropdown)","Start Date","Due Date","Estimated Hours","Planned Hours","Deliverable","Dependencies (semicolon-separated task titles)"],["Set up development environment","Data Migration Project","","Install required tools and configure access","John Smith","IT","To Do","High","No","2025-01-15","2025-02-01","8","8","Development environment ready",""],["Database schema design","Data Migration Project","","Design new database schema","Jane Doe","ENG","To Do","Critical","Yes","2025-01-20","2025-02-15","40","40","Database schema document","Set up development environment"],["Data extraction scripts","Data Migration Project","Database schema design","Write scripts to extract data from legacy system","John Smith","IT","To Do","High","No","2025-02-15","2025-03-01","24","24","Extraction scripts","Database schema design"],["(Delete example rows above)","","","","","","","","","","","","","",""],...Array(50).fill(["","","","","","","","","","","","","","",""])],Ae=Ye.aoa_to_sheet(oe);Jt(Ae,[35,25,25,40,20,12,15,10,12,12,12,12,12,30,35]),Ye.book_append_sheet(t,Ae,"F. Tasks (Input)");const et=[["Milestone Name *","Project * (dropdown)","Description","Target Date *","Status (dropdown)","Linked Tasks (semicolon-separated task titles)","Display Order"],["Phase 1 Complete","Data Migration Project","All Phase 1 deliverables completed and signed off","2025-03-31","Pending","Database schema design; Data extraction scripts","1"],["Go Live","Data Migration Project","System goes live in production","2025-06-30","Pending","","2"],["(Delete example rows above)","","","","","",""],...Array(20).fill(["","","","","","",""])],Be=Ye.aoa_to_sheet(et);Jt(Be,[30,25,40,12,12,40,12]),Ye.book_append_sheet(t,Be,"G. Milestones (Input)");const Je=[["DEPARTMENT CODES","","","PROJECT CATEGORIES","",""],["Code","Name","","Code","Name","Description"],...Array.from({length:Math.max(r.length,n.length)}).map((fe,Re)=>{const bt=r[Re],Ft=n[Re];return[bt||"",bt?Un[bt].name:"","",Ft||"",Ft?Hi[Ft].name:"",Ft?Hi[Ft].description:""]}),[""],["STATUS OPTIONS","","","PRIORITY LEVELS","",""],["Project Status","Task Status","","Code","Description",""],["Not Started","To Do","","Low","Low priority - can be deferred",""],["In Progress","In Progress","","Medium","Normal priority",""],["On Hold","Blocked","","High","High priority - needs attention",""],["Completed","Done","","Critical","Critical - immediate attention required",""],["Cancelled","","","","",""],[""],["RAG STATUS","","","KPI UNITS","",""],["Code","Meaning","","Code","Description",""],["GREEN","On track","","%","Percentage",""],["AMBER","At risk","","$","Currency (dollars)",""],["RED","Off track","","score","Score/rating",""],["","","","number","Numeric count",""]],He=Ye.aoa_to_sheet(Je);Jt(He,[15,25,5,15,20,45]),Ye.book_append_sheet(t,He,"Z. Codes Reference");const Ie=[["StratOS AI - Portfolio Summary"],[""],["CURRENT STATE OVERVIEW"],[""],["Entity","Count","Details"],["Strategy Pillars",e.pillars.length,e.pillars.map(fe=>fe.name).join(", ")],["KPIs",e.kpis.length,`Avg Achievement: ${e.kpis.length>0?Math.round(e.kpis.reduce((fe,Re)=>fe+Re.currentValue/Re.targetValue*100,0)/e.kpis.length):0}%`],["Initiatives",e.initiatives.length,`Green: ${e.initiatives.filter(fe=>fe.ragStatus==="green").length}, Amber: ${e.initiatives.filter(fe=>fe.ragStatus==="amber").length}, Red: ${e.initiatives.filter(fe=>fe.ragStatus==="red").length}`],["Projects",e.projects.length,`Green: ${e.projects.filter(fe=>fe.ragStatus==="green").length}, Amber: ${e.projects.filter(fe=>fe.ragStatus==="amber").length}, Red: ${e.projects.filter(fe=>fe.ragStatus==="red").length}`],["Tasks",e.tasks.length,`Todo: ${e.tasks.filter(fe=>fe.kanbanStatus==="todo").length}, In Progress: ${e.tasks.filter(fe=>fe.kanbanStatus==="in_progress").length}, Blocked: ${e.tasks.filter(fe=>fe.kanbanStatus==="blocked").length}, Done: ${e.tasks.filter(fe=>fe.kanbanStatus==="done").length}`],["Milestones",(e.milestones||[]).length,`Pending: ${(e.milestones||[]).filter(fe=>fe.status==="pending").length}, Completed: ${(e.milestones||[]).filter(fe=>fe.status==="completed").length}`],["Resources",e.resources.length,[...new Set(e.resources.map(fe=>fe.departmentCode))].join(", ")],[""],["BUDGET SUMMARY"],[""],["Level","Total Budget","Total Spent","Variance","Utilization %"],["Initiatives",e.initiatives.reduce((fe,Re)=>fe+Re.budget,0),e.initiatives.reduce((fe,Re)=>fe+Re.spentBudget,0),e.initiatives.reduce((fe,Re)=>fe+(Re.spentBudget-Re.budget),0),e.initiatives.length>0?`${Math.round(e.initiatives.reduce((fe,Re)=>fe+Re.spentBudget,0)/e.initiatives.reduce((fe,Re)=>fe+Re.budget,0)*100)}%`:"0%"],["Projects",e.projects.reduce((fe,Re)=>fe+Re.budget,0),e.projects.reduce((fe,Re)=>fe+Re.spentBudget,0),e.projects.reduce((fe,Re)=>fe+(Re.spentBudget-Re.budget),0),e.projects.length>0?`${Math.round(e.projects.reduce((fe,Re)=>fe+Re.spentBudget,0)/e.projects.reduce((fe,Re)=>fe+Re.budget,0)*100)}%`:"0%"],[""],["HOURS SUMMARY"],[""],["Metric","Value"],["Total Estimated Hours",e.tasks.reduce((fe,Re)=>fe+(Re.estimatedHours||0),0)],["Total Actual Hours",e.tasks.reduce((fe,Re)=>fe+(Re.actualHours||0),0)],["Total Planned Hours",e.tasks.reduce((fe,Re)=>fe+(Re.plannedHours||0),0)],["Total Weekly Capacity",e.resources.reduce((fe,Re)=>fe+Re.weeklyCapacity,0)],[""],["PROJECTS BY DEPARTMENT"],[""],...r.map(fe=>{const Re=e.projects.filter(bt=>bt.departmentCode===fe);return[Un[fe].name,Re.length,Re.map(bt=>bt.workId).join(", ")]}),[""],["PROJECTS BY CATEGORY"],[""],...n.map(fe=>{const Re=e.projects.filter(bt=>bt.category===fe);return[Hi[fe].name,Re.length,Re.map(bt=>bt.workId).join(", ")]})],_t=Ye.aoa_to_sheet(Ie);Jt(_t,[25,15,15,15,40]),Ye.book_append_sheet(t,_t,"Summary Dashboard");const Er=`StratOS_AI_Template_${new Date().toISOString().split("T")[0]}.xlsx`;jk(t,Er)},tbe=e=>{const t=Ye.book_new(),r=e.pillars.map(N=>({ID:N.id,Name:N.name,Description:N.description,"Display Order":N.displayOrder,"RAG Status":N.ragStatus})),n=Ye.json_to_sheet(r);Jt(n,[40,30,50,12,12]),Ye.book_append_sheet(t,n,"Pillars");const a=e.kpis.map(N=>{const C=e.pillars.find(E=>E.id===N.pillarId);return{ID:N.id,Pillar:C?.name||"","Pillar ID":N.pillarId,Name:N.name,"Target Value":N.targetValue,"Current Value":N.currentValue,"Previous Value":N.previousValue,Unit:N.unit,"Last Updated":N.lastUpdated}}),i=Ye.json_to_sheet(a);Jt(i,[40,25,40,30,12,12,12,10,12]),Ye.book_append_sheet(t,i,"KPIs");const s=e.initiatives.map(N=>{const C=e.pillars.find(O=>O.id===N.pillarId),E=e.resources.find(O=>O.id===N.ownerId);return{ID:N.id,Pillar:C?.name||"","Pillar ID":N.pillarId,Name:N.name,Description:N.description,Owner:E?.name||"","Owner ID":N.ownerId,"Start Date":N.startDate,"End Date":N.endDate,Budget:N.budget,"Spent Budget":N.spentBudget,"RAG Status":N.ragStatus,"Linked KPI IDs":N.linkedKpiIds?.join("; ")||""}}),c=Ye.json_to_sheet(s);Jt(c,[40,25,40,30,50,20,40,12,12,12,12,10,40]),Ye.book_append_sheet(t,c,"Initiatives");const d=e.projects.map(N=>{const C=e.initiatives.find(O=>O.id===N.initiativeId),E=e.resources.find(O=>O.id===N.managerId);return{ID:N.id,"Work ID":N.workId,Initiative:C?.name||"","Initiative ID":N.initiativeId,Name:N.name,Description:N.description,Manager:E?.name||"","Manager ID":N.managerId,Department:N.departmentCode,Category:N.category,"Fiscal Year":N.fiscalYear,"Sequence #":N.sequenceNumber,Status:N.status,"RAG Status":N.ragStatus,"Start Date":N.startDate,"End Date":N.endDate,Budget:N.budget,"Spent Budget":N.spentBudget,"Completion %":N.completionPercentage}}),f=Ye.json_to_sheet(d);Jt(f,[40,18,25,40,30,40,20,40,10,10,10,10,15,10,12,12,12,12,12]),Ye.book_append_sheet(t,f,"Projects");const h=e.tasks.map(N=>{const C=e.projects.find(A=>A.id===N.projectId),E=e.resources.find(A=>A.id===N.assigneeId),O=N.parentTaskId?e.tasks.find(A=>A.id===N.parentTaskId):null;return{ID:N.id,Project:C?.name||"","Project ID":N.projectId,"Project Work ID":C?.workId||"","WBS Code":N.wbsCode||"",Title:N.title,Description:N.description,"Parent Task":O?.title||"","Parent Task ID":N.parentTaskId||"",Assignee:E?.name||"","Assignee ID":N.assigneeId,Department:N.departmentCode||"",Status:N.kanbanStatus,Priority:N.priority||"medium","Is Milestone":N.isMilestone?"Yes":"No","Start Date":N.startDate||"","Due Date":N.dueDate,"Estimated Hours":N.estimatedHours,"Actual Hours":N.actualHours,"Planned Hours":N.plannedHours||"",Deliverable:N.deliverable||"",Dependencies:N.dependsOn?.join("; ")||"","Sort Order":N.sortOrder??""}}),p=Ye.json_to_sheet(h);Jt(p,[40,25,40,18,10,35,50,25,40,20,40,10,12,10,12,12,12,12,12,12,30,40,8]),Ye.book_append_sheet(t,p,"Tasks");const g=(e.milestones||[]).map(N=>{const C=e.projects.find(E=>E.id===N.projectId);return{ID:N.id,Project:C?.name||"","Project ID":N.projectId,Name:N.name,Description:N.description||"","Target Date":N.targetDate,"Completed Date":N.completedDate||"",Status:N.status,"Linked Task IDs":N.linkedTaskIds?.join("; ")||"","Display Order":N.displayOrder}}),v=Ye.json_to_sheet(g);Jt(v,[40,25,40,30,40,12,12,12,50,12]),Ye.book_append_sheet(t,v,"Milestones");const b=e.resources.map(N=>({ID:N.id,Name:N.name,Email:N.email,Role:N.role,Team:N.team,Department:N.departmentCode,"Weekly Capacity":N.weeklyCapacity,"Hourly Rate":N.hourlyRate||75,"Avatar Color":N.avatarColor})),y=Ye.json_to_sheet(b);Jt(y,[40,25,30,25,20,10,15,12,12]),Ye.book_append_sheet(t,y,"Resources");const w=[["StratOS AI - Full Data Export"],[""],["Export Date:",new Date().toLocaleString()],[""],["Data Summary:"],["Pillars:",e.pillars.length],["KPIs:",e.kpis.length],["Initiatives:",e.initiatives.length],["Projects:",e.projects.length],["Tasks:",e.tasks.length],["Milestones:",(e.milestones||[]).length],["Resources:",e.resources.length],[""],["This file can be used as a backup."],["To restore, use the Import feature in StratOS AI."]],j=Ye.aoa_to_sheet(w);Jt(j,[20,30]),Ye.book_append_sheet(t,j,"_Summary");const T=`StratOS_AI_Backup_${new Date().toISOString().split("T")[0]}.xlsx`;jk(t,T)},rbe=e=>{const t=Ye.book_new(),r=[["Strategic Cascade - Golden Thread View"],[""],["Level","Name","Work ID","Parent","RAG/Status","Budget","Spent","Completion","Owner/Manager","WBS Code"]];e.pillars.forEach(i=>{r.push(["PILLAR",i.name,"-","-",i.ragStatus.toUpperCase(),"-","-","-","-","-"]),e.initiatives.filter(c=>c.pillarId===i.id).forEach(c=>{const d=e.resources.find(h=>h.id===c.ownerId);r.push(["  INITIATIVE",c.name,"-",i.name,c.ragStatus.toUpperCase(),c.budget,c.spentBudget,"-",d?.name||"-","-"]),e.projects.filter(h=>h.initiativeId===c.id).forEach(h=>{const p=e.resources.find(b=>b.id===h.managerId);r.push(["    PROJECT",h.name,h.workId,c.name,h.ragStatus.toUpperCase(),h.budget,h.spentBudget,`${h.completionPercentage}%`,p?.name||"-","-"]);const g=e.tasks.filter(b=>b.projectId===h.id&&!b.parentTaskId),v=(b,y)=>{b.forEach(w=>{const j=e.resources.find(N=>N.id===w.assigneeId);r.push([`${y}TASK${w.isMilestone?" (MS)":""}`,w.title,"-",h.workId,w.kanbanStatus.replace("_"," ").toUpperCase(),"-","-",w.kanbanStatus==="done"?"100%":"-",j?.name||"-",w.wbsCode||"-"]);const T=e.tasks.filter(N=>N.parentTaskId===w.id);T.length>0&&v(T,y+"  ")})};v(g,"      ")})}),r.push(["","","","","","","","","",""])});const n=Ye.aoa_to_sheet(r);Jt(n,[20,40,18,30,15,12,12,12,20,10]),Ye.book_append_sheet(t,n,"Strategic Cascade");const a=`StratOS_AI_Strategic_Cascade_${new Date().toISOString().split("T")[0]}.xlsx`;jk(t,a)};function KD(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function nbe(...e){return t=>{let r=!1;const n=e.map(a=>{const i=KD(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():KD(e[a],null)}}}}var abe=Symbol.for("react.lazy"),Dx=fI[" use ".trim().toString()];function ibe(e){return typeof e=="object"&&e!==null&&"then"in e}function zL(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===abe&&"_payload"in e&&ibe(e._payload)}function sbe(e){const t=obe(e),r=k.forwardRef((n,a)=>{let{children:i,...s}=n;zL(i)&&typeof Dx=="function"&&(i=Dx(i._payload));const c=k.Children.toArray(i),d=c.find(ube);if(d){const f=d.props.children,h=c.map(p=>p===d?k.Children.count(f)>1?k.Children.only(null):k.isValidElement(f)?f.props.children:null:p);return o.jsx(t,{...s,ref:a,children:k.isValidElement(f)?k.cloneElement(f,void 0,h):null})}return o.jsx(t,{...s,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var lbe=sbe("Slot");function obe(e){const t=k.forwardRef((r,n)=>{let{children:a,...i}=r;if(zL(a)&&typeof Dx=="function"&&(a=Dx(a._payload)),k.isValidElement(a)){const s=fbe(a),c=dbe(i,a.props);return a.type!==k.Fragment&&(c.ref=n?nbe(n,s):s),k.cloneElement(a,c)}return k.Children.count(a)>1?k.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var cbe=Symbol("radix.slottable");function ube(e){return k.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===cbe}function dbe(e,t){const r={...t};for(const n in t){const a=e[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...c)=>{const d=i(...c);return a(...c),d}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function fbe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const YD=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,XD=tr,hbe=(e,t)=>r=>{var n;if(t?.variants==null)return XD(e,r?.class,r?.className);const{variants:a,defaultVariants:i}=t,s=Object.keys(a).map(f=>{const h=r?.[f],p=i?.[f];if(h===null)return null;const g=YD(h)||YD(p);return a[f][g]}),c=r&&Object.entries(r).reduce((f,h)=>{let[p,g]=h;return g===void 0||(f[p]=g),f},{}),d=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((f,h)=>{let{class:p,className:g,...v}=h;return Object.entries(v).every(b=>{let[y,w]=b;return Array.isArray(w)?w.includes({...i,...c}[y]):{...i,...c}[y]===w})?[...f,p,g]:f},[]);return XD(e,s,d,r?.class,r?.className)},mbe=(e,t)=>{const r=new Array(e.length+t.length);for(let n=0;n<e.length;n++)r[n]=e[n];for(let n=0;n<t.length;n++)r[e.length+n]=t[n];return r},pbe=(e,t)=>({classGroupId:e,validator:t}),$L=(e=new Map,t=null,r)=>({nextPart:e,validators:t,classGroupId:r}),Ix="-",ZD=[],xbe="arbitrary..",gbe=e=>{const t=ybe(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:s=>{if(s.startsWith("[")&&s.endsWith("]"))return vbe(s);const c=s.split(Ix),d=c[0]===""&&c.length>1?1:0;return HL(c,d,t)},getConflictingClassGroupIds:(s,c)=>{if(c){const d=n[s],f=r[s];return d?f?mbe(f,d):d:f||ZD}return r[s]||ZD}}},HL=(e,t,r)=>{if(e.length-t===0)return r.classGroupId;const a=e[t],i=r.nextPart.get(a);if(i){const f=HL(e,t+1,i);if(f)return f}const s=r.validators;if(s===null)return;const c=t===0?e.join(Ix):e.slice(t).join(Ix),d=s.length;for(let f=0;f<d;f++){const h=s[f];if(h.validator(c))return h.classGroupId}},vbe=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const t=e.slice(1,-1),r=t.indexOf(":"),n=t.slice(0,r);return n?xbe+n:void 0})(),ybe=e=>{const{theme:t,classGroups:r}=e;return bbe(r,t)},bbe=(e,t)=>{const r=$L();for(const n in e){const a=e[n];Ak(a,r,n,t)}return r},Ak=(e,t,r,n)=>{const a=e.length;for(let i=0;i<a;i++){const s=e[i];wbe(s,t,r,n)}},wbe=(e,t,r,n)=>{if(typeof e=="string"){Sbe(e,t,r);return}if(typeof e=="function"){Nbe(e,t,r,n);return}kbe(e,t,r,n)},Sbe=(e,t,r)=>{const n=e===""?t:VL(t,e);n.classGroupId=r},Nbe=(e,t,r,n)=>{if(_be(e)){Ak(e(n),t,r,n);return}t.validators===null&&(t.validators=[]),t.validators.push(pbe(r,e))},kbe=(e,t,r,n)=>{const a=Object.entries(e),i=a.length;for(let s=0;s<i;s++){const[c,d]=a[s];Ak(d,VL(t,c),r,n)}},VL=(e,t)=>{let r=e;const n=t.split(Ix),a=n.length;for(let i=0;i<a;i++){const s=n[i];let c=r.nextPart.get(s);c||(c=$L(),r.nextPart.set(s,c)),r=c}return r},_be=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,jbe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=Object.create(null),n=Object.create(null);const a=(i,s)=>{r[i]=s,t++,t>e&&(t=0,n=r,r=Object.create(null))};return{get(i){let s=r[i];if(s!==void 0)return s;if((s=n[i])!==void 0)return a(i,s),s},set(i,s){i in r?r[i]=s:a(i,s)}}},Fw="!",QD=":",Ebe=[],JD=(e,t,r,n,a)=>({modifiers:e,hasImportantModifier:t,baseClassName:r,maybePostfixModifierPosition:n,isExternal:a}),Tbe=e=>{const{prefix:t,experimentalParseClassName:r}=e;let n=a=>{const i=[];let s=0,c=0,d=0,f;const h=a.length;for(let y=0;y<h;y++){const w=a[y];if(s===0&&c===0){if(w===QD){i.push(a.slice(d,y)),d=y+1;continue}if(w==="/"){f=y;continue}}w==="["?s++:w==="]"?s--:w==="("?c++:w===")"&&c--}const p=i.length===0?a:a.slice(d);let g=p,v=!1;p.endsWith(Fw)?(g=p.slice(0,-1),v=!0):p.startsWith(Fw)&&(g=p.slice(1),v=!0);const b=f&&f>d?f-d:void 0;return JD(i,v,g,b)};if(t){const a=t+QD,i=n;n=s=>s.startsWith(a)?i(s.slice(a.length)):JD(Ebe,!1,s,void 0,!0)}if(r){const a=n;n=i=>r({className:i,parseClassName:a})}return n},Cbe=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((r,n)=>{t.set(r,1e6+n)}),r=>{const n=[];let a=[];for(let i=0;i<r.length;i++){const s=r[i],c=s[0]==="[",d=t.has(s);c||d?(a.length>0&&(a.sort(),n.push(...a),a=[]),n.push(s)):a.push(s)}return a.length>0&&(a.sort(),n.push(...a)),n}},Abe=e=>({cache:jbe(e.cacheSize),parseClassName:Tbe(e),sortModifiers:Cbe(e),...gbe(e)}),Obe=/\s+/,Dbe=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a,sortModifiers:i}=t,s=[],c=e.trim().split(Obe);let d="";for(let f=c.length-1;f>=0;f-=1){const h=c[f],{isExternal:p,modifiers:g,hasImportantModifier:v,baseClassName:b,maybePostfixModifierPosition:y}=r(h);if(p){d=h+(d.length>0?" "+d:d);continue}let w=!!y,j=n(w?b.substring(0,y):b);if(!j){if(!w){d=h+(d.length>0?" "+d:d);continue}if(j=n(b),!j){d=h+(d.length>0?" "+d:d);continue}w=!1}const T=g.length===0?"":g.length===1?g[0]:i(g).join(":"),N=v?T+Fw:T,C=N+j;if(s.indexOf(C)>-1)continue;s.push(C);const E=a(j,w);for(let O=0;O<E.length;++O){const A=E[O];s.push(N+A)}d=h+(d.length>0?" "+d:d)}return d},Ibe=(...e)=>{let t=0,r,n,a="";for(;t<e.length;)(r=e[t++])&&(n=GL(r))&&(a&&(a+=" "),a+=n);return a},GL=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=GL(e[n]))&&(r&&(r+=" "),r+=t);return r},Rbe=(e,...t)=>{let r,n,a,i;const s=d=>{const f=t.reduce((h,p)=>p(h),e());return r=Abe(f),n=r.cache.get,a=r.cache.set,i=c,c(d)},c=d=>{const f=n(d);if(f)return f;const h=Dbe(d,r);return a(d,h),h};return i=s,(...d)=>i(Ibe(...d))},Mbe=[],rn=e=>{const t=r=>r[e]||Mbe;return t.isThemeGetter=!0,t},WL=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,qL=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Pbe=/^\d+\/\d+$/,Fbe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Lbe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Bbe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ube=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,zbe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Tu=e=>Pbe.test(e),pt=e=>!!e&&!Number.isNaN(Number(e)),Jl=e=>!!e&&Number.isInteger(Number(e)),i2=e=>e.endsWith("%")&&pt(e.slice(0,-1)),Gs=e=>Fbe.test(e),$be=()=>!0,Hbe=e=>Lbe.test(e)&&!Bbe.test(e),KL=()=>!1,Vbe=e=>Ube.test(e),Gbe=e=>zbe.test(e),Wbe=e=>!Ge(e)&&!We(e),qbe=e=>Nd(e,ZL,KL),Ge=e=>WL.test(e),Ko=e=>Nd(e,QL,Hbe),s2=e=>Nd(e,Qbe,pt),eI=e=>Nd(e,YL,KL),Kbe=e=>Nd(e,XL,Gbe),op=e=>Nd(e,JL,Vbe),We=e=>qL.test(e),Ef=e=>kd(e,QL),Ybe=e=>kd(e,Jbe),tI=e=>kd(e,YL),Xbe=e=>kd(e,ZL),Zbe=e=>kd(e,XL),cp=e=>kd(e,JL,!0),Nd=(e,t,r)=>{const n=WL.exec(e);return n?n[1]?t(n[1]):r(n[2]):!1},kd=(e,t,r=!1)=>{const n=qL.exec(e);return n?n[1]?t(n[1]):r:!1},YL=e=>e==="position"||e==="percentage",XL=e=>e==="image"||e==="url",ZL=e=>e==="length"||e==="size"||e==="bg-size",QL=e=>e==="length",Qbe=e=>e==="number",Jbe=e=>e==="family-name",JL=e=>e==="shadow",e2e=()=>{const e=rn("color"),t=rn("font"),r=rn("text"),n=rn("font-weight"),a=rn("tracking"),i=rn("leading"),s=rn("breakpoint"),c=rn("container"),d=rn("spacing"),f=rn("radius"),h=rn("shadow"),p=rn("inset-shadow"),g=rn("text-shadow"),v=rn("drop-shadow"),b=rn("blur"),y=rn("perspective"),w=rn("aspect"),j=rn("ease"),T=rn("animate"),N=()=>["auto","avoid","all","avoid-page","page","left","right","column"],C=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],E=()=>[...C(),We,Ge],O=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],D=()=>[We,Ge,d],M=()=>[Tu,"full","auto",...D()],P=()=>[Jl,"none","subgrid",We,Ge],R=()=>["auto",{span:["full",Jl,We,Ge]},Jl,We,Ge],L=()=>[Jl,"auto",We,Ge],te=()=>["auto","min","max","fr",We,Ge],ee=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ue=()=>["start","end","center","stretch","center-safe","end-safe"],V=()=>["auto",...D()],K=()=>[Tu,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...D()],ie=()=>[e,We,Ge],re=()=>[...C(),tI,eI,{position:[We,Ge]}],me=()=>["no-repeat",{repeat:["","x","y","space","round"]}],W=()=>["auto","cover","contain",Xbe,qbe,{size:[We,Ge]}],F=()=>[i2,Ef,Ko],X=()=>["","none","full",f,We,Ge],q=()=>["",pt,Ef,Ko],U=()=>["solid","dashed","dotted","double"],G=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],le=()=>[pt,i2,tI,eI],de=()=>["","none",b,We,Ge],ne=()=>["none",pt,We,Ge],oe=()=>["none",pt,We,Ge],Ae=()=>[pt,We,Ge],z=()=>[Tu,"full",...D()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Gs],breakpoint:[Gs],color:[$be],container:[Gs],"drop-shadow":[Gs],ease:["in","out","in-out"],font:[Wbe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Gs],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Gs],shadow:[Gs],spacing:["px",pt],text:[Gs],"text-shadow":[Gs],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Tu,Ge,We,w]}],container:["container"],columns:[{columns:[pt,Ge,We,c]}],"break-after":[{"break-after":N()}],"break-before":[{"break-before":N()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:E()}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:M()}],"inset-x":[{"inset-x":M()}],"inset-y":[{"inset-y":M()}],start:[{start:M()}],end:[{end:M()}],top:[{top:M()}],right:[{right:M()}],bottom:[{bottom:M()}],left:[{left:M()}],visibility:["visible","invisible","collapse"],z:[{z:[Jl,"auto",We,Ge]}],basis:[{basis:[Tu,"full","auto",c,...D()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[pt,Tu,"auto","initial","none",Ge]}],grow:[{grow:["",pt,We,Ge]}],shrink:[{shrink:["",pt,We,Ge]}],order:[{order:[Jl,"first","last","none",We,Ge]}],"grid-cols":[{"grid-cols":P()}],"col-start-end":[{col:R()}],"col-start":[{"col-start":L()}],"col-end":[{"col-end":L()}],"grid-rows":[{"grid-rows":P()}],"row-start-end":[{row:R()}],"row-start":[{"row-start":L()}],"row-end":[{"row-end":L()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":te()}],"auto-rows":[{"auto-rows":te()}],gap:[{gap:D()}],"gap-x":[{"gap-x":D()}],"gap-y":[{"gap-y":D()}],"justify-content":[{justify:[...ee(),"normal"]}],"justify-items":[{"justify-items":[...ue(),"normal"]}],"justify-self":[{"justify-self":["auto",...ue()]}],"align-content":[{content:["normal",...ee()]}],"align-items":[{items:[...ue(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ue(),{baseline:["","last"]}]}],"place-content":[{"place-content":ee()}],"place-items":[{"place-items":[...ue(),"baseline"]}],"place-self":[{"place-self":["auto",...ue()]}],p:[{p:D()}],px:[{px:D()}],py:[{py:D()}],ps:[{ps:D()}],pe:[{pe:D()}],pt:[{pt:D()}],pr:[{pr:D()}],pb:[{pb:D()}],pl:[{pl:D()}],m:[{m:V()}],mx:[{mx:V()}],my:[{my:V()}],ms:[{ms:V()}],me:[{me:V()}],mt:[{mt:V()}],mr:[{mr:V()}],mb:[{mb:V()}],ml:[{ml:V()}],"space-x":[{"space-x":D()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":D()}],"space-y-reverse":["space-y-reverse"],size:[{size:K()}],w:[{w:[c,"screen",...K()]}],"min-w":[{"min-w":[c,"screen","none",...K()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[s]},...K()]}],h:[{h:["screen","lh",...K()]}],"min-h":[{"min-h":["screen","lh","none",...K()]}],"max-h":[{"max-h":["screen","lh",...K()]}],"font-size":[{text:["base",r,Ef,Ko]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[n,We,s2]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",i2,Ge]}],"font-family":[{font:[Ybe,Ge,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,We,Ge]}],"line-clamp":[{"line-clamp":[pt,"none",We,s2]}],leading:[{leading:[i,...D()]}],"list-image":[{"list-image":["none",We,Ge]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",We,Ge]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:ie()}],"text-color":[{text:ie()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...U(),"wavy"]}],"text-decoration-thickness":[{decoration:[pt,"from-font","auto",We,Ko]}],"text-decoration-color":[{decoration:ie()}],"underline-offset":[{"underline-offset":[pt,"auto",We,Ge]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",We,Ge]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",We,Ge]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:re()}],"bg-repeat":[{bg:me()}],"bg-size":[{bg:W()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Jl,We,Ge],radial:["",We,Ge],conic:[Jl,We,Ge]},Zbe,Kbe]}],"bg-color":[{bg:ie()}],"gradient-from-pos":[{from:F()}],"gradient-via-pos":[{via:F()}],"gradient-to-pos":[{to:F()}],"gradient-from":[{from:ie()}],"gradient-via":[{via:ie()}],"gradient-to":[{to:ie()}],rounded:[{rounded:X()}],"rounded-s":[{"rounded-s":X()}],"rounded-e":[{"rounded-e":X()}],"rounded-t":[{"rounded-t":X()}],"rounded-r":[{"rounded-r":X()}],"rounded-b":[{"rounded-b":X()}],"rounded-l":[{"rounded-l":X()}],"rounded-ss":[{"rounded-ss":X()}],"rounded-se":[{"rounded-se":X()}],"rounded-ee":[{"rounded-ee":X()}],"rounded-es":[{"rounded-es":X()}],"rounded-tl":[{"rounded-tl":X()}],"rounded-tr":[{"rounded-tr":X()}],"rounded-br":[{"rounded-br":X()}],"rounded-bl":[{"rounded-bl":X()}],"border-w":[{border:q()}],"border-w-x":[{"border-x":q()}],"border-w-y":[{"border-y":q()}],"border-w-s":[{"border-s":q()}],"border-w-e":[{"border-e":q()}],"border-w-t":[{"border-t":q()}],"border-w-r":[{"border-r":q()}],"border-w-b":[{"border-b":q()}],"border-w-l":[{"border-l":q()}],"divide-x":[{"divide-x":q()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":q()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...U(),"hidden","none"]}],"divide-style":[{divide:[...U(),"hidden","none"]}],"border-color":[{border:ie()}],"border-color-x":[{"border-x":ie()}],"border-color-y":[{"border-y":ie()}],"border-color-s":[{"border-s":ie()}],"border-color-e":[{"border-e":ie()}],"border-color-t":[{"border-t":ie()}],"border-color-r":[{"border-r":ie()}],"border-color-b":[{"border-b":ie()}],"border-color-l":[{"border-l":ie()}],"divide-color":[{divide:ie()}],"outline-style":[{outline:[...U(),"none","hidden"]}],"outline-offset":[{"outline-offset":[pt,We,Ge]}],"outline-w":[{outline:["",pt,Ef,Ko]}],"outline-color":[{outline:ie()}],shadow:[{shadow:["","none",h,cp,op]}],"shadow-color":[{shadow:ie()}],"inset-shadow":[{"inset-shadow":["none",p,cp,op]}],"inset-shadow-color":[{"inset-shadow":ie()}],"ring-w":[{ring:q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:ie()}],"ring-offset-w":[{"ring-offset":[pt,Ko]}],"ring-offset-color":[{"ring-offset":ie()}],"inset-ring-w":[{"inset-ring":q()}],"inset-ring-color":[{"inset-ring":ie()}],"text-shadow":[{"text-shadow":["none",g,cp,op]}],"text-shadow-color":[{"text-shadow":ie()}],opacity:[{opacity:[pt,We,Ge]}],"mix-blend":[{"mix-blend":[...G(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":G()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[pt]}],"mask-image-linear-from-pos":[{"mask-linear-from":le()}],"mask-image-linear-to-pos":[{"mask-linear-to":le()}],"mask-image-linear-from-color":[{"mask-linear-from":ie()}],"mask-image-linear-to-color":[{"mask-linear-to":ie()}],"mask-image-t-from-pos":[{"mask-t-from":le()}],"mask-image-t-to-pos":[{"mask-t-to":le()}],"mask-image-t-from-color":[{"mask-t-from":ie()}],"mask-image-t-to-color":[{"mask-t-to":ie()}],"mask-image-r-from-pos":[{"mask-r-from":le()}],"mask-image-r-to-pos":[{"mask-r-to":le()}],"mask-image-r-from-color":[{"mask-r-from":ie()}],"mask-image-r-to-color":[{"mask-r-to":ie()}],"mask-image-b-from-pos":[{"mask-b-from":le()}],"mask-image-b-to-pos":[{"mask-b-to":le()}],"mask-image-b-from-color":[{"mask-b-from":ie()}],"mask-image-b-to-color":[{"mask-b-to":ie()}],"mask-image-l-from-pos":[{"mask-l-from":le()}],"mask-image-l-to-pos":[{"mask-l-to":le()}],"mask-image-l-from-color":[{"mask-l-from":ie()}],"mask-image-l-to-color":[{"mask-l-to":ie()}],"mask-image-x-from-pos":[{"mask-x-from":le()}],"mask-image-x-to-pos":[{"mask-x-to":le()}],"mask-image-x-from-color":[{"mask-x-from":ie()}],"mask-image-x-to-color":[{"mask-x-to":ie()}],"mask-image-y-from-pos":[{"mask-y-from":le()}],"mask-image-y-to-pos":[{"mask-y-to":le()}],"mask-image-y-from-color":[{"mask-y-from":ie()}],"mask-image-y-to-color":[{"mask-y-to":ie()}],"mask-image-radial":[{"mask-radial":[We,Ge]}],"mask-image-radial-from-pos":[{"mask-radial-from":le()}],"mask-image-radial-to-pos":[{"mask-radial-to":le()}],"mask-image-radial-from-color":[{"mask-radial-from":ie()}],"mask-image-radial-to-color":[{"mask-radial-to":ie()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":C()}],"mask-image-conic-pos":[{"mask-conic":[pt]}],"mask-image-conic-from-pos":[{"mask-conic-from":le()}],"mask-image-conic-to-pos":[{"mask-conic-to":le()}],"mask-image-conic-from-color":[{"mask-conic-from":ie()}],"mask-image-conic-to-color":[{"mask-conic-to":ie()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:re()}],"mask-repeat":[{mask:me()}],"mask-size":[{mask:W()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",We,Ge]}],filter:[{filter:["","none",We,Ge]}],blur:[{blur:de()}],brightness:[{brightness:[pt,We,Ge]}],contrast:[{contrast:[pt,We,Ge]}],"drop-shadow":[{"drop-shadow":["","none",v,cp,op]}],"drop-shadow-color":[{"drop-shadow":ie()}],grayscale:[{grayscale:["",pt,We,Ge]}],"hue-rotate":[{"hue-rotate":[pt,We,Ge]}],invert:[{invert:["",pt,We,Ge]}],saturate:[{saturate:[pt,We,Ge]}],sepia:[{sepia:["",pt,We,Ge]}],"backdrop-filter":[{"backdrop-filter":["","none",We,Ge]}],"backdrop-blur":[{"backdrop-blur":de()}],"backdrop-brightness":[{"backdrop-brightness":[pt,We,Ge]}],"backdrop-contrast":[{"backdrop-contrast":[pt,We,Ge]}],"backdrop-grayscale":[{"backdrop-grayscale":["",pt,We,Ge]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[pt,We,Ge]}],"backdrop-invert":[{"backdrop-invert":["",pt,We,Ge]}],"backdrop-opacity":[{"backdrop-opacity":[pt,We,Ge]}],"backdrop-saturate":[{"backdrop-saturate":[pt,We,Ge]}],"backdrop-sepia":[{"backdrop-sepia":["",pt,We,Ge]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":D()}],"border-spacing-x":[{"border-spacing-x":D()}],"border-spacing-y":[{"border-spacing-y":D()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",We,Ge]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[pt,"initial",We,Ge]}],ease:[{ease:["linear","initial",j,We,Ge]}],delay:[{delay:[pt,We,Ge]}],animate:[{animate:["none",T,We,Ge]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[y,We,Ge]}],"perspective-origin":[{"perspective-origin":E()}],rotate:[{rotate:ne()}],"rotate-x":[{"rotate-x":ne()}],"rotate-y":[{"rotate-y":ne()}],"rotate-z":[{"rotate-z":ne()}],scale:[{scale:oe()}],"scale-x":[{"scale-x":oe()}],"scale-y":[{"scale-y":oe()}],"scale-z":[{"scale-z":oe()}],"scale-3d":["scale-3d"],skew:[{skew:Ae()}],"skew-x":[{"skew-x":Ae()}],"skew-y":[{"skew-y":Ae()}],transform:[{transform:[We,Ge,"","none","gpu","cpu"]}],"transform-origin":[{origin:E()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:z()}],"translate-x":[{"translate-x":z()}],"translate-y":[{"translate-y":z()}],"translate-z":[{"translate-z":z()}],"translate-none":["translate-none"],accent:[{accent:ie()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:ie()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",We,Ge]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",We,Ge]}],fill:[{fill:["none",...ie()]}],"stroke-w":[{stroke:[pt,Ef,Ko,s2]}],stroke:[{stroke:["none",...ie()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},t2e=Rbe(e2e);function r2e(...e){return t2e(tr(e))}const n2e=hbe("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function l2({className:e,variant:t="default",size:r="default",asChild:n=!1,...a}){const i=n?lbe:"button";return o.jsx(i,{"data-slot":"button","data-variant":t,"data-size":r,className:r2e(n2e({variant:t,size:r,className:e})),...a})}const a2e=()=>{const{state:e}=Pt(),t=()=>{ebe(e)},r=()=>{tbe(e)},n=()=>{rbe(e)},a=e.projects.filter(d=>d.ragStatus==="green").length,i=e.projects.filter(d=>d.ragStatus==="amber").length,s=e.projects.filter(d=>d.ragStatus==="red").length,c=e.tasks.filter(d=>d.kanbanStatus==="done").length;return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Export Data"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Export your portfolio data in various formats for reporting or offline editing."})]}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(od,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Data Export"})]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("h2",{className:"text-lg font-semibold text-text-primary mb-4 flex items-center gap-2",children:[o.jsx(Np,{className:"w-5 h-5 text-accent-blue"}),"Current Portfolio Summary"]}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-3",children:[o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:e.pillars.length}),o.jsx("p",{className:"text-xs text-text-muted",children:"Pillars"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:e.kpis.length}),o.jsx("p",{className:"text-xs text-text-muted",children:"KPIs"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:e.initiatives.length}),o.jsx("p",{className:"text-xs text-text-muted",children:"Initiatives"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:e.projects.length}),o.jsx("p",{className:"text-xs text-text-muted",children:"Projects"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-rag-green",children:a}),o.jsx("p",{className:"text-xs text-text-muted",children:"On Track"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-rag-amber",children:i}),o.jsx("p",{className:"text-xs text-text-muted",children:"At Risk"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("p",{className:"text-2xl font-bold text-rag-red",children:s}),o.jsx("p",{className:"text-xs text-text-muted",children:"Critical"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsxs("p",{className:"text-2xl font-bold text-text-primary",children:[c,"/",e.tasks.length]}),o.jsx("p",{className:"text-xs text-text-muted",children:"Tasks Done"})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[o.jsx("div",{className:"p-3 bg-accent-blue/20 rounded-lg",children:o.jsx(ho,{className:"w-6 h-6 text-accent-blue"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Import Template"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Structured Excel for adding new Projects & Tasks offline."})]})]}),o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary",children:"Includes:"}),o.jsx("div",{className:"space-y-2",children:["Instructions & Work ID guide","Reference sheets (Pillars, Initiatives, Resources)","Existing Projects with Work IDs","Projects input with dropdowns","Tasks input with dropdowns","Dept/Category code reference","Portfolio summary dashboard"].map((d,f)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-secondary",children:[o.jsx(yr,{className:"w-4 h-4 text-rag-green"}),d]},f))})]}),o.jsxs(l2,{onClick:t,className:"w-full",children:[o.jsx(Pf,{className:"w-4 h-4"}),"Download Template"]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[o.jsx("div",{className:"p-3 bg-accent-cyan/20 rounded-lg",children:o.jsx(Lx,{className:"w-6 h-6 text-accent-cyan"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Strategic Cascade"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Golden Thread view - hierarchy from Strategy to Execution."})]})]}),o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary",children:"Includes:"}),o.jsx("div",{className:"space-y-2",children:["Hierarchical cascade view","Pillar  Initiative  Project  Task","Work IDs for all projects","RAG status at each level","Budget & completion tracking","Owner/Manager assignments","Perfect for board presentations"].map((d,f)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-secondary",children:[o.jsx(yr,{className:"w-4 h-4 text-accent-cyan"}),d]},f))})]}),o.jsxs(l2,{onClick:n,variant:"secondary",className:"w-full",children:[o.jsx(Pf,{className:"w-4 h-4"}),"Download Cascade"]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-start gap-4 mb-6",children:[o.jsx("div",{className:"p-3 bg-accent-purple/20 rounded-lg",children:o.jsx(Np,{className:"w-6 h-6 text-accent-purple"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Full Data Backup"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Complete export with IDs for backup or migration."})]})]}),o.jsxs("div",{className:"space-y-3 mb-6",children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary",children:"Includes:"}),o.jsx("div",{className:"space-y-2",children:["All Pillars with UUIDs","All KPIs with pillar linkage","All Initiatives with owners","All Projects with Work IDs","All Tasks with assignments","All Resources with departments","Summary sheet with counts"].map((d,f)=>o.jsxs("div",{className:"flex items-center gap-2 text-sm text-text-secondary",children:[o.jsx(yr,{className:"w-4 h-4 text-accent-purple"}),d]},f))})]}),o.jsxs(l2,{onClick:r,variant:"secondary",className:"w-full",children:[o.jsx(Pf,{className:"w-4 h-4"}),"Download Backup"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"flex items-start gap-3 p-4 bg-accent-blue/10 rounded-lg border border-accent-blue/30",children:[o.jsx(Wu,{className:"w-5 h-5 text-accent-blue flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"text-sm text-text-secondary",children:[o.jsx("p",{className:"font-medium text-accent-blue mb-1",children:"Work ID System"}),o.jsxs("p",{children:["Projects are coded using the format ",o.jsx("code",{className:"text-accent-blue bg-accent-blue/20 px-1 rounded",children:"DEPT-YY-CATEGORY-SEQ"}),". Example: ",o.jsx("code",{className:"text-accent-blue bg-accent-blue/20 px-1 rounded",children:"IT-25-GROW-001"})," means IT department, FY2025, Growth category, sequence #1."]})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-4 bg-accent-cyan/10 rounded-lg border border-accent-cyan/30",children:[o.jsx(Gu,{className:"w-5 h-5 text-accent-cyan flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"text-sm text-text-secondary",children:[o.jsx("p",{className:"font-medium text-accent-cyan mb-1",children:"Data Validation"}),o.jsx("p",{children:"The import template includes dropdown lists for Initiatives, Resources, Departments, and Categories to ensure data integrity. Work IDs are auto-generated on import."})]})]})]})]})},O0={pillar:"Strategy Pillar",kpi:"Strategic KPI",initiative:"Initiative",project:"Project",task:"Task",resource:"Resource",milestone:"Milestone"},i2e=[{name:"name",label:"Pillar Name",type:"string",required:!0,aliases:["pillar","pillar name","perspective","bsc perspective","strategy pillar"],semanticTags:["name","identifier","title"]},{name:"description",label:"Description",type:"string",required:!1,aliases:["desc","details","about","summary"],semanticTags:["description","text"]},{name:"displayOrder",label:"Display Order",type:"number",required:!1,aliases:["order","sort order","sequence","position","rank"],semanticTags:["order","number"],defaultValue:0},{name:"ragStatus",label:"RAG Status",type:"enum",required:!1,aliases:["rag","status","health","traffic light","color status"],semanticTags:["status","rag"],enumValues:["red","amber","green"],defaultValue:"green"}],s2e=[{name:"name",label:"KPI Name",type:"string",required:!0,aliases:["kpi","kpi name","metric","measure","indicator","key performance indicator"],semanticTags:["name","identifier","title"]},{name:"pillarId",label:"Strategy Pillar",type:"reference",required:!0,referenceType:"pillar",aliases:["pillar","perspective","parent pillar","bsc perspective"],semanticTags:["parent","reference"]},{name:"targetValue",label:"Target Value",type:"number",required:!0,aliases:["target","goal","objective","target value"],semanticTags:["number","target"]},{name:"currentValue",label:"Current Value",type:"number",required:!0,aliases:["current","actual","value","current value"],semanticTags:["number","current"]},{name:"previousValue",label:"Previous Value",type:"number",required:!1,aliases:["previous","last","prior","previous value"],semanticTags:["number","previous"],defaultValue:0},{name:"unit",label:"Unit",type:"enum",required:!1,aliases:["unit","measurement","unit of measure","uom"],semanticTags:["unit"],enumValues:["%","$","score","number"],defaultValue:"number"},{name:"lastUpdated",label:"Last Updated",type:"date",required:!1,aliases:["updated","last updated","date","as of"],semanticTags:["date","updated"]}],l2e=[{name:"name",label:"Initiative Name",type:"string",required:!0,aliases:["initiative","initiative name","program","portfolio","workstream"],semanticTags:["name","identifier","title"]},{name:"pillarId",label:"Strategy Pillar",type:"reference",required:!0,referenceType:"pillar",aliases:["pillar","perspective","parent pillar","strategy pillar"],semanticTags:["parent","reference"]},{name:"description",label:"Description",type:"string",required:!1,aliases:["desc","details","about","summary","objective"],semanticTags:["description","text"]},{name:"ownerId",label:"Owner",type:"reference",required:!1,referenceType:"resource",aliases:["owner","sponsor","lead","initiative owner","program manager"],semanticTags:["person","owner"]},{name:"startDate",label:"Start Date",type:"date",required:!1,aliases:["start","start date","begin","from","kick off"],semanticTags:["date","start"],patterns:[/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{2,4}$/]},{name:"endDate",label:"End Date",type:"date",required:!1,aliases:["end","end date","finish","to","target date","due"],semanticTags:["date","end"],patterns:[/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{2,4}$/]},{name:"budget",label:"Budget",type:"number",required:!1,aliases:["budget","total budget","allocated budget","funding"],semanticTags:["budget","money","currency"],defaultValue:0},{name:"spentBudget",label:"Spent Budget",type:"number",required:!1,aliases:["spent","spent budget","actual spend","expenditure","cost"],semanticTags:["budget","money","spent"],defaultValue:0},{name:"ragStatus",label:"RAG Status",type:"enum",required:!1,aliases:["rag","status","health","traffic light"],semanticTags:["status","rag"],enumValues:["red","amber","green"],defaultValue:"green"}],o2e=[{name:"name",label:"Project Name",type:"string",required:!0,aliases:["project","project name","title","project title"],semanticTags:["name","identifier","title"]},{name:"initiativeId",label:"Initiative",type:"reference",required:!0,referenceType:"initiative",aliases:["initiative","parent initiative","program","workstream"],semanticTags:["parent","reference"]},{name:"description",label:"Description",type:"string",required:!1,aliases:["desc","details","about","summary","scope"],semanticTags:["description","text"]},{name:"managerId",label:"Project Manager",type:"reference",required:!1,referenceType:"resource",aliases:["manager","pm","project manager","lead","owner"],semanticTags:["person","manager"]},{name:"status",label:"Status",type:"enum",required:!1,aliases:["status","project status","state","phase"],semanticTags:["status"],enumValues:["not_started","in_progress","on_hold","completed","cancelled"],defaultValue:"not_started"},{name:"ragStatus",label:"RAG Status",type:"enum",required:!1,aliases:["rag","rag status","health","traffic light"],semanticTags:["status","rag"],enumValues:["red","amber","green"],defaultValue:"green"},{name:"startDate",label:"Start Date",type:"date",required:!1,aliases:["start","start date","begin","from","kick off"],semanticTags:["date","start"]},{name:"endDate",label:"End Date",type:"date",required:!1,aliases:["end","end date","finish","to","target date","deadline"],semanticTags:["date","end"]},{name:"completionPercentage",label:"Completion %",type:"number",required:!1,aliases:["completion","percent complete","progress","% complete","done"],semanticTags:["percentage","progress"],defaultValue:0},{name:"budget",label:"Budget",type:"number",required:!1,aliases:["budget","total budget","allocated budget","funding"],semanticTags:["budget","money","currency"],defaultValue:0},{name:"spentBudget",label:"Spent Budget",type:"number",required:!1,aliases:["spent","spent budget","actual spend","cost","expenditure"],semanticTags:["budget","money","spent"],defaultValue:0},{name:"departmentCode",label:"Department",type:"enum",required:!1,aliases:["department","dept","function","team","business unit"],semanticTags:["department"],enumValues:["FIN","MKT","OPS","IT","HR","SAL","PRD","ENG","LEG","ADM"],defaultValue:"IT"},{name:"category",label:"Category",type:"enum",required:!1,aliases:["category","type","project type","classification"],semanticTags:["category"],enumValues:["RUN","GROW","TRNS"],defaultValue:"GROW"},{name:"fiscalYear",label:"Fiscal Year",type:"number",required:!1,aliases:["fiscal year","fy","year","financial year"],semanticTags:["year","date"]}],c2e=[{name:"title",label:"Task Title",type:"string",required:!0,aliases:["task","task name","title","name","task title","activity"],semanticTags:["name","identifier","title"]},{name:"projectId",label:"Project",type:"reference",required:!0,referenceType:"project",aliases:["project","parent project","project name"],semanticTags:["parent","reference"]},{name:"description",label:"Description",type:"string",required:!1,aliases:["desc","details","about","notes","summary"],semanticTags:["description","text"]},{name:"assigneeId",label:"Assignee",type:"reference",required:!1,referenceType:"resource",aliases:["assignee","assigned to","owner","resource","responsible"],semanticTags:["person","assignee"]},{name:"kanbanStatus",label:"Status",type:"enum",required:!1,aliases:["status","task status","state","kanban"],semanticTags:["status"],enumValues:["todo","in_progress","blocked","done"],defaultValue:"todo"},{name:"dueDate",label:"Due Date",type:"date",required:!1,aliases:["due","due date","deadline","target date","end date"],semanticTags:["date","due"]},{name:"startDate",label:"Start Date",type:"date",required:!1,aliases:["start","start date","begin","from"],semanticTags:["date","start"]},{name:"estimatedHours",label:"Estimated Hours",type:"number",required:!1,aliases:["estimated hours","est hours","estimate","planned hours","effort"],semanticTags:["hours","estimate"],defaultValue:8},{name:"actualHours",label:"Actual Hours",type:"number",required:!1,aliases:["actual hours","act hours","actual","time spent","logged hours"],semanticTags:["hours","actual"],defaultValue:0},{name:"plannedHours",label:"Planned Hours",type:"number",required:!1,aliases:["planned hours","planned","budgeted hours"],semanticTags:["hours","planned"]},{name:"priority",label:"Priority",type:"enum",required:!1,aliases:["priority","importance","urgency","level"],semanticTags:["priority"],enumValues:["low","medium","high","critical"],defaultValue:"medium"},{name:"parentTaskId",label:"Parent Task",type:"reference",required:!1,referenceType:"task",aliases:["parent task","parent","parent wbs","wbs parent"],semanticTags:["parent","hierarchy"]},{name:"wbsCode",label:"WBS Code",type:"string",required:!1,aliases:["wbs","wbs code","wbs number","work breakdown"],semanticTags:["code","wbs"]},{name:"isMilestone",label:"Is Milestone",type:"boolean",required:!1,aliases:["milestone","is milestone","key milestone"],semanticTags:["milestone","flag"],defaultValue:!1},{name:"deliverable",label:"Deliverable",type:"string",required:!1,aliases:["deliverable","output","artifact","result"],semanticTags:["deliverable","output"]},{name:"departmentCode",label:"Department",type:"enum",required:!1,aliases:["department","dept","function","team"],semanticTags:["department"],enumValues:["FIN","MKT","OPS","IT","HR","SAL","PRD","ENG","LEG","ADM"]}],u2e=[{name:"name",label:"Name",type:"string",required:!0,aliases:["name","resource name","full name","person","employee"],semanticTags:["name","identifier","person"]},{name:"email",label:"Email",type:"string",required:!1,aliases:["email","e-mail","mail","email address"],semanticTags:["email","contact"],patterns:[/^[^\s@]+@[^\s@]+\.[^\s@]+$/]},{name:"role",label:"Role",type:"string",required:!1,aliases:["role","job title","position","title","job role"],semanticTags:["role","job"]},{name:"team",label:"Team",type:"string",required:!1,aliases:["team","group","squad","unit"],semanticTags:["team","group"]},{name:"weeklyCapacity",label:"Weekly Capacity",type:"number",required:!1,aliases:["capacity","weekly capacity","hours per week","availability"],semanticTags:["hours","capacity"],defaultValue:40},{name:"departmentCode",label:"Department",type:"enum",required:!1,aliases:["department","dept","function","business unit"],semanticTags:["department"],enumValues:["FIN","MKT","OPS","IT","HR","SAL","PRD","ENG","LEG","ADM"],defaultValue:"IT"},{name:"hourlyRate",label:"Hourly Rate",type:"number",required:!1,aliases:["hourly rate","rate","cost rate","billing rate"],semanticTags:["money","rate"]}],d2e=[{name:"name",label:"Milestone Name",type:"string",required:!0,aliases:["milestone","milestone name","name","title","gate"],semanticTags:["name","identifier","milestone"]},{name:"projectId",label:"Project",type:"reference",required:!0,referenceType:"project",aliases:["project","parent project","project name"],semanticTags:["parent","reference"]},{name:"description",label:"Description",type:"string",required:!1,aliases:["desc","details","about","summary"],semanticTags:["description","text"]},{name:"targetDate",label:"Target Date",type:"date",required:!0,aliases:["target date","target","due date","deadline","planned date"],semanticTags:["date","target"]},{name:"completedDate",label:"Completed Date",type:"date",required:!1,aliases:["completed date","completed","actual date","done date"],semanticTags:["date","completed"]},{name:"status",label:"Status",type:"enum",required:!1,aliases:["status","milestone status","state"],semanticTags:["status"],enumValues:["pending","completed","missed"],defaultValue:"pending"},{name:"displayOrder",label:"Display Order",type:"number",required:!1,aliases:["order","display order","sequence","sort order"],semanticTags:["order","number"],defaultValue:0}],Ok={pillar:{entityType:"pillar",fields:i2e,identifierField:"name"},kpi:{entityType:"kpi",fields:s2e,identifierField:"name",parentField:"pillarId",parentType:"pillar"},initiative:{entityType:"initiative",fields:l2e,identifierField:"name",parentField:"pillarId",parentType:"pillar"},project:{entityType:"project",fields:o2e,identifierField:"name",parentField:"initiativeId",parentType:"initiative"},task:{entityType:"task",fields:c2e,identifierField:"title",parentField:"projectId",parentType:"project"},resource:{entityType:"resource",fields:u2e,identifierField:"name"},milestone:{entityType:"milestone",fields:d2e,identifierField:"name",parentField:"projectId",parentType:"project"}},f2e={pillar:["pillar","pillars","perspective","perspectives","bsc","balanced scorecard","strategy"],kpi:["kpi","kpis","metric","metrics","indicator","indicators","measure","measures"],initiative:["initiative","initiatives","program","programs","portfolio","workstream"],project:["project","projects","prj","work","works"],task:["task","tasks","activity","activities","action","actions","todo","wbs","work breakdown"],resource:["resource","resources","people","person","employee","employees","team","staff","member"],milestone:["milestone","milestones","gate","gates","checkpoint","checkpoints","deliverable"]};function ut(e){return e.toLowerCase().replace(/[_\-\s]+/g,"").replace(/[^a-z0-9]/g,"")}function h2e(e){return e.toLowerCase().replace(/[_\-]+/g," ").replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim()}function rI(e){return h2e(e).split(" ").filter(t=>t.length>0)}function m2e(e,t){const r=e.length,n=t.length;if(r===0)return n;if(n===0)return r;const a=[];for(let i=0;i<=r;i++)a[i]=[i];for(let i=0;i<=n;i++)a[0][i]=i;for(let i=1;i<=r;i++)for(let s=1;s<=n;s++){const c=e[i-1]===t[s-1]?0:1;a[i][s]=Math.min(a[i-1][s]+1,a[i][s-1]+1,a[i-1][s-1]+c)}return a[r][n]}function p2e(e,t){const r=m2e(e,t),n=Math.max(e.length,t.length);return n===0?1:1-r/n}function Rx(e,t){const r=ut(e),n=ut(t);if(r===n)return 100;if(r.includes(n))return 85+n.length/r.length*10;if(n.includes(r))return 85+r.length/n.length*10;const a=p2e(r,n);return Math.round(a*80)}function Dk(e,t){let r=null;for(let n=0;n<t.length;n++){const a=Rx(e,t[n]);(!r||a>r.score)&&(r={target:t[n],score:a,index:n})}return r&&r.score>=50?r:null}function x2e(e,t){const r=new Set(rI(e)),n=new Set(rI(t));if(r.size===0||n.size===0)return 0;let a=0;for(const c of r)n.has(c)&&a++;const i=new Set([...r,...n]).size,s=a/i;return Math.round(s*100)}const g2e={id:["identifier","identification"],desc:["description"],mgr:["manager"],pm:["project manager"],dept:["department"],org:["organization","organisation"],est:["estimated","estimate"],act:["actual"],hrs:["hours"],pct:["percent","percentage"],amt:["amount"],qty:["quantity"],num:["number"],dt:["date"],yr:["year"],mo:["month"],wk:["week"],fy:["fiscal year"],seq:["sequence"],cat:["category"],stat:["status"],rag:["red amber green"],wbs:["work breakdown structure"],kpi:["key performance indicator"],bsc:["balanced scorecard"]};function nI(e){const t=ut(e),r=[e];for(const[n,a]of Object.entries(g2e))if(t===n||t.includes(n))for(const i of a)r.push(e.replace(new RegExp(n,"gi"),i));return r}function aI(e,t){const r=Rx(e,t),n=nI(e),a=nI(t);let i=r;for(const s of n)for(const c of a){const d=Rx(s,c);d>i&&(i=d)}return i}function v2e(e,t,r=[]){if(ut(e)===ut(t))return{score:100,reason:"Exact match"};for(const c of r)if(ut(e)===ut(c))return{score:98,reason:`Alias match: "${c}"`};const n=aI(e,t),a=x2e(e,t);let i=0,s="";for(const c of r){const d=aI(e,c);d>i&&(i=d,s=c)}return i>=n&&i>=a&&i>=60?{score:i,reason:`Similar to alias: "${s}"`}:a>=n&&a>=60?{score:a,reason:"Word overlap match"}:n>=60?{score:n,reason:"Fuzzy string match"}:{score:Math.max(n,a,i),reason:"Low confidence"}}async function y2e(e){const t=[];try{const r=await e.arrayBuffer(),n=Ax(r,{type:"array",cellDates:!0}),a=[];for(const i of n.SheetNames)try{const s=n.Sheets[i],c=b2e(s,i);a.push(c)}catch(s){t.push(`Error parsing sheet "${i}": ${s}`)}return{fileName:e.name,sheets:a,parseErrors:t}}catch(r){return{fileName:e.name,sheets:[],parseErrors:[`Failed to parse Excel file: ${r}`]}}}function b2e(e,t){const r=Ye.decode_range(e["!ref"]||"A1"),n=r.e.r-r.s.r,a=r.e.c-r.s.c+1,i=Ye.sheet_to_json(e,{header:1}),s=[];if(i.length>0)for(let p=0;p<a;p++){const g=i[0]?.[p];s.push(g!=null?String(g):`Column ${p+1}`)}const c=[];for(let p=1;p<=Math.min(10,i.length-1);p++)i[p]&&c.push(i[p]);const{entityType:d,confidence:f,reasons:h}=w2e(t,s);return{sheetName:t,headers:s,sampleData:c,rowCount:Math.max(0,n),columnCount:a,suggestedEntityType:d,entityConfidence:f,entityMatchReasons:h}}function w2e(e,t){const r={pillar:{score:0,reasons:[]},kpi:{score:0,reasons:[]},initiative:{score:0,reasons:[]},project:{score:0,reasons:[]},task:{score:0,reasons:[]},resource:{score:0,reasons:[]},milestone:{score:0,reasons:[]}},n=ut(e);for(const[f,h]of Object.entries(f2e))for(const p of h)if(n.includes(ut(p))){r[f].score+=40,r[f].reasons.push(`Sheet name contains "${p}"`);break}const a={pillar:["pillar","perspective","bsc"],kpi:["target value","current value","kpi","metric","unit"],initiative:["initiative","program","portfolio","sponsor"],project:["project","work id","department","category","fiscal year","manager","budget"],task:["task","assignee","kanban","wbs","estimated hours","due date","priority"],resource:["email","capacity","hourly rate","team","role"],milestone:["milestone","target date","completed date","gate"]};for(const f of t){const h=ut(f);for(const[p,g]of Object.entries(a))for(const v of g){const b=Rx(h,ut(v));if(b>=70){const y=Math.round(b/10);r[p].score+=y,b>=85&&r[p].reasons.push(`Header "${f}" matches "${v}"`)}}}t.some(f=>ut(f).includes("target"))&&t.some(f=>ut(f).includes("current"))&&(r.kpi.score+=20,r.kpi.reasons.push("Has target and current value columns")),t.some(f=>ut(f).includes("status")||ut(f).includes("kanban"))&&t.some(f=>ut(f).includes("hour"))&&(r.task.score+=15,r.task.reasons.push("Has status and hours columns")),t.some(f=>ut(f).includes("email"))&&(r.resource.score+=15,r.resource.reasons.push("Has email column")),t.some(f=>ut(f).includes("budget"))&&t.some(f=>ut(f).includes("date"))&&(r.project.score+=10,r.project.reasons.push("Has budget and date columns"));let i=null,s=0,c=[];for(const[f,{score:h,reasons:p}]of Object.entries(r))h>s&&(s=h,i=f,c=p);const d=Math.min(100,s);return d<30?{entityType:null,confidence:0,reasons:[]}:{entityType:i,confidence:d,reasons:c}}function o2(e,t){const r=e.Sheets[t];return r?Ye.sheet_to_json(r,{header:1}).slice(1):[]}async function S2e(e){const t=await e.arrayBuffer();return Ax(t,{type:"array",cellDates:!0})}function N2e(e){if(e.rowCount<1)return!1;const t=["lookup","reference","ref","instruction","help","summary","dashboard","codes"],r=ut(e.sheetName);for(const n of t)if(r.includes(n))return!1;return!e.sheetName.startsWith("_")}const ja={email:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,url:/^(https?:\/\/|www\.)[^\s]+$/i,date_iso:/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2})?/,date_us:/^\d{1,2}\/\d{1,2}\/\d{2,4}$/,date_eu:/^\d{1,2}\.\d{1,2}\.\d{2,4}$/,currency:/^\$?-?\d{1,3}(,\d{3})*(\.\d{2})?$/,percentage:/^-?\d+(\.\d+)?%$/,boolean_true:/^(yes|true|1|y|t|on)$/i,boolean_false:/^(no|false|0|n|f|off)$/i,integer:/^-?\d+$/,decimal:/^-?\d+\.\d+$/};function k2e(e,t){const r=[];for(let n=0;n<e.length;n++){const a=t.map(s=>s[n]),i=_2e(n,e[n],a);r.push(i)}return r}function _2e(e,t,r){const n=r.filter(p=>p!=null&&p!==""),a=n.map(p=>String(p)),i=new Set(a),s=i.size,c=n.slice(0,5),d=j2e(a),f=E2e(n,d,s);let h;return(f==="enum"||f==="string"&&s<=10&&s>0)&&(h=Array.from(i).slice(0,20)),{columnIndex:e,headerName:t,inferredDataType:f,sampleValues:c,uniqueCount:s,nullCount:r.length-n.length,totalCount:r.length,detectedPatterns:d,possibleEnumValues:h}}function j2e(e){if(e.length===0)return[];const t=[],r={email:ja.email,url:ja.url,"date (ISO)":ja.date_iso,"date (US)":ja.date_us,"date (EU)":ja.date_eu,currency:ja.currency,percentage:ja.percentage};for(const[n,a]of Object.entries(r))e.filter(c=>a.test(c)).length/e.length>=.5&&t.push(n);return t}function E2e(e,t,r){if(e.length===0)return"string";if(t.includes("email"))return"email";if(t.includes("url"))return"url";if(t.some(d=>d.startsWith("date")))return"date";if(t.includes("currency"))return"currency";if(t.includes("percentage"))return"percentage";let n=0,a=0,i=0,s=0;for(const d of e)switch(T2e(d)){case"number":n++;break;case"boolean":a++;break;case"date":i++;break;default:s++}const c=e.length;return n/c>=.8?"number":a/c>=.8?"boolean":i/c>=.8?"date":r<=10&&r/c<.3?"enum":n>0&&s>0?"mixed":"string"}function T2e(e){if(typeof e=="number"&&!isNaN(e))return"number";if(typeof e=="boolean")return"boolean";if(e instanceof Date)return"date";const t=String(e);return ja.boolean_true.test(t)||ja.boolean_false.test(t)?"boolean":ja.integer.test(t)||ja.decimal.test(t)?"number":ja.date_iso.test(t)||ja.date_us.test(t)||ja.date_eu.test(t)?"date":"string"}function C2e(e,t){return({string:["string","email","url","mixed"],number:["number","currency","percentage"],date:["date"],boolean:["boolean"],enum:["enum","string"],reference:["string","number","mixed"]}[t]||["string"]).includes(e)}const up={headerNameMatch:.4,dataTypeMatch:.25,patternMatch:.2,semanticMatch:.15};function A2e(e,t){const r=Ok[t],n=[],a=new Set,i=[];for(const c of e)for(const d of r.fields){const f=eB(c,d);f.totalConfidence>0&&i.push({column:c,field:d,confidence:f})}i.sort((c,d)=>d.confidence.totalConfidence-c.confidence.totalConfidence);const s=new Set;for(const{column:c,field:d,confidence:f}of i)if(!(s.has(c.columnIndex)||a.has(d.name))&&f.totalConfidence>=30){const h=iI(c,r.fields,d.name,a);n.push({sourceColumnIndex:c.columnIndex,sourceColumnName:c.headerName,targetField:d.name,targetFieldLabel:d.label,confidence:f.totalConfidence,matchReason:tB(f.scores),isRequired:d.required,alternatives:h}),s.add(c.columnIndex),a.add(d.name)}for(const c of e)if(!s.has(c.columnIndex)){const d=iI(c,r.fields,null,a);n.push({sourceColumnIndex:c.columnIndex,sourceColumnName:c.headerName,targetField:"",targetFieldLabel:"",confidence:0,matchReason:"No confident match found",isRequired:!1,alternatives:d})}return n.sort((c,d)=>c.sourceColumnIndex-d.sourceColumnIndex)}function eB(e,t){const r=[],n=O2e(e.headerName,t);r.push({strategy:"Header Match",score:n.score,weight:up.headerNameMatch,reason:n.reason});const a=D2e(e,t);r.push({strategy:"Type Match",score:a.score,weight:up.dataTypeMatch,reason:a.reason});const i=I2e(e,t);r.push({strategy:"Pattern Match",score:i.score,weight:up.patternMatch,reason:i.reason});const s=R2e(e.headerName,t);r.push({strategy:"Semantic Match",score:s.score,weight:up.semanticMatch,reason:s.reason});const c=Math.round(r.reduce((d,f)=>d+f.score*f.weight,0));return{totalConfidence:c,scores:r,topMatch:c>=30?t.name:null}}function O2e(e,t){if(ut(e)===ut(t.name))return{score:100,reason:`Exact match: "${t.name}"`};if(ut(e)===ut(t.label))return{score:100,reason:`Exact match: "${t.label}"`};const r=v2e(e,t.name,[t.label,...t.aliases]);return{score:r.score,reason:r.reason}}function D2e(e,t){return e.inferredDataType===t.type?{score:100,reason:`Type match: ${t.type}`}:C2e(e.inferredDataType,t.type)?{score:70,reason:`Compatible type: ${e.inferredDataType}  ${t.type}`}:e.inferredDataType==="string"?{score:40,reason:"String can be converted"}:{score:0,reason:"Incompatible types"}}function I2e(e,t){if(t.patterns&&t.patterns.length>0){const r=e.sampleValues.map(a=>String(a));let n=0;for(const a of r)t.patterns.some(i=>i.test(a))&&n++;if(r.length>0){const a=n/r.length;if(a>=.8)return{score:100,reason:"Values match expected pattern"};if(a>=.5)return{score:70,reason:"Some values match pattern"}}}if(t.type==="date"&&e.detectedPatterns.some(r=>r.includes("date")))return{score:90,reason:"Date pattern detected"};if(t.type==="number"&&e.detectedPatterns.some(r=>["currency","percentage"].includes(r)))return{score:80,reason:"Numeric pattern detected"};if(t.type==="enum"&&t.enumValues&&e.possibleEnumValues){const r=e.possibleEnumValues.filter(n=>t.enumValues.some(a=>ut(String(n))===ut(a)));if(r.length>0){const n=r.length/e.possibleEnumValues.length;return{score:Math.round(n*100),reason:`${r.length} enum values match`}}}return{score:50,reason:"No specific pattern match"}}function R2e(e,t){if(!t.semanticTags||t.semanticTags.length===0)return{score:50,reason:"No semantic tags defined"};const r=ut(e),n={name:["name","title","label","identifier","id"],description:["desc","detail","about","summary","note"],date:["date","when","time","day","month","year"],start:["start","begin","from","kick","launch"],end:["end","finish","to","due","deadline","target"],budget:["budget","cost","amount","price","spend","money","dollar"],hours:["hour","time","effort","duration"],person:["owner","manager","assignee","responsible","lead","resource"],status:["status","state","phase","stage"],rag:["rag","health","traffic","light","color"],parent:["parent","linked","related","ref"],department:["dept","department","function","team","unit"],priority:["priority","urgent","important","level"],percentage:["percent","pct","progress","complete"],email:["email","mail","contact"]};for(const a of t.semanticTags){const i=n[a]||[];for(const s of i)if(r.includes(ut(s)))return{score:85,reason:`Contains "${s}" (${a})`}}for(const a of t.semanticTags)if(r.includes(ut(a)))return{score:70,reason:`Contains semantic tag "${a}"`};return{score:30,reason:"Weak semantic match"}}function iI(e,t,r,n){const a=[];for(const i of t){if(i.name===r||n.has(i.name))continue;const s=eB(e,i);s.totalConfidence>=30&&a.push({targetField:i.name,confidence:s.totalConfidence,reason:tB(s.scores)})}return a.sort((i,s)=>s.confidence-i.confidence).slice(0,3)}function tB(e){const t=e.filter(n=>n.score>=60);return t.length===0?"Low confidence match":t.reduce((n,a)=>a.score*a.weight>n.score*n.weight?a:n).reason}function M2e(e,t){if(e==null||e==="")return{value:void 0};switch(t){case"string":return c2(e);case"number":return P2e(e);case"date":return F2e(e);case"boolean":return L2e(e);case"enum":return c2(e);case"reference":return c2(e);default:return{value:String(e)}}}function c2(e){return typeof e=="string"?{value:e.trim()}:{value:String(e).trim()}}function P2e(e){if(typeof e=="number"&&!isNaN(e))return{value:e};const t=String(e).trim(),r=t.replace(/[$]/g,"").replace(/,/g,"").replace(/\s/g,"");if(t.endsWith("%")){const a=parseFloat(r);if(!isNaN(a))return{value:a}}const n=parseFloat(r);return isNaN(n)?{value:void 0,error:`Invalid number: "${e}"`}:{value:n}}function F2e(e){if(e instanceof Date)return isNaN(e.getTime())?{value:void 0,error:"Invalid date object"}:{value:Cu(e)};if(typeof e=="number")try{const s=H8.parse_date_code(e);if(s){const c=new Date(s.y,s.m-1,s.d);return{value:Cu(c)}}}catch{}const t=String(e).trim();if(/^\d{4}-\d{2}-\d{2}/.test(t)){const s=new Date(t);if(!isNaN(s.getTime()))return{value:Cu(s)}}const r=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);if(r){const[,s,c,d]=r,f=new Date(parseInt(d),parseInt(s)-1,parseInt(c));if(!isNaN(f.getTime()))return{value:Cu(f)}}const n=t.match(/^(\d{1,2})[./](\d{1,2})[./](\d{4})$/);if(n){const[,s,c,d]=n,f=new Date(parseInt(d),parseInt(c)-1,parseInt(s));if(!isNaN(f.getTime()))return{value:Cu(f)}}if(t.match(/\/(\d{2})$|\.(\d{2})$/))return{value:void 0,error:`Invalid date "${e}": Please use 4-digit year (e.g., 2025)`};const i=new Date(t);return isNaN(i.getTime())?{value:void 0,error:`Invalid date: "${e}"`}:{value:Cu(i),warning:"Date format may be ambiguous"}}function L2e(e){if(typeof e=="boolean")return{value:e};if(typeof e=="number")return{value:e!==0};const t=String(e).toLowerCase().trim(),r=["true","yes","y","1","on","x","checked"],n=["false","no","n","0","off","","unchecked"];return r.includes(t)?{value:!0}:n.includes(t)?{value:!1}:{value:!1,warning:`Unrecognized boolean value "${e}", defaulting to false`}}function Cu(e){const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}function B2e(e,t,r,n){const a=[],i=[],s=GI,c=H2e(r),d=twe(e);for(const b of d){if(!b.enabled)continue;const y=t.get(b.sheetName);if(!y||y.length===0){a.push(`Sheet "${b.sheetName}" has no data`);continue}const w=U2e(b,y,c,r,s);i.push(w),V2e(c,w,b.entityType)}const f=i.reduce((b,y)=>b+y.rowResults.length,0),h=i.reduce((b,y)=>b+y.validCount,0),p=i.reduce((b,y)=>b+y.errorCount,0);let g=h,v=p;if(s.fields.treatWarningsAsErrors){const b=i.reduce((y,w)=>y+w.rowResults.filter(j=>j.isValid&&j.warnings.length>0).length,0);g-=b,v+=b}return{isValid:a.length===0&&v===0,canProceed:a.length===0&&g>0,sheets:i,totalRows:f,validRows:g,errorRows:v,globalErrors:a}}function U2e(e,t,r,n,a){const i=Ok[e.entityType],s=[];for(let p=0;p<t.length;p++){const g=t[p],v=p+2;if(ewe(g))continue;const b=z2e(g,v,e,i,r,n,a);s.push(b)}const c=s.filter(p=>p.isValid).length,d=s.filter(p=>!p.isValid).length,f=s.reduce((p,g)=>p+g.warnings.length,0),h=s.filter(p=>p.duplicate).length;return{sheetName:e.sheetName,entityType:e.entityType,rowResults:s,validCount:c,errorCount:d,warningCount:f,duplicateCount:h}}function z2e(e,t,r,n,a,i,s){const c=[],d=[],f={};for(const v of r.columnMappings){if(!v.targetField)continue;const b=n.fields.find(w=>w.name===v.targetField);if(!b)continue;const y=e[v.sourceColumnIndex];$2e(y,b,f,c,d,s)}for(const v of n.fields)v.required&&(f[v.name]===void 0||f[v.name]==="")&&(v.defaultValue!==void 0?f[v.name]=v.defaultValue:c.push({field:v.name,fieldLabel:v.label,message:`Required field "${v.label}" is empty`,value:null}));const h=r.entityType,p=s.fields.additionalRequired[h]||[];for(const v of p)if(f[v]===void 0||f[v]===""){const b=n.fields.find(y=>y.name===v);c.push({field:v,fieldLabel:b?.label||v,message:`Field "${b?.label||v}" is required by import policy`,value:null})}for(const v of n.fields.filter(b=>b.type==="reference")){const b=f[v.name];if(b===void 0||b==="")continue;const y=G2e(String(b),v.referenceType,a,s.references);y?f[v.name]=y:c.push({field:v.name,fieldLabel:v.label,message:`Cannot find ${v.referenceType} named "${b}"`,value:b})}W2e(r.entityType,f,c,d,i,s);const g=Z2e(r.entityType,f,i,s.references.fuzzyMatchThreshold);return c.length===0&&(f.id=No(),r.entityType==="project"&&J2e(f,i)),{rowNumber:t,isValid:c.length===0,errors:c,warnings:d,transformedData:f,rawData:e,duplicate:g}}function $2e(e,t,r,n,a,i){if(e==null||e===""){t.defaultValue!==void 0&&(r[t.name]=t.defaultValue);return}const s=M2e(e,t.type);if(s.error){n.push({field:t.name,fieldLabel:t.label,message:s.error,value:e});return}if(s.warning&&a.push({field:t.name,fieldLabel:t.label,message:s.warning,value:e}),t.type==="enum"&&t.enumValues){const c=ut(String(s.value)),d=t.enumValues.find(f=>ut(f)===c);if(d)r[t.name]=d;else{const{allowFuzzyMatching:f,fuzzyMatchThreshold:h}=i.references,p=f?Dk(String(s.value),t.enumValues):null;p&&p.score>=h?(r[t.name]=t.enumValues[p.index],a.push({field:t.name,fieldLabel:t.label,message:`Value "${e}" matched to "${t.enumValues[p.index]}" (${p.score}% confidence)`,value:e})):t.defaultValue!==void 0?(r[t.name]=t.defaultValue,a.push({field:t.name,fieldLabel:t.label,message:`Invalid value "${e}", using default "${t.defaultValue}"`,value:e})):n.push({field:t.name,fieldLabel:t.label,message:`Invalid value "${e}". Expected: ${t.enumValues.join(", ")}`,value:e})}return}if(t.patterns&&t.patterns.length>0){const c=String(s.value);t.patterns.some(f=>f.test(c))||a.push({field:t.name,fieldLabel:t.label,message:`Value "${c}" doesn't match expected pattern`,value:e})}r[t.name]=s.value}function H2e(e){const t=new Map,r=new Map;for(const f of e.pillars)r.set(ut(f.name),f.id);t.set("pillar",r);const n=new Map;for(const f of e.initiatives)n.set(ut(f.name),f.id);t.set("initiative",n);const a=new Map;for(const f of e.projects)a.set(ut(f.name),f.id);t.set("project",a);const i=new Map;for(const f of e.resources)i.set(ut(f.name),f.id);t.set("resource",i);const s=new Map;for(const f of e.kpis)s.set(ut(f.name),f.id);t.set("kpi",s);const c=new Map;for(const f of e.tasks)c.set(ut(f.title),f.id);t.set("task",c);const d=new Map;for(const f of e.milestones||[])d.set(ut(f.name),f.id);return t.set("milestone",d),t}function V2e(e,t,r){const n=e.get(r)||new Map;for(const a of t.rowResults)if(a.isValid){const i=r==="task"?"title":"name",s=a.transformedData[i],c=a.transformedData.id;s&&c&&n.set(ut(String(s)),String(c))}e.set(r,n)}function G2e(e,t,r,n){const a=r.get(t);if(!a)return null;const i=ut(e);if(a.has(i))return a.get(i);if(!n.allowFuzzyMatching)return null;const s=Array.from(a.entries()),c=s.map(([f])=>f),d=Dk(i,c);if(d&&d.score>=n.fuzzyMatchThreshold)return s[d.index][1];for(const[f,h]of s)if(f.includes(i)||i.includes(f))return h;return null}function W2e(e,t,r,n,a,i){switch(e){case"project":q2e(t,r,n,i.businessRules);break;case"task":K2e(t,r,n,i.businessRules);break;case"initiative":Y2e(t,r,n,i.businessRules);break;case"milestone":X2e(t,r,n);break}}function q2e(e,t,r,n){if(n.enforceProjectDateRange&&e.startDate&&e.endDate&&new Date(String(e.startDate))>new Date(String(e.endDate))&&t.push({field:"dates",fieldLabel:"Dates",message:"Start date must be before end date",value:`${e.startDate} - ${e.endDate}`}),n.enforceBudgetPositive&&e.budget!==void 0&&Number(e.budget)<0&&t.push({field:"budget",fieldLabel:"Budget",message:"Budget cannot be negative",value:e.budget}),n.enforceCompletionRange&&e.completionPercentage!==void 0){const a=Number(e.completionPercentage);(a<0||a>100)&&(r.push({field:"completionPercentage",fieldLabel:"Completion %",message:"Completion percentage should be between 0 and 100",value:e.completionPercentage}),e.completionPercentage=Math.max(0,Math.min(100,a)))}}function K2e(e,t,r,n){if(e.dueDate){const a=new Date(String(e.dueDate)),i=new Date(a.getFullYear(),a.getMonth(),a.getDate()),s=new Date;s.setHours(0,0,0,0),i<s&&(n.rejectOverdueTasks?t.push({field:"dueDate",fieldLabel:"Due Date",message:"Due date is in the past (overdue tasks rejected by policy)",value:e.dueDate}):r.push({field:"dueDate",fieldLabel:"Due Date",message:"Due date is in the past",value:e.dueDate}))}e.estimatedHours!==void 0&&Number(e.estimatedHours)<0&&(e.estimatedHours=0,r.push({field:"estimatedHours",fieldLabel:"Estimated Hours",message:"Hours adjusted to 0 (was negative)",value:e.estimatedHours}))}function Y2e(e,t,r,n){e.budget&&e.spentBudget&&Number(e.spentBudget)>Number(e.budget)&&(n.rejectOverBudgetInitiatives?t.push({field:"spentBudget",fieldLabel:"Spent Budget",message:"Spent budget exceeds allocated budget (rejected by policy)",value:e.spentBudget}):r.push({field:"spentBudget",fieldLabel:"Spent Budget",message:"Spent budget exceeds allocated budget",value:e.spentBudget}))}function X2e(e,t,r){e.completedDate&&e.targetDate&&new Date(String(e.completedDate))>new Date(String(e.targetDate))&&r.push({field:"completedDate",fieldLabel:"Completed Date",message:"Milestone was completed after target date",value:e.completedDate})}function Z2e(e,t,r,n){const a=e==="task"?"title":"name",i=t[a];if(!i)return;const s=Q2e(e,r);if(s.length===0)return;const c=ut(i);for(const h of s){const p=h[a];if(ut(p)===c)return{existingId:h.id,existingName:p,confidence:100,matchType:"exact"}}const d=s.map(h=>h[a]),f=Dk(i,d);if(f&&f.score>=n)return{existingId:s[f.index].id,existingName:d[f.index],confidence:f.score,matchType:"fuzzy"}}function Q2e(e,t){switch(e){case"pillar":return t.pillars;case"kpi":return t.kpis;case"initiative":return t.initiatives;case"project":return t.projects;case"task":return t.tasks;case"resource":return t.resources;case"milestone":return t.milestones||[];default:return[]}}function J2e(e,t){const r=e.departmentCode||"IT",n=e.category||"GROW",a=e.fiscalYear||new Date().getFullYear(),i=_w(t.projects,r,a,n),s=kw(r,a,n,i);e.sequenceNumber=i,e.workId=s}function ewe(e){return e.every(t=>t==null||t==="")}function twe(e){const t=["pillar","resource","kpi","initiative","project","task","milestone"];return[...e].sort((r,n)=>t.indexOf(r.entityType)-t.indexOf(n.entityType))}const u2={currentStep:"upload",file:null,workbook:null,sheetConfigs:[],mappingSuggestions:new Map,validationResult:null,importResult:null,isProcessing:!1,error:null},d2=["upload","sheets","spreadsheet","preview","import"];function rwe({currentState:e,onImportComplete:t}){const[r,n]=k.useState(u2),[a,i]=k.useState(null),s=k.useMemo(()=>d2.indexOf(r.currentStep),[r.currentStep]),c=s>0&&r.currentStep!=="import",d=k.useMemo(()=>{switch(r.currentStep){case"upload":return r.workbook!==null;case"sheets":return r.sheetConfigs.some(N=>N.enabled);case"spreadsheet":return r.sheetConfigs.some(N=>N.enabled);case"preview":return r.validationResult?.canProceed===!0;default:return!1}},[r]),f=k.useCallback(()=>{c&&n(N=>({...N,currentStep:d2[s-1],error:null}))},[c,s]),h=k.useCallback(async()=>{if(!d)return;const N=d2[s+1];if(r.currentStep==="spreadsheet"&&N==="preview"){n(C=>({...C,isProcessing:!0,error:null}));try{const C=new Map,E=r.sheetConfigs.filter(A=>A.enabled);for(const A of E)if(a){const D=o2(a,A.sheetName);C.set(A.sheetName,D)}const O=B2e(E,C,e);n(A=>({...A,currentStep:N,validationResult:O,isProcessing:!1}))}catch(C){n(E=>({...E,isProcessing:!1,error:`Validation failed: ${C}`}))}}else n(C=>({...C,currentStep:N,error:null}))},[d,s,r.currentStep,r.sheetConfigs,a,e]),p=k.useCallback(async N=>{n(C=>({...C,isProcessing:!0,error:null,file:N}));try{const[C,E]=await Promise.all([y2e(N),S2e(N)]);i(E);const A=C.sheets.filter(N2e).map(D=>({sheetName:D.sheetName,entityType:D.suggestedEntityType||"task",columnMappings:[],skipRows:0,enabled:D.suggestedEntityType!==null}));n(D=>({...D,workbook:C,sheetConfigs:A,isProcessing:!1,error:C.parseErrors.length>0?C.parseErrors.join("; "):null}))}catch(C){n(E=>({...E,isProcessing:!1,error:`Failed to parse file: ${C}`}))}},[]),g=k.useCallback(()=>{n(u2),i(null)},[]),v=k.useCallback((N,C)=>{n(E=>{const O=E.sheetConfigs.map(A=>A.sheetName===N?{...A,...C}:A);return{...E,sheetConfigs:O}})},[]),b=k.useCallback((N,C)=>{const E=r.workbook?.sheets.find(P=>P.sheetName===N);if(!E||!a)return;const O=o2(a,N),A=k2e(E.headers,O.slice(0,10)),D=A2e(A,C),M=D.map(P=>({sourceColumnIndex:P.sourceColumnIndex,sourceColumnName:P.sourceColumnName,targetField:P.confidence>=50?P.targetField:null}));n(P=>{const R=new Map(P.mappingSuggestions);R.set(N,D);const L=P.sheetConfigs.map(te=>te.sheetName===N?{...te,entityType:C,columnMappings:M}:te);return{...P,sheetConfigs:L,mappingSuggestions:R}})},[r.workbook,a]),y=k.useCallback((N,C,E)=>{n(O=>{const A=O.sheetConfigs.map(D=>{if(D.sheetName!==N)return D;const M=D.columnMappings.map(P=>P.sourceColumnIndex===C?{...P,targetField:E}:P);return{...D,columnMappings:M}});return{...O,sheetConfigs:A}})},[]),w=k.useCallback(async N=>{if(!r.validationResult?.canProceed)return;n(O=>({...O,isProcessing:!0,currentStep:"import"}));const C=Date.now(),E={success:!0,sheets:[],totalAttempted:0,totalSuccessful:0,totalFailed:0,duration:0};try{for(const O of r.validationResult.sheets){const A={sheetName:O.sheetName,entityType:O.entityType,attempted:0,successful:0,failed:0,results:[]};for(const D of O.rowResults){if(!D.isValid){A.failed++,A.results.push({rowNumber:D.rowNumber,success:!1,error:D.errors[0]?.message});continue}A.attempted++;try{const M=nwe(O.entityType);N({type:M,payload:D.transformedData}),A.successful++,A.results.push({rowNumber:D.rowNumber,success:!0,entityId:D.transformedData.id})}catch(M){A.failed++,A.results.push({rowNumber:D.rowNumber,success:!1,error:String(M)})}}E.sheets.push(A),E.totalAttempted+=A.attempted,E.totalSuccessful+=A.successful,E.totalFailed+=A.failed}E.duration=Date.now()-C,E.success=E.totalFailed===0,n(O=>({...O,importResult:E,isProcessing:!1})),t(E)}catch(O){E.success=!1,E.duration=Date.now()-C,n(A=>({...A,importResult:E,isProcessing:!1,error:`Import failed: ${O}`}))}},[r.validationResult,t]),j=k.useCallback(()=>{n(u2),i(null)},[]),T=k.useCallback(N=>a?o2(a,N):[],[a]);return{state:r,canGoBack:c,canGoNext:d,goBack:f,goNext:h,handleFileSelect:p,clearFile:g,updateSheetConfig:v,setSheetEntityType:b,updateColumnMapping:y,executeImport:w,reset:j,getSheetData:T}}function nwe(e){return{pillar:"ADD_PILLAR",kpi:"ADD_KPI",initiative:"ADD_INITIATIVE",project:"ADD_PROJECT",task:"ADD_TASK",resource:"ADD_RESOURCE",milestone:"ADD_MILESTONE"}[e]}const awe=({file:e,isProcessing:t,onFileSelect:r,onClear:n})=>{const a=k.useRef(null),i=k.useCallback(d=>{d.preventDefault();const f=d.dataTransfer.files[0];f&&iwe(f)&&r(f)},[r]),s=k.useCallback(d=>{d.preventDefault()},[]),c=k.useCallback(d=>{const f=d.target.files?.[0];f&&r(f)},[r]);return o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"}),o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Smart Import"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Upload any Excel file and our AI will automatically detect entity types and map columns to the correct fields. No rigid template required."})]}),o.jsxs("div",{onDrop:i,onDragOver:s,className:`
          border-2 border-dashed rounded-lg p-8 text-center transition-all
          ${e?"border-accent-blue bg-accent-blue/5":"border-border hover:border-accent-blue/50 hover:bg-bg-hover/50"}
          ${t?"opacity-50 pointer-events-none":""}
        `,children:[e?o.jsxs("div",{className:"flex items-center justify-center gap-4",children:[o.jsx(ho,{className:"w-10 h-10 text-accent-blue"}),o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"font-medium text-text-primary",children:e.name}),o.jsxs("p",{className:"text-sm text-text-muted",children:[(e.size/1024).toFixed(1)," KB"]})]}),!t&&o.jsx("button",{onClick:n,className:"p-2 text-text-muted hover:text-text-primary transition-colors",children:o.jsx(B0,{className:"w-5 h-5"})})]}):o.jsxs(o.Fragment,{children:[o.jsx(od,{className:"w-12 h-12 text-text-muted mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium text-text-primary mb-2",children:"Drop your Excel file here"}),o.jsx("p",{className:"text-sm text-text-secondary mb-4",children:"Supports .xlsx and .xls files"}),o.jsx("input",{ref:a,type:"file",accept:".xlsx,.xls",onChange:c,className:"hidden"}),o.jsx(Xe,{onClick:()=>a.current?.click(),children:"Select File"})]}),t&&o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-accent-blue border-t-transparent rounded-full mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Analyzing file structure..."})]})]}),o.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-3 gap-4",children:[o.jsx(f2,{title:"Auto-Detection",description:"Automatically detects entity types from sheet names and column headers"}),o.jsx(f2,{title:"Smart Mapping",description:"AI suggests column-to-field mappings with confidence scores"}),o.jsx(f2,{title:"Validation",description:"Validates data and references before import with detailed feedback"})]})]})},f2=({title:e,description:t})=>o.jsxs("div",{className:"p-4 bg-bg-hover rounded-lg",children:[o.jsx("h4",{className:"font-medium text-text-primary text-sm mb-1",children:e}),o.jsx("p",{className:"text-xs text-text-muted",children:t})]});function iwe(e){return["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(e.type)||/\.xlsx?$/i.test(e.name)}const swe={pillar:o.jsx(gr,{className:"w-4 h-4"}),kpi:o.jsx(Vu,{className:"w-4 h-4"}),initiative:o.jsx(mc,{className:"w-4 h-4"}),project:o.jsx(Ai,{className:"w-4 h-4"}),task:o.jsx(n5,{className:"w-4 h-4"}),resource:o.jsx(ri,{className:"w-4 h-4"}),milestone:o.jsx(ys,{className:"w-4 h-4"})},lwe=["pillar","kpi","initiative","project","task","resource","milestone"],owe=({workbook:e,sheetConfigs:t,onToggleSheet:r,onSetEntityType:n})=>o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-2",children:"Select Sheets to Import"}),o.jsxs("p",{className:"text-sm text-text-secondary",children:["We detected ",e.sheets.length," sheets in your file. Select which ones to import and verify the entity type for each."]})]}),o.jsx("div",{className:"space-y-3",children:e.sheets.map(a=>{const i=t.find(d=>d.sheetName===a.sheetName),s=i?.enabled??!1,c=i?.entityType??"task";return o.jsxs("div",{className:`
                p-4 rounded-lg border transition-all
                ${s?"border-accent-blue bg-accent-blue/5":"border-border bg-bg-hover/50"}
              `,children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("button",{onClick:()=>r(a.sheetName,!s),className:`
                    mt-0.5 w-5 h-5 rounded border-2 flex items-center justify-center
                    transition-colors
                    ${s?"bg-accent-blue border-accent-blue text-white":"border-border hover:border-accent-blue/50"}
                  `,children:s&&o.jsx(Zf,{className:"w-3 h-3"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(ho,{className:"w-4 h-4 text-text-muted"}),o.jsx("span",{className:"font-medium text-text-primary truncate",children:a.sheetName}),o.jsxs("span",{className:"text-xs text-text-muted",children:["(",a.rowCount," rows, ",a.columnCount," columns)"]})]}),o.jsxs("p",{className:"text-xs text-text-muted mb-3 truncate",children:["Columns: ",a.headers.slice(0,5).join(", "),a.headers.length>5&&` +${a.headers.length-5} more`]}),a.suggestedEntityType&&a.entityConfidence>0&&o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Detected:"}),o.jsxs("span",{className:`
                          text-xs px-2 py-0.5 rounded-full
                          ${a.entityConfidence>=70?"bg-rag-green/20 text-rag-green":a.entityConfidence>=40?"bg-rag-amber/20 text-rag-amber":"bg-text-muted/20 text-text-muted"}
                        `,children:[O0[a.suggestedEntityType]," (",a.entityConfidence,"%)"]})]}),s&&o.jsx("div",{className:"flex flex-wrap gap-2",children:lwe.map(d=>o.jsxs("button",{onClick:()=>n(a.sheetName,d),className:`
                            flex items-center gap-1.5 px-2.5 py-1.5 rounded-lg text-xs
                            transition-colors
                            ${c===d?"bg-accent-blue text-white":"bg-bg-card hover:bg-bg-hover text-text-secondary"}
                          `,children:[swe[d],O0[d]]},d))})]})]}),s&&a.entityMatchReasons.length>0&&o.jsx("div",{className:"mt-3 pt-3 border-t border-border",children:o.jsx("p",{className:"text-xs text-text-muted",children:a.entityMatchReasons.slice(0,3).join("  ")})})]},a.sheetName)})}),e.sheets.length===0&&o.jsxs("div",{className:"text-center py-8",children:[o.jsx(_n,{className:"w-12 h-12 text-text-muted mx-auto mb-4"}),o.jsx("p",{className:"text-text-secondary",children:"No data sheets found in the file"})]}),t.filter(a=>a.enabled).length>0&&o.jsx("div",{className:"mt-6 p-4 bg-bg-hover rounded-lg",children:o.jsxs("p",{className:"text-sm text-text-secondary",children:[o.jsx("span",{className:"font-medium text-text-primary",children:t.filter(a=>a.enabled).length})," ","sheet(s) selected for import"]})})]}),cwe=()=>Math.random().toString(36).substring(2,9),Ws=(e,t)=>`${e}:${t}`,sI=e=>{const[t,r]=e.split(":").map(Number);return{row:t,col:r}},uwe=e=>{let t="",r=e;for(;r>=0;)t=String.fromCharCode(r%26+65)+t,r=Math.floor(r/26)-1;return t};function dwe({initialData:e,sheetName:t,entityType:r}){const[n,a]=k.useState(e),[i,s]=k.useState(new Set),[c,d]=k.useState([]),[f,h]=k.useState(null),[p,g]=k.useState(null),v=k.useMemo(()=>{if(i.size===0)return null;let R=1/0,L=-1/0,te=1/0,ee=-1/0;return i.forEach(ue=>{const{row:V,col:K}=sI(ue);R=Math.min(R,V),L=Math.max(L,V),te=Math.min(te,K),ee=Math.max(ee,K)}),{minRow:R,maxRow:L,minCol:te,maxCol:ee}},[i]),b=i.size,y=k.useCallback((R,L)=>i.has(Ws(R,L)),[i]),w=k.useCallback((R,L,te)=>{const ee=Ws(R,L);if(te==="single")s(new Set([ee])),g({row:R,col:L});else if(te==="add")s(ue=>{const V=new Set(ue);return V.has(ee)?V.delete(ee):V.add(ee),V}),g({row:R,col:L});else if(te==="range"&&p){const ue=Math.min(p.row,R),V=Math.max(p.row,R),K=Math.min(p.col,L),ie=Math.max(p.col,L),re=new Set;for(let me=ue;me<=V;me++)for(let W=K;W<=ie;W++)re.add(Ws(me,W));s(re)}},[p]),j=k.useCallback((R,L,te,ee)=>{const ue=Math.min(R,te),V=Math.max(R,te),K=Math.min(L,ee),ie=Math.max(L,ee),re=new Set;for(let me=ue;me<=V;me++)for(let W=K;W<=ie;W++)re.add(Ws(me,W));s(re),g({row:R,col:L})},[]),T=k.useCallback(R=>{const L=new Set;for(let te=0;te<n.length;te++)L.add(Ws(te,R));s(L)},[n.length]),N=k.useCallback(R=>{if(!n[R])return;const L=new Set;for(let te=0;te<n[R].length;te++)L.add(Ws(R,te));s(L)},[n]),C=k.useCallback(()=>{s(new Set),g(null)},[]),E=k.useCallback(R=>{if(i.size===0)return;const L=Array.from(i),te=new Set(L.map(ue=>sI(ue).col)),ee=te.size===1?Array.from(te)[0]:void 0;d(ue=>[...ue.filter(K=>!K.cells.some(re=>i.has(re))),{id:cwe(),cells:L,label:R,columnIndex:ee}]),C()},[i,C]),O=k.useCallback(R=>{d(L=>L.filter(te=>te.id!==R))},[]),A=k.useCallback((R,L)=>{const te=Ws(R,L);return c.find(ee=>ee.cells.includes(te))},[c]),D=k.useCallback((R,L)=>{h(Ws(R,L))},[]),M=k.useCallback(()=>{h(null)},[]),P=k.useCallback((R,L,te)=>{a(ee=>{const ue=ee.map(V=>[...V]);return ue[R]&&(ue[R][L]=te),ue})},[]);return{selectedCells:i,mappings:c,editingCell:f,data:n,selectCell:w,selectRange:j,selectColumn:T,selectRow:N,clearSelection:C,isSelected:y,assignLabel:E,removeMapping:O,getMappingForCell:A,startEditing:D,stopEditing:M,updateCellValue:P,selectionBounds:v,selectionCount:b}}const fwe=({entityType:e,appState:t,selectedLabel:r,onSelectLabel:n,selectionCount:a,onAssign:i})=>{const[s,c]=k.useState(new Set(["fields","references"])),d=k.useMemo(()=>{const p=[],v=Ok[e].fields.map(y=>({id:`field:${y.name}`,name:y.name,displayName:y.label,type:"field",category:"Entity Fields",required:y.required,dataType:y.type,enumValues:y.enumValues}));p.push({id:"fields",name:"Entity Fields",icon:o.jsx(HH,{className:"w-4 h-4"}),labels:v});const b=[];return t.pillars.length>0&&b.push({id:"ref:pillars",name:"Strategy Pillars",icon:o.jsx(gr,{className:"w-4 h-4"}),labels:t.pillars.map(y=>({id:`ref:pillar:${y.id}`,name:y.name,displayName:y.name,type:"reference",category:"Strategy Pillars"}))}),t.initiatives.length>0&&b.push({id:"ref:initiatives",name:"Initiatives",icon:o.jsx(Wu,{className:"w-4 h-4"}),labels:t.initiatives.map(y=>({id:`ref:initiative:${y.id}`,name:y.name,displayName:y.name,type:"reference",category:"Initiatives"}))}),t.projects.length>0&&b.push({id:"ref:projects",name:"Projects",icon:o.jsx(mc,{className:"w-4 h-4"}),labels:t.projects.map(y=>({id:`ref:project:${y.id}`,name:y.name,displayName:y.name,type:"reference",category:"Projects"}))}),t.resources.length>0&&b.push({id:"ref:resources",name:"Resources",icon:o.jsx(ri,{className:"w-4 h-4"}),labels:t.resources.map(y=>({id:`ref:resource:${y.id}`,name:y.name,displayName:`${y.name} (${y.role})`,type:"reference",category:"Resources"}))}),b.push({id:"ref:departments",name:"Departments",icon:o.jsx(Np,{className:"w-4 h-4"}),labels:Object.values(Un).map(y=>({id:`ref:dept:${y.code}`,name:y.code,displayName:y.name,type:"reference",category:"Departments"}))}),b.push({id:"ref:ragstatus",name:"RAG Status",icon:o.jsx(ys,{className:"w-4 h-4"}),labels:["green","amber","red"].map(y=>({id:`ref:rag:${y}`,name:y,displayName:y.charAt(0).toUpperCase()+y.slice(1),type:"reference",category:"RAG Status"}))}),b.push({id:"ref:taskstatus",name:"Task Status",icon:o.jsx(dH,{className:"w-4 h-4"}),labels:[{id:"todo",name:"Todo"},{id:"in_progress",name:"In Progress"},{id:"blocked",name:"Blocked"},{id:"done",name:"Done"}].map(y=>({id:`ref:taskstatus:${y.id}`,name:y.id,displayName:y.name,type:"reference",category:"Task Status"}))}),b.push({id:"ref:projectstatus",name:"Project Status",icon:o.jsx(mc,{className:"w-4 h-4"}),labels:[{id:"not_started",name:"Not Started"},{id:"in_progress",name:"In Progress"},{id:"on_hold",name:"On Hold"},{id:"completed",name:"Completed"},{id:"cancelled",name:"Cancelled"}].map(y=>({id:`ref:projectstatus:${y.id}`,name:y.id,displayName:y.name,type:"reference",category:"Project Status"}))}),b.forEach(y=>p.push(y)),p},[e,t]),f=p=>{c(g=>{const v=new Set(g);return v.has(p)?v.delete(p):v.add(p),v})},h=p=>{switch(p){case"string":return"Aa";case"number":return"#";case"date":return"";case"boolean":return"";case"enum":return"";case"reference":return"";default:return""}};return o.jsxs("div",{className:"h-full flex flex-col bg-bg-card border-l border-border",children:[o.jsxs("div",{className:"p-4 border-b border-border",children:[o.jsx("h3",{className:"text-sm font-semibold text-text-primary mb-1",children:"Assign Label"}),o.jsx("p",{className:"text-xs text-text-muted",children:a>0?`${a} cell${a>1?"s":""} selected`:"Select cells to assign a label"})]}),o.jsx("div",{className:"flex-1 overflow-y-auto",children:d.map(p=>o.jsxs("div",{className:"border-b border-border/50",children:[o.jsxs("button",{onClick:()=>f(p.id),className:"w-full flex items-center gap-2 px-4 py-2 hover:bg-bg-hover transition-colors",children:[s.has(p.id)?o.jsx(Ra,{className:"w-4 h-4 text-text-muted"}):o.jsx(ha,{className:"w-4 h-4 text-text-muted"}),p.icon,o.jsx("span",{className:"text-sm font-medium text-text-primary flex-1 text-left",children:p.name}),o.jsx("span",{className:"text-xs text-text-muted",children:p.labels.length})]}),s.has(p.id)&&o.jsx("div",{className:"pb-2",children:p.labels.map(g=>o.jsxs("button",{onClick:()=>n(g),className:`
                      w-full flex items-center gap-2 px-6 py-1.5 text-left transition-colors
                      ${r?.id===g.id?"bg-accent-blue/20 text-accent-blue":"hover:bg-bg-hover text-text-secondary hover:text-text-primary"}
                    `,children:[g.type==="field"&&o.jsx("span",{className:"text-xs font-mono text-text-muted w-4",children:h(g.dataType)}),o.jsx("span",{className:"text-sm flex-1 truncate",children:g.displayName}),g.required&&o.jsx("span",{className:"text-rag-red text-xs",children:"*"})]},g.id))})]},p.id))}),o.jsx("div",{className:"p-4 border-t border-border",children:o.jsx("button",{onClick:i,disabled:!r||a===0,className:`
            w-full py-2 px-4 rounded-lg text-sm font-medium transition-colors
            ${r&&a>0?"bg-accent-blue text-white hover:bg-accent-blue/90":"bg-bg-hover text-text-muted cursor-not-allowed"}
          `,children:r&&a>0?`Assign "${r.displayName}"`:"Select cells and label"})})]})},lI=["bg-accent-blue/20 border-accent-blue","bg-accent-purple/20 border-accent-purple","bg-rag-green/20 border-rag-green","bg-rag-amber/20 border-rag-amber","bg-accent-teal/20 border-accent-teal","bg-rag-red/20 border-rag-red","bg-pink-500/20 border-pink-500","bg-cyan-500/20 border-cyan-500"],hwe=({sheetName:e,sheetData:t,entityType:r,onEntityTypeChange:n,appState:a,onMappingsChange:i})=>{const[s,c]=k.useState(null),[d,f]=k.useState(!1),[h,p]=k.useState(null),g=k.useRef(null),{mappings:v,editingCell:b,data:y,selectCell:w,selectRange:j,selectColumn:T,selectRow:N,clearSelection:C,isSelected:E,assignLabel:O,removeMapping:A,getMappingForCell:D,startEditing:M,stopEditing:P,updateCellValue:R,selectionCount:L}=dwe({initialData:t,sheetName:e,entityType:r});k.useEffect(()=>{i(v)},[v,i]);const te=k.useCallback(me=>{const W=v.findIndex(F=>F.id===me);return lI[W%lI.length]},[v]),ee=k.useCallback((me,W,F)=>{F.shiftKey?w(me,W,"range"):F.metaKey||F.ctrlKey?w(me,W,"add"):w(me,W,"single")},[w]),ue=k.useCallback((me,W)=>{M(me,W)},[M]),V=k.useCallback((me,W,F)=>{F.button===0&&(f(!0),p({row:me,col:W}),!F.shiftKey&&!F.metaKey&&!F.ctrlKey&&w(me,W,"single"))},[w]),K=k.useCallback((me,W)=>{d&&h&&j(h.row,h.col,me,W)},[d,h,j]);k.useEffect(()=>{const me=()=>{f(!1),p(null)};return window.addEventListener("mouseup",me),()=>window.removeEventListener("mouseup",me)},[]),k.useEffect(()=>{const me=W=>{if(b){W.key==="Escape"&&P();return}W.key==="Escape"&&C()};return window.addEventListener("keydown",me),()=>window.removeEventListener("keydown",me)},[b,P,C]);const ie=k.useCallback(()=>{s&&(O(s),c(null))},[s,O]),re=k.useMemo(()=>Math.max(...y.map(me=>me.length),0),[y]);return o.jsxs("div",{className:"h-full flex flex-col",children:[o.jsxs("div",{className:"px-6 py-4 border-b border-border",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:e}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-sm text-text-muted",children:"Import as:"}),o.jsxs("div",{className:"relative",children:[o.jsx("select",{value:r,onChange:me=>n(me.target.value),className:"appearance-none bg-bg-card border border-border rounded-lg px-3 py-1.5 pr-8 text-sm text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-blue",children:Object.entries(O0).map(([me,W])=>o.jsx("option",{value:me,children:W},me))}),o.jsx(Ra,{className:"absolute right-2 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})]})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Select cells and assign labels from the sidebar. Click to select, drag to select range, Ctrl/Cmd+click to add to selection."})]}),o.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[o.jsx("div",{className:"flex-1 overflow-auto",ref:g,children:o.jsxs("table",{className:"border-collapse min-w-full",children:[o.jsx("thead",{className:"sticky top-0 z-10",children:o.jsxs("tr",{children:[o.jsx("th",{className:"bg-bg-hover border border-border w-12 h-8 text-xs text-text-muted"}),Array.from({length:re}).map((me,W)=>o.jsx("th",{onClick:()=>T(W),className:"bg-bg-hover border border-border min-w-[100px] h-8 text-xs font-medium text-text-muted cursor-pointer hover:bg-bg-card",children:uwe(W)},W))]})}),o.jsx("tbody",{children:y.map((me,W)=>o.jsxs("tr",{children:[o.jsx("td",{onClick:()=>N(W),className:"bg-bg-hover border border-border w-12 h-8 text-xs text-text-muted text-center font-medium cursor-pointer hover:bg-bg-card sticky left-0 z-5",children:W+1}),Array.from({length:re}).map((F,X)=>{const q=me[X],U=Ws(W,X),G=E(W,X),le=D(W,X),de=b===U,ne=le?te(le.id):"";return o.jsxs("td",{onClick:oe=>ee(W,X,oe),onDoubleClick:()=>ue(W,X),onMouseDown:oe=>V(W,X,oe),onMouseEnter:()=>K(W,X),className:`
                          border border-border min-w-[100px] h-8 text-sm transition-colors relative
                          ${G?"bg-accent-blue/30 border-accent-blue":le?ne:"bg-bg-card hover:bg-bg-hover"}
                          ${de?"p-0":"px-2"}
                        `,children:[de?o.jsx(mwe,{value:q,onSave:oe=>{R(W,X,oe),P()},onCancel:P}):o.jsx("span",{className:"truncate block",children:rB(q)}),le&&!G&&o.jsx("span",{className:"absolute top-0 right-0 text-[8px] px-1 bg-bg-hover text-text-muted",children:le.label.displayName.slice(0,8)})]},X)})]},W))})]})}),o.jsx("div",{className:"w-64 flex-shrink-0",children:o.jsx(fwe,{entityType:r,appState:a,selectedLabel:s,onSelectLabel:c,selectionCount:L,onAssign:ie})})]}),v.length>0&&o.jsxs("div",{className:"px-6 py-3 border-t border-border bg-bg-hover",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(nH,{className:"w-4 h-4 text-text-muted"}),o.jsxs("span",{className:"text-sm font-medium text-text-primary",children:["Current Mappings (",v.length,")"]})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:v.map(me=>o.jsxs("div",{className:`
                  flex items-center gap-2 px-2 py-1 rounded border text-sm
                  ${te(me.id)}
                `,children:[o.jsx("span",{className:"font-medium",children:me.label.displayName}),o.jsxs("span",{className:"text-text-muted",children:["(",me.cells.length," cell",me.cells.length>1?"s":"",")"]}),o.jsx("button",{onClick:()=>A(me.id),className:"text-text-muted hover:text-rag-red transition-colors",children:o.jsx(B0,{className:"w-3 h-3"})})]},me.id))})]})]})},mwe=({value:e,onSave:t,onCancel:r})=>{const[n,a]=k.useState(rB(e)),i=k.useRef(null);k.useEffect(()=>{i.current?.focus(),i.current?.select()},[]);const s=c=>{c.key==="Enter"?t(n):c.key==="Escape"&&r()};return o.jsx("input",{ref:i,type:"text",value:n,onChange:c=>a(c.target.value),onKeyDown:s,onBlur:()=>t(n),className:"w-full h-full px-2 bg-white text-text-primary outline-none border-2 border-accent-blue"})};function rB(e){return e==null?"":typeof e=="boolean"?e?"TRUE":"FALSE":typeof e=="number"?e>25569&&e<1e5?new Date((e-25569)*86400*1e3).toLocaleDateString():e.toLocaleString():e instanceof Date?e.toLocaleDateString():String(e)}const pwe=({validationResult:e})=>o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-2",children:"Review & Import"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Review the validation results before importing. Fix any errors to proceed."})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[o.jsx(h2,{label:"Total Rows",value:e.totalRows,icon:o.jsx(ho,{className:"w-5 h-5"}),variant:"neutral"}),o.jsx(h2,{label:"Valid Rows",value:e.validRows,icon:o.jsx(yr,{className:"w-5 h-5"}),variant:"success"}),o.jsx(h2,{label:"Errors",value:e.errorRows,icon:o.jsx(_n,{className:"w-5 h-5"}),variant:e.errorRows>0?"error":"neutral"})]}),e.globalErrors.length>0&&o.jsxs("div",{className:"mb-6 p-4 bg-rag-red/10 border border-rag-red/30 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 text-rag-red font-medium mb-2",children:[o.jsx(_n,{className:"w-5 h-5"}),"Global Errors"]}),o.jsx("ul",{className:"space-y-1",children:e.globalErrors.map((t,r)=>o.jsxs("li",{className:"text-sm text-text-primary",children:[" ",t]},r))})]}),o.jsx("div",{className:"space-y-4",children:e.sheets.map(t=>o.jsx(xwe,{sheet:t},t.sheetName))}),e.canProceed&&o.jsx("div",{className:"mt-6 p-4 bg-rag-green/10 border border-rag-green/30 rounded-lg",children:o.jsxs("div",{className:"flex items-center gap-2 text-rag-green",children:[o.jsx(yr,{className:"w-5 h-5"}),o.jsxs("span",{className:"font-medium",children:["Ready to import ",e.validRows," records"]})]})}),!e.canProceed&&o.jsx("div",{className:"mt-6 p-4 bg-rag-red/10 border border-rag-red/30 rounded-lg",children:o.jsxs("div",{className:"flex items-center gap-2 text-rag-red",children:[o.jsx(_n,{className:"w-5 h-5"}),o.jsx("span",{className:"font-medium",children:"Cannot proceed - please fix the errors above"})]})})]}),h2=({label:e,value:t,icon:r,variant:n})=>{const a={success:"bg-rag-green/10 border-rag-green/30 text-rag-green",error:"bg-rag-red/10 border-rag-red/30 text-rag-red",neutral:"bg-bg-hover border-border text-text-muted"};return o.jsxs("div",{className:`p-4 rounded-lg border ${a[n]}`,children:[o.jsx("div",{className:"flex items-center gap-2 mb-2",children:r}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:t}),o.jsx("p",{className:"text-sm opacity-75",children:e})]})},xwe=({sheet:e})=>{const[t,r]=k.useState(e.errorCount>0),[n,a]=k.useState(!0),i=n?e.rowResults.filter(s=>!s.isValid||s.warnings.length>0):e.rowResults;return o.jsxs("div",{className:"border border-border rounded-lg overflow-hidden",children:[o.jsxs("button",{onClick:()=>r(!t),className:"w-full flex items-center justify-between p-4 bg-bg-hover hover:bg-bg-hover/80 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[t?o.jsx(Ra,{className:"w-5 h-5 text-text-muted"}):o.jsx(ha,{className:"w-5 h-5 text-text-muted"}),o.jsx(ho,{className:"w-5 h-5 text-accent-blue"}),o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"font-medium text-text-primary",children:e.sheetName}),o.jsx("p",{className:"text-xs text-text-muted",children:O0[e.entityType]})]})]}),o.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.validCount>0&&o.jsxs("span",{className:"flex items-center gap-1 text-rag-green",children:[o.jsx(yr,{className:"w-4 h-4"}),e.validCount," valid"]}),e.errorCount>0&&o.jsxs("span",{className:"flex items-center gap-1 text-rag-red",children:[o.jsx(_n,{className:"w-4 h-4"}),e.errorCount," errors"]}),e.warningCount>0&&o.jsxs("span",{className:"flex items-center gap-1 text-rag-amber",children:[o.jsx(jn,{className:"w-4 h-4"}),e.warningCount," warnings"]})]})]}),t&&o.jsxs("div",{className:"border-t border-border",children:[e.rowResults.length>0&&o.jsx("div",{className:"px-4 py-2 bg-bg-card border-b border-border",children:o.jsxs("label",{className:"flex items-center gap-2 text-sm text-text-secondary cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:n,onChange:s=>a(s.target.checked),className:"rounded border-border"}),"Show only rows with errors or warnings"]})}),o.jsx("div",{className:"max-h-80 overflow-y-auto",children:i.length===0?o.jsx("div",{className:"p-4 text-center text-text-muted",children:n?"No errors or warnings found":"No rows to display"}):o.jsxs("div",{className:"divide-y divide-border",children:[i.slice(0,50).map(s=>o.jsx(gwe,{row:s},s.rowNumber)),i.length>50&&o.jsxs("div",{className:"p-3 text-center text-sm text-text-muted",children:["...and ",i.length-50," more rows"]})]})})]})]})},gwe=({row:e})=>o.jsxs("div",{className:`px-4 py-3 ${e.isValid?e.warnings.length>0?"bg-rag-amber/5":"":"bg-rag-red/5"}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.isValid?e.warnings.length>0?o.jsx(jn,{className:"w-4 h-4 text-rag-amber"}):o.jsx(yr,{className:"w-4 h-4 text-rag-green"}):o.jsx(_n,{className:"w-4 h-4 text-rag-red"}),o.jsxs("span",{className:"text-sm font-medium text-text-primary",children:["Row ",e.rowNumber]})]}),e.errors.length>0&&o.jsx("ul",{className:"ml-6 space-y-1",children:e.errors.map((t,r)=>o.jsxs("li",{className:"text-sm text-rag-red",children:[t.fieldLabel,": ",t.message]},r))}),e.warnings.length>0&&o.jsx("ul",{className:"ml-6 space-y-1",children:e.warnings.map((t,r)=>o.jsxs("li",{className:"text-sm text-rag-amber",children:[t.fieldLabel,": ",t.message]},r))})]}),vwe=({result:e,isProcessing:t,onReset:r})=>t?o.jsxs("div",{className:"p-12 text-center",children:[o.jsx(il,{className:"w-16 h-16 text-accent-blue animate-spin mx-auto mb-6"}),o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"Importing Data..."}),o.jsx("p",{className:"text-text-secondary",children:"Please wait while we import your data into the system."})]}):e?e.success?o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-20 h-20 bg-rag-green/20 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(yr,{className:"w-10 h-10 text-rag-green"})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:"Import Successful!"}),o.jsxs("p",{className:"text-text-secondary",children:[e.totalSuccessful," records have been imported successfully."]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[o.jsx(Au,{label:"Records Imported",value:e.totalSuccessful,icon:o.jsx(yr,{className:"w-5 h-5 text-rag-green"})}),o.jsx(Au,{label:"Sheets Processed",value:e.sheets.length,icon:o.jsx(ho,{className:"w-5 h-5 text-accent-blue"})}),o.jsx(Au,{label:"Time Taken",value:`${(e.duration/1e3).toFixed(1)}s`,icon:o.jsx(fo,{className:"w-5 h-5 text-text-muted"})})]}),o.jsxs("div",{className:"mb-8",children:[o.jsx("h3",{className:"text-sm font-medium text-text-secondary mb-3",children:"Import Details by Sheet"}),o.jsx("div",{className:"space-y-2",children:e.sheets.map(n=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ho,{className:"w-4 h-4 text-text-muted"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary",children:n.sheetName}),o.jsx("p",{className:"text-xs text-text-muted",children:O0[n.entityType]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-sm text-rag-green",children:[n.successful," imported"]}),n.failed>0&&o.jsxs("span",{className:"text-sm text-rag-red",children:[n.failed," failed"]})]})]},n.sheetName))})]}),o.jsxs("div",{className:"flex items-center justify-center gap-4",children:[o.jsx(Xe,{variant:"secondary",onClick:r,icon:o.jsx(co,{className:"w-4 h-4"}),children:"Import More Data"}),o.jsx(Xe,{onClick:()=>window.location.href="/portfolio",icon:o.jsx(Qf,{className:"w-4 h-4"}),children:"View Portfolio"})]})]}):o.jsxs("div",{className:"p-6",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4 ${e.totalSuccessful>0?"bg-rag-amber/20":"bg-rag-red/20"}`,children:o.jsx(_n,{className:`w-10 h-10 ${e.totalSuccessful>0?"text-rag-amber":"text-rag-red"}`})}),o.jsx("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:e.totalSuccessful>0?"Import Completed with Issues":"Import Failed"}),o.jsxs("p",{className:"text-text-secondary",children:[e.totalSuccessful," of ",e.totalAttempted," records were imported.",e.totalFailed>0&&` ${e.totalFailed} records failed.`]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[o.jsx(Au,{label:"Successfully Imported",value:e.totalSuccessful,icon:o.jsx(yr,{className:"w-5 h-5 text-rag-green"})}),o.jsx(Au,{label:"Failed",value:e.totalFailed,icon:o.jsx(_n,{className:"w-5 h-5 text-rag-red"})}),o.jsx(Au,{label:"Time Taken",value:`${(e.duration/1e3).toFixed(1)}s`,icon:o.jsx(fo,{className:"w-5 h-5 text-text-muted"})})]}),e.sheets.some(n=>n.failed>0)&&o.jsxs("div",{className:"mb-8",children:[o.jsx("h3",{className:"text-sm font-medium text-text-secondary mb-3",children:"Failed Records"}),o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:e.sheets.map(n=>n.results.filter(a=>!a.success).map(a=>o.jsxs("div",{className:"p-3 bg-rag-red/10 border border-rag-red/30 rounded-lg",children:[o.jsxs("p",{className:"text-sm font-medium text-text-primary",children:[n.sheetName," - Row ",a.rowNumber]}),o.jsx("p",{className:"text-sm text-rag-red",children:a.error||"Unknown error"})]},`${n.sheetName}-${a.rowNumber}`)))})]}),o.jsxs("div",{className:"flex items-center justify-center gap-4",children:[o.jsx(Xe,{variant:"secondary",onClick:r,icon:o.jsx(co,{className:"w-4 h-4"}),children:"Try Again"}),e.totalSuccessful>0&&o.jsx(Xe,{onClick:()=>window.location.href="/portfolio",icon:o.jsx(Qf,{className:"w-4 h-4"}),children:"View Imported Data"})]})]}):o.jsxs("div",{className:"p-12 text-center",children:[o.jsx(_n,{className:"w-16 h-16 text-text-muted mx-auto mb-6"}),o.jsx("h2",{className:"text-xl font-semibold text-text-primary mb-2",children:"No Import Data"}),o.jsx("p",{className:"text-text-secondary mb-6",children:"Something went wrong. Please try again."}),o.jsx(Xe,{onClick:r,icon:o.jsx(co,{className:"w-4 h-4"}),children:"Start Over"})]}),Au=({label:e,value:t,icon:r})=>o.jsxs("div",{className:"p-4 bg-bg-hover rounded-lg text-center",children:[o.jsx("div",{className:"flex justify-center mb-2",children:r}),o.jsx("p",{className:"text-2xl font-bold text-text-primary",children:t}),o.jsx("p",{className:"text-xs text-text-muted",children:e})]}),ywe={upload:{label:"Upload",icon:o.jsx(od,{className:"w-4 h-4"})},sheets:{label:"Sheets",icon:o.jsx(ho,{className:"w-4 h-4"})},spreadsheet:{label:"Map Data",icon:o.jsx(tH,{className:"w-4 h-4"})},preview:{label:"Preview",icon:o.jsx(e5,{className:"w-4 h-4"})},import:{label:"Complete",icon:o.jsx(yr,{className:"w-4 h-4"})}},oI=["upload","sheets","spreadsheet","preview","import"],bwe=({onComplete:e})=>{const{state:t,dispatch:r}=Pt(),[n,a]=k.useState(0),[i,s]=k.useState(new Map),c=rwe({currentState:t,onImportComplete:T=>{e?.(T)}}),{state:d,canGoBack:f,canGoNext:h,goBack:p,goNext:g}=c,v=oI.indexOf(d.currentStep),b=()=>{c.executeImport(r)},y=d.sheetConfigs.filter(T=>T.enabled),w=y[n],j=k.useCallback(T=>{w&&s(N=>{const C=new Map(N);return C.set(w.sheetName,T),C})},[w]);return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsx("div",{className:"flex items-center justify-center",children:o.jsx("div",{className:"flex items-center gap-2",children:oI.map((T,N)=>{const C=ywe[T],E=N===v,O=N<v,A=N<v&&d.currentStep!=="import";return o.jsxs(Nt.Fragment,{children:[N>0&&o.jsx("div",{className:`w-8 h-0.5 ${O?"bg-accent-blue":"bg-border"}`}),o.jsxs("button",{onClick:()=>A&&c.goBack(),disabled:!A,className:`
                    flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium
                    transition-colors
                    ${E?"bg-accent-blue text-white":O?"bg-accent-blue/20 text-accent-blue cursor-pointer hover:bg-accent-blue/30":"bg-bg-card text-text-muted cursor-default"}
                  `,children:[C.icon,o.jsx("span",{className:"hidden sm:inline",children:C.label})]})]},T)})})}),d.error&&o.jsx("div",{className:"bg-rag-red/10 border border-rag-red/30 rounded-xl p-4",children:o.jsx("p",{className:"text-sm text-rag-red",children:d.error})}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border",children:[d.currentStep==="upload"&&o.jsx(awe,{file:d.file,isProcessing:d.isProcessing,onFileSelect:c.handleFileSelect,onClear:c.clearFile}),d.currentStep==="sheets"&&d.workbook&&o.jsx(owe,{workbook:d.workbook,sheetConfigs:d.sheetConfigs,onToggleSheet:(T,N)=>c.updateSheetConfig(T,{enabled:N}),onSetEntityType:c.setSheetEntityType}),d.currentStep==="spreadsheet"&&w&&c.getSheetData&&o.jsxs("div",{className:"h-[600px]",children:[y.length>1&&o.jsx("div",{className:"flex gap-2 px-4 pt-4 border-b border-border",children:y.map((T,N)=>o.jsx("button",{onClick:()=>a(N),className:`
                      px-4 py-2 text-sm font-medium border-b-2 transition-colors
                      ${N===n?"border-accent-blue text-accent-blue":"border-transparent text-text-muted hover:text-text-primary"}
                    `,children:T.sheetName},T.sheetName))}),o.jsx(hwe,{sheetName:w.sheetName,sheetData:c.getSheetData(w.sheetName),entityType:w.entityType,onEntityTypeChange:T=>c.setSheetEntityType(w.sheetName,T),appState:t,onMappingsChange:j})]}),d.currentStep==="preview"&&d.validationResult&&o.jsx(pwe,{validationResult:d.validationResult}),d.currentStep==="import"&&o.jsx(vwe,{result:d.importResult,isProcessing:d.isProcessing,onReset:c.reset})]}),d.currentStep!=="import"&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(Xe,{variant:"secondary",onClick:p,disabled:!f||d.isProcessing,icon:o.jsx(Fx,{className:"w-4 h-4"}),children:"Back"}),o.jsxs("div",{className:"flex items-center gap-3",children:[d.isProcessing&&o.jsx(il,{className:"w-5 h-5 text-accent-blue animate-spin"}),d.currentStep==="preview"?o.jsx(Xe,{onClick:b,disabled:!h||d.isProcessing,icon:o.jsx(yr,{className:"w-4 h-4"}),children:d.isProcessing?"Importing...":"Import Data"}):o.jsx(Xe,{onClick:g,disabled:!h||d.isProcessing,icon:o.jsx(Kt,{className:"w-4 h-4"}),children:d.isProcessing?"Processing...":"Next"})]})]})]})},wwe=()=>o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Import Data"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Import Projects, Tasks, and other entities from Excel files using AI-powered mapping."})]}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Smart Import"})]})]}),o.jsx(bwe,{onComplete:e=>{console.log("Import completed:",e)}})]}),cI=["#3b82f6","#22c55e","#8b5cf6","#f59e0b","#ec4899","#06b6d4","#f43f5e","#14b8a6","#a855f7","#eab308"],Swe=()=>{const{state:e,dispatch:t}=Pt(),{resources:r,tasks:n}=e,[a,i]=k.useState(!1),[s,c]=k.useState(null),[d,f]=k.useState({name:"",email:"",role:"",team:"",weeklyCapacity:40,departmentCode:"IT",hourlyRate:75}),h=b=>{b?(c(b),f({name:b.name,email:b.email,role:b.role,team:b.team,weeklyCapacity:b.weeklyCapacity,departmentCode:b.departmentCode,hourlyRate:b.hourlyRate||75})):(c(null),f({name:"",email:"",role:"",team:"",weeklyCapacity:40,departmentCode:"IT",hourlyRate:75})),i(!0)},p=b=>{b.preventDefault();const y={id:s?.id||No(),name:d.name,email:d.email,role:d.role,team:d.team,weeklyCapacity:d.weeklyCapacity,avatarColor:s?.avatarColor||cI[Math.floor(Math.random()*cI.length)],departmentCode:d.departmentCode,hourlyRate:d.hourlyRate};t(s?{type:"UPDATE_RESOURCE",payload:y}:{type:"ADD_RESOURCE",payload:y}),i(!1)},g=b=>{const y=n.filter(w=>w.assigneeId===b);if(y.length>0){alert(`Cannot delete this resource. They have ${y.length} tasks assigned.`);return}confirm("Are you sure you want to delete this resource?")&&t({type:"DELETE_RESOURCE",payload:b})},v=b=>n.filter(y=>y.assigneeId===b&&y.kanbanStatus!=="done").length;return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Resources"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Manage team members and their capacity."})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(rV,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Team Management"})]}),o.jsx(Xe,{onClick:()=>h(),icon:o.jsx(Ir,{className:"w-4 h-4"}),children:"Add Resource"})]})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(b=>{const y=v(b.id),w=n.filter(N=>N.assigneeId===b.id&&N.kanbanStatus!=="done").reduce((N,C)=>N+C.estimatedHours,0),j=Math.round(w/(b.weeklyCapacity*4)*100),T=Un[b.departmentCode];return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5 hover:border-border-light transition-colors",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-lg font-medium text-white",style:{backgroundColor:b.avatarColor},children:b.name.split(" ").map(N=>N[0]).join("")}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-text-primary",children:b.name}),o.jsx("p",{className:"text-sm text-text-muted",children:b.role})]})]}),o.jsxs("div",{className:"flex gap-1",children:[o.jsx("button",{onClick:()=>h(b),className:"p-2 text-text-muted hover:text-text-primary transition-colors",children:o.jsx(sl,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>g(b.id),className:"p-2 text-text-muted hover:text-rag-red transition-colors",children:o.jsx(ac,{className:"w-4 h-4"})})]})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Department"}),o.jsxs("span",{className:"px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:`${T?.color}20`,color:T?.color},children:[T?.code," - ",T?.name]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Team"}),o.jsx("span",{className:"text-text-secondary",children:b.team})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Active Tasks"}),o.jsx("span",{className:"text-text-secondary",children:y})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Utilization"}),o.jsxs("span",{className:j>100?"text-rag-red":j>80?"text-rag-amber":"text-rag-green",children:[j,"%"]})]})]}),o.jsx("div",{className:"mt-3",children:o.jsx("div",{className:"h-2 bg-bg-hover rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full ${j>100?"bg-rag-red":j>80?"bg-rag-amber":"bg-rag-green"}`,style:{width:`${Math.min(j,100)}%`}})})})]},b.id)})}),o.jsx(Ta,{isOpen:a,onClose:()=>i(!1),title:s?"Edit Resource":"Add Resource",children:o.jsxs("form",{onSubmit:p,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Full Name *"}),o.jsx("input",{type:"text",value:d.name,onChange:b=>f({...d,name:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Email"}),o.jsx("input",{type:"email",value:d.email,onChange:b=>f({...d,email:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Role *"}),o.jsx("input",{type:"text",value:d.role,onChange:b=>f({...d,role:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Team"}),o.jsx("input",{type:"text",value:d.team,onChange:b=>f({...d,team:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Department *"}),o.jsx("select",{value:d.departmentCode,onChange:b=>f({...d,departmentCode:b.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:Object.values(Un).map(b=>o.jsxs("option",{value:b.code,children:[b.code," - ",b.name]},b.code))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Weekly Capacity (Hours)"}),o.jsx("input",{type:"number",value:d.weeklyCapacity,onChange:b=>f({...d,weeklyCapacity:Number(b.target.value)}),min:0,max:80,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Hourly Rate ($)"}),o.jsx("input",{type:"number",value:d.hourlyRate,onChange:b=>f({...d,hourlyRate:Number(b.target.value)}),min:0,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:()=>i(!1),children:"Cancel"}),o.jsx(Xe,{type:"submit",children:s?"Update":"Create"})]})]})})]})},Tf=({title:e,icon:t,children:r,defaultOpen:n=!1})=>{const[a,i]=k.useState(n);return o.jsxs("div",{className:"border border-border rounded-lg overflow-hidden",children:[o.jsxs("button",{onClick:()=>i(!a),className:"w-full flex items-center justify-between p-4 bg-bg-hover hover:bg-bg-primary transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[t,o.jsx("span",{className:"font-medium text-text-primary",children:e})]}),a?o.jsx(Ra,{className:"w-4 h-4 text-text-muted"}):o.jsx(ha,{className:"w-4 h-4 text-text-muted"})]}),a&&o.jsx("div",{className:"p-4 border-t border-border space-y-4",children:r})]})},cr=({label:e,description:t,checked:r,onChange:n})=>o.jsxs("label",{className:"flex items-center gap-3 cursor-pointer group",children:[o.jsx("button",{type:"button",role:"switch","aria-checked":r,onClick:()=>n(!r),className:`relative h-5 w-9 flex-shrink-0 rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-accent-purple focus:ring-offset-2 focus:ring-offset-bg-primary ${r?"bg-accent-purple":"bg-gray-600"}`,children:o.jsx("span",{className:"absolute h-3.5 w-3.5 rounded-full bg-white shadow-sm transition-all duration-200",style:{top:"3px",left:r?"19px":"3px"}})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"text-sm font-medium text-text-primary",children:e}),t&&o.jsx("p",{className:"text-xs text-text-muted mt-0.5",children:t})]})]}),gn=({label:e,value:t,onChange:r,min:n=0,max:a=100,step:i=1,suffix:s})=>o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm text-text-secondary",children:e}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"number",value:t,onChange:c=>r(Number(c.target.value)),min:n,max:a,step:i,className:"w-20 px-2 py-1 text-sm bg-bg-primary border border-border rounded text-text-primary text-right"}),s&&o.jsx("span",{className:"text-xs text-text-muted",children:s})]})]}),Nwe=()=>{const{config:e,currentPreset:t,importEnforcement:r,riskScoreConfig:n,insightsConfig:a,approvalConfig:i,features:s,updateImportEnforcement:c,updateRiskScoreConfig:d,updateInsightsConfig:f,updateApprovalConfig:h,updateFeatures:p,applyPreset:g,resetToDefaults:v,exportConfig:b,importConfigJson:y}=$z(),[w,j]=k.useState(null),T=E=>{E!=="custom"&&g(E)},N=()=>{const E=b(),O=new Blob([E],{type:"application/json"}),A=URL.createObjectURL(O),D=document.createElement("a");D.href=A,D.download=`stratos-config-${new Date().toISOString().split("T")[0]}.json`,D.click(),URL.revokeObjectURL(A)},C=E=>{const O=E.target.files?.[0];if(!O)return;const A=new FileReader;A.onload=D=>{const M=D.target?.result,P=y(M);j(P?null:"Invalid configuration file")},A.onerror=()=>j("Failed to read file"),A.readAsText(O),E.target.value=""};return o.jsxs("div",{className:"w-full bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(mo,{className:"w-5 h-5 text-accent-cyan"}),o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Business Rules & Enforcement"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs text-text-muted",children:"Preset:"}),o.jsx("select",{value:t,onChange:E=>T(E.target.value),className:"text-sm bg-bg-primary border border-border rounded px-2 py-1 text-text-primary",children:Object.entries(a1).map(([E,O])=>o.jsx("option",{value:E,children:O.label},E))})]})]}),o.jsx("div",{className:"mb-6 p-3 bg-accent-cyan/10 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Gu,{className:"w-4 h-4 text-accent-cyan mt-0.5"}),o.jsxs("div",{className:"text-xs text-text-secondary",children:[o.jsxs("strong",{className:"text-text-primary",children:[a1[t].label,":"]})," ",a1[t].description]})]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsx(Tf,{title:"Feature Toggles",icon:o.jsx(WH,{className:"w-4 h-4 text-accent-purple"}),defaultOpen:!0,children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsx(cr,{label:"AI Insights",description:"Enable Claude-powered AI analysis",checked:s.aiInsights,onChange:E=>p({aiInsights:E})}),o.jsx(cr,{label:"Rule-Based Insights",description:"Enable automated rule-based insights",checked:s.ruleBasedInsights,onChange:E=>p({ruleBasedInsights:E})}),o.jsx(cr,{label:"Risk Scoring",description:"Calculate risk scores for initiatives",checked:s.riskScoring,onChange:E=>p({riskScoring:E})}),o.jsx(cr,{label:"Approval Framework",description:"Enable stage-gate approval process",checked:s.approvalFramework,onChange:E=>p({approvalFramework:E})}),o.jsx(cr,{label:"Charter Tracking",description:"Track project charter completeness",checked:s.charterTracking,onChange:E=>p({charterTracking:E})}),o.jsx(cr,{label:"Smart Import",description:"Enable intelligent Excel import wizard",checked:s.smartImport,onChange:E=>p({smartImport:E})}),o.jsx(cr,{label:"Fuzzy Matching",description:"Allow approximate reference matching",checked:s.fuzzyMatching,onChange:E=>p({fuzzyMatching:E})}),o.jsx(cr,{label:"Executive Summary",description:"Show executive summary dashboards",checked:s.executiveSummary,onChange:E=>p({executiveSummary:E})})]})}),o.jsx(Tf,{title:"Import Enforcement",icon:o.jsx(PH,{className:"w-4 h-4 text-accent-blue"}),children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Charter Requirements"}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(cr,{label:"Require Charter for Import",description:"Projects must have charter data to be imported",checked:r.charter.enforceOnImport,onChange:E=>c({charter:{...r.charter,enforceOnImport:E}})}),o.jsx(gn,{label:"Minimum Charter Completeness",value:r.charter.minimumCompletenessScore,onChange:E=>c({charter:{...r.charter,minimumCompletenessScore:E}}),suffix:"%"})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Field Validation"}),o.jsx(cr,{label:"Treat Warnings as Errors",description:"Block import if any warnings are raised",checked:r.fields.treatWarningsAsErrors,onChange:E=>c({fields:{...r.fields,treatWarningsAsErrors:E}})})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Reference Matching"}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(cr,{label:"Allow Fuzzy Matching",description:"Match similar names when exact match not found",checked:r.references.allowFuzzyMatching,onChange:E=>c({references:{...r.references,allowFuzzyMatching:E}})}),o.jsx(gn,{label:"Fuzzy Match Threshold",value:r.references.fuzzyMatchThreshold,onChange:E=>c({references:{...r.references,fuzzyMatchThreshold:E}}),min:50,max:100,suffix:"%"}),o.jsx(cr,{label:"Auto-Create Missing References",description:"Create placeholder entities for unmatched references",checked:r.references.createMissingReferences,onChange:E=>c({references:{...r.references,createMissingReferences:E}})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Business Rules"}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(cr,{label:"Enforce Date Range",description:"Start date must be before end date",checked:r.businessRules.enforceProjectDateRange,onChange:E=>c({businessRules:{...r.businessRules,enforceProjectDateRange:E}})}),o.jsx(cr,{label:"Enforce Positive Budget",description:"Budget must be >= 0",checked:r.businessRules.enforceBudgetPositive,onChange:E=>c({businessRules:{...r.businessRules,enforceBudgetPositive:E}})}),o.jsx(cr,{label:"Reject Overdue Tasks",description:"Block import of tasks with past due dates",checked:r.businessRules.rejectOverdueTasks,onChange:E=>c({businessRules:{...r.businessRules,rejectOverdueTasks:E}})}),o.jsx(cr,{label:"Reject Over-Budget Initiatives",description:"Block import where spent > budget",checked:r.businessRules.rejectOverBudgetInitiatives,onChange:E=>c({businessRules:{...r.businessRules,rejectOverBudgetInitiatives:E}})})]})]})]})}),o.jsx(Tf,{title:"Risk Score Settings",icon:o.jsx(jn,{className:"w-4 h-4 text-rag-amber"}),children:o.jsxs("div",{className:"space-y-6",children:[o.jsx(cr,{label:"Enable Risk Scoring",description:"Calculate and display risk scores",checked:n.enabled,onChange:E=>d({enabled:E})}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Dimension Weights (must sum to 100%)"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(gn,{label:"Schedule",value:Math.round(n.weights.schedule*100),onChange:E=>d({weights:{...n.weights,schedule:E/100}}),suffix:"%"}),o.jsx(gn,{label:"Cost",value:Math.round(n.weights.cost*100),onChange:E=>d({weights:{...n.weights,cost:E/100}}),suffix:"%"}),o.jsx(gn,{label:"Scope",value:Math.round(n.weights.scope*100),onChange:E=>d({weights:{...n.weights,scope:E/100}}),suffix:"%"}),o.jsx(gn,{label:"Resource",value:Math.round(n.weights.resource*100),onChange:E=>d({weights:{...n.weights,resource:E/100}}),suffix:"%"}),o.jsx(gn,{label:"Quality",value:Math.round(n.weights.quality*100),onChange:E=>d({weights:{...n.weights,quality:E/100}}),suffix:"%"})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Risk Level Boundaries"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(gn,{label:"Low Risk (up to)",value:n.riskLevels.low,onChange:E=>d({riskLevels:{...n.riskLevels,low:E}})}),o.jsx(gn,{label:"Medium Risk (up to)",value:n.riskLevels.medium,onChange:E=>d({riskLevels:{...n.riskLevels,medium:E}})}),o.jsx(gn,{label:"High Risk (up to)",value:n.riskLevels.high,onChange:E=>d({riskLevels:{...n.riskLevels,high:E}})})]})]})]})}),o.jsx(Tf,{title:"Insights Engine",icon:o.jsx(L0,{className:"w-4 h-4 text-rag-green"}),children:o.jsxs("div",{className:"space-y-6",children:[o.jsx(cr,{label:"Enable Rule-Based Insights",description:"Generate automated insights from data",checked:a.enabled,onChange:E=>f({enabled:E})}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Enabled Categories"}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[o.jsx(cr,{label:"Schedule",checked:a.categories.schedule,onChange:E=>f({categories:{...a.categories,schedule:E}})}),o.jsx(cr,{label:"Cost",checked:a.categories.cost,onChange:E=>f({categories:{...a.categories,cost:E}})}),o.jsx(cr,{label:"Scope",checked:a.categories.scope,onChange:E=>f({categories:{...a.categories,scope:E}})}),o.jsx(cr,{label:"Resource",checked:a.categories.resource,onChange:E=>f({categories:{...a.categories,resource:E}})}),o.jsx(cr,{label:"Strategic",checked:a.categories.strategic,onChange:E=>f({categories:{...a.categories,strategic:E}})}),o.jsx(cr,{label:"Success",checked:a.categories.success,onChange:E=>f({categories:{...a.categories,success:E}})})]})]})]})}),o.jsx(Tf,{title:"Approval Framework",icon:o.jsx(BH,{className:"w-4 h-4 text-accent-purple"}),children:o.jsxs("div",{className:"space-y-6",children:[o.jsx(cr,{label:"Enable Approval Framework",description:"Require stage-gate approvals for projects",checked:i.enabled,onChange:E=>h({enabled:E})}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Gate Minimum Scores"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(gn,{label:"Gate 1: Idea",value:i.gateMinimums.idea,onChange:E=>h({gateMinimums:{...i.gateMinimums,idea:E}}),suffix:"%"}),o.jsx(gn,{label:"Gate 2: Business Case",value:i.gateMinimums.business_case,onChange:E=>h({gateMinimums:{...i.gateMinimums,business_case:E}}),suffix:"%"}),o.jsx(gn,{label:"Gate 3: Planning",value:i.gateMinimums.planning,onChange:E=>h({gateMinimums:{...i.gateMinimums,planning:E}}),suffix:"%"}),o.jsx(gn,{label:"Gate 4: Execution",value:i.gateMinimums.execution,onChange:E=>h({gateMinimums:{...i.gateMinimums,execution:E}}),suffix:"%"}),o.jsx(gn,{label:"Gate 5: Closure",value:i.gateMinimums.closure,onChange:E=>h({gateMinimums:{...i.gateMinimums,closure:E}}),suffix:"%"})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-medium text-text-primary mb-3",children:"Recommendation Logic"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(gn,{label:"Conditional Threshold Offset",value:i.recommendations.conditionalThresholdOffset,onChange:E=>h({recommendations:{...i.recommendations,conditionalThresholdOffset:E}}),suffix:"%"}),o.jsx(gn,{label:"Defer Minimum Score",value:i.recommendations.deferMinimumScore,onChange:E=>h({recommendations:{...i.recommendations,deferMinimumScore:E}})}),o.jsx(gn,{label:"Max Blockers for Defer",value:i.recommendations.deferMaxBlockers,onChange:E=>h({recommendations:{...i.recommendations,deferMaxBlockers:E}})})]})]})]})})]}),o.jsxs("div",{className:"mt-6 pt-4 border-t border-border",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[o.jsx(Xe,{onClick:v,variant:"secondary",size:"sm",icon:o.jsx(i5,{className:"w-4 h-4"}),children:"Reset to Defaults"}),o.jsx(Xe,{onClick:N,variant:"secondary",size:"sm",icon:o.jsx(Pf,{className:"w-4 h-4"}),children:"Export Config"}),o.jsxs("label",{className:"inline-flex",children:[o.jsx("input",{type:"file",accept:".json",onChange:C,className:"hidden"}),o.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1.5 text-sm bg-bg-hover text-text-primary rounded-lg cursor-pointer hover:bg-bg-hover/80",children:[o.jsx(od,{className:"w-4 h-4"}),"Import Config"]})]})]}),w&&o.jsx("div",{className:"mt-3 p-2 bg-rag-red/10 text-rag-red text-sm rounded",children:w}),o.jsxs("p",{className:"mt-3 text-xs text-text-muted",children:["Last updated: ",new Date(e.lastUpdated).toLocaleString()]})]})]})},kwe=({config:e,onUpdate:t})=>{const[r,n]=k.useState(e.levelNames),a=()=>{t({...e,levelNames:r})};return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Level Names"}),o.jsx("p",{className:"text-sm text-text-secondary mb-4",children:"Customize the names for each organizational level."}),o.jsx("div",{className:"grid grid-cols-2 gap-4",children:MI.map(i=>o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1 capitalize",children:i}),o.jsx("input",{type:"text",value:r[i],onChange:s=>n({...r,[i]:s.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue"})]},i))}),o.jsx("div",{className:"mt-4 flex justify-end",children:o.jsx(Xe,{onClick:a,children:"Save Names"})})]})},_we=({config:e,onUpdate:t})=>{const r=n=>{if(n==="section")return;const a=e.levelsWithBSC.includes(n)?e.levelsWithBSC.filter(i=>i!==n):[...e.levelsWithBSC,n];a.includes("directorate")||a.push("directorate"),t({...e,levelsWithBSC:a})};return o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsx("h3",{className:"text-lg font-semibold text-text-primary mb-4",children:"Balanced Scorecard Levels"}),o.jsx("p",{className:"text-sm text-text-secondary mb-4",children:"Select which organizational levels can have their own Balanced Scorecard. Other levels will inherit from their parent."}),o.jsx("div",{className:"space-y-3",children:MI.map(n=>o.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg bg-bg-primary border border-border ${n==="section"?"opacity-50 cursor-not-allowed":"cursor-pointer hover:bg-bg-hover"}`,children:[o.jsx("input",{type:"checkbox",checked:e.levelsWithBSC.includes(n),onChange:()=>r(n),disabled:n==="section"||n==="directorate",className:"w-4 h-4 rounded border-border text-accent-blue focus:ring-accent-blue"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:"text-text-primary font-medium",children:e.levelNames[n]}),n==="directorate"&&o.jsx("span",{className:"ml-2 text-xs text-text-muted",children:"(always enabled)"}),n==="section"&&o.jsx("span",{className:"ml-2 text-xs text-text-muted",children:"(operational only - no BSC)"})]}),e.levelsWithBSC.includes(n)&&o.jsx(Qf,{className:"w-4 h-4 text-accent-blue"})]},n))})]})},jwe=({unit:e,parentId:t,level:r,companyId:n,config:a,onSave:i,onClose:s})=>{const{state:c}=Pt(),d=!!e,[f,h]=k.useState({name:e?.name||"",code:e?.code||"",description:e?.description||"",hasBSC:e?.hasBSC??(r!=="section"&&a.levelsWithBSC.includes(r)),inheritBSCFromId:e?.inheritBSCFromId||t||""}),p=(c.orgUnits||[]).filter(v=>v.hasBSC&&v.id!==e?.id&&v.companyId===n),g=v=>{v.preventDefault();const b=Mf({id:e?.id,name:f.name,code:f.code,level:r,companyId:n,parentId:e?.parentId??t??null,description:f.description||void 0,hasBSC:r==="section"?!1:f.hasBSC,inheritBSCFromId:!f.hasBSC||r==="section"?f.inheritBSCFromId:void 0,displayOrder:e?.displayOrder??1,isActive:e?.isActive??!0,createdAt:e?.createdAt});i(b),s()};return o.jsxs("form",{onSubmit:g,className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Name *"}),o.jsx("input",{type:"text",value:f.name,onChange:v=>h({...f,name:v.target.value}),placeholder:`e.g., ${a.levelNames[r]} Name`,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Code *"}),o.jsx("input",{type:"text",value:f.code,onChange:v=>h({...f,code:v.target.value.toUpperCase()}),placeholder:"e.g., IT, FIN",className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",required:!0,maxLength:10})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Description"}),o.jsx("textarea",{value:f.description,onChange:v=>h({...f,description:v.target.value}),placeholder:"Brief description of this organizational unit...",rows:2,className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue resize-none"})]}),r!=="section"&&a.levelsWithBSC.includes(r)&&o.jsxs("div",{className:"p-3 rounded-lg bg-bg-primary border border-border",children:[o.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[o.jsx("input",{type:"checkbox",checked:f.hasBSC,onChange:v=>h({...f,hasBSC:v.target.checked}),className:"w-4 h-4 rounded border-border text-accent-blue focus:ring-accent-blue"}),o.jsxs("div",{children:[o.jsx("span",{className:"text-text-primary font-medium",children:"Has Own Balanced Scorecard"}),o.jsxs("p",{className:"text-xs text-text-muted",children:["Enable if this ",a.levelNames[r].toLowerCase()," should have its own BSC pillars"]})]})]}),!f.hasBSC&&p.length>0&&o.jsxs("div",{className:"mt-3",children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-1",children:"Inherit BSC From"}),o.jsxs("select",{value:f.inheritBSCFromId,onChange:v=>h({...f,inheritBSCFromId:v.target.value}),className:"w-full px-3 py-2 bg-bg-primary border border-border rounded-lg text-text-primary focus:outline-none focus:border-accent-blue",children:[o.jsx("option",{value:"",children:"Select parent unit..."}),p.map(v=>o.jsxs("option",{value:v.id,children:[v.name," (",a.levelNames[v.level],")"]},v.id))]})]})]}),r==="section"&&o.jsx("div",{className:"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30",children:o.jsx("p",{className:"text-sm text-amber-500",children:"Sections are operational units and cannot have their own Balanced Scorecard."})}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-border",children:[o.jsx(Xe,{type:"button",variant:"secondary",onClick:s,children:"Cancel"}),o.jsx(Xe,{type:"submit",children:d?"Update":"Create"})]})]})},nB=({unit:e,config:t,children:r,onEdit:n,onDelete:a,onAddChild:i})=>{const[s,c]=k.useState(!0),{getChildOrgUnits:d,getInitiativesByOrgUnit:f,getProjectsByOrgUnit:h}=Pt(),p=r.length>0,g=e.level==="directorate"?"division":e.level==="division"?"department":e.level==="department"?"section":null,v=f(e.id).length,b=h(e.id).length;return o.jsxs("div",{className:"ml-4",children:[o.jsxs("div",{className:"flex items-center gap-2 py-2 px-3 rounded-lg hover:bg-bg-hover group",children:[p||g?o.jsx("button",{onClick:()=>c(!s),className:"w-5 h-5 flex items-center justify-center text-text-muted hover:text-text-primary",children:o.jsx(ha,{className:`w-4 h-4 transition-transform ${s?"rotate-90":""}`})}):o.jsx("div",{className:"w-5"}),o.jsx(gl,{className:"w-4 h-4 text-accent-blue"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-medium text-text-primary truncate",children:e.name}),o.jsxs("span",{className:"text-xs text-text-muted",children:["(",e.code,")"]}),e.hasBSC&&o.jsx("span",{title:"Has BSC",children:o.jsx(Qf,{className:"w-3 h-3 text-accent-blue"})})]}),o.jsxs("div",{className:"text-xs text-text-muted",children:[t.levelNames[e.level],(v>0||b>0)&&o.jsxs("span",{className:"ml-2",children:[v>0&&`${v} initiative${v!==1?"s":""}`,v>0&&b>0&&", ",b>0&&`${b} project${b!==1?"s":""}`]})]})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[g&&o.jsx("button",{onClick:()=>i(e.id,g),className:"p-1 rounded hover:bg-bg-primary text-text-muted hover:text-accent-blue",title:`Add ${t.levelNames[g]}`,children:o.jsx(Ir,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>n(e),className:"p-1 rounded hover:bg-bg-primary text-text-muted hover:text-accent-blue",title:"Edit",children:o.jsx(sl,{className:"w-4 h-4"})}),o.jsx("button",{onClick:()=>a(e),className:"p-1 rounded hover:bg-bg-primary text-text-muted hover:text-rag-red",title:"Delete",children:o.jsx(ac,{className:"w-4 h-4"})})]})]}),s&&p&&o.jsx("div",{className:"border-l border-border ml-2",children:r.map(y=>o.jsx(nB,{unit:y,config:t,children:d(y.id),onEdit:n,onDelete:a,onAddChild:i},y.id))}),s&&g&&r.length===0&&o.jsx("div",{className:"ml-6 py-2 px-3 text-sm text-text-muted",children:o.jsxs("button",{onClick:()=>i(e.id,g),className:"flex items-center gap-2 text-accent-blue hover:underline",children:[o.jsx(Ir,{className:"w-3 h-3"}),"Add ",t.levelNames[g]]})})]})},Ewe=()=>{const{state:e,dispatch:t,getChildOrgUnits:r,getOrgConfig:n,getAllCompanies:a,getOrgUnitsForCompany:i}=Pt(),s=n(),c=a(),[d,f]=k.useState(c[0]?.id||""),h=c.find(ee=>ee.id===d),g=(d?i(d):[]).filter(ee=>!ee.parentId),[v,b]=k.useState(!1),[y,w]=k.useState(),[j,T]=k.useState(null),[N,C]=k.useState("directorate"),[E,O]=k.useState(null),A=ee=>{t({type:"UPDATE_ORG_CONFIG",payload:ee})},D=ee=>{t(y?{type:"UPDATE_ORG_UNIT",payload:ee}:{type:"ADD_ORG_UNIT",payload:ee})},M=ee=>{w(ee),C(ee.level),T(ee.parentId),b(!0)},P=(ee,ue)=>{w(void 0),T(ee),C(ue),b(!0)},R=()=>{w(void 0),T(null),C("directorate"),b(!0)},L=ee=>{O(ee)},te=()=>{E&&(t({type:"DELETE_ORG_UNIT",payload:E.id}),O(null))};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold text-text-primary mb-2",children:"Organization Hierarchy"}),o.jsx("p",{className:"text-text-secondary",children:"Configure your organization structure and Balanced Scorecard levels within each company."})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsx(kwe,{config:s,onUpdate:A}),o.jsx(_we,{config:s,onUpdate:A})]}),c.length>0&&o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsx("div",{className:"flex items-center justify-between mb-4",children:o.jsx("h3",{className:"text-lg font-semibold text-text-primary",children:"Select Company"})}),o.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(ee=>o.jsxs("button",{onClick:()=>f(ee.id),className:`px-4 py-2 rounded-lg border transition-colors flex items-center gap-2 ${d===ee.id?"bg-accent-blue text-white border-accent-blue":"bg-bg-primary border-border text-text-primary hover:bg-bg-hover"}`,children:[o.jsx(S2,{className:"w-4 h-4"}),ee.name]},ee.id))})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-text-primary",children:["Organization Structure",h&&o.jsxs("span",{className:"text-text-secondary font-normal",children:[" - ",h.name]})]}),d&&o.jsxs(Xe,{onClick:R,children:[o.jsx(Ir,{className:"w-4 h-4 mr-2"}),"Add ",s.levelNames.directorate]})]}),!d||c.length===0?o.jsxs("div",{className:"text-center py-8 text-text-muted",children:[o.jsx(S2,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{children:"No companies found."}),o.jsx("p",{className:"text-sm",children:"Create companies in the Corporate Structure settings first."})]}):g.length>0?o.jsx("div",{className:"-ml-4",children:g.map(ee=>o.jsx(nB,{unit:ee,config:s,children:r(ee.id),onEdit:M,onDelete:L,onAddChild:P},ee.id))}):o.jsxs("div",{className:"text-center py-8 text-text-muted",children:[o.jsx(gl,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),o.jsx("p",{children:"No organization structure defined for this company."}),o.jsxs("p",{className:"text-sm",children:["Add a ",s.levelNames.directorate.toLowerCase()," to get started."]})]})]}),o.jsx(Ta,{isOpen:v,onClose:()=>b(!1),title:y?`Edit ${s.levelNames[y.level]}`:`Add ${s.levelNames[N]}`,children:o.jsx(jwe,{unit:y,parentId:j,level:y?.level||N,companyId:y?.companyId||d,config:s,onSave:D,onClose:()=>b(!1)})}),o.jsx(Ta,{isOpen:!!E,onClose:()=>O(null),title:"Delete Organization Unit",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-start gap-3 p-4 bg-rag-red/10 rounded-lg",children:[o.jsx(jn,{className:"w-5 h-5 text-rag-red flex-shrink-0 mt-0.5"}),o.jsxs("div",{children:[o.jsxs("p",{className:"text-text-primary",children:["Are you sure you want to delete ",o.jsx("strong",{children:E?.name}),"?"]}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Any child units will be moved to the parent level. Initiatives and projects will be reassigned."})]})]}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx(Xe,{variant:"secondary",onClick:()=>O(null),children:"Cancel"}),o.jsx(Xe,{onClick:te,className:"bg-rag-red hover:bg-rag-red/90",children:"Delete"})]})]})})]})},uI=[{key:"pillars",label:"Strategy Pillars",icon:o.jsx(gr,{className:"w-4 h-4"}),color:"text-accent-blue",children:["kpis","initiatives"]},{key:"kpis",label:"KPIs",icon:o.jsx(Vu,{className:"w-4 h-4"}),color:"text-rag-green",parentKey:"pillars",parentIdField:"pillarId"},{key:"initiatives",label:"Initiatives",icon:o.jsx(Wu,{className:"w-4 h-4"}),color:"text-accent-purple",parentKey:"pillars",parentIdField:"pillarId",children:["projects"]},{key:"projects",label:"Projects",icon:o.jsx(mc,{className:"w-4 h-4"}),color:"text-accent-cyan",parentKey:"initiatives",parentIdField:"initiativeId",children:["tasks","milestones"]},{key:"tasks",label:"Tasks",icon:o.jsx(n5,{className:"w-4 h-4"}),color:"text-rag-amber",parentKey:"projects",parentIdField:"projectId"},{key:"resources",label:"Resources",icon:o.jsx(ri,{className:"w-4 h-4"}),color:"text-accent-teal"},{key:"milestones",label:"Milestones",icon:o.jsx(ys,{className:"w-4 h-4"}),color:"text-rag-red",parentKey:"projects",parentIdField:"projectId"}],Twe=()=>{const{state:e,dispatch:t,resetToSeedData:r,isSetupWizardCompleted:n}=Pt(),a=fa(),[i,s]=k.useState(!1),[c,d]=k.useState(""),[f,h]=k.useState(!1),[p,g]=k.useState(!1),[v,b]=k.useState(!1),[y,w]=k.useState(null),[j,T]=k.useState("");k.useEffect(()=>{const V=Sp();V&&(d(V),g(!0))},[]);const N=()=>{c.trim()&&(PT(c.trim()),g(!0),w(null))},C=()=>{confirm("Remove the API key? AI features will be disabled.")&&(bz(),d(""),g(!1),w(null))},E=async()=>{if(c.trim()){b(!0),w(null),T("");try{PT(c.trim()),await $I(e,c.trim(),!0),w("success"),T("Connection successful! AI analysis is working."),g(!0)}catch(V){w("error"),T(V instanceof Error?V.message:"Connection failed")}finally{b(!1)}}},O=()=>{HI(),alert("AI cache cleared. Next analysis will fetch fresh data.")},A=()=>{confirm("Are you sure you want to reset all data to the demo dataset? This cannot be undone.")&&r()},D=()=>{const V=e.pillars.length+e.kpis.length+e.initiatives.length+e.projects.length+e.tasks.length+e.resources.length+(e.milestones?.length||0);confirm(`Are you sure you want to DELETE ALL ${V} records?

This will remove everything including sample data.
You can restore sample data using "Reset to Demo Data" afterward.

This cannot be undone.`)&&t({type:"SET_STATE",payload:{pillars:[],kpis:[],initiatives:[],projects:[],tasks:[],resources:[],milestones:[]}})},M=V=>{const K=e[V];return Array.isArray(K)?K.length:0},P=V=>{if(!V.children)return{count:0,types:[]};let K=0;const ie=[];for(const re of V.children){const me=M(re);if(me>0){K+=me;const W=uI.find(F=>F.key===re);W&&ie.push(W.label)}}return{count:K,types:ie}},R=V=>{const K=M(V.key);if(K===0)return;const ie=P(V);let re=`Are you sure you want to delete all ${K} ${V.label}?`;if(ie.count>0&&(re+=`

WARNING: This will orphan ${ie.count} related items:
 ${ie.types.join(`
 `)}

Orphaned items will have invalid parent references.`),confirm(re)){const me={...e,[V.key]:[]};t({type:"SET_STATE",payload:me})}},L=k.useMemo(()=>{const V=[],K=new Set(e.pillars.map(U=>U.id)),ie=e.kpis.filter(U=>!K.has(U.pillarId));ie.length>0&&V.push({key:"kpis",label:"KPIs",count:ie.length});const re=e.initiatives.filter(U=>!K.has(U.pillarId));re.length>0&&V.push({key:"initiatives",label:"Initiatives",count:re.length});const me=new Set(e.initiatives.map(U=>U.id)),W=e.projects.filter(U=>!me.has(U.initiativeId));W.length>0&&V.push({key:"projects",label:"Projects",count:W.length});const F=new Set(e.projects.map(U=>U.id)),X=e.tasks.filter(U=>!F.has(U.projectId));X.length>0&&V.push({key:"tasks",label:"Tasks",count:X.length});const q=(e.milestones||[]).filter(U=>!F.has(U.projectId));return q.length>0&&V.push({key:"milestones",label:"Milestones",count:q.length}),V},[e]),te=()=>{if(L.length===0)return;const V=L.reduce((W,F)=>W+F.count,0);if(!confirm(`Delete ${V} orphaned records? This cannot be undone.`))return;const K=new Set(e.pillars.map(W=>W.id)),ie=new Set(e.initiatives.map(W=>W.id)),re=new Set(e.projects.map(W=>W.id)),me={...e,kpis:e.kpis.filter(W=>K.has(W.pillarId)),initiatives:e.initiatives.filter(W=>K.has(W.pillarId)),projects:e.projects.filter(W=>ie.has(W.initiativeId)),tasks:e.tasks.filter(W=>re.has(W.projectId)),milestones:(e.milestones||[]).filter(W=>re.has(W.projectId))};t({type:"SET_STATE",payload:me})},ue=(new Blob([JSON.stringify(e)]).size/1024).toFixed(2);return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Settings"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Manage application data and preferences."})]}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(mo,{className:"w-5 h-5 text-accent-cyan"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"Configuration"})]})]}),o.jsxs("div",{className:"w-full bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"}),o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"AI Configuration"}),p&&o.jsxs("span",{className:"flex items-center gap-1 text-xs text-rag-green bg-rag-green/10 px-2 py-1 rounded-full",children:[o.jsx(yr,{className:"w-3 h-3"})," Connected"]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-text-secondary mb-2",children:"Claude API Key"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx("input",{type:f?"text":"password",value:c,onChange:V=>d(V.target.value),placeholder:"sk-ant-api03-...",className:"w-full px-3 py-2 pr-10 bg-bg-primary border border-border rounded-lg text-text-primary placeholder:text-text-muted focus:outline-none focus:border-accent-purple"}),o.jsx("button",{onClick:()=>h(!f),className:"absolute right-3 top-1/2 -translate-y-1/2 text-text-muted hover:text-text-primary",children:f?o.jsx(F$,{className:"w-4 h-4"}):o.jsx(e5,{className:"w-4 h-4"})})]}),o.jsx(Xe,{onClick:E,variant:"secondary",disabled:!c.trim()||v,children:v?o.jsx(il,{className:"w-4 h-4 animate-spin"}):"Test"}),o.jsx(Xe,{onClick:N,disabled:!c.trim(),children:"Save"})]})]}),y&&o.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg ${y==="success"?"bg-rag-green/10 text-rag-green":"bg-rag-red/10 text-rag-red"}`,children:[y==="success"?o.jsx(yr,{className:"w-4 h-4"}):o.jsx(Qw,{className:"w-4 h-4"}),o.jsx("span",{className:"text-sm",children:j})]}),o.jsx("div",{className:"p-3 bg-accent-purple/10 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Gu,{className:"w-4 h-4 text-accent-purple mt-0.5"}),o.jsxs("div",{className:"text-xs text-text-secondary space-y-1",children:[o.jsxs("p",{children:["Get your API key from ",o.jsx("a",{href:"https://console.anthropic.com/settings/keys",target:"_blank",rel:"noopener noreferrer",className:"text-accent-purple hover:underline",children:"console.anthropic.com"})]}),o.jsx("p",{children:"The API key is stored locally in your browser and used to power AI insights, executive summaries, and project suggestions."})]})]})}),p&&o.jsxs("div",{className:"flex gap-2 pt-2 border-t border-border",children:[o.jsx(Xe,{onClick:O,variant:"secondary",size:"sm",children:"Clear AI Cache"}),o.jsx(Xe,{onClick:C,variant:"danger",size:"sm",children:"Remove API Key"})]})]})]}),o.jsxs("div",{className:"w-full bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(gl,{className:"w-5 h-5 text-accent-cyan"}),o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Corporate Structure"}),n()?o.jsxs("span",{className:"flex items-center gap-1 text-xs text-rag-green bg-rag-green/10 px-2 py-1 rounded-full",children:[o.jsx(yr,{className:"w-3 h-3"})," Configured"]}):o.jsxs("span",{className:"flex items-center gap-1 text-xs text-rag-amber bg-rag-amber/10 px-2 py-1 rounded-full",children:[o.jsx(jn,{className:"w-3 h-3"})," Not Configured"]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Use the Setup Wizard to configure your corporate hierarchy (Corporation  Holdings  Companies) and organizational structure (Directorate  Division  Department  Section)."}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-hover rounded-lg",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-text-primary",children:"Setup Wizard"}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Configure corporate entities, organizational units, and BSC structure."})]}),o.jsx(Xe,{onClick:()=>a("/setup-wizard"),variant:"primary",size:"sm",icon:o.jsx(iV,{className:"w-4 h-4"}),children:n()?"Reconfigure":"Start Setup"})]}),e.corporateEntities&&e.corporateEntities.length>0&&o.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-2",children:[o.jsxs("div",{className:"text-center p-3 bg-bg-primary rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-accent-blue",children:e.corporateEntities.filter(V=>V.entityType==="corporation").length}),o.jsx("div",{className:"text-xs text-text-muted",children:"Corporations"})]}),o.jsxs("div",{className:"text-center p-3 bg-bg-primary rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-accent-purple",children:e.corporateEntities.filter(V=>V.entityType==="holding").length}),o.jsx("div",{className:"text-xs text-text-muted",children:"Holdings"})]}),o.jsxs("div",{className:"text-center p-3 bg-bg-primary rounded-lg",children:[o.jsx("div",{className:"text-2xl font-bold text-rag-green",children:e.corporateEntities.filter(V=>V.entityType==="company").length}),o.jsx("div",{className:"text-xs text-text-muted",children:"Companies"})]})]})]})]}),o.jsx(Nwe,{}),o.jsx("div",{className:"w-full bg-bg-card rounded-xl border border-border p-5",children:o.jsx(Ewe,{})}),o.jsxs("div",{className:"w-full bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(Np,{className:"w-5 h-5 text-accent-blue"}),o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Data Storage"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Storage Used"}),o.jsxs("span",{className:"text-text-primary font-medium",children:[ue," KB"]})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Storage Type"}),o.jsx("span",{className:"text-text-primary",children:"Browser localStorage"})]}),o.jsxs("div",{className:"flex justify-between text-sm",children:[o.jsx("span",{className:"text-text-secondary",children:"Total Records"}),o.jsx("span",{className:"text-text-primary",children:e.pillars.length+e.kpis.length+e.initiatives.length+e.projects.length+e.tasks.length+e.resources.length+(e.milestones?.length||0)})]})]}),o.jsxs("div",{className:"mt-4 border-t border-border pt-4",children:[o.jsxs("button",{onClick:()=>s(!i),className:"w-full flex items-center justify-between text-sm text-text-secondary hover:text-text-primary",children:[o.jsx("span",{className:"font-medium",children:"Entity Breakdown & Management"}),i?o.jsx(Ra,{className:"w-4 h-4"}):o.jsx(ha,{className:"w-4 h-4"})]}),i&&o.jsxs("div",{className:"mt-4 space-y-2",children:[uI.map(V=>{const K=M(V.key),ie=P(V);return o.jsxs("div",{className:"flex items-center justify-between p-3 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:V.color,children:V.icon}),o.jsxs("div",{children:[o.jsx("span",{className:"text-sm font-medium text-text-primary",children:V.label}),o.jsxs("span",{className:"ml-2 text-sm text-text-muted",children:["(",K,")"]}),ie.count>0&&o.jsxs("span",{className:"ml-2 text-xs text-rag-amber",children:["(",ie.count," children)"]})]})]}),o.jsx(Xe,{onClick:()=>R(V),variant:"secondary",size:"sm",disabled:K===0,icon:o.jsx(ac,{className:"w-3 h-3"}),children:"Clear"})]},V.key)}),L.length>0&&o.jsxs("div",{className:"mt-4 p-4 bg-rag-amber/10 border border-rag-amber/30 rounded-lg",children:[o.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[o.jsx(jn,{className:"w-4 h-4 text-rag-amber mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Orphaned Records Detected"}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"These items have invalid parent references:"})]})]}),o.jsx("ul",{className:"text-sm text-text-secondary mb-3 ml-6",children:L.map(V=>o.jsxs("li",{children:[V.count," ",V.label]},V.key))}),o.jsx(Xe,{onClick:te,variant:"secondary",size:"sm",icon:o.jsx(ac,{className:"w-3 h-3"}),children:"Clean Up Orphans"})]})]})]}),o.jsx("div",{className:"mt-4 p-3 bg-accent-blue/10 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Gu,{className:"w-4 h-4 text-accent-blue mt-0.5"}),o.jsx("p",{className:"text-xs text-text-secondary",children:"Data is stored in your browser's localStorage. Export a backup before clearing your browser data to avoid losing your work."})]})})]}),o.jsxs("div",{className:"w-full bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(co,{className:"w-5 h-5 text-accent-purple"}),o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Data Management"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 bg-bg-hover rounded-lg",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-medium text-text-primary",children:"Reset to Demo Data"}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Restore the sample Balanced Scorecard data for testing."})]}),o.jsx(Xe,{onClick:A,variant:"secondary",size:"sm",icon:o.jsx(co,{className:"w-4 h-4"}),children:"Reset"})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-rag-red/10 rounded-lg border border-rag-red/20",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-sm font-medium text-text-primary flex items-center gap-2",children:[o.jsx(jn,{className:"w-4 h-4 text-rag-red"}),"Delete All Data"]}),o.jsx("p",{className:"text-xs text-text-muted mt-1",children:"Permanently delete everything including sample data. Start fresh."}),o.jsx("p",{className:"text-xs text-text-muted",children:'Use "Reset to Demo Data" above to restore sample data afterward.'})]}),o.jsx(Xe,{onClick:D,variant:"danger",size:"sm",icon:o.jsx(ac,{className:"w-4 h-4"}),children:"Delete All"})]})]})]}),o.jsxs("div",{className:"w-full bg-bg-card rounded-xl border border-border p-5",children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary mb-4",children:"About StratOS AI"}),o.jsxs("div",{className:"space-y-2 text-sm text-text-secondary",children:[o.jsxs("p",{children:[o.jsx("strong",{className:"text-text-primary",children:"Version:"})," 1.0.0"]}),o.jsxs("p",{children:[o.jsx("strong",{className:"text-text-primary",children:"Description:"})," AI-driven Integrated Strategy & Delivery Platform connecting Balanced Scorecard to execution."]}),o.jsx("p",{className:"pt-2",children:"Built with React, TypeScript, TailwindCSS, and Recharts."})]})]})]})},eo=({title:e,icon:t,children:r,defaultOpen:n=!1})=>{const[a,i]=k.useState(n);return o.jsxs("div",{className:"border border-border rounded-lg overflow-hidden",children:[o.jsxs("button",{onClick:()=>i(!a),className:"w-full flex items-center justify-between px-4 py-3 bg-bg-card hover:bg-bg-hover transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-accent-blue/10 rounded-lg text-accent-blue",children:t}),o.jsx("span",{className:"font-medium text-text-primary",children:e})]}),a?o.jsx(Ra,{className:"w-5 h-5 text-text-muted"}):o.jsx(ha,{className:"w-5 h-5 text-text-muted"})]}),a&&o.jsx("div",{className:"px-4 py-4 bg-bg-primary border-t border-border",children:r})]})},Cwe=()=>o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:"Help & Documentation"}),o.jsx("p",{className:"text-text-secondary mt-1",children:"Learn how to use StratOS AI effectively"})]}),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-bg-card rounded-lg border border-border",children:[o.jsx(QI,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"text-sm text-text-secondary",children:"User Guide"})]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-5",children:[o.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-accent-purple/20 rounded-lg",children:o.jsx(Ea,{className:"w-5 h-5 text-accent-purple"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg font-semibold text-text-primary",children:"Welcome to StratOS AI"}),o.jsx("p",{className:"text-text-secondary mt-1",children:'StratOS AI is an AI-driven Integrated Strategy & Delivery Platform that connects strategic goals to operational execution through the "Golden Thread" - a hierarchical framework that links every task back to strategic objectives.'})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4",children:[o.jsxs(Xn,{to:"/",className:"flex items-center gap-3 p-3 bg-bg-hover rounded-lg hover:bg-bg-secondary transition-colors",children:[o.jsx(gr,{className:"w-6 h-6 text-accent-blue"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Dashboards"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Strategic overview"})]})]}),o.jsxs(Xn,{to:"/strategy",className:"flex items-center gap-3 p-3 bg-bg-hover rounded-lg hover:bg-bg-secondary transition-colors",children:[o.jsx(Wu,{className:"w-6 h-6 text-rag-green"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Strategy Hub"}),o.jsx("p",{className:"text-xs text-text-muted",children:"KPIs & Pillars"})]})]}),o.jsxs(Xn,{to:"/portfolio",className:"flex items-center gap-3 p-3 bg-bg-hover rounded-lg hover:bg-bg-secondary transition-colors",children:[o.jsx(Vu,{className:"w-6 h-6 text-accent-purple"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Portfolio"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Initiatives & Projects"})]})]}),o.jsxs(Xn,{to:"/execution",className:"flex items-center gap-3 p-3 bg-bg-hover rounded-lg hover:bg-bg-secondary transition-colors",children:[o.jsx(Ai,{className:"w-6 h-6 text-accent-cyan"}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-text-primary",children:"Execution"}),o.jsx("p",{className:"text-xs text-text-muted",children:"Tasks & Kanban"})]})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx(eo,{title:"The Golden Thread Hierarchy",icon:o.jsx(Wu,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"The Golden Thread is a strict 4-level hierarchy that ensures every piece of work can be traced back to strategic objectives:"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-bg-hover rounded-lg",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-blue/20 flex items-center justify-center text-accent-blue font-bold",children:"1"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Strategy Pillars (Balanced Scorecard)"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"The four perspectives: Financial, Customer, Internal Processes, and Learning & Growth. These represent your organization's strategic focus areas."})]})]}),o.jsx("div",{className:"flex items-center justify-center",children:o.jsx(Kt,{className:"w-4 h-4 text-text-muted rotate-90"})}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-bg-hover rounded-lg",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-purple/20 flex items-center justify-center text-accent-purple font-bold",children:"2"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Initiatives (Programs/Portfolios)"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Major programs or portfolios linked to a single Strategy Pillar. Each initiative has a budget, timeline, and owner."})]})]}),o.jsx("div",{className:"flex items-center justify-center",children:o.jsx(Kt,{className:"w-4 h-4 text-text-muted rotate-90"})}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-bg-hover rounded-lg",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-accent-cyan/20 flex items-center justify-center text-accent-cyan font-bold",children:"3"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Projects"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Time-bound execution vehicles linked to a single Initiative. Projects have budgets, timelines, and RAG status tracking."})]})]}),o.jsx("div",{className:"flex items-center justify-center",children:o.jsx(Kt,{className:"w-4 h-4 text-text-muted rotate-90"})}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-bg-hover rounded-lg",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-rag-green/20 flex items-center justify-center text-rag-green font-bold",children:"4"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Tasks"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Granular work items linked to a single Project. Tasks are managed via Kanban board with statuses: To Do, In Progress, Blocked, Done."})]})]})]})]})}),o.jsx(eo,{title:"RAG Status Explained",icon:o.jsx(jn,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"RAG (Red, Amber, Green) status is used throughout the platform to indicate health and risk levels:"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-rag-green/10 border border-rag-green/30 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-green"}),o.jsx("span",{className:"font-medium text-rag-green",children:"Green - On Track"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Everything is progressing as planned. No immediate action required."})]}),o.jsxs("div",{className:"p-4 bg-rag-amber/10 border border-rag-amber/30 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-amber"}),o.jsx("span",{className:"font-medium text-rag-amber",children:"Amber - At Risk"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Some issues identified that may impact delivery. Monitor closely and take preventive action."})]}),o.jsxs("div",{className:"p-4 bg-rag-red/10 border border-rag-red/30 rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full bg-rag-red"}),o.jsx("span",{className:"font-medium text-rag-red",children:"Red - Critical"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Significant issues requiring immediate attention. Escalation and intervention needed."})]})]})]})}),o.jsx(eo,{title:"Risk Score Calculation",icon:o.jsx(c$,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("p",{className:"text-sm text-text-secondary",children:['The Risk Score (0-100) provides a comprehensive assessment of initiative health based on the project management "holy trinity" of ',o.jsx("strong",{children:"Cost, Scope, and Time"}),", plus resource and quality dimensions. A score of 0 means everything is on track."]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("div",{className:"text-lg font-bold text-accent-blue mb-1",children:""}),o.jsx("p",{className:"text-xs font-medium text-text-primary",children:"Time"}),o.jsx("p",{className:"text-[10px] text-text-muted",children:"25% weight"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("div",{className:"text-lg font-bold text-accent-blue mb-1",children:""}),o.jsx("p",{className:"text-xs font-medium text-text-primary",children:"Cost"}),o.jsx("p",{className:"text-[10px] text-text-muted",children:"25% weight"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("div",{className:"text-lg font-bold text-accent-blue mb-1",children:""}),o.jsx("p",{className:"text-xs font-medium text-text-primary",children:"Scope"}),o.jsx("p",{className:"text-[10px] text-text-muted",children:"20% weight"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("div",{className:"text-lg font-bold text-accent-blue mb-1",children:""}),o.jsx("p",{className:"text-xs font-medium text-text-primary",children:"Resource"}),o.jsx("p",{className:"text-[10px] text-text-muted",children:"15% weight"})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg text-center",children:[o.jsx("div",{className:"text-lg font-bold text-accent-blue mb-1",children:""}),o.jsx("p",{className:"text-xs font-medium text-text-primary",children:"Quality"}),o.jsx("p",{className:"text-[10px] text-text-muted",children:"15% weight"})]})]}),o.jsxs("div",{className:"bg-bg-hover rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Key Performance Indices"}),o.jsxs("div",{className:"space-y-3 text-sm",children:[o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-primary font-medium",children:"SPI (Schedule Performance Index)"}),o.jsx("p",{className:"text-xs text-text-muted",children:"% Complete  % Time Elapsed"})]}),o.jsx("span",{className:"text-text-secondary",children:"1.0 = On schedule"})]}),o.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-border",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-text-primary font-medium",children:"CPI (Cost Performance Index)"}),o.jsx("p",{className:"text-xs text-text-muted",children:"% Complete  % Budget Spent"})]}),o.jsx("span",{className:"text-text-secondary",children:"1.0 = On budget"})]})]})]}),o.jsxs("div",{className:"bg-bg-hover rounded-lg p-4",children:[o.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"Risk Factors Evaluated"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-semibold text-accent-blue mb-2",children:"Schedule (Time)"}),o.jsxs("ul",{className:"text-text-secondary space-y-1 text-xs",children:[o.jsx("li",{children:" SPI below target (behind schedule)"}),o.jsx("li",{children:" Overdue tasks percentage"}),o.jsx("li",{children:" Projects significantly behind"})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-semibold text-rag-green mb-2",children:"Cost (Budget)"}),o.jsxs("ul",{className:"text-text-secondary space-y-1 text-xs",children:[o.jsx("li",{children:" CPI below target (over budget)"}),o.jsx("li",{children:" Budget variance percentage"}),o.jsx("li",{children:" Projects exceeding budget"})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-semibold text-accent-purple mb-2",children:"Scope (Delivery)"}),o.jsxs("ul",{className:"text-text-secondary space-y-1 text-xs",children:[o.jsx("li",{children:" Completion vs timeline gap"}),o.jsx("li",{children:" Scope change requests"}),o.jsx("li",{children:" Task completion rate"})]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-xs font-semibold text-rag-amber mb-2",children:"Resource & Quality"}),o.jsxs("ul",{className:"text-text-secondary space-y-1 text-xs",children:[o.jsx("li",{children:" Over-allocated team members"}),o.jsx("li",{children:" Key person dependencies"}),o.jsx("li",{children:" Blocked tasks ratio"}),o.jsx("li",{children:" RAG status indicators"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[o.jsxs("div",{className:"p-3 bg-rag-green/10 border border-rag-green/30 rounded-lg text-center",children:[o.jsx("p",{className:"text-xl font-bold text-rag-green",children:"0-25"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Low"})]}),o.jsxs("div",{className:"p-3 bg-rag-amber/10 border border-rag-amber/30 rounded-lg text-center",children:[o.jsx("p",{className:"text-xl font-bold text-rag-amber",children:"26-50"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Medium"})]}),o.jsxs("div",{className:"p-3 bg-rag-red/10 border border-rag-red/30 rounded-lg text-center",children:[o.jsx("p",{className:"text-xl font-bold text-rag-red",children:"51-75"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"High"})]}),o.jsxs("div",{className:"p-3 bg-rag-red/20 border border-rag-red/50 rounded-lg text-center",children:[o.jsx("p",{className:"text-xl font-bold text-rag-red",children:"76-100"}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Critical"})]})]}),o.jsx("div",{className:"p-4 bg-accent-blue/10 border border-accent-blue/30 rounded-lg",children:o.jsxs("p",{className:"text-sm text-text-primary",children:[o.jsx("strong",{children:"Tip:"})," Click on any Risk Score in the Portfolio grid to see the detailed breakdown including SPI, CPI, and individual risk factors contributing to the score."]})})]})}),o.jsx(eo,{title:"AI-Powered Insights",icon:o.jsx(Ea,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"StratOS AI uses Claude AI to analyze your organizational data and provide actionable insights:"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Executive Summary"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"AI-generated overview of organizational health, highlighting key risks, opportunities, and recommendations for leadership."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Pillar Insights"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Specific analysis for each Balanced Scorecard pillar, identifying trends and areas needing attention."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Project Suggestions"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:'AI "Fix-it" suggestions for projects showing risk indicators, with actionable recommendations to get back on track.'})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Resource Alerts"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Identifies team members who may be over-allocated or underutilized based on task assignments and capacity."})]})]}),o.jsx("div",{className:"p-4 bg-accent-blue/10 border border-accent-blue/30 rounded-lg",children:o.jsxs("p",{className:"text-sm text-text-primary",children:[o.jsx("strong",{children:"Setup:"})," To enable AI insights, go to"," ",o.jsx(Xn,{to:"/settings",className:"text-accent-blue hover:underline",children:"Settings"})," ","and enter your Claude API key."]})})]})}),o.jsx(eo,{title:"User Personas & Views",icon:o.jsx(ri,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"StratOS AI is designed for different user personas, each with their own focus and default view:"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"p-4 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx(gr,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"font-medium text-text-primary",children:"Board of Directors / C-Suite"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Focus on strategic health, outcomes, and high-level risks. Uses the Strategic Command Center with BSC cards and AI executive summary."})]}),o.jsxs("div",{className:"p-4 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx(Vu,{className:"w-5 h-5 text-accent-purple"}),o.jsx("span",{className:"font-medium text-text-primary",children:"PMO (Project Management Office)"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Focus on portfolio health, resource allocation, and systemic risks. Uses the Portfolio Oversight Hub with roadmap and data grid views."})]}),o.jsxs("div",{className:"p-4 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx(Ai,{className:"w-5 h-5 text-accent-cyan"}),o.jsx("span",{className:"font-medium text-text-primary",children:"Business Process Owner"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Focus on execution, team performance, and task delivery. Uses the Operational Delivery Dashboard with Kanban board and project KPIs."})]})]})]})}),o.jsx(eo,{title:"Budget & Financial Tracking",icon:o.jsx(sd,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Budget tracking is available at both Initiative and Project levels:"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Budget Allocation"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Each initiative and project has an allocated budget set during creation or import."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Spent Budget"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Track actual spend against allocated budget. Update this as costs are incurred."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Budget Variance"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"The difference between spent and allocated budget. Positive values (red) indicate overspend; negative values (green) indicate underspend."})]})]}),o.jsx("div",{className:"p-4 bg-rag-amber/10 border border-rag-amber/30 rounded-lg",children:o.jsxs("p",{className:"text-sm text-text-primary",children:[o.jsx("strong",{children:"Tip:"})," Budget overruns impact the Risk Score. Initiatives exceeding budget by more than 10% receive a significant risk penalty."]})})]})}),o.jsx(eo,{title:"Data Import & Export",icon:o.jsx(UT,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"StratOS AI supports Excel-based data import and export for offline planning:"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"p-4 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(UT,{className:"w-5 h-5 text-accent-blue"}),o.jsx("span",{className:"font-medium text-text-primary",children:"Export"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Download your data as an Excel file with all pillars, KPIs, initiatives, projects, tasks, and resources. Use for reporting or as a template for bulk updates."}),o.jsxs(Xn,{to:"/export",className:"inline-flex items-center gap-1 mt-2 text-sm text-accent-blue hover:underline",children:["Go to Export ",o.jsx(Kt,{className:"w-3 h-3"})]})]}),o.jsxs("div",{className:"p-4 bg-bg-hover rounded-lg",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(G$,{className:"w-5 h-5 text-rag-green"}),o.jsx("span",{className:"font-medium text-text-primary",children:"Smart Import"})]}),o.jsx("p",{className:"text-sm text-text-secondary",children:"Upload Excel files and use the spreadsheet view to map your data to entity fields. Select cells and assign labels from the sidebar."}),o.jsxs(Xn,{to:"/import",className:"inline-flex items-center gap-1 mt-2 text-sm text-accent-blue hover:underline",children:["Go to Import ",o.jsx(Kt,{className:"w-3 h-3"})]})]})]}),o.jsxs("div",{className:"mt-4 p-4 bg-accent-purple/10 border border-accent-purple/30 rounded-lg",children:[o.jsxs("h4",{className:"font-medium text-text-primary mb-3 flex items-center gap-2",children:[o.jsx(Ea,{className:"w-4 h-4 text-accent-purple"}),"How to Use Smart Import"]}),o.jsxs("ol",{className:"text-sm text-text-secondary space-y-2 list-decimal ml-4",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Upload:"})," Drag and drop or select your Excel file (.xlsx, .xls)"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Select Sheet:"})," Choose which sheets to import and set entity type for each (Pillar, Initiative, Project, Task, etc.)"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Map Data:"})," In the spreadsheet view:",o.jsxs("ul",{className:"list-disc ml-4 mt-1",children:[o.jsx("li",{children:"Click cells to select, drag to select range, Ctrl/Cmd+click for multi-select"}),o.jsx("li",{children:"Choose a label from the sidebar (entity fields or reference data)"}),o.jsx("li",{children:'Click "Assign" to map selected cells to the label'}),o.jsx("li",{children:"Double-click any cell to edit its value"})]})]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Preview:"})," Review validation results before importing"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Import:"})," Confirm and import your data into the system"]})]})]}),o.jsxs("div",{className:"mt-4 p-4 bg-accent-blue/10 border border-accent-blue/30 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-text-primary mb-3",children:"PMO Recommended Workflow"}),o.jsxs("div",{className:"text-sm text-text-secondary space-y-2",children:[o.jsx("p",{children:o.jsx("strong",{children:"For Initial Setup:"})}),o.jsxs("ol",{className:"list-decimal ml-4 space-y-1",children:[o.jsxs("li",{children:["First import ",o.jsx("strong",{children:"Strategy Pillars"})," (BSC perspectives) - these are the foundation"]}),o.jsxs("li",{children:["Then import ",o.jsx("strong",{children:"KPIs"})," linked to pillars (strategic metrics)"]}),o.jsxs("li",{children:["Add ",o.jsx("strong",{children:"Initiatives"})," linked to pillars (programs/portfolios)"]}),o.jsxs("li",{children:["Create ",o.jsx("strong",{children:"Projects"})," linked to initiatives"]}),o.jsxs("li",{children:["Finally, add ",o.jsx("strong",{children:"Tasks"})," and ",o.jsx("strong",{children:"Resources"})]})]}),o.jsx("p",{className:"mt-3",children:o.jsx("strong",{children:"Essential Fields by Entity:"})}),o.jsxs("ul",{className:"list-disc ml-4 space-y-1",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Pillar:"})," Name (required), RAG Status"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"KPI:"})," Name, Pillar*, Target Value, Current Value"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Initiative:"})," Name, Pillar*, Owner, Start/End Dates, Budget"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Project:"})," Name, Initiative*, Manager, Status, Dates, Budget"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Task:"})," Title, Project*, Assignee, Due Date, Status"]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Resource:"})," Name, Email, Role, Department"]})]}),o.jsx("p",{className:"text-xs mt-2 italic",children:"* Required parent reference"})]})]})]})}),o.jsx(eo,{title:"Settings & Configuration",icon:o.jsx(mo,{className:"w-5 h-5"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-text-secondary",children:"Configure the platform to match your preferences:"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Claude API Key"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Enter your Anthropic API key to enable AI-powered insights and suggestions."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Data Storage"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"View storage usage and entity breakdown. Expand to see counts for each entity type."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Entity Management"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Clear specific entity types (Pillars, KPIs, Initiatives, Projects, Tasks, Resources, Milestones). System warns you about orphaned child records before deletion."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Orphan Cleanup"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"If you have items with invalid parent references (e.g., a Task pointing to a deleted Project), the system will detect and let you clean them up."})]}),o.jsxs("div",{className:"p-3 bg-bg-hover rounded-lg",children:[o.jsx("p",{className:"font-medium text-text-primary",children:"Reset / Clear All"}),o.jsx("p",{className:"text-sm text-text-secondary mt-1",children:"Reset to demo data or clear everything. Use with caution - these actions cannot be undone."})]})]}),o.jsxs(Xn,{to:"/settings",className:"inline-flex items-center gap-2 px-4 py-2 bg-accent-blue text-white rounded-lg hover:bg-accent-blue/90 transition-colors",children:[o.jsx(mo,{className:"w-4 h-4"}),"Go to Settings"]})]})})]}),o.jsx("div",{className:"bg-bg-card rounded-xl border border-border p-5 text-center",children:o.jsxs("p",{className:"text-sm text-text-secondary",children:["Need more help? Check the"," ",o.jsx(Xn,{to:"/insights",className:"text-accent-blue hover:underline",children:"AI Insights"})," ","page for personalized recommendations based on your data."]})})]}),Awe=({project:e})=>{const{state:t}=Pt(),{tasks:r,resources:n,functionContributions:a}=t,i=r.filter(y=>y.projectId===e.id),s=(a||[]).filter(y=>y.projectId===e.id),c=[],d=new Map;if(i.forEach(y=>{const w=n.find(j=>j.id===y.assigneeId);if(w){const j=d.get(w.departmentCode)||[];j.push(y),d.set(w.departmentCode,j)}}),new Set([...Array.from(d.keys()),...s.map(y=>y.departmentCode)]).forEach(y=>{const w=Un[y],j=d.get(y)||[],T=s.find(A=>A.departmentCode===y),N=j.reduce((A,D)=>A+D.actualHours,0),C=j.reduce((A,D)=>A+D.estimatedHours,0),E=j.filter(A=>A.kanbanStatus==="done").length,O=new Set(j.map(A=>A.assigneeId).filter(A=>A));c.push({departmentCode:y,departmentName:w?.name||y,totalPlannedHours:T?.plannedHours||C,totalActualHours:T?.actualHours||N,resourceCount:T?.assignedResourceIds?.length||O.size,taskCount:j.length,completedTaskCount:E,completionPercentage:T?.completionPercentage||(j.length>0?Math.round(E/j.length*100):0),variance:(T?.actualHours||N)-(T?.plannedHours||C)})}),c.sort((y,w)=>w.taskCount-y.taskCount),c.length===0)return o.jsx("div",{className:"text-center py-8 text-text-muted",children:"No cross-functional contributions tracked yet."});const h=c.reduce((y,w)=>y+w.totalPlannedHours,0),p=c.reduce((y,w)=>y+w.totalActualHours,0),g=c.reduce((y,w)=>y+w.resourceCount,0),v=c.reduce((y,w)=>y+w.taskCount,0),b=c.reduce((y,w)=>y+w.completedTaskCount,0);return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-sm text-text-secondary mb-2",children:["Cross-functional effort allocation for ",o.jsx("span",{className:"font-medium text-text-primary",children:e.name})]}),o.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[o.jsxs("div",{className:"bg-bg-hover rounded-lg p-3 text-center",children:[o.jsx("div",{className:"text-lg font-semibold text-text-primary",children:c.length}),o.jsx("div",{className:"text-xs text-text-muted",children:"Departments"})]}),o.jsxs("div",{className:"bg-bg-hover rounded-lg p-3 text-center",children:[o.jsx("div",{className:"text-lg font-semibold text-text-primary",children:g}),o.jsx("div",{className:"text-xs text-text-muted",children:"Resources"})]}),o.jsxs("div",{className:"bg-bg-hover rounded-lg p-3 text-center",children:[o.jsxs("div",{className:"text-lg font-semibold text-text-primary",children:[h,"h"]}),o.jsx("div",{className:"text-xs text-text-muted",children:"Planned Hours"})]}),o.jsxs("div",{className:"bg-bg-hover rounded-lg p-3 text-center",children:[o.jsxs("div",{className:`text-lg font-semibold ${p>h?"text-rag-red":"text-rag-green"}`,children:[p,"h"]}),o.jsx("div",{className:"text-xs text-text-muted",children:"Actual Hours"})]})]}),o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full text-sm",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b border-border",children:[o.jsx("th",{className:"text-left py-2 px-3 text-text-secondary font-medium",children:"Department"}),o.jsx("th",{className:"text-center py-2 px-3 text-text-secondary font-medium",children:"Resources"}),o.jsx("th",{className:"text-center py-2 px-3 text-text-secondary font-medium",children:"Tasks"}),o.jsx("th",{className:"text-center py-2 px-3 text-text-secondary font-medium",children:"Progress"}),o.jsx("th",{className:"text-right py-2 px-3 text-text-secondary font-medium",children:"Planned"}),o.jsx("th",{className:"text-right py-2 px-3 text-text-secondary font-medium",children:"Actual"}),o.jsx("th",{className:"text-right py-2 px-3 text-text-secondary font-medium",children:"Variance"})]})}),o.jsx("tbody",{children:c.map(y=>{const w=Un[y.departmentCode];return o.jsxs("tr",{className:"border-b border-border/50 hover:bg-bg-hover",children:[o.jsx("td",{className:"py-2 px-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:w?.color||"#888"}}),o.jsx("span",{className:"font-medium text-text-primary",children:y.departmentCode}),o.jsxs("span",{className:"text-text-muted",children:["- ",y.departmentName]})]})}),o.jsx("td",{className:"text-center py-2 px-3 text-text-secondary",children:y.resourceCount}),o.jsxs("td",{className:"text-center py-2 px-3 text-text-secondary",children:[y.completedTaskCount,"/",y.taskCount]}),o.jsx("td",{className:"py-2 px-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 h-2 bg-bg-primary rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-accent-blue rounded-full",style:{width:`${y.completionPercentage}%`}})}),o.jsxs("span",{className:"text-xs text-text-muted w-10 text-right",children:[y.completionPercentage,"%"]})]})}),o.jsxs("td",{className:"text-right py-2 px-3 text-text-secondary",children:[y.totalPlannedHours,"h"]}),o.jsxs("td",{className:"text-right py-2 px-3 text-text-secondary",children:[y.totalActualHours,"h"]}),o.jsxs("td",{className:`text-right py-2 px-3 font-medium ${y.variance>0?"text-rag-red":y.variance<0?"text-rag-green":"text-text-muted"}`,children:[y.variance>0?"+":"",y.variance,"h"]})]},y.departmentCode)})}),o.jsx("tfoot",{children:o.jsxs("tr",{className:"bg-bg-hover font-medium",children:[o.jsx("td",{className:"py-2 px-3 text-text-primary",children:"Total"}),o.jsx("td",{className:"text-center py-2 px-3 text-text-primary",children:g}),o.jsxs("td",{className:"text-center py-2 px-3 text-text-primary",children:[b,"/",v]}),o.jsx("td",{className:"py-2 px-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"flex-1 h-2 bg-bg-primary rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-accent-blue rounded-full",style:{width:`${v>0?Math.round(b/v*100):0}%`}})}),o.jsxs("span",{className:"text-xs text-text-muted w-10 text-right",children:[v>0?Math.round(b/v*100):0,"%"]})]})}),o.jsxs("td",{className:"text-right py-2 px-3 text-text-primary",children:[h,"h"]}),o.jsxs("td",{className:"text-right py-2 px-3 text-text-primary",children:[p,"h"]}),o.jsxs("td",{className:`text-right py-2 px-3 ${p-h>0?"text-rag-red":"text-rag-green"}`,children:[p-h>0?"+":"",p-h,"h"]})]})})]})}),o.jsxs("div",{className:"mt-4",children:[o.jsx("div",{className:"text-xs text-text-muted mb-2",children:"Effort Distribution by Department"}),o.jsx("div",{className:"h-6 bg-bg-primary rounded-full overflow-hidden flex",children:c.map(y=>{const w=h>0?y.totalPlannedHours/h*100:0;if(w<1)return null;const j=Un[y.departmentCode];return o.jsx("div",{className:"h-full flex items-center justify-center text-xs text-white font-medium",style:{width:`${w}%`,backgroundColor:j?.color||"#888"},title:`${y.departmentCode}: ${Math.round(w)}%`,children:w>10&&y.departmentCode},y.departmentCode)})})]})]})},Owe=()=>{const{projectId:e}=NI(),t=fa(),{state:r}=Pt(),{projects:n,initiatives:a,pillars:i,kpis:s,resources:c,tasks:d}=r,f=n.find(ee=>ee.id===e);if(!f)return o.jsx("div",{className:"w-full p-6",children:o.jsxs("div",{className:"text-center py-12",children:[o.jsx("h2",{className:"text-xl text-text-primary",children:"Project Not Found"}),o.jsx("button",{onClick:()=>t(-1),className:"mt-4 text-accent-blue hover:underline",children:"Go Back"})]})});const h=a.find(ee=>ee.id===f.initiativeId),p=h?i.find(ee=>ee.id===h.pillarId):null,g=c.find(ee=>ee.id===f.managerId),v=h?.linkedKpiIds?s.filter(ee=>h.linkedKpiIds?.includes(ee.id)):[],b=d.filter(ee=>ee.projectId===f.id),y=b.filter(ee=>ee.kanbanStatus==="done").length,w=b.filter(ee=>ee.kanbanStatus==="blocked").length,j=b.reduce((ee,ue)=>ee+ue.estimatedHours,0),T=b.reduce((ee,ue)=>ee+ue.actualHours,0),N=Un[f.departmentCode],C=Hi[f.category],E=f.spentBudget-f.budget,O=f.budget>0?Math.round(f.spentBudget/f.budget*100):0,A=new Date,D=new Date(f.endDate),M=new Date(f.startDate),P=D.getTime()-M.getTime(),R=A.getTime()-M.getTime(),L=Math.min(100,Math.max(0,Math.round(R/P*100))),te=f.completionPercentage-L;return o.jsxs("div",{className:"w-full space-y-6",children:[o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("button",{onClick:()=>t(-1),className:"p-2 rounded-lg hover:bg-bg-hover text-text-muted hover:text-text-primary transition-colors",children:o.jsx(Fx,{className:"w-5 h-5"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[o.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-mono font-semibold",style:{backgroundColor:`${N?.color}20`,color:N?.color},children:f.workId}),o.jsx(ic,{status:f.ragStatus})]}),o.jsx("h1",{className:"text-2xl font-bold text-text-primary",children:f.name}),o.jsx("p",{className:"text-text-secondary mt-1",children:f.description||"No description provided."})]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsxs("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[o.jsx(gr,{className:"w-4 h-4"}),"Strategic Alignment (Golden Thread)"]}),o.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[p&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-bg-hover rounded-lg",children:[o.jsx(Wu,{className:"w-4 h-4 text-accent-purple"}),o.jsx("span",{className:"text-text-secondary",children:"Pillar:"}),o.jsx("span",{className:"font-medium text-text-primary",children:p.name}),o.jsx(ic,{status:p.ragStatus,size:"sm"})]}),o.jsx("span",{className:"text-text-muted",children:""})]}),h&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-bg-hover rounded-lg",children:[o.jsx(Ai,{className:"w-4 h-4 text-accent-blue"}),o.jsx("span",{className:"text-text-secondary",children:"Initiative:"}),o.jsx("span",{className:"font-medium text-text-primary",children:h.name}),o.jsx(ic,{status:h.ragStatus,size:"sm"})]}),o.jsx("span",{className:"text-text-muted",children:""})]}),o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-accent-blue/10 border border-accent-blue/30 rounded-lg",children:[o.jsx("span",{className:"text-text-secondary",children:"Project:"}),o.jsx("span",{className:"font-medium text-accent-blue",children:f.name})]})]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsx("h3",{className:"text-sm font-medium text-text-secondary mb-3",children:"Classification"}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Department"}),o.jsxs("span",{className:"px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:`${N?.color}20`,color:N?.color},children:[N?.code," - ",N?.name]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Category"}),o.jsx("span",{className:"px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:`${C?.color}20`,color:C?.color},children:C?.name})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Fiscal Year"}),o.jsxs("span",{className:"text-text-primary font-medium",children:["FY",f.fiscalYear]})]})]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsxs("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[o.jsx(ri,{className:"w-4 h-4"}),"Project Manager"]}),g?o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-sm font-medium text-white",style:{backgroundColor:g.avatarColor},children:g.name.split(" ").map(ee=>ee[0]).join("")}),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium text-text-primary",children:g.name}),o.jsx("div",{className:"text-sm text-text-muted",children:g.role})]})]}):o.jsx("div",{className:"text-text-muted",children:"No manager assigned"})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsxs("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[o.jsx(Zw,{className:"w-4 h-4"}),"Timeline"]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Start Date"}),o.jsx("span",{className:"text-text-primary",children:f.startDate})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"End Date"}),o.jsx("span",{className:"text-text-primary",children:f.endDate})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-text-muted",children:"Status"}),o.jsx("span",{className:"text-text-primary capitalize",children:f.status.replace("_"," ")})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsxs("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[o.jsx(sd,{className:"w-4 h-4"}),"Budget Performance"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-2xl font-bold text-text-primary",children:["$",f.spentBudget.toLocaleString()]}),o.jsxs("div",{className:"text-sm text-text-muted",children:["of $",f.budget.toLocaleString()," budget"]})]}),o.jsxs("div",{className:`text-lg font-semibold ${E>0?"text-rag-red":"text-rag-green"}`,children:[E>0?"+":"","$",E.toLocaleString()]})]}),o.jsx("div",{className:"h-3 bg-bg-hover rounded-full overflow-hidden",children:o.jsx("div",{className:`h-full rounded-full transition-all ${O>100?"bg-rag-red":O>80?"bg-rag-amber":"bg-rag-green"}`,style:{width:`${Math.min(O,100)}%`}})}),o.jsxs("div",{className:"text-sm text-text-muted text-right",children:[O,"% consumed"]})]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsxs("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[o.jsx(Ac,{className:"w-4 h-4"}),"Progress & Schedule"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"text-2xl font-bold text-text-primary",children:[f.completionPercentage,"%"]}),o.jsx("div",{className:"text-sm text-text-muted",children:"Complete"})]}),o.jsxs("div",{className:`text-sm ${te>=0?"text-rag-green":"text-rag-red"}`,children:[te>=0?"Ahead":"Behind"," by ",Math.abs(te),"%"]})]}),o.jsxs("div",{className:"h-3 bg-bg-hover rounded-full overflow-hidden relative",children:[o.jsx("div",{className:"h-full bg-accent-blue rounded-full transition-all",style:{width:`${f.completionPercentage}%`}}),o.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-text-muted",style:{left:`${L}%`},title:`Expected: ${L}%`})]}),o.jsxs("div",{className:"flex justify-between text-sm text-text-muted",children:[o.jsxs("span",{children:["Actual: ",f.completionPercentage,"%"]}),o.jsxs("span",{children:["Expected: ",L,"%"]})]})]})]})]}),v.length>0&&o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsx("h3",{className:"text-sm font-medium text-text-secondary mb-3",children:"Linked Strategic KPIs"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:v.map(ee=>{const ue=ee.targetValue>0?Math.round(ee.currentValue/ee.targetValue*100):0;return o.jsxs("div",{className:"bg-bg-hover rounded-lg p-3",children:[o.jsx("div",{className:"text-sm font-medium text-text-primary mb-1",children:ee.name}),o.jsxs("div",{className:"flex items-end justify-between",children:[o.jsxs("div",{children:[o.jsxs("span",{className:"text-lg font-bold text-accent-blue",children:[ee.currentValue,ee.unit==="%"?"%":""]}),o.jsxs("span",{className:"text-text-muted text-sm",children:[" ","/ ",ee.targetValue,ee.unit==="%"?"%":""]})]}),o.jsxs("span",{className:"text-xs text-text-muted",children:[ue,"%"]})]})]},ee.id)})})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsxs("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[o.jsx(fo,{className:"w-4 h-4"}),"Task Summary"]}),o.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-text-primary",children:b.length}),o.jsx("div",{className:"text-sm text-text-muted",children:"Total Tasks"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-rag-green",children:y}),o.jsx("div",{className:"text-sm text-text-muted",children:"Completed"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-rag-amber",children:b.filter(ee=>ee.kanbanStatus==="in_progress").length}),o.jsx("div",{className:"text-sm text-text-muted",children:"In Progress"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-2xl font-bold text-rag-red",children:w}),o.jsx("div",{className:"text-sm text-text-muted",children:"Blocked"})]}),o.jsxs("div",{className:"text-center",children:[o.jsxs("div",{className:`text-2xl font-bold ${T>j?"text-rag-red":"text-rag-green"}`,children:[T,"h"]}),o.jsxs("div",{className:"text-sm text-text-muted",children:["of ",j,"h est."]})]})]}),w>0&&o.jsxs("div",{className:"mt-3 p-2 bg-rag-red/10 border border-rag-red/30 rounded-lg flex items-center gap-2",children:[o.jsx(jn,{className:"w-4 h-4 text-rag-red"}),o.jsxs("span",{className:"text-sm text-rag-red",children:[w," task",w>1?"s":""," blocked - requires attention"]})]})]}),o.jsxs("div",{className:"bg-bg-card rounded-xl border border-border p-4",children:[o.jsxs("h3",{className:"text-sm font-medium text-text-secondary mb-3 flex items-center gap-2",children:[o.jsx(ri,{className:"w-4 h-4"}),"Cross-Functional Resource Allocation"]}),o.jsx(Awe,{project:f})]})]})},nc=["corporate","organization","golden-thread"],Dwe={corporate:"Corporate Structure",organization:"Organization Units","golden-thread":"Golden Thread"};function Iwe(){const{state:e,dispatch:t}=Pt(),[r,n]=k.useState(()=>({currentStep:"corporate",corporateEntities:e.corporateEntities||[],orgUnits:e.orgUnits||[],pillars:e.pillars||[],selectedCompanyId:null,isDirty:!1})),a=nc.indexOf(r.currentStep),i=nc.length,s=a>0,c=a<i-1,d=a===i-1,f=k.useCallback(M=>{n(P=>({...P,currentStep:M}))},[]),h=k.useCallback(()=>{c&&n(M=>({...M,currentStep:nc[a+1]}))},[c,a]),p=k.useCallback(()=>{s&&n(M=>({...M,currentStep:nc[a-1]}))},[s,a]),g=k.useCallback(M=>{const P=DI(M);n(R=>({...R,corporateEntities:[...R.corporateEntities,P],isDirty:!0}))},[]),v=k.useCallback((M,P)=>{n(R=>({...R,corporateEntities:R.corporateEntities.map(L=>L.id===M?{...L,...P,updatedAt:new Date().toISOString()}:L),isDirty:!0}))},[]),b=k.useCallback(M=>{n(P=>({...P,corporateEntities:P.corporateEntities.filter(R=>R.id!==M),orgUnits:P.orgUnits.filter(R=>R.companyId!==M),isDirty:!0}))},[]),y=k.useCallback(M=>{n(P=>({...P,selectedCompanyId:M}))},[]),w=k.useCallback(M=>{const P=Mf(M);n(R=>({...R,orgUnits:[...R.orgUnits,P],isDirty:!0}))},[]),j=k.useCallback((M,P)=>{n(R=>({...R,orgUnits:R.orgUnits.map(L=>L.id===M?{...L,...P,updatedAt:new Date().toISOString()}:L),isDirty:!0}))},[]),T=k.useCallback(M=>{n(P=>({...P,orgUnits:P.orgUnits.filter(R=>R.id!==M),isDirty:!0}))},[]),N=k.useCallback(M=>{n(P=>({...P,pillars:[...P.pillars,M],isDirty:!0}))},[]),C=k.useCallback((M,P)=>{n(R=>({...R,pillars:R.pillars.map(L=>L.id===M?{...L,...P}:L),isDirty:!0}))},[]),E=k.useCallback(M=>{n(P=>({...P,pillars:P.pillars.filter(R=>R.id!==M),isDirty:!0}))},[]),O=k.useCallback(()=>{r.corporateEntities.forEach(M=>{const P=e.corporateEntities?.find(R=>R.id===M.id);t(P?{type:"UPDATE_CORPORATE_ENTITY",payload:M}:{type:"ADD_CORPORATE_ENTITY",payload:M})}),r.orgUnits.forEach(M=>{const P=e.orgUnits?.find(R=>R.id===M.id);t(P?{type:"UPDATE_ORG_UNIT",payload:M}:{type:"ADD_ORG_UNIT",payload:M})}),r.pillars.forEach(M=>{const P=e.pillars?.find(R=>R.id===M.id);t(P?{type:"UPDATE_PILLAR",payload:M}:{type:"ADD_PILLAR",payload:M})}),t({type:"SET_SETUP_WIZARD_COMPLETED",payload:!0}),n(M=>({...M,isDirty:!1}))},[r,e,t]),A=k.useCallback(()=>{n({currentStep:"corporate",corporateEntities:e.corporateEntities||[],orgUnits:e.orgUnits||[],pillars:e.pillars||[],selectedCompanyId:null,isDirty:!1})},[e]),D=k.useCallback(()=>{n({currentStep:"corporate",corporateEntities:[],orgUnits:[],pillars:[],selectedCompanyId:null,isDirty:!0})},[]);return{state:r,currentStep:r.currentStep,stepIndex:a,totalSteps:i,canGoBack:s,canGoNext:c,isComplete:d,goToStep:f,goNext:h,goBack:p,addCorporateEntity:g,updateCorporateEntity:v,deleteCorporateEntity:b,selectCompany:y,addOrgUnit:w,updateOrgUnit:j,deleteOrgUnit:T,addPillar:N,updatePillar:C,deletePillar:E,saveAndComplete:O,cancel:A,reset:D}}const Rwe={corporate:o.jsx(gl,{className:"w-4 h-4"}),organization:o.jsx(Lx,{className:"w-4 h-4"}),"golden-thread":o.jsx(gr,{className:"w-4 h-4"})},Mwe=({currentStep:e,completedSteps:t=[],onStepClick:r})=>{const n=nc.indexOf(e);return o.jsx("div",{className:"flex items-center justify-center gap-2 py-4 px-6 bg-[var(--cds-layer-01)] border-b border-[var(--cds-border-subtle-00)]",children:nc.map((a,i)=>{const s=a===e,c=t.includes(a)||i<n,d=r&&(c||i<=n);return o.jsxs(Nt.Fragment,{children:[o.jsxs("button",{onClick:()=>d&&r?.(a),disabled:!d,className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-all ${s?"bg-[var(--cds-interactive)] text-white":c?"bg-[var(--cds-support-success)] text-white":"bg-[var(--cds-field-01)] text-[var(--cds-text-secondary)]"} ${d?"cursor-pointer hover:opacity-90":"cursor-default"}`,children:[o.jsx("span",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-white/20",children:c&&!s?o.jsx(Zf,{className:"w-4 h-4"}):o.jsx("span",{className:"text-sm font-medium",children:i+1})}),o.jsx("span",{className:"text-sm font-medium hidden sm:inline",children:Dwe[a]}),o.jsx("span",{className:"sm:hidden",children:Rwe[a]})]}),i<nc.length-1&&o.jsx("div",{className:`w-8 h-0.5 ${i<n?"bg-[var(--cds-support-success)]":"bg-[var(--cds-border-subtle-01)]"}`})]},a)})})},Rf={corporation:o.jsx(gl,{className:"w-4 h-4 text-[var(--cds-support-info)]"}),holding:o.jsx(S2,{className:"w-4 h-4 text-[var(--cds-support-warning)]"}),company:o.jsx(U$,{className:"w-4 h-4 text-[var(--cds-support-success)]"})},dp={corporation:"Corporation",holding:"Holding Company",company:"Operating Company"};function aB(e){return e==="corporation"?"holding":e==="holding"?"company":null}function iB(e,t,r){let n=e.find(a=>a.id===r);for(;n;){if(n.id===t)return!0;n=e.find(a=>a.id===n?.parentEntityId)}return!1}const m2=({id:e,isActive:t,position:r,depth:n})=>{const{setNodeRef:a,isOver:i}=dh({id:e}),s=i||t;return r==="child"?o.jsx("div",{ref:a,className:`
          mx-2 my-1 rounded-lg border-2 border-dashed transition-all
          ${s?"h-8 border-[var(--cds-interactive)] bg-[var(--cds-interactive)]/10":"h-0 border-transparent"}
        `,style:{marginLeft:`${(n+1)*20+8}px`},children:s&&o.jsxs("div",{className:"flex items-center gap-2 h-full px-3 text-xs text-[var(--cds-interactive)]",children:[o.jsx(Jw,{className:"w-3 h-3"}),o.jsx("span",{children:"Drop as child"})]})}):o.jsx("div",{ref:a,className:`relative transition-all ${s?"h-1":"h-0"}`,children:s&&o.jsx("div",{className:"absolute left-0 right-0 h-1 bg-[var(--cds-interactive)]",style:{marginLeft:`${n*20+8}px`},children:o.jsx("div",{className:"absolute -left-1 -top-1 w-3 h-3 bg-[var(--cds-interactive)] rounded-full"})})})},sB=({entity:e,entities:t,depth:r,onAdd:n,onUpdate:a,onDelete:i,activeId:s,dropTarget:c,selectedId:d,onSelect:f})=>{const[h,p]=k.useState(!0),[g,v]=k.useState(!1),[b,y]=k.useState(e.name),w=k.useRef(null),j=t.filter(K=>K.parentEntityId===e.id),T=j.length>0,N=d===e.id,C=s===e.id,E=aB(e.entityType),O=E!==null,{attributes:A,listeners:D,setNodeRef:M,transform:P}=Dg({id:e.id}),R=P?{transform:`translate3d(${P.x}px, ${P.y}px, 0)`,zIndex:1e3}:void 0,L=s!==null&&s!==e.id&&!iB(t,s,e.id);k.useEffect(()=>{g&&w.current&&(w.current.focus(),w.current.select())},[g]);const te=()=>{b.trim()?a(e.id,{name:b.trim()}):y(e.name),v(!1)},ee=()=>{E&&(n({name:`New ${dp[E]}`,entityType:E,parentEntityId:e.id,hasBSC:!0,bscScope:E==="company"?"standalone":"consolidated"}),p(!0))},ue=()=>{const K=e.entityType;n({name:`New ${dp[K]}`,entityType:K,parentEntityId:e.parentEntityId||void 0,hasBSC:!0,bscScope:K==="company"?"standalone":"consolidated"})},V=K=>{if(g){K.key==="Enter"?(K.preventDefault(),te()):K.key==="Escape"&&(K.preventDefault(),y(e.name),v(!1));return}N&&(K.key==="Enter"?(K.preventDefault(),e.entityType!=="corporation"&&ue()):K.key==="Tab"&&!K.shiftKey?(K.preventDefault(),O&&ee()):K.key==="F2"||K.key==="Enter"&&K.ctrlKey?(K.preventDefault(),v(!0)):(K.key==="Delete"||K.key==="Backspace")&&e.entityType!=="corporation"&&(K.preventDefault(),i(e.id)))};return o.jsxs("div",{children:[L&&o.jsx(m2,{id:`${e.id}:before`,isActive:c?.entityId===e.id&&c?.position==="before",position:"before",depth:r}),o.jsxs("div",{ref:M,className:`
          flex items-center gap-2 px-2 py-1.5 rounded-lg group transition-colors
          ${C?"opacity-50 bg-[var(--cds-interactive)]/20":"hover:bg-[var(--cds-background-hover)]"}
          ${N?"bg-[var(--cds-background-active)] ring-1 ring-[var(--cds-interactive)]":""}
        `,style:{...R,paddingLeft:`${r*20+8}px`},onClick:()=>f(e.id),onKeyDown:V,tabIndex:0,children:[o.jsx("div",{...A,...D,className:"cursor-grab active:cursor-grabbing p-0.5 text-[var(--cds-icon-secondary)] hover:text-[var(--cds-icon-primary)] transition-colors touch-none",children:o.jsx(ld,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:K=>{K.stopPropagation(),p(!h)},className:`w-5 h-5 flex items-center justify-center rounded hover:bg-[var(--cds-background-active)] ${T?"":"invisible"}`,children:h?o.jsx(Ra,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"}):o.jsx(ha,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"})}),Rf[e.entityType],g?o.jsx("input",{ref:w,type:"text",value:b,onChange:K=>y(K.target.value),onBlur:te,onKeyDown:V,onClick:K=>K.stopPropagation(),className:"flex-1 px-2 py-0.5 text-sm bg-[var(--cds-field-01)] border border-[var(--cds-border-strong-01)] rounded focus:outline-none focus:border-[var(--cds-focus)]"}):o.jsx("span",{className:"flex-1 text-sm text-[var(--cds-text-primary)] cursor-text",onDoubleClick:K=>{K.stopPropagation(),v(!0)},children:e.name}),o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-[var(--cds-field-02)] text-[var(--cds-text-secondary)] rounded",children:dp[e.entityType]}),e.hasBSC&&o.jsxs("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded ${e.bscScope==="consolidated"?"bg-[var(--cds-support-info)]/20 text-[var(--cds-support-info)]":"bg-[var(--cds-support-success)]/20 text-[var(--cds-support-success)]"}`,children:["BSC: ",e.bscScope]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[O&&o.jsx("button",{onClick:K=>{K.stopPropagation(),ee()},className:"p-1 rounded hover:bg-[var(--cds-background-active)]",title:`Add ${dp[E]} (Tab)`,children:o.jsx(Ir,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"})}),o.jsx("button",{onClick:K=>{K.stopPropagation(),v(!0)},className:"p-1 rounded hover:bg-[var(--cds-background-active)]",title:"Edit (F2)",children:o.jsx(sl,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"})}),e.entityType!=="corporation"&&o.jsx("button",{onClick:K=>{K.stopPropagation(),i(e.id)},className:"p-1 rounded hover:bg-[var(--cds-support-error)]/20",title:"Delete (Del)",children:o.jsx(ac,{className:"w-3.5 h-3.5 text-[var(--cds-support-error)]"})})]})]}),L&&O&&o.jsx(m2,{id:`${e.id}:child`,isActive:c?.entityId===e.id&&c?.position==="child",position:"child",depth:r}),L&&o.jsx(m2,{id:`${e.id}:after`,isActive:c?.entityId===e.id&&c?.position==="after",position:"after",depth:r}),h&&T&&o.jsx("div",{children:j.sort((K,ie)=>K.displayOrder-ie.displayOrder).map(K=>o.jsx(sB,{entity:K,entities:t,depth:r+1,onAdd:n,onUpdate:a,onDelete:i,activeId:s,dropTarget:c,selectedId:d,onSelect:f},K.id))})]})},Pwe=({entities:e,onAdd:t,onUpdate:r,onDelete:n})=>{const[a,i]=k.useState(null),[s,c]=k.useState(null),[d,f]=k.useState(null),h=jg(Sc(Eg,{activationConstraint:{distance:8}}),Sc(Tg,{activationConstraint:{delay:200,tolerance:5}})),p=e.filter(w=>!w.parentEntityId),g=a?e.find(w=>w.id===a):null,v=w=>{i(w.active.id)},b=w=>{const{over:j}=w;if(!j){c(null);return}const T=j.id;if(T.includes(":")){const[N,C]=T.split(":");c({entityId:N,position:C})}else c({entityId:T,position:"child"})},y=w=>{const{active:j}=w,T=s;if(i(null),c(null),!T)return;const N=j.id,C=e.find(P=>P.id===N),E=e.find(P=>P.id===T.entityId);if(!C||!E||N===T.entityId)return;const{position:O}=T;let A;if(O==="child"?A=E.id:A=E.parentEntityId,A&&iB(e,N,A))return;if(A){const P=e.find(R=>R.id===A);if(P&&aB(P.entityType)!==C.entityType)return}else if(C.entityType!=="corporation")return;const D=e.filter(P=>P.parentEntityId===A&&P.id!==N).sort((P,R)=>P.displayOrder-R.displayOrder);let M;if(O==="child")M=D.length;else if(O==="before"){const P=D.findIndex(R=>R.id===E.id);M=P>=0?P:0}else{const P=D.findIndex(R=>R.id===E.id);M=P>=0?P+1:D.length}r(N,{parentEntityId:A,displayOrder:M}),D.forEach((P,R)=>{const L=R>=M?R+1:R;P.displayOrder!==L&&r(P.id,{displayOrder:L})})};return o.jsxs(Og,{sensors:h,collisionDetection:PN,onDragStart:v,onDragOver:b,onDragEnd:y,children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"p-3 bg-[var(--cds-notification-info-background)] border-l-4 border-[var(--cds-support-info)] rounded-r",children:o.jsxs("p",{className:"text-sm text-[var(--cds-text-primary)]",children:["Define your corporate structure. Drag to reorder. ",o.jsx("strong",{children:"Enter"})," adds sibling, ",o.jsx("strong",{children:"Tab"})," adds child, ",o.jsx("strong",{children:"F2"})," to edit."]})}),o.jsx("div",{className:"border border-[var(--cds-border-subtle-00)] rounded-lg bg-[var(--cds-layer-01)] min-h-[200px]",children:p.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-[var(--cds-text-secondary)]",children:[o.jsx(gl,{className:"w-12 h-12 mb-3 opacity-40"}),o.jsx("p",{className:"text-sm mb-4",children:"No corporate structure defined yet."}),o.jsxs("button",{onClick:()=>t({name:"My Corporation",entityType:"corporation",hasBSC:!0,bscScope:"consolidated"}),className:"flex items-center gap-2 px-4 py-2 bg-[var(--cds-interactive)] text-white rounded hover:bg-[var(--cds-interactive)]/90",children:[o.jsx(Ir,{className:"w-4 h-4"}),o.jsx("span",{children:"Create Corporation"})]})]}):o.jsx("div",{className:"py-2",children:p.sort((w,j)=>w.displayOrder-j.displayOrder).map(w=>o.jsx(sB,{entity:w,entities:e,depth:0,onAdd:t,onUpdate:r,onDelete:n,activeId:a,dropTarget:s,selectedId:d,onSelect:f},w.id))})}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-[var(--cds-text-secondary)]",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[Rf.corporation,o.jsx("span",{children:"Corporation (Root)"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[Rf.holding,o.jsx("span",{children:"Holding Company"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[Rf.company,o.jsx("span",{children:"Operating Company"})]})]})]}),o.jsx(Ig,{children:g&&o.jsx("div",{className:"bg-[var(--cds-layer-01)] border border-[var(--cds-interactive)] rounded-lg shadow-xl px-4 py-2 opacity-90",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ld,{className:"w-4 h-4 text-[var(--cds-interactive)]"}),Rf[g.entityType],o.jsx("span",{className:"text-[var(--cds-text-primary)] font-medium",children:g.name})]})})})]})},Fwe=({entities:e,onAdd:t,onUpdate:r,onDelete:n})=>o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-[var(--cds-text-primary)] mb-2",children:"Corporate Structure"}),o.jsx("p",{className:"text-sm text-[var(--cds-text-secondary)]",children:"Define your corporate hierarchy starting with the root Corporation, then add any Holding Companies and Operating Companies. Each Operating Company can have its own organizational structure (Directorates, Divisions, etc.)."})]}),o.jsx(Pwe,{entities:e,onAdd:t,onUpdate:r,onDelete:n}),o.jsxs("div",{className:"p-4 bg-[var(--cds-layer-02)] rounded-lg border border-[var(--cds-border-subtle-00)]",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--cds-text-primary)] mb-2",children:"Tips"}),o.jsxs("ul",{className:"space-y-1 text-xs text-[var(--cds-text-secondary)]",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Corporation"})," is the root entity - typically your parent company or main legal entity."]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Holding Companies"})," are intermediate entities that own other companies (e.g., regional holdings)."]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Operating Companies"})," are the entities where actual business operations occur. Each will have its own organizational structure."]}),o.jsxs("li",{children:[o.jsx("strong",{children:"BSC Scope"}),": Consolidated means metrics roll up from children; Standalone means independent tracking."]})]})]})]}),Iu={directorate:o.jsx(ri,{className:"w-4 h-4 text-[var(--cds-support-info)]"}),division:o.jsx(t5,{className:"w-4 h-4 text-[var(--cds-support-warning)]"}),department:o.jsx(mc,{className:"w-4 h-4 text-[var(--cds-support-success)]"}),section:o.jsx(JH,{className:"w-4 h-4 text-[var(--cds-text-secondary)]"})},fp={directorate:"Directorate",division:"Division",department:"Department",section:"Section"};function lB(e,t,r){let n=e.find(a=>a.id===r);for(;n;){if(n.id===t)return!0;n=e.find(a=>a.id===n?.parentId)}return!1}const p2=({id:e,isActive:t,position:r,depth:n})=>{const{setNodeRef:a,isOver:i}=dh({id:e}),s=i||t;return r==="child"?o.jsx("div",{ref:a,className:`
          mx-2 my-1 rounded-lg border-2 border-dashed transition-all
          ${s?"h-8 border-[var(--cds-interactive)] bg-[var(--cds-interactive)]/10":"h-0 border-transparent"}
        `,style:{marginLeft:`${(n+1)*20+8}px`},children:s&&o.jsxs("div",{className:"flex items-center gap-2 h-full px-3 text-xs text-[var(--cds-interactive)]",children:[o.jsx(Jw,{className:"w-3 h-3"}),o.jsx("span",{children:"Drop as child"})]})}):o.jsx("div",{ref:a,className:`relative transition-all ${s?"h-1":"h-0"}`,children:s&&o.jsx("div",{className:"absolute left-0 right-0 h-1 bg-[var(--cds-interactive)]",style:{marginLeft:`${n*20+8}px`},children:o.jsx("div",{className:"absolute -left-1 -top-1 w-3 h-3 bg-[var(--cds-interactive)] rounded-full"})})})},oB=({unit:e,units:t,depth:r,onAdd:n,onUpdate:a,onDelete:i,activeId:s,dropTarget:c,selectedId:d,onSelect:f})=>{const[h,p]=k.useState(!0),[g,v]=k.useState(!1),[b,y]=k.useState(e.name),w=k.useRef(null),j=t.filter(ie=>ie.parentId===e.id),T=j.length>0,N=d===e.id,C=s===e.id,E=II(e.level),O=E!==null,A=e.level==="section",{attributes:D,listeners:M,setNodeRef:P,transform:R}=Dg({id:e.id}),L=R?{transform:`translate3d(${R.x}px, ${R.y}px, 0)`,zIndex:1e3}:void 0,te=s!==null&&s!==e.id&&!lB(t,s,e.id);k.useEffect(()=>{g&&w.current&&(w.current.focus(),w.current.select())},[g]);const ee=()=>{b.trim()?a(e.id,{name:b.trim()}):y(e.name),v(!1)},ue=()=>{E&&(n({name:`New ${fp[E]}`,level:E,companyId:e.companyId,parentId:e.id,hasBSC:!y2.includes(E)}),p(!0))},V=()=>{n({name:`New ${fp[e.level]}`,level:e.level,companyId:e.companyId,parentId:e.parentId,hasBSC:!y2.includes(e.level)})},K=ie=>{if(g){ie.key==="Enter"?(ie.preventDefault(),ee()):ie.key==="Escape"&&(ie.preventDefault(),y(e.name),v(!1));return}N&&(ie.key==="Enter"?(ie.preventDefault(),V()):ie.key==="Tab"&&!ie.shiftKey?(ie.preventDefault(),O&&ue()):ie.key==="F2"||ie.key==="Enter"&&ie.ctrlKey?(ie.preventDefault(),v(!0)):(ie.key==="Delete"||ie.key==="Backspace")&&(ie.preventDefault(),i(e.id)))};return o.jsxs("div",{children:[te&&o.jsx(p2,{id:`${e.id}:before`,isActive:c?.unitId===e.id&&c?.position==="before",position:"before",depth:r}),o.jsxs("div",{ref:P,className:`
          flex items-center gap-2 px-2 py-1.5 rounded-lg group transition-colors
          ${C?"opacity-50 bg-[var(--cds-interactive)]/20":"hover:bg-[var(--cds-background-hover)]"}
          ${N?"bg-[var(--cds-background-active)] ring-1 ring-[var(--cds-interactive)]":""}
        `,style:{...L,paddingLeft:`${r*20+8}px`},onClick:()=>f(e.id),onKeyDown:K,tabIndex:0,children:[o.jsx("div",{...D,...M,className:"cursor-grab active:cursor-grabbing p-0.5 text-[var(--cds-icon-secondary)] hover:text-[var(--cds-icon-primary)] transition-colors touch-none",children:o.jsx(ld,{className:"w-3.5 h-3.5"})}),o.jsx("button",{onClick:ie=>{ie.stopPropagation(),p(!h)},className:`w-5 h-5 flex items-center justify-center rounded hover:bg-[var(--cds-background-active)] ${T?"":"invisible"}`,children:h?o.jsx(Ra,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"}):o.jsx(ha,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"})}),Iu[e.level],g?o.jsx("input",{ref:w,type:"text",value:b,onChange:ie=>y(ie.target.value),onBlur:ee,onKeyDown:K,onClick:ie=>ie.stopPropagation(),className:"flex-1 px-2 py-0.5 text-sm bg-[var(--cds-field-01)] border border-[var(--cds-border-strong-01)] rounded focus:outline-none focus:border-[var(--cds-focus)]"}):o.jsx("span",{className:"flex-1 text-sm text-[var(--cds-text-primary)] cursor-text",onDoubleClick:ie=>{ie.stopPropagation(),v(!0)},children:e.name}),o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-[var(--cds-field-02)] text-[var(--cds-text-secondary)] rounded",children:fp[e.level]}),e.hasBSC?o.jsx("span",{className:"px-1.5 py-0.5 text-[10px] font-medium bg-[var(--cds-support-success)]/20 text-[var(--cds-support-success)] rounded",children:"BSC"}):A&&o.jsxs("span",{className:"flex items-center gap-1 px-1.5 py-0.5 text-[10px] font-medium bg-[var(--cds-notification-warning-background)] text-[var(--cds-support-warning)] rounded",title:"Sections are operational only and cannot have BSC",children:[o.jsx(_n,{className:"w-3 h-3"}),"No BSC"]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[O&&o.jsx("button",{onClick:ie=>{ie.stopPropagation(),ue()},className:"p-1 rounded hover:bg-[var(--cds-background-active)]",title:`Add ${fp[E]} (Tab)`,children:o.jsx(Ir,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"})}),o.jsx("button",{onClick:ie=>{ie.stopPropagation(),v(!0)},className:"p-1 rounded hover:bg-[var(--cds-background-active)]",title:"Edit (F2)",children:o.jsx(sl,{className:"w-3.5 h-3.5 text-[var(--cds-icon-secondary)]"})}),o.jsx("button",{onClick:ie=>{ie.stopPropagation(),i(e.id)},className:"p-1 rounded hover:bg-[var(--cds-support-error)]/20",title:"Delete (Del)",children:o.jsx(ac,{className:"w-3.5 h-3.5 text-[var(--cds-support-error)]"})})]})]}),te&&O&&o.jsx(p2,{id:`${e.id}:child`,isActive:c?.unitId===e.id&&c?.position==="child",position:"child",depth:r}),te&&o.jsx(p2,{id:`${e.id}:after`,isActive:c?.unitId===e.id&&c?.position==="after",position:"after",depth:r}),h&&T&&o.jsx("div",{children:j.map(ie=>o.jsx(oB,{unit:ie,units:t,depth:r+1,onAdd:n,onUpdate:a,onDelete:i,activeId:s,dropTarget:c,selectedId:d,onSelect:f},ie.id))})]})},Lwe=({orgUnits:e,companyId:t,companies:r,onAdd:n,onUpdate:a,onDelete:i,onSelectCompany:s})=>{const[c,d]=k.useState(null),[f,h]=k.useState(null),[p,g]=k.useState(null),v=jg(Sc(Eg,{activationConstraint:{distance:8}}),Sc(Tg,{activationConstraint:{delay:200,tolerance:5}})),b=e.filter(E=>E.companyId===t),y=b.filter(E=>!E.parentId),w=r.find(E=>E.id===t),j=c?b.find(E=>E.id===c):null,T=E=>{d(E.active.id)},N=E=>{const{over:O}=E;if(!O){h(null);return}const A=O.id;if(A.includes(":")){const[D,M]=A.split(":");h({unitId:D,position:M})}else h({unitId:A,position:"child"})},C=E=>{const{active:O}=E,A=f;if(d(null),h(null),!A)return;const D=O.id,M=b.find(te=>te.id===D),P=b.find(te=>te.id===A.unitId);if(!M||!P||D===A.unitId)return;const{position:R}=A;let L;if(R==="child"?L=P.id:L=P.parentId??void 0,!(L&&lB(b,D,L))){if(L){const te=b.find(ee=>ee.id===L);if(te&&II(te.level)!==M.level)return}else if(M.level!=="directorate")return;a(D,{parentId:L})}};return o.jsxs(Og,{sensors:v,collisionDetection:PN,onDragStart:T,onDragOver:N,onDragEnd:C,children:[o.jsxs("div",{className:"space-y-4",children:[r.length>1&&o.jsx("div",{className:"flex items-center gap-2 pb-3 border-b border-[var(--cds-border-subtle-00)] overflow-x-auto",children:r.map(E=>o.jsxs("button",{onClick:()=>s(E.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm whitespace-nowrap transition-colors ${E.id===t?"bg-[var(--cds-interactive)] text-white":"bg-[var(--cds-field-01)] text-[var(--cds-text-secondary)] hover:bg-[var(--cds-background-hover)]"}`,children:[o.jsx(ri,{className:"w-3.5 h-3.5"}),o.jsx("span",{children:E.name})]},E.id))}),o.jsx("div",{className:"p-3 bg-[var(--cds-notification-info-background)] border-l-4 border-[var(--cds-support-info)] rounded-r",children:o.jsx("p",{className:"text-sm text-[var(--cds-text-primary)]",children:w?o.jsxs(o.Fragment,{children:["Define the organizational structure for ",o.jsx("strong",{children:w.name}),". Drag to reorder. ",o.jsx("strong",{children:"Enter"})," adds sibling, ",o.jsx("strong",{children:"Tab"})," adds child, ",o.jsx("strong",{children:"F2"})," to edit."]}):"Select a company to define its organizational structure."})}),o.jsx("div",{className:"border border-[var(--cds-border-subtle-00)] rounded-lg bg-[var(--cds-layer-01)] min-h-[200px]",children:w?y.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-[var(--cds-text-secondary)]",children:[o.jsx(t5,{className:"w-12 h-12 mb-3 opacity-40"}),o.jsx("p",{className:"text-sm mb-4",children:"No organizational units defined for this company."}),o.jsxs("button",{onClick:()=>n({name:"New Directorate",level:"directorate",companyId:t,hasBSC:!0}),className:"flex items-center gap-2 px-4 py-2 bg-[var(--cds-interactive)] text-white rounded hover:bg-[var(--cds-interactive)]/90",children:[o.jsx(Ir,{className:"w-4 h-4"}),o.jsx("span",{children:"Add Directorate"})]})]}):o.jsxs("div",{className:"py-2",children:[y.map(E=>o.jsx(oB,{unit:E,units:b,depth:0,onAdd:n,onUpdate:a,onDelete:i,activeId:c,dropTarget:f,selectedId:p,onSelect:g},E.id)),o.jsxs("button",{onClick:()=>n({name:"New Directorate",level:"directorate",companyId:t,hasBSC:!0}),className:"flex items-center gap-2 px-4 py-2 mt-2 ml-2 text-sm text-[var(--cds-link-primary)] hover:bg-[var(--cds-background-hover)] rounded",children:[o.jsx(Ir,{className:"w-4 h-4"}),o.jsx("span",{children:"Add Directorate"})]})]}):o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-[var(--cds-text-secondary)]",children:[o.jsx(_n,{className:"w-12 h-12 mb-3 opacity-40"}),o.jsx("p",{className:"text-sm",children:"No company selected or no companies defined."})]})}),o.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-xs text-[var(--cds-text-secondary)]",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[Iu.directorate,o.jsx("span",{children:"Directorate"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[Iu.division,o.jsx("span",{children:"Division"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[Iu.department,o.jsx("span",{children:"Department"})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[Iu.section,o.jsx("span",{children:"Section (No BSC)"})]})]})]}),o.jsx(Ig,{children:j&&o.jsx("div",{className:"bg-[var(--cds-layer-01)] border border-[var(--cds-interactive)] rounded-lg shadow-xl px-4 py-2 opacity-90",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ld,{className:"w-4 h-4 text-[var(--cds-interactive)]"}),Iu[j.level],o.jsx("span",{className:"text-[var(--cds-text-primary)] font-medium",children:j.name})]})})})]})},Bwe=({orgUnits:e,corporateEntities:t,selectedCompanyId:r,onAdd:n,onUpdate:a,onDelete:i,onSelectCompany:s})=>{const c=t.filter(d=>d.entityType==="company"&&d.isActive);return k.useEffect(()=>{!r&&c.length>0&&s(c[0].id)},[r,c,s]),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-[var(--cds-text-primary)] mb-2",children:"Organization Structure"}),o.jsx("p",{className:"text-sm text-[var(--cds-text-secondary)]",children:"Define the organizational units within each Operating Company. The hierarchy goes: Directorate  Division  Department  Section. Note that Sections are operational only and cannot have BSC metrics."})]}),c.length===0?o.jsx("div",{className:"p-6 text-center bg-[var(--cds-notification-warning-background)] rounded-lg border border-[var(--cds-support-warning)]",children:o.jsx("p",{className:"text-sm text-[var(--cds-text-primary)]",children:"No Operating Companies defined yet. Please go back to the Corporate Structure step and add at least one Operating Company."})}):o.jsx(Lwe,{orgUnits:e,companyId:r||c[0].id,companies:c,onAdd:n,onUpdate:a,onDelete:i,onSelectCompany:s}),o.jsxs("div",{className:"p-4 bg-[var(--cds-layer-02)] rounded-lg border border-[var(--cds-border-subtle-00)]",children:[o.jsx("h3",{className:"text-sm font-semibold text-[var(--cds-text-primary)] mb-2",children:"Tips"}),o.jsxs("ul",{className:"space-y-1 text-xs text-[var(--cds-text-secondary)]",children:[o.jsxs("li",{children:[o.jsx("strong",{children:"Directorates"})," are top-level organizational units (e.g., Technology, Operations, Finance)."]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Divisions"})," are major sub-units within a Directorate."]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Departments"})," are functional teams within a Division."]}),o.jsxs("li",{children:[o.jsx("strong",{children:"Sections"})," are the smallest operational units - they cannot have their own BSC metrics."]}),o.jsx("li",{children:"You can always edit this structure later in Settings  Organization."})]})]})]})},dI=[{name:"Financial",description:"Financial performance and growth objectives",icon:Ac,color:"#22c55e"},{name:"Customer",description:"Customer satisfaction and market position",icon:ri,color:"#3b82f6"},{name:"Internal Processes",description:"Operational excellence and efficiency",icon:j$,color:"#f59e0b"},{name:"Learning & Growth",description:"People development and organizational capability",icon:gr,color:"#8b5cf6"}],Uwe=({pillars:e,corporateEntities:t,orgUnits:r,onAdd:n,onUpdate:a,onDelete:i})=>{const s=t.filter(p=>p.entityType==="company"),c=new Set(e.map(p=>p.name.toLowerCase())),d=()=>{dI.forEach((p,g)=>{c.has(p.name.toLowerCase())||n({id:`pillar-${p.name.toLowerCase().replace(/\s+/g,"-")}-${Date.now()}`,name:p.name,description:p.description,displayOrder:e.length+g,ragStatus:"green"})})},f=t.filter(p=>p.hasBSC).length,h=r.filter(p=>p.hasBSC).length;return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold text-[var(--cds-text-primary)] mb-2",children:"Golden Thread Setup"}),o.jsx("p",{className:"text-sm text-[var(--cds-text-secondary)]",children:'The "Golden Thread" connects your strategy to execution. Configure your Balanced Scorecard (BSC) pillars that will cascade through your organization.'})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-[var(--cds-layer-02)] rounded-lg border border-[var(--cds-border-subtle-00)]",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(gr,{className:"w-5 h-5 text-[var(--cds-support-info)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--cds-text-primary)]",children:"BSC Pillars"})]}),o.jsx("p",{className:"text-2xl font-bold text-[var(--cds-text-primary)]",children:e.length}),o.jsx("p",{className:"text-xs text-[var(--cds-text-secondary)]",children:"Strategy perspectives defined"})]}),o.jsxs("div",{className:"p-4 bg-[var(--cds-layer-02)] rounded-lg border border-[var(--cds-border-subtle-00)]",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(Ac,{className:"w-5 h-5 text-[var(--cds-support-success)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--cds-text-primary)]",children:"Corporate BSC"})]}),o.jsx("p",{className:"text-2xl font-bold text-[var(--cds-text-primary)]",children:f}),o.jsx("p",{className:"text-xs text-[var(--cds-text-secondary)]",children:"Entities with BSC enabled"})]}),o.jsxs("div",{className:"p-4 bg-[var(--cds-layer-02)] rounded-lg border border-[var(--cds-border-subtle-00)]",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(ri,{className:"w-5 h-5 text-[var(--cds-support-warning)]"}),o.jsx("span",{className:"text-sm font-medium text-[var(--cds-text-primary)]",children:"Organization BSC"})]}),o.jsx("p",{className:"text-2xl font-bold text-[var(--cds-text-primary)]",children:h}),o.jsx("p",{className:"text-xs text-[var(--cds-text-secondary)]",children:"Org units with BSC enabled"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold text-[var(--cds-text-primary)]",children:"Balanced Scorecard Pillars"}),e.length<4&&o.jsxs("button",{onClick:d,className:"flex items-center gap-2 px-3 py-1.5 text-sm bg-[var(--cds-interactive)] text-white rounded hover:bg-[var(--cds-interactive)]/90",children:[o.jsx(gr,{className:"w-4 h-4"}),o.jsx("span",{children:"Create Default Pillars"})]})]}),e.length===0?o.jsxs("div",{className:"p-6 text-center bg-[var(--cds-notification-info-background)] rounded-lg border border-[var(--cds-support-info)]",children:[o.jsx(gr,{className:"w-12 h-12 mx-auto mb-3 text-[var(--cds-support-info)] opacity-50"}),o.jsx("p",{className:"text-sm text-[var(--cds-text-primary)] mb-4",children:"No BSC pillars defined yet. Create the standard Balanced Scorecard pillars or customize your own."}),o.jsxs("button",{onClick:d,className:"inline-flex items-center gap-2 px-4 py-2 bg-[var(--cds-interactive)] text-white rounded hover:bg-[var(--cds-interactive)]/90",children:[o.jsx(gr,{className:"w-4 h-4"}),o.jsx("span",{children:"Create Default Pillars"})]})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:dI.map(p=>{const g=e.find(b=>b.name.toLowerCase()===p.name.toLowerCase()),v=p.icon;return o.jsx("div",{className:`p-4 rounded-lg border ${g?"bg-[var(--cds-layer-02)] border-[var(--cds-border-subtle-00)]":"bg-[var(--cds-layer-01)] border-dashed border-[var(--cds-border-subtle-01)]"}`,children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${p.color}20`},children:o.jsx(v,{className:"w-5 h-5",style:{color:p.color}})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h4",{className:"font-medium text-[var(--cds-text-primary)]",children:g?.name||p.name}),g&&o.jsx(Zf,{className:"w-4 h-4 text-[var(--cds-support-success)]"})]}),o.jsx("p",{className:"text-xs text-[var(--cds-text-secondary)] mt-1",children:g?.description||p.description}),!g&&o.jsx("span",{className:"text-xs text-[var(--cds-text-placeholder)] italic",children:"Not yet created"})]})]})},p.name)})})]}),o.jsx("div",{className:"p-4 bg-[var(--cds-notification-success-background)] rounded-lg border border-[var(--cds-support-success)]",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Zf,{className:"w-5 h-5 text-[var(--cds-support-success)] mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-[var(--cds-text-primary)]",children:"Ready to Complete Setup"}),o.jsx("p",{className:"text-sm text-[var(--cds-text-secondary)] mt-1",children:'You can always return to Settings to modify your corporate structure, organization units, and BSC pillars. Click "Complete Setup" to save your configuration and start using StratOS AI.'})]})]})}),(s.length===0||e.length===0)&&o.jsx("div",{className:"p-4 bg-[var(--cds-notification-warning-background)] rounded-lg border border-[var(--cds-support-warning)]",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(_n,{className:"w-5 h-5 text-[var(--cds-support-warning)] mt-0.5"}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-medium text-[var(--cds-text-primary)]",children:"Setup Incomplete"}),o.jsxs("ul",{className:"text-sm text-[var(--cds-text-secondary)] mt-1 list-disc list-inside",children:[s.length===0&&o.jsx("li",{children:"At least one Operating Company is required"}),e.length===0&&o.jsx("li",{children:"At least one BSC pillar should be defined"})]})]})]})})]})},zwe=({onComplete:e,onCancel:t})=>{const r=Iwe(),n=()=>{r.saveAndComplete(),e?.()},a=()=>{r.cancel(),t?.()},i=r.state.corporateEntities.filter(c=>c.entityType==="company"&&c.isActive),s=r.state.corporateEntities.length>0&&i.length>0;return o.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col bg-[var(--cds-background)]",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-[var(--cds-layer-01)] border-b border-[var(--cds-border-subtle-00)]",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-semibold text-[var(--cds-text-primary)]",children:"StratOS AI Setup Wizard"}),o.jsx("p",{className:"text-sm text-[var(--cds-text-secondary)]",children:"Configure your corporate and organizational structure"})]}),o.jsx("button",{onClick:a,className:"p-2 rounded-lg text-[var(--cds-text-secondary)] hover:bg-[var(--cds-background-hover)] transition-colors",title:"Cancel",children:o.jsx(B0,{className:"w-5 h-5"})})]}),o.jsx(Mwe,{currentStep:r.currentStep,onStepClick:r.goToStep}),o.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.currentStep==="corporate"&&o.jsx(Fwe,{entities:r.state.corporateEntities,onAdd:r.addCorporateEntity,onUpdate:r.updateCorporateEntity,onDelete:r.deleteCorporateEntity}),r.currentStep==="organization"&&o.jsx(Bwe,{orgUnits:r.state.orgUnits,corporateEntities:r.state.corporateEntities,selectedCompanyId:r.state.selectedCompanyId,onAdd:r.addOrgUnit,onUpdate:r.updateOrgUnit,onDelete:r.deleteOrgUnit,onSelectCompany:r.selectCompany}),r.currentStep==="golden-thread"&&o.jsx(Uwe,{pillars:r.state.pillars,corporateEntities:r.state.corporateEntities,orgUnits:r.state.orgUnits,onAdd:r.addPillar,onUpdate:r.updatePillar,onDelete:r.deletePillar})]})}),o.jsxs("div",{className:"flex items-center justify-between px-6 py-4 bg-[var(--cds-layer-01)] border-t border-[var(--cds-border-subtle-00)]",children:[o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("button",{onClick:r.reset,className:"flex items-center gap-2 px-4 py-2 text-sm text-[var(--cds-text-secondary)] hover:bg-[var(--cds-background-hover)] rounded-lg transition-colors",title:"Reset all data",children:[o.jsx(i5,{className:"w-4 h-4"}),o.jsx("span",{children:"Reset"})]})}),o.jsxs("div",{className:"flex items-center gap-3",children:[r.canGoBack&&o.jsxs("button",{onClick:r.goBack,className:"flex items-center gap-2 px-4 py-2 text-sm text-[var(--cds-text-primary)] bg-[var(--cds-field-01)] hover:bg-[var(--cds-background-hover)] rounded-lg transition-colors",children:[o.jsx(Fx,{className:"w-4 h-4"}),o.jsx("span",{children:"Back"})]}),r.canGoNext?o.jsxs("button",{onClick:r.goNext,className:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-[var(--cds-interactive)] hover:bg-[var(--cds-interactive)]/90 rounded-lg transition-colors",children:[o.jsx("span",{children:"Next"}),o.jsx(Kt,{className:"w-4 h-4"})]}):o.jsxs("button",{onClick:n,disabled:!s,className:"flex items-center gap-2 px-4 py-2 text-sm text-white bg-[var(--cds-support-success)] hover:bg-[var(--cds-support-success)]/90 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:s?void 0:"At least one corporation and operating company is required",children:[o.jsx(Zf,{className:"w-4 h-4"}),o.jsx("span",{children:"Complete Setup"})]})]})]})]})},$we=()=>{const e=fa(),t=()=>{e("/")},r=()=>{e(-1)};return o.jsx(zwe,{onComplete:t,onCancel:r})};function Hwe(){return o.jsx(fz,{children:o.jsx(zz,{children:o.jsx(dz,{children:o.jsx(Gz,{children:o.jsx(Hz,{children:o.jsx(qz,{children:o.jsx(Lz,{children:o.jsx(VU,{children:o.jsxs(bU,{children:[o.jsxs(sa,{path:"/",element:o.jsx(pV,{}),children:[o.jsx(sa,{index:!0,element:o.jsx(Ele,{})}),o.jsx(sa,{path:"strategy",element:o.jsx(Kce,{})}),o.jsx(sa,{path:"portfolio",element:o.jsx(Ule,{})}),o.jsx(sa,{path:"execution",element:o.jsx(LO,{})}),o.jsx(sa,{path:"execution/:projectId",element:o.jsx(LO,{})}),o.jsx(sa,{path:"project/:projectId",element:o.jsx(Owe,{})}),o.jsx(sa,{path:"insights",element:o.jsx(Jce,{})}),o.jsx(sa,{path:"export",element:o.jsx(a2e,{})}),o.jsx(sa,{path:"import",element:o.jsx(wwe,{})}),o.jsx(sa,{path:"resources",element:o.jsx(Swe,{})}),o.jsx(sa,{path:"settings",element:o.jsx(Twe,{})}),o.jsx(sa,{path:"help",element:o.jsx(Cwe,{})})]}),o.jsx(sa,{path:"setup-wizard",element:o.jsx($we,{})})]})})})})})})})})})}_7.createRoot(document.getElementById("root")).render(o.jsx(k.StrictMode,{children:o.jsx(Hwe,{})}));
